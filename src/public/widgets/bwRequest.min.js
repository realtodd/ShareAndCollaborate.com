$.widget("bw.bwRequest",{options:{lastSavedJson:[],requestWorkflowTasks:[],Checklists:null,Workflows:null,CurrentWorkflow:null,ActiveForms:[],lastPoppedOutZoom:1,store:null,operationUriPrefix:null,numberOfRequestFormsCurrentlyDisplayed:0,dragSourceAttachmentElement:null,displayWorkflowPicker:!1,displayRoleIdColumn:!1},_create:function(){var t,u,f,r,n;this.element.addClass("bwRequest");try{console.log("In bwRequest._create().");t=this;this.options.operationUriPrefix==null&&(u=window.location.href.split("https://")[1],f=u.split("/")[0],this.options.operationUriPrefix="https://"+f+"/");r=$(".bwAuthentication").bwAuthentication("option","workflowAppId");r?(console.log("In bwRequest.js._create(). Calling loadActiveForms. xcx44432-1."),t.loadActiveForms().then(function(n){if(n.status!="SUCCESS"){var i="Error in bwRequest.js._create(). "+n.status+", "+n.message;console.log(i);displayAlertDialog(i)}else t.createRequestJson()}).catch(function(n){var t="Exception in bwRequest.js._create.loadActiveForms(): "+JSON.stringify(n);console.log(t);displayAlertDialog(t)})):(alert("In bwRequest.js._create(). No workflowAppId so not loading forms."),console.log(""),console.log("In bwRequest.js._create(). No workflowAppId so not loading forms. workflowAppId: "+r),console.log(""));console.log("In bwRequest._create(). The widget has been initialized.")}catch(i){console.log("Exception in bwRequest.js._create(): "+i.message+", "+i.stack);n="";n+='<span style="font-size:24pt;color:red;">bwRequest: CANNOT RENDER THE widget<\/span>';n+="<br />";n+='<span style="">Exception in bwRequest.Create(): '+i.message+", "+i.stack+"<\/span>";t.element.html(n)}},_setOption:function(n,t){this.options[n]=t;this._update()},_update:function(){try{console.log("In _update(). This does nothing! (yet)")}catch(n){console.log("Exception in _update(): "+n.message+", "+n.stack)}},_destroy:function(){this.element.removeClass("bwRequest").text("")},getOption:function(n){try{return console.log("In getOption()."),this.options[n]}catch(t){console.log("Exception in getOption(): "+t.message+", "+t.stack)}},addSupplementalToRequest:function(n,t){var i;try{console.log("In bwRequest.js.addSupplementalToRequest().");$("#bwRequest_AddSupplementalToRequestDialog").dialog("close");alert("In bwRequest.js.addSupplementalToRequest(). source_bwBudgetRequestId: "+n+", destination_bwBudgetRequestId: "+t);var u=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),f=$(".bwAuthentication").bwAuthentication("option","participantId"),e=$(".bwAuthentication").bwAuthentication("option","participantEmail"),o=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),s=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),h={bwParticipantId_LoggedIn:f,bwActiveStateIdentifier:s,bwWorkflowAppId_LoggedIn:u,bwParticipantEmail:e,bwParticipantFriendlyName:o,source_bwBudgetRequestId:n,destination_bwBudgetRequestId:t};$.ajax({url:webserviceurl+"/addsupplementaltorequest",type:"POST",data:h,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){n.status==401?(console.log('HTTP 401 "Unauthorized".'),console.log('HTTP 401 "Unauthorized".'),console.log("Error in bwRequest.js.displayRequestForm.getsinglebudgetrequest(). xcx213124-1-1 Unauthorized. Please refresh your browser and log in again. jqXHR.status: "+n.status+", settings: "+t+", errorThrown: "+i),console.log('HTTP 401 "Unauthorized".'),console.log('HTTP 401 "Unauthorized".')):(console.log("Error in bwRequest.js.displayRequestForm():1: "+t+", "+i+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n)),alert("Error in bwRequest.js.displayRequestForm():1: "+t+", "+i+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n)))},success:function(n){try{n.status!="SUCCESS"?(console.log("Error in bwRequest.js.addSupplementalToRequest.success(): "+n.status+", "+n.message),displayAlertDialog("Error in bwRequest.js.addSupplementalToRequest.success(): "+n.status+", "+n.message)):(console.log("SUCCESS in bwRequest.js.addSupplementalToRequest.success(): "+n.status+", "+n.message),displayAlertDialog("The Supplemental has been added to the request."))}catch(t){console.log("Exception in bwRequest.js.addSupplementalToRequest():2: "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.addSupplementalToRequest():2: "+t.message+", "+t.stack)}}})}catch(r){i="Exception in bwRequest.js.addSupplementalToRequest(): "+r.message+", "+r.stack;console.log(i);displayAlertDialog(i)}},removeSupplementalFromARequest:function(n,t){var i;try{console.log("In bwRequest.js.removeSupplementalFromARequest().");$("#bwRequest_RemoveSupplementalFromARequestDialog").dialog("close");var u=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),f=$(".bwAuthentication").bwAuthentication("option","participantId"),e=$(".bwAuthentication").bwAuthentication("option","participantEmail"),o=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),s=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),h={bwParticipantId_LoggedIn:f,bwActiveStateIdentifier:s,bwWorkflowAppId_LoggedIn:u,bwParticipantEmail:e,bwParticipantFriendlyName:o,supplemental_bwBudgetRequestId:n,master_bwBudgetRequestId:t};$.ajax({url:webserviceurl+"/removesupplementalfromarequest",type:"POST",data:h,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){var r="Error in bwRequest.js.removeSupplementalFromARequest.removesupplementalfromarequest(): "+t+", "+i+", data: "+JSON.stringify(n);console.log(r);displayAlertDialog(r)},success:function(n){try{n.status!="SUCCESS"?(console.log("Error in bwRequest.js.removeSupplementalFromARequest.success(): "+n.status+", "+n.message),displayAlertDialog("Error in bwRequest.js.removeSupplementalFromARequest.success(): "+n.status+", "+n.message)):(console.log("SUCCESS in bwRequest.js.removeSupplementalFromARequest.success(): "+n.status+", "+n.message),displayAlertDialog("The Supplemental has been removed from the request."))}catch(t){console.log("Exception in bwRequest.js.removeSupplementalFromARequest():2: "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.removeSupplementalFromARequest():2: "+t.message+", "+t.stack)}}})}catch(r){i="Exception in bwRequest.js.removeSupplementalFromARequest(): "+r.message+", "+r.stack;console.log(i);displayAlertDialog(i)}},cmdCreateSupplementalAr:function(){var i,n;try{console.log("In bwRequest.js.cmdCreateSupplementalAr().");try{$("#ArDialog").dialog("close")}catch(t){}$("#bwQuickLaunchMenuTd").css({width:"0"});$("#liWelcome").hide();$("#liArchive").hide();$("#liSummaryReport").hide();$("#liConfiguration").hide();$("#liHelp").hide();$("#liNewRequest").show();i=document.getElementById("divNewRequestMasterDiv");i.style.borderRadius="20px 0 0 20px";$("#divWelcomeMasterDivTitle").text("New Supplemental Request");renderLeftButtons("divNewRequestPageLeftButtons");$("#divNewRequestPageLeftButtonsWelcomeButton").off("click").click(function(){renderWelcomeScreen()});renderNewSupplementalBudgetRequestForm(budgetRequestId,functionalAreaId,pmAccountId,brTitle)}catch(t){n="Exception in bwRequest.js.cmdCreateSupplementalAr(): "+t.message+", "+t.stack;console.log(n);displayAlertDialog(n)}},renderNewSupplementalBudgetRequestForm:function(n,t,i,r){var f,u,e;try{console.log("In bwRequest.js.renderNewSupplementalBudgetRequestForm().");f="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)});document.getElementById("myxml").innerHTML="";u="";u+='<table style="BORDER-TOP-STYLE: none; WORD-WRAP: break-word; BORDER-LEFT-STYLE: none; BORDER-COLLAPSE: collapse; TABLE-LAYOUT: fixed; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; WIDTH: 654px" class="xdFormLayout">';u+="  <colgroup>";u+='    <col style="WIDTH: 654px" />';u+="  <\/colgroup>";u+="  <tbody>";u+='    <tr class="xdTableContentRow">';u+='      <td style="BORDER-TOP: #d8d8d8 1pt solid; BORDER-RIGHT: #d8d8d8 1pt solid; VERTICAL-ALIGN: top; BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; BORDER-LEFT: #d8d8d8 1pt solid; PADDING-RIGHT: 0px" class="xdTableContentCell">';u+="        <div />";u+='        <!--<img src="../Lists/LogoImage/CompanyLogo.png" style="HEIGHT: 96px; WIDTH: 96px" />-->';u+="        <table>";u+="        <!--<tr><td>&nbsp;<\/td><\/tr>-->";u+="          <tr><td>&nbsp;<\/td><\/tr>";u+="          <tr>";u+='            <td width="5px"><\/td>';u+='            <td><!--<img src="../Lists/LogoImage/CompanyLogo.png" style="HEIGHT: 96px; WIDTH: 96px" />--><\/td>';u+='            <td><span id="spanNewRequestFormTitle"><br /><span style="font-size:200%;">&nbsp;&nbsp;&nbsp;Supplemental <strong>Budget Request<\/strong><\/span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-style:italic;font-size:150%;">for '+r+"<br /><br /><\/span><\/span><\/td>";u+="          <\/tr>";u+="        <\/table>";u+='        <div align="right">';u+='        <span class="xdlabel">';u+="          <em />";u+="        <\/span>";u+="        <\/div>";u+='        <div align="right">';u+='          <span class="xdlabel">';u+="            <em>";u+='            <font style="FONT-SIZE: 11pt">';u+='            <!--<a xd:disableEditing="yes" href="http://sp2010/budget/_layouts/help.aspx?Lcid=1033&amp;amp;Key=HelpHome&amp;amp;ShowNav=true">';u+='              <img setWidth="24" setHeight="22" src="30837E49.png" alt="SharePoint-Help-Question-Mark.png" style="BORDER-TOP: #000080 1.5pt; HEIGHT: 22px; BORDER-RIGHT: #000080 1.5pt; BORDER-BOTTOM: #000080 1.5pt; BORDER-LEFT: #000080 1.5pt; WIDTH: 24px" class="ms-rtePosition-4" />';u+="            <\/a>-->";u+='            xComplete the form then click the "Submit" button.';u+="            <\/font>";u+="            <\/em>";u+="          <\/span>";u+="        <\/div>";u+='        <div align="right">';u+='          <span class="xdlabel" id="spanNewBudgetRequestPageButtons">';u+='            <!-- <input tabindex="0" xd:xctname="Button" xd:ctrlid="CTRL81" value="Submit" type="button" style="margin: 1px" class="langFont" title="Click here to Submit the request, or click the Help icon in the top right corner of this screen..." /> -->';u+='            <!--<input type="button" name="startWorkflowButton" value="Submitxcx1" onclick="cmdCreateBudgetRequestAndStartWorkflow();" title="Click here to Submit the request." style="MARGIN: 1px; WIDTH: 200px;font-size: 20pt;cursor:pointer;" />-->';u+='            <button id="startWorkflowButton" onclick="cmdCreateSupplementalBudgetRequestAndStartWorkflow(\''+n+"', '"+f+"', '"+t+"', '"+i+'\');" class="BwButton200" title="Click here to Submit the supplemental request.">Submit<\/button>';u+="            &nbsp;";u+='            <!--<input type="button" value="Cancel" onclick="populateStartPageItem(\'divWelcome\', \'Reports\', \'\');" style="MARGIN: 1px; WIDTH: 200px;font-size: 20pt;cursor:pointer;" />-->';u+="            <button onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\" class=\"BwButton200\">Cancel<\/button>";u+="            &nbsp;";u+="          <\/span>";u+="        <\/div>";u+='        <div align="right">';u+="          &nbsp;";u+="        <\/div>";u+='        <div align="center">';u+='          <span class="xdlabel" />';u+='          <span style="BORDER-TOP: #dcdcdc 1pt; BORDER-RIGHT: #dcdcdc 1pt; WHITE-SPACE: nowrap; BORDER-BOTTOM: #dcdcdc 1pt; COLOR: #ff0000; TEXT-ALIGN: right; BORDER-LEFT: #dcdcdc 1pt; WIDTH: 100%" tabindex="-1" xd:binding="my:GlobalError" xd:xctname="PlainText" xd:ctrlid="CTRL115" xd:disableediting="yes" hidefocus="1" class="xdTextBox" title="" />';u+="        <\/div>";u+='        <div align="center">';u+='          <span class="xdlabel" />';u+="        <\/div>";u+='    <div align="center">';u+='        <table class="xdFormLayout" style="BORDER-TOP-STYLE: none; WORD-WRAP: break-word; BORDER-LEFT-STYLE: none; BORDER-COLLAPSE: collapse; TABLE-LAYOUT: fixed; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; WIDTH: 652px">';u+="            <!-- original was  WIDTH: 652px had changed to 98% for some reason...-->";u+="            <colgroup>";u+='                <col style="WIDTH: 98%" /> <!-- was style="WIDTH: 652px"-->';u+="            <\/colgroup>";u+="            <tbody>";u+='                <tr style="MIN-HEIGHT: 4px" class="xdTableContentRow">';u+='                    <td valign="top" style="BORDER-TOP: #d8d8d8 1pt solid; BORDER-BOTTOM: #d8d8d8 1pt" class="xdTableContentCell">';u+="                        <div>";u+='                            <table class="xdFormLayout xdTableStyleTwoCol" style="BORDER-TOP-STYLE: none; WORD-WRAP: break-word; BORDER-LEFT-STYLE: none; BORDER-COLLAPSE: collapse; TABLE-LAYOUT: fixed; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; WIDTH: 649px">';u+="                                <colgroup>";u+='                                    <col style="WIDTH: 169px" />';u+='                                    <col style="WIDTH: 480px" />';u+="                                <\/colgroup>";u+='                                <tbody valign="top">';u+='                                    <tr class="xdTableOffsetRow">';u+='                                        <td class="xdTableOffsetCellLabel" style="text-align:left; BORDER-TOP: #d8d8d8 1pt; VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 22px; BORDER-LEFT: #d8d8d8 1pt; PADDING-RIGHT: 5px">';u+='                                            <font color="#000000">';u+='                                                <span class="xdlabel" />';u+='                                                <span class="xdlabel">Description:<\/span>&nbsp;<span style="color:red;font-size:medium;">*<\/span>';u+="                                            <\/font>";u+="                                        <\/td>";u+='                                        <td style="BORDER-TOP: #d8d8d8 1pt; VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 22px" class="xdTableOffsetCellComponent">';u+="                                            <div>";u+="                                                <input type=\"text\" id=\"strProjectTitle\" style=\"WIDTH: 70%;font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 20pt;\" /> <!-- was 2.77em -->";u+='                                                <!--<textarea id="strProjectTitle" rows="1" style="WIDTH: 97%; HEIGHT: 18px;"><\/textarea>-->';u+="                                           <\/div>";u+="                                       <\/td>";u+="                                    <\/tr>";u+='                                    <tr class="xdTableOffsetRow">';u+='                                        <td style="text-align:left; VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 22px; BORDER-LEFT: #d8d8d8 1pt; PADDING-RIGHT: 5px" class="xdTableOffsetCellLabel">';u+='                                            <span id="spanNewRequestDetailsLabel"><span class="xdlabel">Justification details:<\/span><\/span>';u+="                                        <\/td>";u+='                                        <td style="VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 22px" class="xdTableOffsetCellComponent">';u+="                                            <div>";u+="                                                <textarea id=\"strBriefDescriptionOfProject\" rows=\"3\" style=\"WIDTH: 97%;font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 20pt;\"><\/textarea>";u+='                                                <!--<span style="WORD-WRAP: break-word; HEIGHT: 60px; WHITE-SPACE: normal; TEXT-ALIGN: left; OVERFLOW-X: auto; OVERFLOW-Y: auto; WIDTH: 451px" tabindex="0" xd:datafmt="" xd:binding="my:Brief_Description_of_Project" xd:xctname="PlainText" xd:ctrlid="CTRL83" contenteditable="true" hidefocus="1" class="xdTextBox xdBehavior_Formatting" title="" />-->';u+="                                            <\/div>";u+="                                        <\/td>";u+="                                    <\/tr>";u+='                                    <tr class="xdTableOffsetRow">';u+='                                        <td style="text-align:left; VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 22px; BORDER-LEFT: #d8d8d8 1pt; PADDING-RIGHT: 5px" class="xdTableOffsetCellLabel">';u+='                                            <span class="xdlabel">';u+='                                                <span class="xdlabel">';u+='                                                    <font color="#000000">Requested Amount:<\/font>&nbsp;<span style="color:red;font-size:medium;">*<\/span>';u+="                                                <\/span>";u+="                                            <\/span>";u+="                                        <\/td>";u+='                                        <td style="text-align:left; VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 22px" class="xdTableOffsetCellComponent">';u+="                                            <div>";u+='                                                <input type="text" id="dblRequestedCapital" onblur="formatRequestedCapital_InitBudgetRequest();" style="WIDTH: 60%;font-family: \'Segoe UI Light\',\'Segoe UI\',\'Segoe\',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 20pt;TEXT-ALIGN: right;" />';u+="                                            <\/div>";u+="                                        <\/td>";u+="                                    <\/tr>";enableNewRequestAttachments==!0&&(u+='                                    <tr id="trNewRequestAttachmentsSection" class="xdTableOffsetRow">',u+='                                        <td class="xdTableOffsetCellLabel" valign="top" style="text-align:left; BORDER-BOTTOM: #d8d8d8 1pt; BORDER-LEFT: #d8d8d8 1pt; BACKGROUND-COLOR: #ffffff">',u+='                                            <span class="xdlabel">Attachments:<\/span>',u+="                                        <\/td>",u+='                                        <td style="VERTICAL-ALIGN: top; BORDER-BOTTOM: #d8d8d8 1pt; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 22px" class="xdTableOffsetCellComponent">',u+="                                            <div>",u+='                                                <div xd:widgetindex="0" tabindex="-1" xd:xctname="RepeatingSection" xd:ctrlid="CTRL90" align="left" style="MARGIN-BOTTOM: 0px; WIDTH: 100%" class="xdRepeatingSection xdRepeating" title="">',u+="                                                    <div>",u+='                                                        <!--<span tabindex="0" tabstop="true" xd:boundprop="xd:inline" xd:binding="my:CapexAttachment" xd:xctname="FileAttachment" xd:ctrlid="CTRL91" style="HEIGHT: 30px; WIDTH: 161px" hidefocus="1" class="xdFileAttachment" />-->',u+='                                                        <input id="inputFile" type="file" onchange="uploadAttachment(\'attachments\');" style="width: 75%;" />',u+="                                                    <\/div>",u+="                                                <\/div>",u+='                                                <p id="newrequestattachments"><\/p>',u+="                                            <\/div>",u+="                                        <\/td>",u+="                                    <\/tr>");u+='<span id="BudgetRequestId" style="display: none; visibility: hidden;" xd:binding="my:BudgetRequestId"><\/span>';u+="<tr>";u+="  <td>";u+="&nbsp;";u+="";u+="";u+="";u+="";u+="  <\/td>";u+="<\/tr>";u+="                                <\/tbody>";u+="                            <\/table>";u+="                        <\/div>";u+="                    <\/td>";u+="                <\/tr>";u+="            <\/tbody>";u+="        <\/table>";u+="   <\/div>";u+="<\/td>";u+="<\/tr>";u+="<\/tbody>";u+="<\/table>";document.getElementById("budgetrequestform").innerHTML=u;document.getElementById("BudgetRequestId").innerHTML=f;displayAlertDialog("In bwRequest.js.renderNewSupplementalBudgetRequestForm. supplementalRequestId: "+f);document.getElementById("spanNewRequestDetailsLabel").innerHTML=requireRequestDetails==!0?'<span class="xdlabel">Justification details:<\/span>&nbsp;<span style="color:red;font-size:medium;">*<\/span>':'<span class="xdlabel">Justification details:<\/span>'}catch(o){e="Exception in bwRequest.js.renderNewSupplementalBudgetRequestForm(): "+o.message+", "+o.stack;console.log(e);displayAlertDialog(e)}},checkIfThereHaveBeenAnyChanges:function(n,t){var i=this;return new Promise(function(r,u){var e,s,f,o;try{if(console.log("In bwRequest.js.checkIfThereHaveBeenAnyChanges()."),n){if(!t)for(e=0;e<i.options.lastSavedJson.length;e++)if(i.options.lastSavedJson[e]&&i.options.lastSavedJson[e].bwBudgetRequestId){if(i.options.lastSavedJson[e].bwBudgetRequestId==n){t=i.options.lastSavedJson[e];break}}else alert("xcx12345-1 Error: Property [bwBudgetRequestId] does not exist: "+JSON.stringify(i.options.lastSavedJson[e]));t?(console.log("In checkIfThereHaveBeenAnyChanges(). Calling bwRequest.js.scrapeBwRequestJson(). xcx1231242-1"),s=i.scrapeBwRequestJson(n),s.then(function(i){var h,c,p,y,e,w,l,f,b,a,v,d,o,s;try{for(console.log("Returning from scrapeBwRequestJson(). xcx2131241-1"),c=document.getElementsByClassName("budgetrequestform"),f=0;f<c.length;f++)if(p=c[f].getAttribute("bwbudgetrequestid"),n==p){h=c[f];break}if(h){for(y=$(h).find("[bwwidgetname]"),e=[],f=0;f<y.length;f++)w=y[f].getAttribute("bwwidgetname"),e.push(w);for(l=[],f=0;f<e.length;f++)if(b=$(h).find("."+e[f]+":first"),$(b)[e[f]]){if(a=function(){return}(),console.log("xcx23123123-2. In checkIfThereHaveBeenAnyChanges(). Calling getData()."),v=i.bwRequestJson[e[f]].value,t[e[f]]||typeof v!="undefined"){try{a=t[e[f]].value}catch(k){}JSON.stringify(v)!=JSON.stringify(a)&&(d={widget:e[f],originalValue:JSON.stringify(a),currentValue:JSON.stringify(v)},l.push(d))}}else o="12-26-2023. NO LONGER DISPLAYING THIS message to the user. Currently it stubmled on ProjectTitle.js, which I believe has been depracated/removed/renamed. A remnant on the form defiinition. xcx2131245368894-2",console.log(o);l.length>0?(console.log("widgetsWithChanges: "+JSON.stringify(l)),s={status:"SUCCESS",message:o,results:"YES_CHANGES_TO_SAVE"},r(s)):(o="The json is the same, so let the user close the request dialog.",s={status:"SUCCESS",message:o,results:"NO_CHANGES_TO_SAVE"},r(s))}else console.log("In bwRequest.js.checkIfThereHaveBeenAnyChanges(). Could not find the form for bwBudgetRequestId: "+n),displayAlertDialog("In bwRequest.js.checkIfThereHaveBeenAnyChanges(). Could not find the form for bwBudgetRequestId: "+n)}catch(k){o="Exception in bwRequest.js.checkIfThereHaveBeenAnyChanges.scrapeBwRequestJson(): "+k.message+", "+k.stack;console.log(o);displayAlertDialog(o);s={status:"EXCEPTION",message:o};u(s)}})):(f="There is no lastSavedJson, so let the user close the request dialog. xcx88374005693.",o={status:"SUCCESS",message:f,results:"NO_CHANGES_TO_SAVE"},console.log(f),r(o))}else f="Error in bwRequest.js.checkIfThereHaveBeenAnyChanges(). Unexpected value for bwBudgetRequestId: "+n,alert(f),o={status:"ERROR",message:f},u(o)}catch(h){f="Exception in beRequest.js.checkIfThereHaveBeenAnyChanges(): "+h.message+", "+h.stack;console.log(f);displayAlertDialog(f);o={status:"EXCEPTION",message:f};u(o)}})},recoverFromTheTrashBin:function(){var n,t;try{console.log("In recoverFromTheTrashBin().");n="";n+='<table style="width:100%;">';n+="   <tr>";n+='       <td style="width:90%;">';n+="           <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size:30pt;font-weight:bold;\">TrashBin - This functionality is incomplete. Coming Soon!<\/span>";n+="           <br />";n+="       <\/td>";n+='       <td style="width:9%;"><\/td>';n+='       <td style="width:1%;cursor:pointer;vertical-align:top;">';n+='           <span class="dialogXButton" style="font-size:30pt;font-weight:bold;" onclick="$(\'#bwDataGrid_TrashBinAdminDialog\').dialog(\'close\');">X<\/span>';n+="       <\/td>";n+="   <\/tr>";n+="<\/table>";n+='<input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';n+="<table>";n+="   <tr>";n+="       <td><\/td>";n+='       <td style="text-align:right;">';n+='           <span id="spanThereAreChangesToPublishText51" style="font-style:italic;color:tomato;">';n+="An easy way to find and recover a deleted request, with all of it's incomplete and completed tasks. Notifications will have to happen accordingly, and the mapping to the new title (eg: BR-230099). ";n+='Maybe the system should ask the question, "Do you wish to merge this request with an another/existing one?". ';n+="Ensure full remediation for getting this request back into the organization smoothly. An upper-right search component will allow the user to find the exact request easily as well.";n+="           <\/span>";n+="       <\/td>";n+="       <td><\/td>";n+="   <\/tr>";n+="<\/table>";n+="<br />";n+="<br />";t=document.getElementById("bwDataGrid_TrashBinAdminDialog");t||(t=document.createElement("div"),t.id="bwDataGrid_TrashBinAdminDialog",t.style.display="none",document.body.appendChild(t));t.innerHTML=n;$("#bwDataGrid_TrashBinAdminDialog").dialog({modal:!1,resizable:!1,closeOnEscape:!1,position:{my:"middle top+12",at:"middle top","of":window},width:"1200",dialogClass:"no-close",hide:!1,open:function(){try{}catch(n){console.log("Exception in recoverFromTheTrashBin.bwDataGrid_TrashBinAdminDialog.open(): "+n.message+", "+n.stack);displayAlertDialog("Exception in recoverFromTheTrashBin.bwDataGrid_TrashBinAdminDialog.open(): "+n.message+", "+n.stack)}},close:function(){$("#bwDataGrid_TrashBinAdminDialog").dialog("destroy")}})}catch(i){console.log("Exception in recoverFromTheTrashBin(): "+i.message+", "+i.stack);displayAlertDialog("Exception in recoverFromTheTrashBin(): "+i.message+", "+i.stack)}},permanentlyDeleteThisRequestFromTheTrashbin:function(n){var r;try{console.log("In permanentlyDeleteThisRequestFromTheTrashbin().");var f=this,i="bwRequest_PermanentlyDeleteRequestDialog",t="";t+='<table style="width:100%;">';t+="   <tr>";t+='       <td style="width:90%;">';t+="           <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size:30pt;font-weight:bold;\">Permanently delete this request?<\/span>";t+="           <br />";t+="       <\/td>";t+='       <td style="width:9%;"><\/td>';t+='       <td style="width:1%;cursor:pointer;vertical-align:top;">';t+='           <span class="dialogXButton" style="font-size:30pt;font-weight:bold;" onclick="$(\'#'+i+"').dialog('close');\">X<\/span>";t+="       <\/td>";t+="   <\/tr>";t+="<\/table>";t+='<input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';t+="<table>";t+="   <tr>";t+="       <td><\/td>";t+='       <td style="text-align:right;">';t+='           <span id="spanThereAreChangesToPublishText51" style="font-weight:bold;color:tomato;">';t+="This request will be permanently deleted. There will be no possibility of recovery.";t+="           <\/span>";t+="       <\/td>";t+="       <td><\/td>";t+="   <\/tr>";t+="<\/table>";t+="<br />";t+='<div id="bwRequest_PermanentlyDeleteRequestDialog_PermanentlyDeleteRequest" class="divDialogButton" >';t+="Permanently Delete";t+="<\/div>";t+="<br />";t+='<div class="divDialogButton" onclick="$(\'#'+i+"').dialog('close');\">";t+="Close";t+="<\/div>";t+="<br /><br />";t+="<br />";t+="<br />";r=document.getElementById(i);r||(r=document.createElement("div"),r.id=i,r.style.display="none",document.body.appendChild(r));r.innerHTML=t;$("#"+i).dialog({modal:!1,resizable:!1,closeOnEscape:!1,position:{my:"middle top+12",at:"middle top","of":window},width:"750",dialogClass:"no-close",hide:!1,open:function(){try{$("#bwRequest_PermanentlyDeleteRequestDialog_PermanentlyDeleteRequest").off("click").click(function(){var e;try{console.log("In bwRequest.js.permanentlyDeleteThisRequestFromTheTrashbin.bwRequest_PermanentlyDeleteRequestDialog_PermanentlyDeleteRequest.click().");var r=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),u=$(".bwAuthentication").bwAuthentication("option","participantId"),o=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");data={bwParticipantId_LoggedIn:u,bwActiveStateIdentifier:o,bwWorkflowAppId_LoggedIn:r,bwWorkflowAppId:r,bwBudgetRequestId:n,bwParticipantId:u};e=f.options.operationUriPrefix+"_bw/bwworkflow/permanentlyDeleteThisRequestFromTheTrashbin";$.ajax({url:e,type:"POST",data:data,headers:{Accept:"application/json; odata=verbose"},success:function(t){var f,r,u,e;if(t.status!="SUCCESS")displayAlertDialog(t.message),$("#"+i).dialog("close"),$("#divRequestFormDialog_"+n).dialog("close");else if(displayAlertDialog(t.message),$("#"+i).dialog("close"),$("#divRequestFormDialog_"+n).dialog("close"),f=window,window.opener&&(f=window.opener),r=f.$(".executiveSummaryInCarousel"),r&&r.length&&r.length>0)for(u=0;u<r.length;u++)e=f.$(r[u]).attr("bwbudgetrequestid"),n==e&&(console.log("In bwRequest.js.permanentlyDeleteThisRequestFromTheTrashbin(). We just permanently deleted the request... remove it from the display. bwBudgetRequestId: "+n),r[u].remove())},error:function(n,t,i){console.log("Error in bwRequest.js.permanentlyDeleteThisRequestFromTheTrashbin(). errorMessage: "+i+", errorCode: "+t+", data: "+JSON.stringify(n));displayAlertDialog("Error in bwRequest.js.permanentlyDeleteThisRequestFromTheTrashbin(). errorMessage: "+i+", errorCode: "+t+", data: "+JSON.stringify(n))}})}catch(t){console.log("Exception in bwRequest.js.permanentlyDeleteThisRequestFromTheTrashbin.bwRequest_PermanentlyDeleteRequestDialog_PermanentlyDeleteRequest.click(): "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.permanentlyDeleteThisRequestFromTheTrashbin.bwRequest_PermanentlyDeleteRequestDialog_PermanentlyDeleteRequest.click(): "+t.message+", "+t.stack)}})}catch(t){console.log("Exception in permanentlyDeleteThisRequestFromTheTrashbin.bwDataGrid_TrashBinAdminDialog.open(): "+t.message+", "+t.stack);displayAlertDialog("Exception in permanentlyDeleteThisRequestFromTheTrashbin.bwDataGrid_TrashBinAdminDialog.open(): "+t.message+", "+t.stack)}}});$("#"+i).dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}catch(u){console.log("Exception in permanentlyDeleteThisRequestFromTheTrashbin(): "+u.message+", "+u.stack);displayAlertDialog("Exception in permanentlyDeleteThisRequestFromTheTrashbin(): "+u.message+", "+u.stack)}},reloadAndRefreshTheRequest:function(n,t,i){try{console.log("In bwRequest.js.reloadAndRefreshTheRequest(). requestDialogId: "+n+", budgetRequestId: "+t+", bwWorkflowTaskItemId: "+i);var u=this,f=u.checkIfThereHaveBeenAnyChanges(t);f.then(function(r){var o,e,f;try{$("#"+n).dialog("option","bwForceClose",!1);r.status!="SUCCESS"?(console.log("Error in bwRequest.js.reloadAndRefreshTheRequest(). Unexpected error when checking if there have been any changes. results: "+JSON.stringify(r)),displayAlertDialog("Error in bwRequest.js.reloadAndRefreshTheRequest(). Unexpected error when checking if there have been any changes. results: "+JSON.stringify(r))):r.results=="YES_CHANGES_TO_SAVE"?(console.log("You have made changes to this request. You cannot close it until you save your changes."),o="divPromptToSaveRequestChangesDialog",e=document.getElementById(o),e||(e=document.createElement("div"),e.id=o,e.style.display="none",document.body.appendChild(e),f="",f+='        <table style="width:100%;">',f+="            <tr>",f+='                <td style="width:90%;">',f+="                    <br /><br />",f+='                    <span style="font-size:25pt;font-weight:bold;">Save changes to this request before closing it?<\/span>',f+="                    <br /><br />",f+='                    <span style="font-size:25pt;font-weight:normal;">Your changes will be lost if you don\'t save them.<\/span>',f+="                <\/td>",f+="            <\/tr>",f+="        <\/table>",f+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->',f+="        <br /><br />",e.innerHTML=f),$("#"+o).dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Save Changes xcx1-1",width:"720",dialogClass:"no-close",hide:!1,buttons:{Save:function(){try{$(".bwRequest").bwRequest("saveAndPublishTheRequest",n,"true","").then(function(t){try{t.status=="SUCCESS"?($("#"+n).dialog("option","bwForceClose",!0),$("#"+n).dialog("close"),$("#divPromptToSaveRequestChangesDialog").dialog("close")):t.status=="REFUSED_SAVE_CHANGED_ORGID"?$("#divPromptToSaveRequestChangesDialog").dialog("close"):$("#divPromptToSaveRequestChangesDialog").dialog("close")}catch(i){displayAlertDialog("Exception in bwRequest.js.reloadAndRefreshTheRequest.checkIfThereHaveBeenAnyChanges.Save.saveAndPublishTheRequest(): "+i.message+", "+i.stack)}}).catch(function(n){displayAlertDialog("Exception in bwRequest.js.reloadAndRefreshTheRequest.checkIfThereHaveBeenAnyChanges.Save(). Unexpected exception saving the request: "+JSON.stringify(n))})}catch(t){displayAlertDialog("Exception in bwRequest.js.reloadAndRefreshTheRequest.checkIfThereHaveBeenAnyChanges.Save(): "+t.message+", "+t.stack)}},"Don't Save and Lose Changes":function(){try{this.style.color="red";$("#"+n).dialog("option","bwForceClose",!0);$("#"+n).dialog("close");$("#divPromptToSaveRequestChangesDialog").dialog("close");u.displayArInDialog("https://budgetworkflow.com",t,"","","","",i)}catch(r){displayAlertDialog("Exception in bwRequest.js.reloadAndRefreshTheRequest.checkIfThereHaveBeenAnyChanges.DontSave(): "+r.message+", "+r.stack)}},Cancel:function(){$("#divPromptToSaveRequestChangesDialog").dialog("close")}},open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divPromptToSaveRequestChangesDialog").dialog("close")})},close:function(){}})):r.results=="NO_CHANGES_TO_SAVE"?($("#"+n).dialog("option","bwForceClose",!0),$("#"+n).dialog("close"),u.displayArInDialog("https://budgetworkflow.com",t,"","","","",i)):(console.log("Error in bwRequest.js.reloadAndRefreshTheRequest.dialog.beforeClose.checkIfThereHaveBeenAnyChanges(). Unexpected value from checkIfThereHaveBeenAnyChanges(). results: "+JSON.stringify(r)),displayAlertDialog("Error in bwRequest.js.reloadAndRefreshTheRequest.dialog.beforeClose.checkIfThereHaveBeenAnyChanges(). Unexpected value from checkIfThereHaveBeenAnyChanges(). results: "+JSON.stringify(r)))}catch(s){console.log("Exception in bwRequest.js.reloadAndRefreshTheRequest.dialog.beforeClose.checkIfThereHaveBeenAnyChanges():2: "+s.message+", "+s.stack);displayAlertDialog("Exception in bwRequest.js.reloadAndRefreshTheRequest.dialog.beforeClose.checkIfThereHaveBeenAnyChanges():2: "+s.message+", "+s.stack)}}).catch(function(n){console.log("Exception in bwRequest.js.reloadAndRefreshTheRequest.dialog.beforeClose.checkIfThereHaveBeenAnyChanges():1: "+JSON.stringify(n));displayAlertDialog("Exception in bwRequest.js.reloadAndRefreshTheRequest.dialog.beforeClose.checkIfThereHaveBeenAnyChanges():1: "+JSON.stringify(n))})}catch(r){console.log("Exception in bwRequest.js.reloadAndRefreshTheRequest(): "+r.message+", "+r.stack);displayAlertDialog("Exception in bwRequest.js.reloadAndRefreshTheRequest(): "+r.message+", "+r.stack)}},reloadAndRefreshThePoppedOutRequest:function(){try{console.log("In bwRequest.js.reloadAndRefreshThePoppedOutRequest().");location.reload()}catch(n){console.log("Exception in bwRequest.js.reloadAndRefreshThePoppedOutRequest(): "+n.message+", "+n.stack);displayAlertDialog("Exception in bwRequest.js.reloadAndRefreshThePoppedOutRequest(): "+n.message+", "+n.stack)}},loadActiveForms:function(){console.log("In bwRequest.js.loadActiveForms(). THIS IS THE ONLY PLACE WHERE WE SHOULD BE LOADING THE FORMS.");var n=this;return new Promise(function(t,i){var r,u,f;try{if(r=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),console.log("In bwRequest.js.loadActiveForms(). workflowAppId: "+r),r){var o=$(".bwAuthentication").bwAuthentication("option","participantId"),s=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),h={bwParticipantId_LoggedIn:o,bwActiveStateIdentifier:s,bwWorkflowAppId_LoggedIn:r,bwWorkflowAppId:r,bwRequestTypeId:"all"};$.ajax({url:webserviceurl+"/formsconfiguration",type:"POST",contentType:"application/json",data:JSON.stringify(h),success:function(r){var u,f;try{console.log("In bwRequest.js.loadActiveForms(). xcx3425345465675674.");r.status!="SUCCESS"?(u="Error in bwRequest.js.loadActiveForms.formsconfiguration(): "+r.status+", "+r.message,f={status:"ERROR",message:u},i(f)):(n.options.ActiveForms=r.data,u="Success in bwRequest.js.loadActiveForms.formsconfiguration(). Loaded options.ActiveForms. THIS IS THE ONLY PLACE THIS SHOULD BE HAPPENING.",console.log(u),f={status:"SUCCESS",message:u},t(f))}catch(e){u="Exception in bwRequest.loadActiveForms().done: "+e.message+", "+e.stack;f={status:"EXCEPTION",message:u};i(f)}},error:function(n,t){var r="Error in bwRequest.js.loadActiveForms.formsconfiguration(). "+t+". data: "+JSON.stringify(n),u={status:"ERROR",message:r};i(u)}})}else u="In bwRequest.js.loadActiveForms(). Unexpected value for workflowAppId: "+r,f={status:"ERROR",message:u},i(f)}catch(e){u="Exception in bwRequest.loadActiveForms().done: "+e.message+", "+e.stack;f={status:"EXCEPTION",message:u};i(f)}})},assignRequestTypeToRequest:function(n){var s,h;try{console.log("In assignRequestTypeToRequest().");alert("In assignRequestTypeToRequest().");var f=this,i=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),r=$(".bwAuthentication").bwAuthentication("option","participantId"),e=$(".bwAuthentication").bwAuthentication("option","participantEmail"),o=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),u=$("#ChangeRequestTypeDialog_selectRequestTypeDropDown option:selected").val();console.log("xcx993486 bwBudgetRequestId: "+n+", bwRequestTypeId: "+u);s=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");data={bwParticipantId_LoggedIn:r,bwActiveStateIdentifier:s,bwWorkflowAppId_LoggedIn:i,bwWorkflowAppId:i,bwBudgetRequestId:n,bwRequestTypeId:u,bwParticipantId:r,participantEmail:e,participantFriendlyName:o};h=webserviceurl+"/assignrequesttypetorequest";$.ajax({url:h,type:"POST",data:data,headers:{Accept:"application/json; odata=verbose"},success:function(t){var c,s,l,a,v;try{if(t.message!="SUCCESS")displayAlertDialog(t.message);else if(t.mod.nModified==1){console.log("In assignRequestTypeToRequest.post.assignrequesttypetorequest(). Showing the request here, calling thiz.displayArInDialog(). xcx325346");try{$("#"+requestDialogId).dialog("close")}catch(h){$("#ChangeRequestTypeDialog").dialog("close")}if(f.reloadAndRefreshTheRequest("divRequestFormDialog_"+n,n,null),c=window,window.opener&&(c=window.opener),s=c.$(".executiveSummaryInCarousel"),s&&s.length&&s.length>0)for(l=0;l<s.length;l++)a=c.$(s[l]).attr("bwbudgetrequestid"),n==a&&(console.log("In bwRequest.js.assignRequestTypeToRequest(). The request type was changes, so updating the executive summary that is displayed. bwBudgetRequestId: "+n),alert("Dev ToDo: xcx1243677. In bwRequest.js.assignRequestTypeToRequest(). The request type was changed, so updating the executive summary that is displayed. Does the request type display Ok? bwBudgetRequestId: "+n),console.log("Calling bwRequest.js.scrapeBwRequestJson(). xcx1231242-8-2"),v=f.scrapeBwRequestJson(n),v.then(function(t){var h,f;try{t.status!="SUCCESS"?(h="Error in bwRequest.js.assignRequestTypeToRequest(). "+t.status+", "+t.message,console.log(h),displayAlertDialog(h)):(f=t.bwRequestJson,bwBudgetRequest={bwWorkflowAppId:i,bwBudgetRequestId:n,ModifiedById:r,ModifiedByEmail:e,ModifiedByFriendlyName:o,bwRequestJson:JSON.stringify(f),BudgetAmount:null,bwRequestTypeId:u},f.bwLocationPicker&&f.bwLocationPicker.value&&f.bwLocationPicker.value.bwOrgId&&(bwBudgetRequest.OrgId=f.bwLocationPicker.value.bwOrgId),f.bwLocationPicker&&f.bwLocationPicker.value&&f.bwLocationPicker.value.bwOrgName&&(bwBudgetRequest.OrgName=f.bwLocationPicker.value.bwOrgName),f.ProjectTitle&&f.ProjectTitle.value&&(bwBudgetRequest.ProjectTitle=f.ProjectTitle.value),f.bwRequestedCapitalField&&f.bwRequestedCapitalField.value&&(bwBudgetRequest.RequestedCapital=f.bwRequestedCapitalField.value),f.RequestedExpense&&(bwBudgetRequest.RequestedExpense=f.RequestedExpense.value),f.ProjectManager&&(bwBudgetRequest.ManagerId=f.ProjectManager.ParticipantId,bwBudgetRequest.ManagerEmail=f.ProjectManager.ParticipantEmail,bwBudgetRequest.ManagerFriendlyName=f.ProjectManager.ParticipantFriendlyName),$(".bwAuthentication").bwAuthentication("redrawSingleExecutiveSummary",n,bwBudgetRequest))}catch(s){console.log("Exception in assignRequestTypeToRequest.post.assignrequesttypetorequest(): "+s.message+", "+s.stack);displayAlertDialog("Exception in assignRequestTypeToRequest.post.assignrequesttypetorequest(): "+s.message+", "+s.stack)}}).catch(function(n){console.log("Exception in assignRequestTypeToRequest.post.assignrequesttypetorequest(): "+JSON.stringify(n));displayAlertDialog("Exception in assignRequestTypeToRequest.post.assignrequesttypetorequest(): "+JSON.stringify(n))}))}else console.log("Error in assignRequestTypeToRequest.post.assignrequesttypetorequest(). result.message: "+t.message+", mod: "+JSON.stringify(t.mod)+" xcx92385-1"),displayAlertDialog("Error in assignRequestTypeToRequest.post.assignrequesttypetorequest(). result.message: "+t.message+", mod: "+JSON.stringify(t.mod)+" xcx92385-1")}catch(h){console.log("Exception in assignRequestTypeToRequest.post.assignrequesttypetorequest(). result.message: "+t.message+", mod: "+JSON.stringify(t.mod)+" xcx92385-2. "+h.message+", "+h.stack);displayAlertDialog("Exception in assignRequestTypeToRequest.post.assignrequesttypetorequest(). result.message: "+t.message+", mod: "+JSON.stringify(t.mod)+" xcx92385-2. "+h.message+", "+h.stack)}},error:function(n,t,i){displayAlertDialog("Error in my.js.cmdChooseSelectedWorkflow(): "+t+" "+i)}})}catch(t){console.log("Exception in assignRequestTypeToRequest(): "+t.message+", "+t.stack);alert("Exception in assignRequestTypeToRequest(): "+t.message+", "+t.stack)}},changeTheRequestTypeForARequest:function(n){var i,t;try{console.log("In changeTheRequestTypeForARequest().");i=document.getElementById("ChangeRequestTypeDialog");i||(i=document.createElement("div"),i.id="ChangeRequestTypeDialog",i.style.display="none",document.body.appendChild(i),t="",t+='   <table style="width:100%;">',t+="       <tr>",t+='           <td style="width:90%;">',t+="               <span id=\"spanChangeRequestTypeDialogTitle\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\"><\/span>",t+="           <\/td>",t+='           <td style="width:9%;"><\/td>',t+='           <td style="width:1%;cursor:pointer;vertical-align:top;">',t+="               <span class=\"dialogXButton\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size: 30pt;font-weight:bold;\" onclick=\"$('#ChangeRequestTypeDialog').dialog('close');\">X<\/span>",t+="           <\/td>",t+="       <\/tr>",t+="   <\/table>",t+="   <br /><br />",t+='   <span id="spanChangeRequestTypeDialog_Content"><\/span>',i.innerHTML=t);t="";t+="        <br /><br />";t+="        <span id=\"spanChangeRequestTypeDialogTitle2\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 22pt;font-weight:bold;\">Select from the available Request Types, then click the \"Change Request Type\" button.<\/span><br /><br />";t+="        <br /><br />";t+="        <span id=\"spanChangeRequestTypeDialog_spanChangeRequestTypeDialog_Content_spanRequestTypeDropDown\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 22pt;font-weight:bold;\"><\/span><br /><br />";t+="        <br /><br />";t+="        <br /><br />";t+='        <div id="btnUserRoleDialogChangeRole" class="divSignInButton" style="width:90%;text-align:center;line-height:0.8em;font-weight:bold;" onclick="$(\'.bwRequest\').bwRequest(\'assignRequestTypeToRequest\', \''+n+"', this);\">";t+="            Change Request Type";t+="        <\/div>";t+="        <br /><br />";t+='        <div id="xxxx" class="divSignInButton" style="width:90%;text-align:center;line-height:0.8em;font-weight:bold;" onclick="$(\'#ChangeRequestTypeDialog\').dialog(\'close\');">';t+="            Close";t+="        <\/div>";t+="        <br /><br />";$("#spanChangeRequestTypeDialog_Content").html(t);$("#ChangeRequestTypeDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"570px",dialogClass:"no-close",hide:!1,close:function(){$("#ChangeRequestTypeDialog").dialog("destroy")},open:function(){var i,n,t;try{for($(".ui-widget-overlay").bind("click",function(){$("#ChangeRequestTypeDialog").dialog("close")}),i=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes"),n="",n+='<select id="ChangeRequestTypeDialog_selectRequestTypeDropDown" onchange="" style=\'display:inline;border-color: whitesmoke; color: grey; font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 14pt; font-weight: bold; cursor: pointer;\'>',t=0;t<i.EnabledItems.length;t++)n+='<option value="'+i.EnabledItems[t].bwRequestTypeId+'" >'+i.EnabledItems[t].SingletonName+"<\/option>";n+="<\/select>";$("#spanChangeRequestTypeDialog_spanChangeRequestTypeDialog_Content_spanRequestTypeDropDown").html(n)}catch(r){console.log("Exception in changeTheRequestTypeForARequest.ChangeRequestTypeDialog.dialog.open(): "+r.message+", "+r.stack);displayAlertDialog("Exception in changeTheRequestTypeForARequest.ChangeRequestTypeDialog.dialog.open(): "+r.message+", "+r.stack)}}});document.getElementById("spanChangeRequestTypeDialogTitle").innerHTML="Change the Request Type for bwBudgetRequestId."}catch(r){console.log("Exception in changeTheRequestTypeForARequest(): "+r.message+", "+r.stack);displayAlertDialog("Exception in changeTheRequestTypeForARequest(): "+r.message+", "+r.stack)}},renderRequestFormButtons_old:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var r,p,w,b,d;try{if(console.log("In bwRequest.js.renderRequestFormButtons_old(). source: "+u),alert("In bwRequest.js.renderRequestFormButtons_old(). source: "+u+". CONVERTING THE bwBudgetRequestId PARAMETER TO SEND THE REQUEST OBJECT bwBudgetRequest, and get rid of bwRequestTypeId parameter."),r="",u=="xcx445566-6-1")r+='<button xcx="xcx4242-2" onclick="$(\'#'+n+'\').dialog(\'close\');" class="BwButton200ForRequestForm" title="Close">Close<\/button>&nbsp;';else if(u=="xcx445566-4")r+='<button xcx="xcx4242-2" onclick="$(\'#'+n+'\').dialog(\'close\');" class="BwButton200ForRequestForm" title="Close">Close<\/button>&nbsp;';else if(u=="xcx445566-1")r+="<button xcx=\"xcx2312412-1\" onclick=\"$('.bwRequest').bwRequest('saveAndPublishTheRequest', '', 'true', '"+t+"', '"+i+'\');" class="BwButton200ForRequestForm" title="Publish so that everyone sees the latest updates to the request.">Save/Publish<\/button>&nbsp;',r+="                        &nbsp;",r+="                        <button onclick=\"$('.bwRequest').bwRequest('saveRequestOnThisDevice', '"+t+'\');" title="Save on this device." class="BwButton250ForRequestForm">Save (on this device)<\/button>',r+="                        &nbsp;",r+='                        <button name="startWorkflowButton" xcx="xcx22354235-1" id="startWorkflowButton" onclick="$(\'.bwRequest\').bwRequest(\'cmdCreateBudgetRequestAndStartWorkflow\', \''+t+'\');" class="BwButton200ForRequestForm" title="Click here to Submit the request.">Submit<\/button>',r+="                        &nbsp;",r+='                        <button xcx="xcx4242-3" onclick="$(\'#'+n+"').dialog('close');\" class=\"BwButton200ForRequestForm\">Close<\/button>";else if(u=="xcx445566-7"){if(p={WorkflowStep:{Assign:e},RequestingUser:o},r+="<button xcx=\"xcx2312412-2\" onclick=\"$('.bwRequest').bwRequest('saveAndPublishTheRequest', '"+n+"', 'true', '');\" class=\"BwButton200ForRequestForm\" title=\"Publish so that everyone sees the latest updates to the request.\">Save/Publish<\/button>&nbsp;",p.WorkflowStep.Assign.Action&&p.WorkflowStep.Assign.Action.length)for(console.log("If we get here that means this workflow step must have "+p.WorkflowStep.Assign.Action.length+" Actions (and hence "+p.WorkflowStep.Assign.Action.length+" buttons).  onmouseenter calls showRequestButtonADMINOnBehalfOfDialog()."),w=0;w<p.WorkflowStep.Assign.Action.length;w++)p.WorkflowStep.Assign.Action[w]["@Name"]=="Approve"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?y&&y.length&&y.length>0?(r+="<button disabled ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">',r+=p.WorkflowStep.Assign.Action[w]["@Name"]+"",r+="<\/button>&nbsp;"):(r+="<button ",r+=" onclick=\"$('.bwRequest').bwRequest('cmdApproveRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+s.roleMember_participantId+"', '"+s.roleMember_participantEmail+"', '"+s.roleMember_participantFriendlyName+"');\"",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">',r+=p.WorkflowStep.Assign.Action[w]["@Name"]+"",r+="<\/button>&nbsp;"):p.WorkflowStep.Assign.Action[w]["@Name"]=="Decline"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?(r+="<button onclick=\"$('.bwRequest').bwRequest('cmdDeclineRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+s.roleMember_participantId+"', '"+s.roleMember_participantEmail+"', '"+s.roleMember_participantFriendlyName+"');\" ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;"):p.WorkflowStep.Assign.Action[w]["@Name"]=="Revise/Hold"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?(r+="<button onclick=\"$('.bwRequest').bwRequest('cmdReviseHoldRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+s.roleMember_participantId+"', '"+s.roleMember_participantEmail+"', '"+s.roleMember_participantFriendlyName+"');\" ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;"):(b=p.WorkflowStep.Assign.Action[w]["@JavaScript"],b?r+='<button onclick="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;":(console.log(""),console.log("In displayRequestFormDialog(). ERROR CREATING BUTTONS: NO ACTION JAVASCRIPT SET IN THE WORKFLOW FOR THIS ACTION: "+p.WorkflowStep.Assign.Action[w]["@Name"]+". This process cannot continue. xcx2341-1"),console.log(""),b="alert('In displayRequestFormDialog(). ERROR CREATING BUTTONS: NO ACTION JAVASCRIPT SET IN THE WORKFLOW FOR THIS ACTION: "+p.WorkflowStep.Assign.Action[w]["@Name"]+". This process cannot continue. xcx2341-1');",r+='<button onclick="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;"));else p.WorkflowStep.Assign.Action?(console.log("If we get here that means this workflow step must have 1 Action (and hence 1 button). onmouseenter calls showRequestButtonADMINOnBehalfOfDialog()."),p.WorkflowStep.Assign.Action["@Name"]=="Approve"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?y&&y.length&&y.length>0?(r+="<button  disabled ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action.Tooltip+'">'+p.WorkflowStep.Assign.Action["@Name"]+" xcx123235689<\/button>&nbsp;"):(r+="<button onclick=\"$('.bwRequest').bwRequest('cmdApproveRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+roleMember_participantId+"', '"+roleMember_participantEmail+"', '"+roleMember_participantFriendlyName+"');\" ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action.Tooltip+'">'+p.WorkflowStep.Assign.Action["@Name"]+" xcx123235689<\/button>&nbsp;"):p.WorkflowStep.Assign.Action["@Name"]=="Decline"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?(r+="<button onclick=\"$('.bwRequest').bwRequest('cmdDeclineRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+roleMember_participantId+"', '"+roleMember_participantEmail+"', '"+roleMember_participantFriendlyName+"');\" ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;"):p.WorkflowStep.Assign.Action["@Name"]=="Revise/Hold"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?(r+="<button onclick=\"$('.bwRequest').bwRequest('cmdReviseHoldRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+roleMember_participantId+"', '"+roleMember_participantEmail+"', '"+roleMember_participantFriendlyName+"');\" ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;"):(b=p.WorkflowStep.Assign.Action["@JavaScript"],b?r+='<button onclick="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action.Tooltip+'">'+p.WorkflowStep.Assign.Action["@Name"]+"<\/button>&nbsp;":(console.log(""),console.log("In displayRequestFormDialog(). ERROR CREATING BUTTONS: NO ACTION JAVASCRIPT SET IN THE WORKFLOW FOR THIS ACTION: "+p.WorkflowStep.Assign.Action["@Name"]+". This process cannot continue. xcx2341-1"),console.log(""),b="alert('In displayRequestFormDialog(). ERROR CREATING BUTTONS: NO ACTION JAVASCRIPT SET IN THE WORKFLOW FOR THIS ACTION: "+p.WorkflowStep.Assign.Action["@Name"]+". This process cannot continue. xcx2341-1');",r+='<button onclick="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action.Tooltip+'">'+p.WorkflowStep.Assign.Action["@Name"]+"<\/button>&nbsp;"))):console.log("If we get here that means this workflow step must not have any Actions (and hence no buttons).");r+='<button xcx="xcx4242-1" onclick="$(\'#'+n+'\').dialog(\'close\');" class="BwButton200ForRequestForm" title="Close">Close<\/button>&nbsp;'}else u=="xcx445566-8"?(r+="<button xcx=\"xcx2312412-3\" onclick=\"$('.bwRequest').bwRequest('saveAndPublishTheRequest', '', 'true', '"+t+"', '"+i+'\');" class="BwButton200ForRequestForm" title="Publish so that everyone sees the latest updates to the request.">Save/Publish<\/button>&nbsp;',r+="                        &nbsp;",r+="                        <button onclick=\"$('.bwRequest').bwRequest('saveRequestOnThisDevice', '"+t+'\');" title="Save on this device." class="BwButton250ForRequestForm">Save (on this device)<\/button>',r+="                        &nbsp;",r+='                        <button name="startWorkflowButton" xcx="xcx22354235-2" id="startWorkflowButton" onclick="$(\'.bwRequest\').bwRequest(\'cmdCreateBudgetRequestAndStartWorkflow\', \''+t+'\');" class="BwButton200ForRequestForm" title="Click here to Submit the request.">Submit<\/button>',r+="                        &nbsp;",r+="                        <button onclick=\"$('.bwActiveMenu').bwActiveMenu('RenderContentForButton', 'NEW_REQUEST_FORM_CANCEL_BUTTON', 'HOME');\" class=\"BwButton200ForRequestForm\">Cancel<\/button>"):(d="In bwRequest.js.renderRequestFormButtons(). Unexpected value for source: "+u,console.log(d),displayAlertDialog(d));u=="xcx445566-8"?$(n).find("#spanRequestForm_Buttons").html(r):$("#"+n).find("#spanRequestForm_Buttons")[0].innerHTML=r}catch(k){console.log("Exception in bwRequest.js.renderRequestFormButtons(): "+k.message+", "+k.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestFormButtons(): "+k.message+", "+k.stack)}},renderRequestFormButtons:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var r,p,w,b,d,nt,k,tt;try{if(console.log("In bwRequest.js.renderRequestFormButtons(). source: "+u),console.log("In bwRequest.js.renderRequestFormButtons(). source: "+u+". CONVERTING THE bwBudgetRequestId PARAMETER TO SEND THE REQUEST OBJECT bwBudgetRequest, and get rid of bwRequestTypeId parameter."),r="",u=="xcx445566-6-1")r+='<button xcx="xcx4242-2" onclick="$(\'#'+n+'\').dialog(\'close\');" class="BwButton200ForRequestForm" title="Close">Close<\/button>&nbsp;';else if(u=="xcx445566-4")r+='<button xcx="xcx4242-2" onclick="$(\'#'+n+'\').dialog(\'close\');" class="BwButton200ForRequestForm" title="Close">Close<\/button>&nbsp;';else if(u=="xcx445566-1")r+="<button xcx=\"xcx2312412-1\" onclick=\"$('.bwRequest').bwRequest('saveAndPublishTheRequest', '', 'true', '"+t.bwBudgetRequestId+"', '"+t.bwRequestTypeId+'\');" class="BwButton200ForRequestForm" title="Publish so that everyone sees the latest updates to the request.">Save/Publish<\/button>&nbsp;',r+="                        &nbsp;",r+="                        <button onclick=\"$('.bwRequest').bwRequest('saveRequestOnThisDevice', '"+t.bwBudgetRequestId+'\');" title="Save on this device." class="BwButton250ForRequestForm">Save (on this device)<\/button>',r+="                        &nbsp;",r+=t.BudgetWorkflowStatus=="NOT_SUBMITTED"?'                        <button name="startWorkflowButton" xcx="xcx22354235-1enabled" id="startWorkflowButton" onclick="$(\'.bwRequest\').bwRequest(\'cmdCreateBudgetRequestAndStartWorkflow\', \''+t.bwBudgetRequestId+'\');" class="BwButton200ForRequestForm" title="Click here to Submit the request.">Submit<\/button>':'                        <button name="startWorkflowButton" xcx="xcx22354235-1disabled" disabled="disabled" id="startWorkflowButton" class="BwButton200ForRequestForm" title="Click here to Submit the request.">Submit<\/button>',r+="                        &nbsp;",r+='                        <button xcx="xcx4242-3" onclick="$(\'#'+n+"').dialog('close');\" class=\"BwButton200ForRequestForm\">Close<\/button>";else if(u=="xcx445566-7"){if(p={WorkflowStep:{Assign:e},RequestingUser:o},r+="<button xcx=\"xcx2312412-2\" onclick=\"$('.bwRequest').bwRequest('saveAndPublishTheRequest', '"+n+"', 'true', '');\" class=\"BwButton200ForRequestForm\" title=\"Publish so that everyone sees the latest updates to the request.\">Save/Publish<\/button>&nbsp;",p.WorkflowStep.Assign.Action&&p.WorkflowStep.Assign.Action.length)for(console.log("If we get here that means this workflow step must have "+p.WorkflowStep.Assign.Action.length+" Actions (and hence "+p.WorkflowStep.Assign.Action.length+" buttons).  onmouseenter calls showRequestButtonADMINOnBehalfOfDialog()."),w=0;w<p.WorkflowStep.Assign.Action.length;w++)p.WorkflowStep.Assign.Action[w]["@Name"]=="Approve"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?y&&y.length&&y.length>0?(r+="<button disabled ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">',r+=p.WorkflowStep.Assign.Action[w]["@Name"]+"",r+="<\/button>&nbsp;"):(r+="<button ",r+=" onclick=\"$('.bwRequest').bwRequest('cmdApproveRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+s.roleMember_participantId+"', '"+s.roleMember_participantEmail+"', '"+s.roleMember_participantFriendlyName+"');\"",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">',r+=p.WorkflowStep.Assign.Action[w]["@Name"]+"",r+="<\/button>&nbsp;"):p.WorkflowStep.Assign.Action[w]["@Name"]=="Decline"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?(r+="<button onclick=\"$('.bwRequest').bwRequest('cmdDeclineRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+s.roleMember_participantId+"', '"+s.roleMember_participantEmail+"', '"+s.roleMember_participantFriendlyName+"');\" ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;"):p.WorkflowStep.Assign.Action[w]["@Name"]=="Revise/Hold"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?(r+="<button onclick=\"$('.bwRequest').bwRequest('cmdReviseHoldRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+s.roleMember_participantId+"', '"+s.roleMember_participantEmail+"', '"+s.roleMember_participantFriendlyName+"');\" ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;"):(b=p.WorkflowStep.Assign.Action[w]["@JavaScript"],b?r+='<button onclick="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;":(console.log(""),console.log("In displayRequestFormDialog(). ERROR CREATING BUTTONS: NO ACTION JAVASCRIPT SET IN THE WORKFLOW FOR THIS ACTION: "+p.WorkflowStep.Assign.Action[w]["@Name"]+". This process cannot continue. xcx2341-1"),console.log(""),b="alert('In displayRequestFormDialog(). ERROR CREATING BUTTONS: NO ACTION JAVASCRIPT SET IN THE WORKFLOW FOR THIS ACTION: "+p.WorkflowStep.Assign.Action[w]["@Name"]+". This process cannot continue. xcx2341-1');",r+='<button onclick="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;"));else p.WorkflowStep.Assign.Action?(console.log("If we get here that means this workflow step must have 1 Action (and hence 1 button). onmouseenter calls showRequestButtonADMINOnBehalfOfDialog()."),p.WorkflowStep.Assign.Action["@Name"]=="Approve"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?y&&y.length&&y.length>0?(r+="<button  disabled ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action.Tooltip+'">'+p.WorkflowStep.Assign.Action["@Name"]+" xcx123235689<\/button>&nbsp;"):(r+="<button onclick=\"$('.bwRequest').bwRequest('cmdApproveRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+roleMember_participantId+"', '"+roleMember_participantEmail+"', '"+roleMember_participantFriendlyName+"');\" ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action.Tooltip+'">'+p.WorkflowStep.Assign.Action["@Name"]+" xcx123235689<\/button>&nbsp;"):p.WorkflowStep.Assign.Action["@Name"]=="Decline"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?(r+="<button onclick=\"$('.bwRequest').bwRequest('cmdDeclineRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+roleMember_participantId+"', '"+roleMember_participantEmail+"', '"+roleMember_participantFriendlyName+"');\" ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;"):p.WorkflowStep.Assign.Action["@Name"]=="Revise/Hold"&&p.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?(r+="<button onclick=\"$('.bwRequest').bwRequest('cmdReviseHoldRequest', this, '"+h+"', '"+c+"', '"+l+"', '"+a+"', '"+participantId+"', '"+participantEmail+"', '"+participantFriendlyName+"', '"+roleMember_participantId+"', '"+roleMember_participantEmail+"', '"+roleMember_participantFriendlyName+"');\" ",r+='onclick_old_thiswasthewaywedidit="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action[w].Tooltip+'">'+p.WorkflowStep.Assign.Action[w]["@Name"]+"<\/button>&nbsp;"):(b=p.WorkflowStep.Assign.Action["@JavaScript"],b?r+='<button onclick="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action.Tooltip+'">'+p.WorkflowStep.Assign.Action["@Name"]+"<\/button>&nbsp;":(console.log(""),console.log("In displayRequestFormDialog(). ERROR CREATING BUTTONS: NO ACTION JAVASCRIPT SET IN THE WORKFLOW FOR THIS ACTION: "+p.WorkflowStep.Assign.Action["@Name"]+". This process cannot continue. xcx2341-1"),console.log(""),b="alert('In displayRequestFormDialog(). ERROR CREATING BUTTONS: NO ACTION JAVASCRIPT SET IN THE WORKFLOW FOR THIS ACTION: "+p.WorkflowStep.Assign.Action["@Name"]+". This process cannot continue. xcx2341-1');",r+='<button onclick="'+b+'" class="BwButton200ForRequestForm" title="'+p.WorkflowStep.Assign.Action.Tooltip+'">'+p.WorkflowStep.Assign.Action["@Name"]+"<\/button>&nbsp;"))):console.log("If we get here that means this workflow step must not have any Actions (and hence no buttons).");r+='<button xcx="xcx4242-1" onclick="$(\'#'+n+'\').dialog(\'close\');" class="BwButton200ForRequestForm" title="Close">Close<\/button>&nbsp;'}else if(u=="xcx445566-8"){for(console.log("Rendering buttons for the new request form. xcx993857."),r+="<button xcx=\"xcx2312412-3\" onclick=\"$('.bwRequest').bwRequest('saveAndPublishTheRequest', '', 'true', '"+t.bwBudgetRequestId+"', '"+t.bwRequestTypeId+'\');" class="BwButton200ForRequestForm" title="Publish so that everyone sees the latest updates to the request.">Save/Publish<\/button>&nbsp;',r+="                        &nbsp;",r+="                        <button onclick=\"$('.bwRequest').bwRequest('saveRequestOnThisDevice', '"+t.bwBudgetRequestId+'\');" title="Save on this device." class="BwButton250ForRequestForm">Save (on this device)<\/button>',r+="                        &nbsp;",d=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes"),nt=!1,k=0;k<d.EnabledItems.length;k++)if(t.bwRequestTypeId==d.EnabledItems[k].bwRequestTypeId){d.EnabledItems[k].hasWorkflow==!0&&(nt=!0);break}nt==!0?(r+='                        <button name="startWorkflowButton" xcx="xcx22354235-2" id="startWorkflowButton" onclick="$(\'.bwRequest\').bwRequest(\'cmdCreateBudgetRequestAndStartWorkflow\', \''+t.bwBudgetRequestId+'\');" class="BwButton200ForRequestForm" title="Click here to Submit the request.">Submit<\/button>',r+="                        &nbsp;",$(n).find("#spanRequestForm_Instructions").html('Complete the form then click the "Submit" button.')):$(n).find("#spanRequestForm_Instructions").html('Complete the form then click a "Save" button.');r+="                        <button onclick=\"$('.bwActiveMenu').bwActiveMenu('RenderContentForButton', 'NEW_REQUEST_FORM_CANCEL_BUTTON', 'HOME');\" class=\"BwButton200ForRequestForm\">Cancel<\/button>"}else tt="In bwRequest.js.renderRequestFormButtons(). Unexpected value for source: "+u,console.log(tt),displayAlertDialog(tt);u=="xcx445566-8"?$(n).find("#spanRequestForm_Buttons").html(r):$("#"+n).find("#spanRequestForm_Buttons")[0].innerHTML=r}catch(g){console.log("Exception in bwRequest.js.renderRequestFormButtons(): "+g.message+", "+g.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestFormButtons(): "+g.message+", "+g.stack)}},saveRequestOnThisDevice:function(n){var r,i;try{r=this;console.log("In saveRequestOnThisDevice().");console.log("DEV: fix: 11-7-2023. NOW WE CLEAR THE CACHED NEW REQUEST AND RETURN TO THE HOME SCREEN. xcx2321312-3.");alert("DEV: fix: 11-7-2023. NOW WE CLEAR THE CACHED NEW REQUEST AND RETURN TO THE HOME SCREEN.  xcx2321312-3.");console.log("Calling bwRequest.js.scrapeBwRequestJson(). xcx1231242-2");i=this.scrapeBwRequestJson(n);i.then(function(t){try{alert("Returning from scrapeBwRequestJson(). xcx2131241-2");console.log("In saveRequestOnThisDevice().scrapeBwRequestJson().bwRequestJson.xcx1: "+JSON.stringify(t,2,null));var r=$(".bwCoreComponent").bwCoreComponent("getIndexDbInstance"),f=r.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),u=!1;f.openCursor().onsuccess=function(n){var f;try{if(f=n.target.result,f&&u==!1){if(f.value.bwBudgetRequestId==t.bwBudgetRequestId){u=!0;var i=r.transaction("objectStoreCachedRequests","readwrite"),e=i.objectStore("objectStoreCachedRequests"),s=e.put(t,f.primaryKey);i.oncomplete=function(){console.log("In saveRequestOnThisDevice(). Transaction completed: database modification finished.");displayAlertDialog("In saveRequestOnThisDevice(). Transaction completed: database modification finished.")};i.onerror=function(){console.log("In saveRequestOnThisDevice(). Transaction not opened due to error. Duplicate items not allowed.");displayAlertDialog("In saveRequestOnThisDevice(). Transaction not opened due to error. Duplicate items not allowed.")}}f.continue()}else if(u!=!0){var i=r.transaction("objectStoreCachedRequests","readwrite"),e=i.objectStore("objectStoreCachedRequests"),s=e.add(t);i.oncomplete=function(){console.log("In saveRequestOnThisDevice(). Transaction completed: database modification finished.");displayAlertDialog("In saveRequestOnThisDevice(). Transaction completed: database modification finished.")};i.onerror=function(){console.log("In saveRequestOnThisDevice(). Transaction not opened due to error. Duplicate items not allowed.");displayAlertDialog("In saveRequestOnThisDevice(). Transaction not opened due to error. Duplicate items not allowed.")}}}catch(o){console.log("Exception in my.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog4. xxError: "+o.message+", "+o.stack)}}}catch(i){console.log("Exception in cmdCreateBudgetRequestAndStartWorkflow().scrapeBwRequestJson():2-1: "+i.message+", "+i.stack);$("#"+n).find("#spanRequestForm_Error")[0].innerHTML="Exception in cmdCreateBudgetRequestAndStartWorkflow().scrapeBwRequestJson():2: "+i.message+", "+i.stack}})}catch(t){console.log("Exception in saveRequestOnThisDevice("+bwBudgetRequestId+"):3: "+t.message+", "+t.stack);displayAlertDialog("Exception in saveRequestOnThisDevice("+bwBudgetRequestId+"):3: "+t.message+", "+t.stack)}},cmdSaveRequestTitle:function(){try{console.log("In bwRequest.cmdSaveRequestTitle().");alert("In bwRequest.cmdSaveRequestTitle(). This functionality is incomplete. Coming soon!xcx3395")}catch(n){console.log("Exception in cmdSaveWorkflowTitle(): "+n.message+", "+n.stack)}},getRequestFormHtml:function(n,t,i,r){var u=this;return new Promise(function(f,e){var s,v,y,a,h,c,o,l;try{if(console.log("In bwRequest.js.getRequestFormHtml(). THIS IS THE ONLY PLACE WHERE WE SHOULD BE RENDERING THE FORM. bwRequestTypeId: "+n+", source: "+r),t&&t==!0||n)if(t&&t==!0)console.log(""),console.log("******************************************"),console.log(" THIS is an OFFINE REQUEST."),console.log("******************************************"),console.log(""),o="In bwRequest.js.getRequestFormHtml(). This is an offline request. Dev: More work to do here.",console.log(o),displayAlertDialog(o),l={status:"ERROR",message:o},e(l);else if(console.log("xcx12332661 this value may not have been reloaded: thiz.options.ActiveForms: "+JSON.stringify(u.options.ActiveForms)),i){if(u.options.ActiveForms&&u.options.ActiveForms.length>0)for(h=0;h<u.options.ActiveForms.length;h++)if(u.options.ActiveForms[h].bwRequestTypeId==n){if(v=new Date(i),y=new Date(u.options.ActiveForms[h].Modified),v.getTime()===y.getTime()){if(console.log("DATES ARE THE SAME. No need to get a new bwForm json."),a=-1,u.options.ActiveForms&&u.options.ActiveForms.length>0){for(h=0;h<u.options.ActiveForms.length;h++)if(u.options.ActiveForms[h].bwRequestTypeId==n){a=h;break}a==-1?(console.log("In getRequestFormHtml(): thiz.options.ActiveForms.length = "+u.options.ActiveForms.length+". Could not find form with bwRequestTypeId: "+n+"."),s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_Default")):s=u.options.ActiveForms[a].bwFormHtml}else u.options.ActiveForms==null||u.options.ActiveForms&&u.options.ActiveForms.length==0?(console.log("Error in getRequestFormHtml(): There are no active forms. thiz.options.ActiveForms: "+JSON.stringify(u.options.ActiveForms)),o="Error: There is no form for this request type. You can continue with this default form here, but the Workflow Administrator or a Configuration Manager should go to Configuration > Forms to create a form for this request type.xcx2",$(".bwActiveMenu").bwActiveMenu("displayTopBarErrorMessage",o),s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_Default")):(console.log("Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms.: "+JSON.stringify(u.options.ActiveForms)),alert("Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms. length: "+u.options.ActiveForms.length+", "+JSON.stringify(u.options.ActiveForms)),results.message='<span style="color:tomato;font-size:40pt;">Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms: '+JSON.stringify(u.options.ActiveForms)+"<\/span>");console.log("");console.log("******************************************");console.log('FORM>>: In bwRequest.js.getRequestFormHtml(). Adding the top of the form div tag id="budgetrequestform". xcx464367-2-1');console.log("******************************************");console.log("");c="";t&&t==!0?(s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_offlinerequest_Default"),c+='<div id="budgetrequestform" class="budgetrequestform" align="left" bwrequesttitle="" bwbudgetrequestid="" bwworkflowtaskitemid="" bwrequesttype="offlinerequest" bwformid="" bworgid="" bworgname="" >'):c+='<div id="budgetrequestform" class="budgetrequestform" align="left" bwrequesttitle="" bwbudgetrequestid="" bwworkflowtaskitemid="" bwrequesttypeid="'+n+'" bwformid="" bworgid="" bworgname="">';c+=s;c+="<\/div>";l={status:"SUCCESS",message:"",html:c};f(l)}else if(v.getTime()>y.getTime())console.log("THE FORM HAS BEEN UPDATED SINCE IT WAS LAST LOADED HERE. WE MUST GET THE FORMS AGAIN. configurationModifiedDate: "+v+", formModifiedDate: "+y),u.loadActiveForms().then(function(i){var l,h,r,o,c;if(i.status!="SUCCESS")r="Error in bwRequest.js.getRequestFormHtml(). xcx324235. "+i.status+", "+i.message,console.log(r),displayAlertDialog(r),c={status:"ERROR",message:r},e(c);else{if(l=-1,u.options.ActiveForms&&u.options.ActiveForms.length>0){for(h=0;h<u.options.ActiveForms.length;h++)if(u.options.ActiveForms[h].bwRequestTypeId==n){l=h;break}l==-1?(console.log("In getRequestFormHtml(): thiz.options.ActiveForms.length = "+u.options.ActiveForms.length+". Could not find form with bwRequestTypeId: "+n+"."),s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_Default")):s=u.options.ActiveForms[l].bwFormHtml}else u.options.ActiveForms==null||u.options.ActiveForms&&u.options.ActiveForms.length==0?(console.log("Error in getRequestFormHtml(): There are no active forms. thiz.options.ActiveForms: "+JSON.stringify(u.options.ActiveForms)),r="Error: There is no form for this request type. You can continue with this default form here, but the Workflow Administrator or a Configuration Manager should go to Configuration > Forms to create a form for this request type.xcx2",$(".bwActiveMenu").bwActiveMenu("displayTopBarErrorMessage",r),s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_Default")):(console.log("Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms.: "+JSON.stringify(u.options.ActiveForms)),alert("Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms. length: "+u.options.ActiveForms.length+", "+JSON.stringify(u.options.ActiveForms)),i.message='<span style="color:tomato;font-size:40pt;">Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms: '+JSON.stringify(u.options.ActiveForms)+"<\/span>");console.log("");console.log("******************************************");console.log('FORM>>: In bwRequest.js.getRequestFormHtml(). Adding the top of the form div tag id="budgetrequestform". xcx464367-2-2');console.log("******************************************");console.log("");o="";t&&t==!0?(s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_offlinerequest_Default"),o+='<div id="budgetrequestform" class="budgetrequestform" align="left" bwrequesttitle="" bwbudgetrequestid="" bwworkflowtaskitemid="" bwrequesttype="offlinerequest" bwformid="" bworgid="" bworgname="" >'):o+='<div id="budgetrequestform" class="budgetrequestform" align="left" bwrequesttitle="" bwbudgetrequestid="" bwworkflowtaskitemid="" bwrequesttypeid="'+n+'" bwformid="" bworgid="" bworgname="">';o+=s;o+="<\/div>";c={status:"SUCCESS",message:"",html:o};f(c)}}).catch(function(n){var t="Exception in bwRequest.js.getRequestFormHtml.loadActiveForms(). xcx324235-2. "+JSON.stringify(n),i;console.log(t);displayAlertDialog(t);i={status:"EXCEPTION",message:t};e(i)});else{if(console.log("THIS FORM IS UP TO DATE. NO RELOADING OF FORMS NECESSARY. configurationModifiedDate: "+v+", formModifiedDate: "+y),a=-1,u.options.ActiveForms&&u.options.ActiveForms.length>0){for(h=0;h<u.options.ActiveForms.length;h++)if(u.options.ActiveForms[h].bwRequestTypeId==n){a=h;break}a==-1?(console.log("In getRequestFormHtml(): thiz.options.ActiveForms.length = "+u.options.ActiveForms.length+". Could not find form with bwRequestTypeId: "+n+"."),s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_Default")):s=u.options.ActiveForms[a].bwFormHtml}else u.options.ActiveForms==null||u.options.ActiveForms&&u.options.ActiveForms.length==0?(console.log("Error in getRequestFormHtml(): There are no active forms. thiz.options.ActiveForms: "+JSON.stringify(u.options.ActiveForms)),o="Error: There is no form for this request type. You can continue with this default form here, but the Workflow Administrator or a Configuration Manager should go to Configuration > Forms to create a form for this request type.xcx2",$(".bwActiveMenu").bwActiveMenu("displayTopBarErrorMessage",o),s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_Default")):(console.log("Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms.: "+JSON.stringify(u.options.ActiveForms)),alert("Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms. length: "+u.options.ActiveForms.length+", "+JSON.stringify(u.options.ActiveForms)),results.message='<span style="color:tomato;font-size:40pt;">Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms: '+JSON.stringify(u.options.ActiveForms)+"<\/span>");console.log("");console.log("******************************************");console.log('FORM>>: In bwRequest.js.getRequestFormHtml(). Adding the top of the form div tag id="budgetrequestform". xcx464367-2-3');console.log("******************************************");console.log("");c="";t&&t==!0?(s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_offlinerequest_Default"),c+='<div id="budgetrequestform" class="budgetrequestform" align="left" bwrequesttitle="" bwbudgetrequestid="" bwworkflowtaskitemid="" bwrequesttype="offlinerequest" bwformid="" bworgid="" bworgname="" >'):c+='<div id="budgetrequestform" class="budgetrequestform" align="left" bwrequesttitle="" bwbudgetrequestid="" bwworkflowtaskitemid="" bwrequesttypeid="'+n+'" bwformid="" bworgid="" bworgname="">';c+=s;c+="<\/div>";l={status:"SUCCESS",message:"",html:c};f(l)}break}}else{if(console.log("THIS FORM IS UP TO DATE. NO RELOADING OF FORMS NECESSARY. configurationModifiedDate: "+v+", formModifiedDate: "+y),a=-1,u.options.ActiveForms&&u.options.ActiveForms.length>0){for(h=0;h<u.options.ActiveForms.length;h++)if(u.options.ActiveForms[h].bwRequestTypeId==n){a=h;break}a==-1?(console.log("In getRequestFormHtml(): thiz.options.ActiveForms.length = "+u.options.ActiveForms.length+". Could not find form with bwRequestTypeId: "+n+"."),s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_Default")):s=u.options.ActiveForms[a].bwFormHtml}else u.options.ActiveForms==null||u.options.ActiveForms&&u.options.ActiveForms.length==0?(o="Error in bwRequest.js.getRequestFormHtml(): DEV: WE SHOULD BE LOADING THEM HERE!!!!!!!!!!!!! There are no active forms. thiz.options.ActiveForms: "+JSON.stringify(u.options.ActiveForms),console.log(o),alert(o),$(".bwActiveMenu").bwActiveMenu("displayTopBarErrorMessage",o),s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_Default")):(console.log("Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms.: "+JSON.stringify(u.options.ActiveForms)),alert("Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms. length: "+u.options.ActiveForms.length+", "+JSON.stringify(u.options.ActiveForms)),results.message='<span style="color:tomato;font-size:40pt;">Unexpected error in getRequestFormHtml(): Unexpected value for thiz.options.ActiveForms: '+JSON.stringify(u.options.ActiveForms)+"<\/span>");console.log("");console.log("******************************************");console.log('FORM>>: In bwRequest.js.getRequestFormHtml(). Adding the top of the form div tag id="budgetrequestform". xcx464367-2-4');console.log("******************************************");console.log("");c="";t&&t==!0?(s=$(".bwAuthentication").bwAuthentication("option","bwFormHtml_offlinerequest_Default"),c+='<div id="budgetrequestform" class="budgetrequestform" align="left" bwrequesttitle="" bwbudgetrequestid="" bwworkflowtaskitemid="" bwrequesttype="offlinerequest" bwformid="" bworgid="" bworgname="" >'):c+='<div id="budgetrequestform" class="budgetrequestform" align="left" bwrequesttitle="" bwbudgetrequestid="" bwworkflowtaskitemid="" bwrequesttypeid="'+n+'" bwformid="" bworgid="" bworgname="">';c+=s;c+="<\/div>";l={status:"SUCCESS",message:"",html:c};f(l)}else o="Error in bwRequest.js.getRequestFormHtml(). Not an offline request, so expected a value for bwRequestTypeId: "+n+". This process cannot continue. thisIsAnOfflineRequest: "+t,console.log(o),displayAlertDialog(o),l={status:"ERROR",message:o},e(l)}catch(p){o="Exception in bwRequest.js.getRequestFormHtml():1: "+p.message+", "+p.stack;console.log(o);displayAlertDialog(o);l={status:"EXCEPTION",message:o};e(l)}})},displayRequestForm:function(n,t,i,r,u){var f,e,o,c,h,s,a;try{console.log("In bwRequest.js.displayRequestForm(). selectedRaciRole: "+r+", budgetRequestId: "+n);f=this;e=$(".bwAuthentication").bwAuthentication("option","workflowAppId");o=$(".bwAuthentication").bwAuthentication("option","participantId");u?(s="In bwRequest.js.displayRequestForm(). bwRequestJson has been passed. THIS MEANS IT IS A POPPED-OUT DIALOG being display, or being returned to the main browser window.. bwRequestJson: "+JSON.stringify(u),console.log(s),c=u.bwRequestJson):(console.log("In bwRequest.js.displayRequestForm(). No bwRequestJson has been passed. bwRequestJson: "+JSON.stringify(u)),c=u);h=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");e&&o&&h&&n?(console.log(">>>>>>>>>>>>>>>>Step 2: In bwRequest.js.displayRequestForm(). Calling operationUri: "+webserviceurl+"/getsinglebudgetrequest"),a={bwParticipantId_LoggedIn:o,bwActiveStateIdentifier:h,bwWorkflowAppId_LoggedIn:e,bwWorkflowAppId:e,bwBudgetRequestId:n},$.ajax({url:webserviceurl+"/getsinglebudgetrequest",type:"POST",data:a,headers:{Accept:"application/json; odata=verbose"},success:function(i){var u,b,v,y,k,a,s,w,l;try{if(console.log(">>>>>>>>>>>>>>>>Step 3: In bwRequest.js.displayRequestForm.getsinglebudgetrequest.success()."),console.log("In displayRequestForm(). THIS IS WHERE WE PARSE THE WORKFLOW JSON AND CUSTOMIZE THE FORM!!!!!!!!!!!!!!"),i.status!="SUCCESS")console.log("Error in bwRequest.js.displayRequestForm.getsinglebudgetrequest.success(): "+JSON.stringify(i)),displayAlertDialog("Error in bwRequest.js.displayRequestForm.getsinglebudgetrequest.success(): "+JSON.stringify(i));else if(u=i.results.bwBudgetRequest,b=i.results,u&&u.bwRequestJson&&u.bwRequestJson!=""){if(c)v="In bwRequest.js.displayRequestForm(). bwRequestJson was provided so overwriting bwBudgetRequest.bwRequestJson. This must be from a popped-out window. SO WHY DID WE JUST CALL THE WEB SERVICE??? Maybe we can optimize this someday, but I already tried, and it is best to leave this until we properly address fine tuned caching and IndexDb.",console.log(v),u.bwRequestJson=JSON.stringify(c);else if(u.bwBudgetRequestId){for(y=-1,l=0;l<f.options.lastSavedJson.length;l++)if(f.options.lastSavedJson[l]&&f.options.lastSavedJson[l].bwBudgetRequestId){if(f.options.lastSavedJson[l].bwBudgetRequestId==u.bwBudgetRequestId){y=l;break}}else displayAlertDialog_Persistent("xcx12345-2 Error: Property [bwBudgetRequestId] does not exist: "+JSON.stringify(f.options.lastSavedJson[l])+", thiz.options.lastSavedJson: "+JSON.stringify(f.options.lastSavedJson));y>-1?f.options.lastSavedJson[y]=JSON.parse(u.bwRequestJson):f.options.lastSavedJson.push(JSON.parse(u.bwRequestJson));console.log('In bwRequest.js.populateRequestForm(). Successfully added bwRequestJson to thiz.options.lastSavedJson for our "You have changes that need to be saved" check.')}else console.log("Error in bwRequest.js.populateRequestForm(). Invalid value for bwBudgetRequest.bwBudgetRequestId: "+u.bwBudgetRequestId),displayAlertDialog("Error in bwRequest.js.populateRequestForm(). Invalid value for bwBudgetRequest.bwBudgetRequestId: "+u.bwBudgetRequestId);if(u.bwRequestTypeId||(console.log("Had to correct the bwBudgetRequest.bwRequestTypeId... fix this eventually. xcx123357-1"),alert("Had to correct the bwBudgetRequest.bwRequestTypeId... fix this eventually. xcx123357-1"),k=JSON.parse(u.bwRequestJson).bwRequestTypeId,u.bwRequestTypeId=k),console.log(""),console.log("********"),console.log("In displayRequestForm(). bwBudgetRequest.bwRequestTypeId: "+u.bwRequestTypeId),console.log("********"),console.log(""),u.bwRequestTypeId)console.log("Calling bwRequest.js.renderRequestForm() from displayRequestForm(). THIS IS THE ONLY PLACE THIS SHOULD BE HAPPENING. Yes, this is true. xcx1312424-1. 3-2-2024."),f.renderRequestForm(u,h,t,o,e,r,b);else{for(console.log('Error: Invalid bwRequestTypeId. A Request Type has not been chosen for this request. Select from the available Request Types, then click the "Select Request Type" button. bwRequestTypeId: '+u.bwRequestTypeId),s="",s+="        <span id=\"spanChangeRequestTypeDialogTitle2\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 22pt;font-weight:bold;\">A Request Type has not been chosen for this request. Select from the available Request Types, then click the \"Select Request Type\" button.<\/span><br /><br />",s+="        <br /><br />",s+="        <span id=\"spanChangeRequestTypeDialogContent\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 22pt;font-weight:bold;\"><\/span><br /><br />",s+="        <br /><br />",s+="        <br /><br />",s+="        <div id=\"btnUserRoleDialogChangeRolexx\" class=\"divSignInButton\" onclick=\"$('.bwRequest').bwRequest('assignRequestTypeToRequest', '"+n+'\', this);" style="width:90%;text-align:center;line-height:0.8em;font-weight:bold;">',s+="            Select Request Type",s+="        <\/div>",s+="        <br /><br />",$("#"+t).find("#divRequestFormDialogContent")[0].innerHTML=s,a=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes"),console.log("Create the request type select element/drop down box. xcx3 bwEnabledRequestTypes: "+JSON.stringify(a)),s="",s+='<select id="selectRequestTypeDropDown" onchange="" style=\'display:inline;border-color: whitesmoke; color: grey; font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 14pt; font-weight: bold; cursor: pointer;\'>',s+='<option value="" >Select a request type...<\/option>',w=!1,l=0;l<a.EnabledItems.length;l++)a.EnabledItems[l].SingletonName&&(s+='<option value="'+a.EnabledItems[l].bwRequestTypeId+'" >'+a.EnabledItems[l].SingletonName+"<\/option>",w=!0);s+="<\/select>";w==!1&&(s="",s+='<span style="color:tomato;">THERE ARE NO AVAILABLE VALID REQUEST TYPES FOR THIS ORGANIZATION. Go to Configuration > Organization Settings, and make sure there is at least 1 request type with a SingletonName and PluralName.<\/span>',$("#"+t).find("#btnUserRoleDialogChangeRolexx")[0].style.display="none",$("#"+t).find("#spanChangeRequestTypeDialogTitle2").html(""));alert('Preparing to populate the form contents in element "spanChangeRequestTypeDialogContent". xcx3247');$("#"+t).find("#spanChangeRequestTypeDialogContent")[0].innerHTML=s}}else v="INVALID bwRequestJson RETURNED. THIS PROCESS CANNOT CONTINUE.xcx41202011 bwBudgetRequest.bwRequestJson: "+u.bwRequestJson,console.log(v),displayAlertDialog(v)}catch(p){console.log("Exception in bwRequest.js.displayRequestForm():2: "+p.message+", "+p.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestForm():2: "+p.message+", "+p.stack)}},error:function(n,i,r){console.log("Error in bwRequest.js.displayRequestForm():1: "+i+", "+r+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n));alert("Error in bwRequest.js.displayRequestForm():1: "+i+", "+r+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n));$(".bwPageScrollingHandler").bwPageScrollingHandler("CloseDialogAndPreventNextWindowScrollEvent",t)}})):(s="Error in bwRequest.js.displayRequestForm(). Unexpected value for parameter(s). workflowAppId: "+e+", participantId: "+o+", activeStateIdentifier: "+h+", budgetRequestId: "+n,console.log(s),displayAlertDialog(s))}catch(l){console.log("Exception in bwRequest.js.displayRequestForm(): "+l.message+", "+l.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestForm(): "+l.message+", "+l.stack)}},displayRequestForm_ForTrashBin:function(n,t,i,r,u){var s,o,a;try{console.log("In bwRequest.js.displayRequestForm_ForTrashBin(). selectedRaciRole: "+r+", budgetRequestId: "+n);var f=this,e=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),h=$(".bwAuthentication").bwAuthentication("option","participantId"),v=$(".bwAuthentication").bwAuthentication("option","participantEmail"),y=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),c;u?(o="In bwRequest.js.displayRequestForm_ForTrashBin(). bwRequestJson has been passed. THIS MEANS IT IS A POPPED-OUT DIALOG being display, or being returned to the main browser window.. bwRequestJson: "+JSON.stringify(u),console.log(o),c=u.bwRequestJson):(console.log("In bwRequest.js.displayRequestForm_ForTrashBin(). No bwRequestJson has been passed. bwRequestJson: "+JSON.stringify(u)),c=u);s=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");e&&h&&s&&n?(console.log(">>>>>>>>>>>>>>>>Step 2: In bwRequest.js.displayRequestForm_ForTrashBin(). Calling operationUri: "+webserviceurl+"/getsinglebudgetrequest"),a={bwParticipantId_LoggedIn:h,bwActiveStateIdentifier:s,bwWorkflowAppId_LoggedIn:e,bwWorkflowAppId:e,bwBudgetRequestId:n,isActive:!0,bwRequestType:"ALL"},$.ajax({url:webserviceurl+"/getsinglebudgetrequest",type:"POST",data:a,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){n.status==401?(console.log("Error in bwRequest.js.displayRequestForm.getsinglebudgetrequest(). xcx213124-1-2 Unauthorized. Please refresh your browser and log in again. jqXHR.status: "+n.status+", settings: "+t+", errorThrown: "+i),alert("Error in bwRequest.js.displayRequestForm.getsinglebudgetrequest(). xcx213124-1-2 Unauthorized. Please refresh your browser and log in again. jqXHR.status: "+n.status+", settings: "+t+", errorThrown: "+i)):(console.log("Error in bwRequest.js.displayRequestForm()():1: "+t+", "+i+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n)),alert("Error in bwRequest.js.displayRequestForm()():1: "+t+", "+i+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n)))},success:function(i){var u,v,y,b,a,o,w,l;try{if(console.log(">>>>>>>>>>>>>>>>Step 3: In bwRequest.js.displayRequestForm_ForTrashBin.getsinglebudgetrequest.success()."),console.log("In displayRequestForm_ForTrashBin(). THIS IS WHERE WE PARSE THE WORKFLOW JSON AND CUSTOMIZE THE FORM!!!!!!!!!!!!!!"),i.status!="SUCCESS")console.log("Error in bwRequest.js.displayRequestForm_ForTrashBin.getsinglebudgetrequest.success(): "+JSON.stringify(i)),displayAlertDialog("Error in bwRequest.js.displayRequestForm_ForTrashBin.getsinglebudgetrequest.success(): "+JSON.stringify(i));else if(u=i.results,u.bwBudgetRequest&&u.bwBudgetRequest.bwRequestJson&&u.bwBudgetRequest.bwRequestJson!=""){if(c)v="In bwRequest.js.displayRequestForm_ForTrashBin(). bwRequestJson was provided so overwriting brData.bwBudgetRequest.bwRequestJson. This must be from a popped-out window. SO WHY DID WE JUST CALL THE WEB SERVICE??? Maybe we can optimize this someday, but I already tried, and it is best to leave this until we properly address fine tuned caching and IndexDb.",console.log(v),u.bwBudgetRequest.bwRequestJson=JSON.stringify(c);else if(u.bwBudgetRequest.bwBudgetRequestId){for(y=-1,l=0;l<f.options.lastSavedJson.length;l++)if(f.options.lastSavedJson[l]&&f.options.lastSavedJson[l].bwBudgetRequestId){if(f.options.lastSavedJson[l].bwBudgetRequestId==u.bwBudgetRequest.bwBudgetRequestId){y=l;break}}else displayAlertDialog_Persistent("xcx12345-2 Error: Property [bwBudgetRequestId] does not exist: "+JSON.stringify(f.options.lastSavedJson[l])+", thiz.options.lastSavedJson: "+JSON.stringify(f.options.lastSavedJson));y>-1?f.options.lastSavedJson[y]=JSON.parse(u.bwBudgetRequest.bwRequestJson):f.options.lastSavedJson.push(JSON.parse(u.bwBudgetRequest.bwRequestJson));console.log('In bwRequest.js.populateRequestForm(). Successfully added bwRequestJson to thiz.options.lastSavedJson for our "You have changes that need to be saved" check.')}else console.log("Error in bwRequest.js.populateRequestForm(). Invalid value for brData.bwBudgetRequest.bwBudgetRequestId: "+u.bwBudgetRequest.bwBudgetRequestId),displayAlertDialog("Error in bwRequest.js.populateRequestForm(). Invalid value for brData.bwBudgetRequest.bwBudgetRequestId: "+u.bwBudgetRequest.bwBudgetRequestId);if(u.bwBudgetRequest.bwRequestTypeId||(console.log("Had to correct the brData.bwBudgetRequest.bwRequestTypeId... fix this eventually. xcx123357-2"),b=JSON.parse(u.bwBudgetRequest.bwRequestJson).bwRequestTypeId,u.bwBudgetRequest.bwRequestTypeId=b),console.log(""),console.log("********"),console.log("In displayRequestForm_ForTrashBin(). brData.bwBudgetRequest.bwRequestTypeId: "+u.bwBudgetRequest.bwRequestTypeId),console.log("********"),console.log(""),u.bwBudgetRequest.bwRequestTypeId)console.log("xcx12356 calling renderRequestForm_ForTrashBin()."),f.renderRequestForm_ForTrashBin(u,s,n,t,h,e,r);else{for(console.log('Error: Invalid bwRequestTypeId. A Request Type has not been chosen for this request. Select from the available Request Types, then click the "Select Request Type" button. bwRequestTypeId: '+u.bwBudgetRequest.bwRequestTypeId),o="",o+="        <span id=\"spanChangeRequestTypeDialogTitle2\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 22pt;font-weight:bold;\">A Request Type has not been chosen for this request. Select from the available Request Types, then click the \"Select Request Type\" button.<\/span><br /><br />",o+="        <br /><br />",o+="        <span id=\"spanChangeRequestTypeDialogContent\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 22pt;font-weight:bold;\"><\/span><br /><br />",o+="        <br /><br />",o+="        <br /><br />",o+="        <div id=\"btnUserRoleDialogChangeRolexx\" class=\"divSignInButton\" onclick=\"$('.bwRequest').bwRequest('assignRequestTypeToRequest', '"+n+'\', this);" style="width:90%;text-align:center;line-height:0.8em;font-weight:bold;">',o+="            Select Request Type",o+="        <\/div>",o+="        <br /><br />",$("#"+t).find("#divRequestFormDialogContent")[0].innerHTML=o,a=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes"),console.log("Create the request type select element/drop down box. xcx3 bwEnabledRequestTypes: "+JSON.stringify(a)),o="",o+='<select id="selectRequestTypeDropDown" onchange="" style=\'display:inline;border-color: whitesmoke; color: grey; font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 14pt; font-weight: bold; cursor: pointer;\'>',o+='<option value="" >Select a request type...<\/option>',w=!1,l=0;l<a.EnabledItems.length;l++)a.EnabledItems[l].SingletonName&&(o+='<option value="'+a.EnabledItems[l].bwRequestTypeId+'" >'+a.EnabledItems[l].SingletonName+"<\/option>",w=!0);o+="<\/select>";w==!1&&(o="",o+='<span style="color:tomato;">THERE ARE NO AVAILABLE VALID REQUEST TYPES FOR THIS ORGANIZATION. Go to Configuration > Organization Settings, and make sure there is at least 1 request type with a SingletonName and PluralName.<\/span>',$("#"+t).find("#btnUserRoleDialogChangeRolexx")[0].style.display="none",$("#"+t).find("#spanChangeRequestTypeDialogTitle2").html(""));alert('Preparing to populate the form contents in element "spanChangeRequestTypeDialogContent". xcx3247');$("#"+t).find("#spanChangeRequestTypeDialogContent")[0].innerHTML=o}}else v="INVALID bwRequestJson RETURNED. THIS PROCESS CANNOT CONTINUE.xcx41202011 brData.bwBudgetRequest.bwRequestJson: "+u.bwBudgetRequest.bwRequestJson,console.log(v),displayAlertDialog(v)}catch(p){console.log("Exception in bwRequest.js.displayRequestForm_ForTrashBin():2: "+p.message+", "+p.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestForm_ForTrashBin():2: "+p.message+", "+p.stack)}}})):(o="Error in bwRequest.js.displayRequestForm_ForTrashBin(). Unexpected value for parameter(s). workflowAppId: "+e+", participantId: "+h+", activeStateIdentifier: "+s+", budgetRequestId: "+n,console.log(o),displayAlertDialog(o))}catch(l){console.log("Exception in bwRequest.js.displayRequestForm_ForTrashBin(): "+l.message+", "+l.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestForm_ForTrashBin(): "+l.message+", "+l.stack)}},renderRequestForm:function(n,t,i,r,u,f,e){var o,h;try{if(o=this,console.log("In bwRequest.js.renderRequestForm(). brData: "+JSON.stringify(e)),console.log("In renderRequestForm(). bwBudgetRequest.BudgetWorkflowStatus: "+n.BudgetWorkflowStatus),n.bwWorkflowAppId&&n.bwBudgetRequestId)if(n.BudgetWorkflowStatus=="NOT_SUBMITTED")console.log("In bwRequest.js.displayRequestForm(). THIS MUST BE A NEW REQUEST xcx3434 brData.BudgetWorkflowStatus: "+e.BudgetWorkflowStatus),h=o.getRequestFormHtml(n.bwRequestTypeId,null,e.ConfigurationModifiedDate_BwForm,"xcx23452-1"),h.then(function(t){var f,s,e,r,l;try{if(t.status!="SUCCESS")console.log("Error xcx342354235: "+t.message),$("#"+i).find("#divRequestFormDialogContent")[0].innerHTML=t.message;else{$("#"+i).find("#divRequestFormDialogContent")[0].innerHTML=t.html;$("#"+i).find("#budgetrequestform")[0].setAttribute("bwrequesttypeid",n.bwRequestTypeId);$("#"+i).find("#budgetrequestform")[0].setAttribute("bwfiscalyear",n.bwFiscalYear);$("#"+i).find("#budgetrequestform")[0].setAttribute("bwbudgetrequestid",n.bwBudgetRequestId);$("#"+i).find("#budgetrequestform")[0].setAttribute("bwrequesttitle",n.Title);$("#"+i).find("#budgetrequestform")[0].setAttribute("bwworkflowstatus_bwworkflowstepname",n.BudgetWorkflowStatus);f=n.OrgId;s=n.OrgName;f||(console.log("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+f+", bwOrgName: "+s),alert("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+f+", bwOrgName: "+s));$("#"+i).find("#budgetrequestform")[0].setAttribute("bworgid",f);$("#"+i).find("#budgetrequestform")[0].setAttribute("bworgname",s);var a=n.FunctionalAreaId,v=n.ManagerId,y=n.ManagerFriendlyName,p=n.ARStatus,h,c=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems;for(e=0;e<c.length;e++)if(n.bwRequestTypeId==c[e].bwRequestTypeId){h=c[e];break}r="";r+="                   <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">";r+=h?"                       New "+h.SingletonName+": ":"                       requesttype_not_found bwRequestTypeId:"+n.bwRequestTypeId+" ";r+='&nbsp;<span xcx="xcx3567-1" id="spanNewRequestEllipsesButton" class="spanButton2 context-menu-newrequesteditor" style="height:20px;width:150px;"> ... <\/span>';r+="<\/span>";$("#"+i).find("#spanRequestForm_Title")&&$("#"+i).find("#spanRequestForm_Title")[0]&&($("#"+i).find("#spanRequestForm_Title")[0].innerHTML=r);$("#"+i).find("#spanViewWorkflowParticipantsLink")[0].innerHTML="";$("#"+i).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML="";$("#"+i).find("#spanRequestForm_Checklists")[0].innerHTML="";$("#"+i).find("#spanRequestForm_Error")[0].innerHTML="";$("#"+i).find("#spanRequestForm_Instructions")[0].innerHTML='Complete the form then click the "Submit" button.';o.renderRequestFormButtons(i,n,null,r,"xcx445566-1");console.log("Calling populateRequestForm(). xcx3452-2-1");l=o.populateRequestForm(i,n.bwRequestJson,!0);l.then(function(){var r,u,f,s;try{if(r=document.getElementById("myCanvas"),r){var t=document.getElementsByTagName("body")[0],h=t.scrollWidth,c=Math.max(t.scrollHeight,document.documentElement.scrollHeight,t.offsetHeight,document.documentElement.offsetHeight,t.clientHeight,document.documentElement.clientHeight,t.scrollHeight,t.getBoundingClientRect().height);r.width=h;r.height=c}u=document.getElementById(i).getBoundingClientRect().left;u<0&&(console.log("THE AR DIALOG has been displayed too far to the left. xcxRepositioning here...xcx23214-1 left: "+u),alert("THE AR DIALOG has been displayed too far to the left. xcxRepositioning here...xcx23214-1 left: "+u),$("#"+i).dialog({position:{my:"center top",at:"center top","of":window}}));window.opener&&(f="divRequestFormDialog_"+n.bwBudgetRequestId,alert("xcx999334-3 Should be closing dialog window.opener.dialogId: "+f),console.log("xcx999334-3 Should be closing dialog window.opener.dialogId: "+f),window.opener.$("#"+f).dialog("close"));s=$("#"+i).find("#spanNewRequestEllipsesButton")[0];$(s).on("click",function(n){n.preventDefault();n.stopImmediatePropagation();$(this).contextMenu()});console.log("Displaying elipses context menu for request without a workflow (new request).");$.contextMenu({selector:".context-menu-newrequesteditor",callback:function(n){var t=$(this).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),r=$(this).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid"),f="divRequestFormDialog_"+t,u,i;n=="requestjson"?t?o.viewScrapedBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjson). Invalid value for bwBudgetRequestId: "+t):n=="requestjsondignostics"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx445"):n=="requestjsondb"?t?o.viewDatabaseBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjsondb). Invalid value for bwBudgetRequestId: "+t):n=="viewbwbudgetrequestjson"?t?o.viewDatabaseBwRequestJson2(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewbwbudgetrequestjson). Invalid value for bwBudgetRequestId: "+t):n=="requesthtmldb"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx4471"):n=="viewworkflowjson"?o.viewWorkflowStepAndRoleJson(workflow.Steps.Step[stepIndex]):n=="changetherequesttype"?t?o.changeTheRequestTypeForARequest(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(changetherequesttype). Invalid value for bwBudgetRequestId: "+t):n=="updatedailyoverduetasknotificationdate"?r?o.displayUpdateDailyOverdueTaskNotificationDateDialog(r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(updatedailyoverduetasknotificationdate). Invalid value for bwWorkflowTaskItemId: "+r):n=="viewtaskjson"?r?o.viewTaskJsonInDialog(r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewtaskjson). Invalid value for bwWorkflowTaskItemId: "+r):n=="deletethisrequest"?t?o.cmdDisplayDeleteBudgetRequestDialog(t,"this New Request"):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(deletethisrequest). Invalid value for bwBudgetRequestId: "+t):n=="setreminder"&&(t?(u=$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders(),u&&u.length&&u.length==1?$(".bwOneTimeRequestReminders").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,"this New Request"):(i=document.getElementById("divBwOneTimeRequestReminders"),i&&i.remove(),i=document.createElement("div"),i.id="divBwOneTimeRequestReminders",i.style.display="none",document.body.appendChild(i),$(i).bwOneTimeRequestReminders({}),$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,"this New Request"))):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(setreminder). Invalid value for bwBudgetRequestId: "+t))},items:{requestjson:{name:"Request JSON",icon:"edit"},requestjsondb:{name:"Request JSON from Database",icon:"edit"},changetherequesttype:{name:"Change the Request Type",icon:"edit"},deletethisrequest:{name:"Delete this Request",icon:"edit"},setreminder:{name:"Set a One-Time Reminder",icon:"edit"}}})}catch(e){console.log("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-1: "+e.message+", "+e.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-1: "+e.message+", "+e.stack)}})}}catch(u){console.log("Exception in bwRequest.js.renderRequestForm():21-1-2: "+u.message+", "+u.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm():21-1-2: "+u.message+", "+u.stack);alert("Exception in bwRequest.js.renderRequestForm():21-1-2: "+u.message+", "+u.stack)}});else{var c=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),l=$(".bwAuthentication").bwAuthentication("option","participantId"),a=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),v={bwParticipantId_LoggedIn:l,bwActiveStateIdentifier:a,bwWorkflowAppId_LoggedIn:c,bwWorkflowAppId:n.bwWorkflowAppId,bwBudgetRequestId:n.bwBudgetRequestId};$.ajax({url:o.options.operationUriPrefix+"_bw/workflowconfiguration5",type:"POST",data:v,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){console.log("xcx23123-1 Error in bwRequest.js.displayRequestForm(): "+t+" "+i);displayAlertDialog("xcx23123-1 Error in bwRequest.js.displayRequestForm(): "+t+" "+i)},success:function(t){var s,a,h,c,v;try{if(t.status!="SUCCESS")console.log(t.message),displayAlertDialog(t.message);else{if(t.Workflow?s=JSON.parse(t.Workflow[0].bwWorkflowJson):n.BudgetWorkflowStatus!="NOT_SUBMITTED"?(c="In bwRequest.js.displayRequestForm(). THERE IS NO WORKFLOW FOR THIS REQUEST TYPE. HOWEVER, BudgetWorkflowStatus SHOULD BE NOT_SUBMITTED. IT IS NOT. bwBudgetRequest.BudgetWorkflowStatus: "+n.BudgetWorkflowStatus,console.log(c),displayAlertDialog(c)):(console.log("This request has no workflow. xcx4354376."),alert("This request has no workflow. xcx4354376.")),console.log("HERE WE GO! WE HAVE A GOOD WORKFLOW JSON. This is the only place we should be creating a header for a form!!!! 2-11-2022"),a=[],t.Tasks&&t.Tasks.length)for(h=0;h<t.Tasks.length;h++)t.Tasks[h].WorkflowStepName==n.BudgetWorkflowStatus?a.push(t.Tasks[h]):t.Tasks[h].bwStatus=="Completed"&&t.Tasks[h].bwPercentComplete==100?console.log('AUDIT Success in bwRequest.js.displayRequestForm(). This task was completed for request "'+n.Title+'" ['+n.bwBudgetRequestId+"]. bwWorkflowTaskItemId: ["+t.Tasks[h].bwWorkflowTaskItemId+"]"):(console.log("AUDIT Error in bwRequest.js.displayRequestForm(): An unfinished task exists for this request which does not match the current workflow step of: "+n.BudgetWorkflowStatus+". The mismatched step is "+t.Tasks[h].WorkflowStepName),displayAlertDialog("AUDIT Error in bwRequest.js.displayRequestForm(): An unfinished task exists for this request which does not match the current workflow step of: "+n.BudgetWorkflowStatus+". The mismatched step is "+t.Tasks[h].WorkflowStepName));console.log("In bwRequest.js.renderRequestForm(). xcx235-4 getting ready to call getRequestFormHtml(). bwRequestTypeId: "+n.bwRequestTypeId);c="In bwRequest.js.xx(). Calling getRequestFormHtml(). This method needs work.... .. ";console.log(c);v=o.getRequestFormHtml(n.bwRequestTypeId,null,e.ConfigurationModifiedDate_BwForm,"xcx23452-2");v.then(function(h){var b,ut,nt,ft,v,ht,vt,yt,c,y,d,et,ot,tt,w,rt,ct,lt,p,g,l,pt,it,k,at,wt,bt,kt;try{if(h.status!="SUCCESS")tt="Error in bwRequest.js.renderRequestForm():xcx2344213: "+h.status+", "+h.message,console.log(tt),displayAlertDialog(tt),$("#"+i).find("#divRequestFormDialogContent")[0].innerHTML=tt;else{$("#"+i).find("#divRequestFormDialogContent")[0].innerHTML=h.html;$("#"+i).find("#spanViewWorkflowParticipantsLink")&&$("#"+i).find("#spanViewWorkflowParticipantsLink")[0]&&($("#"+i).find("#spanViewWorkflowParticipantsLink")[0].innerHTML="");$("#"+i).find("#budgetrequestform")[0].setAttribute("bwrequesttypeid",n.bwRequestTypeId);$("#"+i).find("#budgetrequestform")[0].setAttribute("bwfiscalyear",n.bwFiscalYear);$("#"+i).find("#budgetrequestform")[0].setAttribute("bwbudgetrequestid",n.bwBudgetRequestId);$("#"+i).find("#budgetrequestform")[0].setAttribute("bwrequesttitle",n.Title);$("#"+i).find("#budgetrequestform")[0].setAttribute("bwworkflowstatus_bwworkflowstepname",n.BudgetWorkflowStatus);b=n.OrgId;ut=n.OrgName;b||(console.log("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+b+", bwOrgName: "+ut),alert("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+b+", bwOrgName: "+ut));$("#"+i).find("#budgetrequestform")[0].setAttribute("bworgid",b);$("#"+i).find("#budgetrequestform")[0].setAttribute("bworgname",ut);var dt=n.FunctionalAreaId,gt=n.ManagerId,ni=n.ManagerFriendlyName,ti=n.ARStatus;for(bwApprovalLevelWorkflowToken=n.bwApprovalLevelWorkflowToken,ft=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems,l=0;l<ft.length;l++)if(n.bwRequestTypeId==ft[l].bwRequestTypeId){nt=ft[l];break}if(p="",p+="                   <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">",console.log("xcx213124154 requestType: "+nt),nt?(console.log("xcx213124154 FOUND requestType: "+nt),p+="                       "+nt.SingletonName+": "):(console.log("xcx213124154 NO requestType: "+nt),p+="                       requesttype_not_found bwRequestTypeId:"+n.bwRequestTypeId+": "),p+='                       <span id="spanRequestFormBudgetRequestTitle" title="">',p+=n.Title,p+="                       <\/span>",p+='&nbsp;<span xcx="xcx3567-2-1-1" id="spanNewRequestEllipsesButton" class="spanButton2 context_menu_requestformellipses" style="height:20px;width:150px;"> ... <\/span>',p+="<\/span>",$("#"+i).find("#spanRequestForm_Title")&&$("#"+i).find("#spanRequestForm_Title")[0]&&($("#"+i).find("#spanRequestForm_Title")[0].innerHTML=p),v=null,ht=null,s)for(l=0;l<s.Steps.Step.length;l++)if(ht=s.Steps.Step[l]["@Name"],ht==n.BudgetWorkflowStatus){v=l;break}vt=$("#"+i).find("#spanNewRequestEllipsesButton")[0];$(vt).on("click",function(n){n.preventDefault();n.stopImmediatePropagation();$(this).contextMenu()});if(yt=$(".bwAuthentication").bwAuthentication("option","developerModeEnabled"),yt==!0?(console.log("Displaying elipses context menu for request with a workflow (new request). xcx214-1"),alert("Displaying elipses context menu for request without a workflow (new request). xcx214-1"),$.contextMenu({selector:".context_menu_requestformellipses",callback:function(n){var t=$(this).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),i=$(this).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid"),u="divRequestFormDialog_"+t,r;n=="requestjson"?t?o.viewScrapedBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjson). Invalid value for bwBudgetRequestId: "+t):n=="requestjsondignostics"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx445"):n=="requestjsondb"?t?o.viewDatabaseBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjsondb). Invalid value for bwBudgetRequestId: "+t):n=="viewbwbudgetrequestjson"?t?o.viewDatabaseBwRequestJson2(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewbwbudgetrequestjson). Invalid value for bwBudgetRequestId: "+t):n=="requesthtmldb"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx4471"):n=="viewworkflowjson"?o.viewWorkflowStepAndRoleJson(s.Steps.Step[v]):n=="changetherequesttype"?t?o.changeTheRequestTypeForARequest(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(changetherequesttype). Invalid value for bwBudgetRequestId: "+t):n=="deletethisrequest"?(r=$(this).closest("#budgetrequestform")[0].getAttribute("bwrequesttitle"),t?o.cmdDisplayDeleteBudgetRequestDialog(t,r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(deletethisrequest). Invalid value for bwBudgetRequestId: "+t)):n=="updatedailyoverduetasknotificationdate"?i?o.displayUpdateDailyOverdueTaskNotificationDateDialog(i):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(updatedailyoverduetasknotificationdate). Invalid value for bwWorkflowTaskItemId: "+i):n=="viewtaskjson"&&(i?o.viewTaskJsonInDialog(i):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewtaskjson). Invalid value for bwWorkflowTaskItemId: "+i))},items:{requestjson:{name:"Request JSON (scraped2) xcx2",icon:"edit"},requestjsondb:{name:"Request JSON from Database",icon:"edit"},viewbwbudgetrequestjson:{name:"Request JSON (bwBudgetRequest)",icon:"edit"},updatedailyoverduetasknotificationdate:{name:"Update DailyOverdueTaskNotificationDate",icon:"edit"},viewtaskjson:{name:"Task JSON",icon:"edit"},requestjsondignostics:{name:"Request JSON Diagnostics",icon:"edit"},requesthtmldb:{name:"Request Form HTML from Database xcx1-4",icon:"edit"},viewworkflowjson:{name:"View Workflow Step/Role Json",icon:"edit"},changetherequesttype:{name:"Change the Request Type",icon:"edit"},deletethisrequest:{name:"Delete this Requestxcx2",icon:"edit"}}})):(console.log("Displaying elipses context menu for request with a workflow (new request). xcx214-2"),$.contextMenu({selector:".context_menu_requestformellipses",callback:function(n){var t=$(this).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),e=$(this).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid"),s="divRequestFormDialog_"+t,u,i,r,f;n=="changetherequesttype"?t?o.changeTheRequestTypeForARequest(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(changetherequesttype). Invalid value for bwBudgetRequestId: "+t):n=="deletethisrequest"?(r=$(this).closest("#budgetrequestform")[0].getAttribute("bwrequesttitle"),t?o.cmdDisplayDeleteBudgetRequestDialog(t,r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(deletethisrequest). Invalid value for bwBudgetRequestId: "+t)):n=="setreminder"?(r=$(this).closest("#budgetrequestform")[0].getAttribute("bwrequesttitle"),t?(u=$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders(),u&&u.length&&u.length==1?$(".bwOneTimeRequestReminders").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,r):(i=document.getElementById("divBwOneTimeRequestReminders"),i&&i.remove(),i=document.createElement("div"),i.id="divBwOneTimeRequestReminders",i.style.display="none",document.body.appendChild(i),$(i).bwOneTimeRequestReminders({}),$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,r))):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(setreminder). Invalid value for bwBudgetRequestId: "+t)):n=="removeworkflow"&&(t?(r=$(this).closest("#budgetrequestform")[0].getAttribute("bwrequesttitle"),f=$(this).closest("#budgetrequestform")[0].getAttribute("bwrequesttypeid"),o.displayRequestWorkflowAuditTrailDialog(r,"",f,t,"",!0)):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(removeworkflow). Invalid value for bwBudgetRequestId: "+t))},items:{removeworkflow:{name:"Remove from workflow",icon:"edit"},changetherequesttype:{name:"Change the Request Type",icon:"edit"},deletethisrequest:{name:"Delete this Request",icon:"edit"},setreminder:{name:"Set a One-Time Reminder",icon:"edit"}}})),v==null)s?(it=o.populateRequestForm(i,n.bwRequestJson,k),it.then(function(){var c,u,l,t,f,r,e,h;try{if(c="xNOBUTTONSINVALIDWORKFLOWSTATUS",o.renderRequestFormButtons(i,n.bwBudgetRequestId,n.bwRequestTypeId,c,"xcx445566-4"),u='Error in bwRequest.js.renderRequestForm(). Invalid workflow step. The step "'+n.BudgetWorkflowStatus+'" must have been renamed or removed from the workflow for xxxs.',displayAlertDialog(u),console.log(u),$("#"+i).find("#spanRequestForm_Error")[0].innerHTML=u,l='Invalid workflow step. The step "'+n.BudgetWorkflowStatus+'" must have been renamed or removed from the workflow for xxxs. Select the Revise/Revert button to restart the request workflow.',$("#"+i).find("#spanRequestForm_Instructions")[0].innerHTML=l,t="",t+='<span style="font-weight:bold;">',t+='   <span xcx="342352-1-2" style="cursor:pointer !important;text-decoration:underline;" title="View RACI workflow history..." onclick="$(\'.bwRequest\').bwRequest(\'displayRequestWorkflowAuditTrailDialog\', \''+n.Title+"', '"+String(n.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.bwRequestTypeId+"', '"+n.bwBudgetRequestId+"', '"+n.bwWorkflowId+"');\">",t+="       Workflow step: [missing]",t+="   <\/span>",t+="<\/span>",t+="<br />",$("#"+i).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML=t,f=JSON.parse(n.bwRequestJson).Checklists,f){for(r="",r+="Completed checklist(s):",r+="<br />",e=0;e<f.length;e++)h=JSON.parse(f[e]),r+='<span xcx="xcx8822567" style="cursor:pointer;text-decoration:underline;" ',r+="onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialogReadOnly', '"+h.bwChecklistTemplatesId+"', '"+n.ProjectTitle+"', '"+n.Title+"', '"+n.bwRequestType+"', '"+n.bwBudgetRequestId+"', '"+n.bwWorkflowId+"', '"+b+"');\">"+h.Title+"<\/span>",r+="<br />";$("#"+i).find("#spanRequestForm_Checklists")[0].innerHTML=r}else $("#"+i).find("#spanRequestForm_Checklists")[0].innerHTML=""}catch(s){console.log("Exception in bwRequest.js.renderRequestForm().xcx123123435: "+s.message+", "+s.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm().xcx123123435: "+s.message+", "+s.stack)}})):(it=o.populateRequestForm(i,n.bwRequestJson,k),it.then(function(){try{}catch(n){console.log("Exception in bwRequest.js.renderRequestForm().xcx123123435-22: "+n.message+", "+n.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm().xcx123123435-22: "+n.message+", "+n.stack)}}));else{if(c={status:null,message:"",RequestingUser:{ParticipantRole:e.RequestingUser.ParticipantRole,QualifyingRolesInThisOrg:e.RequestingUser.RoleIds,AssignedRolesForThisWorkflowStep:[]},WorkflowAdmin:{OnBehalfOfRolesForThisWorkflowStep:[]},WorkflowStep:{AssignedRole:{Role:null,RoleName:null,OnBehalfOf:null,bwWorkflowTaskItemId:null},AllRolesInThisWorkflowStep:[],BwWorkflowTask_Table:a,Assign:null}},c.RequestingUser.ParticipantRole=="owner"&&(c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")||(c.RequestingUser.QualifyingRolesInThisOrg.push("ADMIN"),alert("This user is an owner, so adding the ADMIN role to RolesData.RequestingUser.QualifyingRolesInThisOrg: ADMIN"))),s.Steps.Step[v].Assign)if(s.Steps.Step[v].Assign&&s.Steps.Step[v].Assign.length)for(l=0;l<s.Steps.Step[v].Assign.length;l++)y=s.Steps.Step[v].Assign[l]["@Role"],c.WorkflowStep.AllRolesInThisWorkflowStep.push(y),c.RequestingUser.QualifyingRolesInThisOrg.indexOf(y)>-1&&(c.RequestingUser.AssignedRolesForThisWorkflowStep.includes(y)||(c.RequestingUser.AssignedRolesForThisWorkflowStep.push(y),console.log("xcx1234123-3 PUSHED INTO RolesData.RequestingUser.AssignedRolesForThisWorkflowStep: "+y)));else y=s.Steps.Step[v].Assign["@Role"],c.WorkflowStep.AllRolesInThisWorkflowStep.push(y),c.RequestingUser.QualifyingRolesInThisOrg.indexOf(y)>-1&&(c.RequestingUser.AssignedRolesForThisWorkflowStep.includes(y)||c.RequestingUser.AssignedRolesForThisWorkflowStep.push(y));else s.Steps.Step[v].Inform?(y=s.Steps.Step[v].Inform["@Role"],c.WorkflowStep.AllRolesInThisWorkflowStep.push(y),c.RequestingUser.QualifyingRolesInThisOrg.indexOf(y)>-1&&(c.RequestingUser.AssignedRolesForThisWorkflowStep.includes(y)||(c.RequestingUser.AssignedRolesForThisWorkflowStep.push(y),console.log("xcx1234123-1 This user has the assignment for this role in the workflow step. Adding it to RolesData.RequestingUser.AssignedRolesForThisWorkflowStep: "+y)))):alert("NOT INFORM ROLE xcx346754234");for(d=[],l=0;l<c.WorkflowStep.BwWorkflowTask_Table.length;l++)d.push(c.WorkflowStep.BwWorkflowTask_Table[l].bwAssignedToRaciRoleAbbreviation);if(d.length!=0){for(et=[],l=0;l<c.WorkflowStep.AllRolesInThisWorkflowStep.length;l++)d.indexOf(c.WorkflowStep.AllRolesInThisWorkflowStep[l])>-1||(console.log("AUDIT Error in bwRequest.js.displayRequestForm(). missingFrom_BwWorkflowTask_Table: "+c.WorkflowStep.AllRolesInThisWorkflowStep[l]+". BwWorkflowTask_Table: "+JSON.stringify(d)+", result.Tasks: "+JSON.stringify(t.Tasks)),displayAlertDialog("AUDIT Error in bwRequest.js.displayRequestForm(). missingFrom_BwWorkflowTask_Table: "+c.WorkflowStep.AllRolesInThisWorkflowStep[l]+". BwWorkflowTask_Table: "+JSON.stringify(d)),et.push(c.WorkflowStep.AllRolesInThisWorkflowStep[l]));for(ot=[],l=0;l<d.length;l++)c.WorkflowStep.AllRolesInThisWorkflowStep.indexOf(d[l])>-1||ot.push(d[l]);console.log("AUDIT Note: Comparing workflowTasks with existingTasks to make sure all tasks have been created, and also that there aren't too many existing tasks. Any errors will be list immediately below this line in the console. BwWorkflowTask_Table: "+JSON.stringify(d)+", RolesData.WorkflowStep.AllRolesInThisWorkflowStep: "+JSON.stringify(c.WorkflowStep.AllRolesInThisWorkflowStep)+", missingFrom_BwWorkflowTask_Table: "+JSON.stringify(et)+", superfluousIn_BwWorkflowTask_Table: "+JSON.stringify(ot));(et.length>0||ot.length>0)&&(tt="AUDIT Error in bwRequest.js.displayRequestForm(): Unexpected tasks for Request "+n.bwBudgetRequestId+". missingFrom_BwWorkflowTask_Table: "+et+", superfluousIn_BwWorkflowTask_Table: "+ot,console.log(tt),displayAlertDialog(tt))}if(console.log("xcx1231234234 RolesData.WorkflowStep.AllRolesInThisWorkflowStep: "+JSON.stringify(c.WorkflowStep.AllRolesInThisWorkflowStep)),c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(l=0;l<c.WorkflowStep.AllRolesInThisWorkflowStep.length;l++)c.RequestingUser.AssignedRolesForThisWorkflowStep.indexOf(c.WorkflowStep.AllRolesInThisWorkflowStep[l])>-1||c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.push(c.WorkflowStep.AllRolesInThisWorkflowStep[l]);for(w=0;w<c.WorkflowStep.BwWorkflowTask_Table.length;w++){for(rt=0;rt<c.RequestingUser.AssignedRolesForThisWorkflowStep.length;rt++)if(c.WorkflowStep.BwWorkflowTask_Table[w].bwAssignedToRaciRoleAbbreviation==c.RequestingUser.AssignedRolesForThisWorkflowStep[rt]){c.WorkflowStep.BwWorkflowTask_Table[w].bwStatus=="Completed"&&c.WorkflowStep.BwWorkflowTask_Table[w].bwPercentComplete==100?c.RequestingUser.AssignedRolesForThisWorkflowStep.splice(rt,1):c.RequestingUser.AssignedRolesForThisWorkflowStep[rt]={Role:c.WorkflowStep.BwWorkflowTask_Table[w].bwAssignedToRaciRoleAbbreviation,RoleName:null,bwWorkflowTaskItemId:c.WorkflowStep.BwWorkflowTask_Table[w].bwWorkflowTaskItemId};break}if(c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(l=0;l<c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length;l++)if(c.WorkflowStep.BwWorkflowTask_Table[w].bwAssignedToRaciRoleAbbreviation==c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l]){c.WorkflowStep.BwWorkflowTask_Table[w].bwStatus=="Completed"?c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.splice(l,1):c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l]={Role:c.WorkflowStep.BwWorkflowTask_Table[w].bwAssignedToRaciRoleAbbreviation,RoleName:null,bwWorkflowTaskItemId:c.WorkflowStep.BwWorkflowTask_Table[w].bwWorkflowTaskItemId};break}}if(f&&f!="undefined"){for(l=0;l<c.RequestingUser.AssignedRolesForThisWorkflowStep.length;l++)if(f==c.RequestingUser.AssignedRolesForThisWorkflowStep[l].Role){c.WorkflowStep.AssignedRole={Role:c.RequestingUser.AssignedRolesForThisWorkflowStep[l].Role,RoleName:null,OnBehalfOf:!1,bwWorkflowTaskItemId:c.RequestingUser.AssignedRolesForThisWorkflowStep[l].bwWorkflowTaskItemId};c.WorkflowStep.Assign=s.Steps.Step[v].Assign;console.log("xcx23423-1 found matching role. Set RolesData.WorkflowStep.AssignedRole.Role: "+c.WorkflowStep.AssignedRole.Role+".");break}if(!c.WorkflowStep.AssignedRole.Role&&c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(l=0;l<c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length;l++)if(f==c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l].Role){c.WorkflowStep.AssignedRole={Role:c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l].Role,RoleName:null,OnBehalfOf:!0,bwWorkflowTaskItemId:c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l].bwWorkflowTaskItemId};c.WorkflowStep.Assign=s.Steps.Step[v].Assign;console.log("xcx23423-2 found matching role. Set RolesData.WorkflowStep.AssignedRole: "+c.WorkflowStep.AssignedRole.Role+".");break}}else c.RequestingUser.AssignedRolesForThisWorkflowStep&&c.RequestingUser.AssignedRolesForThisWorkflowStep.length&&c.RequestingUser.AssignedRolesForThisWorkflowStep.length>0&&(c.WorkflowStep.AssignedRole={Role:c.RequestingUser.AssignedRolesForThisWorkflowStep[0].Role,RoleName:null,OnBehalfOf:!1,bwWorkflowTaskItemId:c.RequestingUser.AssignedRolesForThisWorkflowStep[0].bwWorkflowTaskItemId},c.WorkflowStep.Assign=s.Steps.Step[v].Assign,console.log("xcx23423-3 found role. Set RolesData.WorkflowStep.AssignedRole: "+c.WorkflowStep.AssignedRole.Role)),c.WorkflowStep.AssignedRole.Role||c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")&&c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep&&c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length&&c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length>0&&(console.log("xcx123123 pick the first one..."),c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[0]?(ct=c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[0].Role,lt=c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[0].bwWorkflowTaskItemId):(ct="ADMIN",lt=""),c.WorkflowStep.AssignedRole={Role:ct,RoleName:null,OnBehalfOf:!0,bwWorkflowTaskItemId:lt},c.WorkflowStep.Assign=s.Steps.Step[v].Assign,console.log("xcx23423-2 found matching role. Set RolesData.WorkflowStep.AssignedRole: "+c.WorkflowStep.AssignedRole.Role));if(c.WorkflowStep.AssignedRole.Role){if($("#"+i).find("#budgetrequestform")[0].setAttribute("bwworkflowtaskitemid",c.WorkflowStep.AssignedRole.bwWorkflowTaskItemId),s.Steps.Step[v].Assign&&s.Steps.Step[v].Assign.length)for(g=0;g<s.Steps.Step[v].Assign.length;g++){for(c.WorkflowStep.AssignedRole.Role==s.Steps.Step[v].Assign[g]["@Role"]&&(c.WorkflowStep.Assign=s.Steps.Step[v].Assign[g],c.WorkflowStep.AssignedRole.RoleName=c.WorkflowStep.Assign["@RoleName"]),l=0;l<c.RequestingUser.AssignedRolesForThisWorkflowStep.length;l++)if(c.RequestingUser.AssignedRolesForThisWorkflowStep[l].Role==s.Steps.Step[v].Assign[g]["@Role"]){c.RequestingUser.AssignedRolesForThisWorkflowStep[l].RoleName=s.Steps.Step[v].Assign[g]["@RoleName"];break}if(c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(l=0;l<c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length;l++)if(c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l].Role==s.Steps.Step[v].Assign[g]["@Role"]){c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l].RoleName=s.Steps.Step[v].Assign[g]["@RoleName"];break}}}else console.log("No roles have been asigned to this user."),p=c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?"No roles have been asigned to this user, but as an ADMIN you can edit this request.":"No roles have been asigned to this user. xcx23234.",$("#"+i).find("#budgetrequestform").find("#spanRequestForm_Instructions").html(p);pt={RequestingUser:c.RequestingUser,WorkflowAdmin:c.WorkflowAdmin,WorkflowStep:{AssignedRole:c.WorkflowStep.AssignedRole,AllRolesInThisWorkflowStep:c.WorkflowStep.AllRolesInThisWorkflowStep}};console.log("xcx3243 RolesData: "+JSON.stringify(pt));c.WorkflowStep.Assign?(c.WorkflowStep.Assign||alert("xcx112233 NO VALUE FOR RolesData.WorkflowStep.Assign HERE..??????"),k=c.WorkflowStep.Assign["@AllowRequestModifications"],console.log(""),console.log("%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%"),console.log("The user plays a role in the workflow. allowRequestModifications: "+k+", RolesData.WorkflowStep.Assign: "+JSON.stringify(c.WorkflowStep.Assign)),console.log("%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%"),console.log(""),at=c.WorkflowStep.Assign["@Role"],wt=c.WorkflowStep.Assign["@RoleName"],$.ajax({url:o.options.operationUriPrefix+"_bw/UserRole2/"+u+"/"+at,dataType:"json",contentType:"application/json",type:"Get",success:function(t){var u,w,ut,a,kt,lt,dt,ft,et,g,ot,d,rt,p,vt,h,l,st,tt,ht,y,r,ct,gt;try{var yt="",pt="",bt="";t.length>0&&(yt=t[0].bwParticipantId,pt=t[0].bwParticipantEmail,bt=t[0].bwParticipantFriendlyName);var ni={roleMember_participantId:yt,roleMember_participantEmail:pt,roleMember_participantFriendlyName:bt},ti=s.Steps.Step[v]["@Name"],ut=s.Steps.Step[v]["@FriendlyName"];if(k&&k!="undefined"||(k=!1),u="",w="",ut=s.Steps.Step[v]["@FriendlyName"]?s.Steps.Step[v]["@FriendlyName"]:s.Steps.Step[v]["@Name"],w+='<span style="font-weight:bold;">',w+='   <span xcx="342352-1-yy" style="cursor:pointer !important;text-decoration:underline;" title="View RACI workflow history..." onclick="$(\'.bwRequest\').bwRequest(\'displayRequestWorkflowAuditTrailDialog\', \''+n.Title+"', '"+String(n.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.bwRequestTypeId+"', '"+n.bwBudgetRequestId+"', '"+n.bwWorkflowId+"');\">",w+="       Workflow step: "+ut,w+="   <\/span>",w+="<\/span>",w+="<br />",a="",e.RequestingUser.RoleIds.includes("ADMIN")||f){for(console.log("Role drop-down. THIS IS THE ONLY SPOT THIS SHOULD BE RENDERED. 10-7-2022"),a+="<select xcx=\"34234-1\" id=\"selectedRaciRole\" onchange=\"$('.bwRequest').bwRequest('selectedRaciRole_OnChange', this);\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 15pt;text-align: left;\" >",r=0;r<c.RequestingUser.AssignedRolesForThisWorkflowStep.length;r++)c.WorkflowStep.AssignedRole.Role==c.RequestingUser.AssignedRolesForThisWorkflowStep[r].Role?(c.RequestingUser.AssignedRolesForThisWorkflowStep[r].RoleName&&c.RequestingUser.AssignedRolesForThisWorkflowStep[r].Role||(c.RequestingUser.AssignedRolesForThisWorkflowStep[r].Role?c.RequestingUser.AssignedRolesForThisWorkflowStep[r].RoleName||(c.RequestingUser.AssignedRolesForThisWorkflowStep[r].Role=="ADMIN"?c.RequestingUser.AssignedRolesForThisWorkflowStep[r].RoleName="Workflow Administrator":alert("In xcx32536(). No RoleName value for Role: "+c.RequestingUser.AssignedRolesForThisWorkflowStep[r].Role)):alert("xcx1214-1 INVALID VALUE(S) FOR Role and/or RoleName while creating the role drop-down.")),a+='<option xcx="34234-1-1" style="font-size:30pt;" selected value="'+c.RequestingUser.AssignedRolesForThisWorkflowStep[r].Role+'" bwworkflowtaskitemid="'+c.RequestingUser.AssignedRolesForThisWorkflowStep[r].bwWorkflowTaskItemId+'"  xcx="xcx554-4">',a+=c.RequestingUser.AssignedRolesForThisWorkflowStep[r].RoleName+" ("+c.RequestingUser.AssignedRolesForThisWorkflowStep[r].Role+")",a+="<\/option>"):(kt="xcx2312 i: "+r+", RoleName/Role: "+c.RequestingUser.AssignedRolesForThisWorkflowStep[r].RoleName+" ("+c.RequestingUser.AssignedRolesForThisWorkflowStep[r].Role+")",console.log(kt),a+='<option xcx="34234-1-2" style="font-size:30pt;" value="'+c.RequestingUser.AssignedRolesForThisWorkflowStep[r].Role+'" bwworkflowtaskitemid="'+c.RequestingUser.AssignedRolesForThisWorkflowStep[r].bwWorkflowTaskItemId+'"  xcx="xcx554-4">',a+=c.RequestingUser.AssignedRolesForThisWorkflowStep[r].RoleName+" ("+c.RequestingUser.AssignedRolesForThisWorkflowStep[r].Role+")",a+="<\/option>",c.RequestingUser.AssignedRolesForThisWorkflowStep[r].RoleName&&c.RequestingUser.AssignedRolesForThisWorkflowStep[r].Role||alert("xcx1214-2 INVALID VALUES FOR Role and/or RoleName while creating the role drop-down."));if(c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(r=0;r<c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length;r++)c.WorkflowStep.AssignedRole.Role==c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].Role?(a+='<option xcx="34234-1-3" style="font-size:30pt;" selected value="'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].Role+'" bwworkflowtaskitemid="'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].bwWorkflowTaskItemId+'"  xcx="xcx554-7">',a+='On behalf of "'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].RoleName+" ("+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].Role+')"',a+="<\/option>",c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].RoleName&&c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].Role||alert("xcx1214-3 INVALID VALUES FOR Role and/or RoleName while creating the role drop-down.")):(a+='<option xcx="34234-1-4" style="font-size:30pt;" value="'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].Role+'" bwworkflowtaskitemid="'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].bwWorkflowTaskItemId+'"  xcx="xcx554-7">',a+='On behalf of "'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].RoleName+" ("+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].Role+')"',a+="<\/option>",c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].RoleName&&c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[r].Role||alert("xcx1214-4 INVALID VALUES FOR Role and/or RoleName while creating the role drop-down."));a+="<\/select>";k==!0?(u+='<table style="float:right;width:85%;">',u+="   <tr>",u+='       <td style="text-align:left;font-weight:normal;">',u+=w,u+="       <\/td>",u+="   <\/tr>",u+="   <tr>",u+='       <td style="text-align:left;font-weight:normal;">',u+="           Your role as "+c.WorkflowStep.Assign["@RoleCategory"]+": "+c.WorkflowStep.Assign["@Role"],u+='<div style="float:right">'+a+"<\/div>",u+="       <\/td>",u+="   <\/tr>",u+="   <tr>",u+="       <td>",u+="           You are allowed to modify this request.",u+="       <\/td>",u+="   <\/tr>",u+="<\/table>"):(u+='<table style="float:right;width:85%;">',u+="   <tr>",u+='       <td style="text-align:left;font-weight:normal;">',u+=w,u+="       <\/td>",u+="   <\/tr>",u+="   <tr>",u+='       <td style="text-align:left;font-weight:normal;">',u+="           Your role as "+c.WorkflowStep.Assign["@RoleCategory"]+": "+c.WorkflowStep.Assign["@Role"],u+='<div style="float:right">'+a+"<\/div>",u+="       <\/td>",u+="   <\/tr>",u+="   <tr>",u+="       <td>",u+="           You are not allowed to modify this request, but you can add comments.",u+="       <\/td>",u+="   <\/tr>",u+="<\/table>")}else a+="This user does not belong to a role present in this workflow step";if(u+="<br />",$("#"+i).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML=u,console.log(">>>>>>>>>>>>>>>>> The role drop-down has been displayed."),lt=$("#"+i).find("#selectedRaciRole")[0],dt=$(lt).find("option:selected").val(),dt?(ft=$(lt).find("option:selected").attr("bwworkflowtaskitemid"),et=$("#"+i).find("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid"),ft&&et&&ft==et||displayAlertDialog("Unrecoverable error. Invalid values for bwWorkflowTaskItemId, either in the drop-down or in the form. selected_indropdown_bwWorkflowTaskItemId: "+ft+", form_bwWorkflowTaskItemId: "+et+", request title: xcx21312, workflow step: "+ut+", bwBudgetRequest.bwRequestJson: "+JSON.stringify(n.bwRequestJson))):(alert("xcx12312-1 Error: The role drop-down does not have a selected value. This process cannot continue."),displayAlertDialog("Error: The role drop-down does not have a selected value. This process cannot continue.")),$("#"+i).find("#spanRequestForm_Error")[0].innerHTML="",$("#"+i).find("#spanRequestForm_Checklists")[0].innerHTML="",c.WorkflowStep.Assign["@Checklists"]){for(g=c.WorkflowStep.Assign["@Checklists"],console.log("xcx31241 This workflow assignment has checklists. WorkflowStep_Assign_Checklists: "+JSON.stringify(g)),ot=JSON.parse(n.bwRequestJson).Checklists,d=[],r=0;r<g.length;r++)if(ot)for(l=0;l<ot.length;l++)if(rt=JSON.parse(ot[l]),rt.bwChecklistTemplatesId==g[r].bwChecklistTemplatesId){tt={bwChecklistTemplatesId:rt.bwChecklistTemplatesId,html:"<span style=\"cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialogReadOnly', '"+rt.bwChecklistTemplatesId+"', '"+n.ProjectTitle+"', '"+n.Title+"', '"+n.bwRequestType+"', '"+n.bwBudgetRequestId+"', '"+n.bwWorkflowId+"', '"+b+"');\">"+rt.Title+"<\/span>"};d.push(tt);break}for(p=[],r=0;r<g.length;r++){for(vt=!1,l=0;l<d.length;l++)if(g[r].bwChecklistTemplatesId==d[l].bwChecklistTemplatesId){vt=!0;break}if(vt!=!0)for(l=0;l<e.OrganizationChecklists.length;l++)g[r].bwChecklistTemplatesId==e.OrganizationChecklists[l].bwChecklistTemplatesId&&(st=JSON.parse(e.OrganizationChecklists[l].ChecklistJson).Title,tt={bwChecklistTemplatesId:e.OrganizationChecklists[l].bwChecklistTemplatesId,html:"<span style=\"cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialog', '"+e.OrganizationChecklists[l].bwChecklistTemplatesId+"', '"+String(n.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.Title+"', '"+n.bwRequestType+"', '"+n.bwBudgetRequestId+"', '"+n.bwWorkflowId+"', '"+b+"');\">"+st+"<\/span>"},p.push(tt))}if(h="",h+="<div>",o.options.Checklists=e.OrganizationChecklists,e.Checklists.length>0){for(h+=e.Checklists.length==1?"Checklist to be completed for this request: ":"Checklists to be completed for this request: ",h+="<ul>",alert("xcx213421 brData.Checklists: "+JSON.stringify(e.Checklists)),r=0;r<e.Checklists.length;r++)for(l=0;l<e.OrganizationChecklists.length;l++)e.Checklists[r].bwChecklistTemplatesId==e.OrganizationChecklists[l].bwChecklistTemplatesId&&(st=JSON.parse(e.OrganizationChecklists[l].ChecklistJson).Title,tt={bwChecklistTemplatesId:e.Checklists[r].bwChecklistTemplatesId,html:"<li style=\"cursor:pointer;text-decoration:underline;text-align:left;\" onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialog', '"+e.Checklists[r].bwChecklistTemplatesId+"', '"+String(n.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.Title+"', '"+n.bwRequestType+"', '"+n.bwBudgetRequestId+"', '"+n.bwWorkflowId+"', '"+b+"');\">"+st+"<\/li>"},h+=tt.html,o.options.Checklists.push(e.Checklists[r]));h+="<\/ul>";h+="<\/div>"}if(d.length>0||p.length>0||p.length>0){if(h+="<div>",d.length>0)for(h+=d.length==1?"Completed checklist: ":"Completed checklists: ",r=0;r<d.length;r++)h+="<span xcx=\"xcx99205476\" style=\"white-space:nowrap;text-decoration:underline;\" onclick=\"$('.bwRequest').bwRequest('RequestARevisionToThisChecklist', 'false', '');\" title=\"The Checklist has been updated. Do you wish to request a revision before this step is completed? and still in this step!\">",h+="&nbsp;"+d[r].html,h+="<\/span>",h+="<br />";if(p.length>0){for(h+='<img width="11" height="11" style="cursor:pointer;vertical-align:top;" alt="" src="/images/red-dot.png">',h+="&nbsp;",h+=p.length==1?"Complete the following checklist before you Approve: ":"Complete the following checklist(s) before you Approve: ",h+="<ul>",r=0;r<p.length;r++)h+='<li style="cursor:pointer;text-decoration:underline;text-align:left;" >'+p[r].html+"<\/li>";h+="<\/ul>";h+="<br />"}h+="<\/div>"}$("#"+i).find("#spanRequestForm_Checklists")[0].innerHTML=h}if(o.renderRequestFormButtons(i,n.bwBudgetRequestId,n.bwRequestTypeId,"","xcx445566-7",!1,c.WorkflowStep.Assign,c.RequestingUser,ni,at,wt,ti,ut,k,p),$("#"+i).find("#spanRequestForm_Instructions")[0].innerHTML="",u="",c.WorkflowStep.Assign&&c.WorkflowStep.Assign["@Instructions"]?(u+=c.WorkflowStep.Assign["@Instructions"],console.log("WORKFLOW HAD VALID INSTRUCTIONS.xcx2231-1")):console.log("In bwRequest.js.xx(). COULDNOTLOCATEVALIDINSTTRUCTIONS.xcx2232-1"),p&&p.length>0&&(u+="Complete the required checklists before approving this request.",u+="<br />"),u&&u!="undefined"&&(console.log(""),console.log("**********"),console.log("In bwRequest.js.renderRequestForm(). Displaying instructions from the workflow JSON in the request form header. instructions: "+u),console.log("**********"),console.log(""),$("#"+i).find("#spanRequestForm_Instructions")[0].innerHTML=u,console.log("The instructions have been displayed.")),nt.closeoutsEnabled==!0&&(ht="",ht+="<br />",ht+="<span style=\"text-decoration:underline;cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displayCloseoutInDialog', '"+n.bwBudgetRequestId+"', '"+n.bwRequestTypeId+"', '"+n.Title+'\');" xcx="xcx2134213-1" >View closeout.<\/span>',$("#"+i).find("#spanRequestForm_Instructions")[0].innerHTML+=ht),y="",n.IsSupplementalRequest&&n.IsSupplementalRequest==!0&&(y+="<br /><br />",y+="THIS IS A SUPPLEMENTAL TO REQUEST ["+n.RelatedBudgetRequestId+"]",y+="<br />"),nt.supplementalsEnabled==!0){if(y+="<br /><br />",y+=`<div allow="clipboard-read;clipboard-write;" contenteditable="true" class="FormCreateASupplementalRequestButton_Dropzone" style="height:100%;border:1px solid goldenrod;background-color:#f6f6f6;color:gray;font-size:10pt;padding:5px 15px 5px 15px;float:right;color:goldenrod;">Drag-and-drop to add Supplementals here.</div>`,y+="<br /><br />",e&&e.SupplementalRequests&&e.SupplementalRequests.length&&e.SupplementalRequests.length>0)for(r=0;r<e.SupplementalRequests.length;r++)y+="<div>",y+='   <span style="text-decoration:underline;cursor:pointer;" ',y+="onmouseenter=\"$('.bwCoreComponent').bwCoreComponent('showRowHoverDetails', '"+encodeURIComponent(JSON.stringify(e.SupplementalRequests[r]))+"', '', this);\" ",y+="onmouseleave=\"$('.bwCoreComponent').bwCoreComponent('hideRowHoverDetails');\" ",y+=" onclick=\"$('.bwRequest').bwRequest('displayArInDialog','https://budgetworkflow.com', '"+e.SupplementalRequests[r].bwBudgetRequestId+"', '"+e.SupplementalRequests[r].Title+"', 'Test 1', '"+e.SupplementalRequests[r].Title+"');\" >",y+=e.SupplementalRequests[r].Title+' "'+e.SupplementalRequests[r].ProjectTitle.substring(0,15)+'"...<\/span>',y+="<img src=\"/images/trashbin.png\" style=\"height:20px;cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('removeSupplementalFromARequest', '"+e.SupplementalRequests[r].bwBudgetRequestId+"', '"+n.bwBudgetRequestId+"');\">",y+="<\/div>";$("#"+i).find("#spanRequestForm_Instructions")[0].innerHTML+=y;ct=$("#"+i).find(".FormCreateASupplementalRequestButton_Dropzone")[0];ct.addEventListener("dragenter",function(n){try{console.log("In bwRequest.js.renderRequestForm.dropzone.dragenter().");n.preventDefault()}catch(n){var t="Exception in bwRequest.js.renderRequestForm.dropzone.dragenter(): "+n.message+", "+n.stack;console.log(t);alert(t)}});ct.addEventListener("dragover",function(n){try{console.log("In bwRequest.js.renderRequestForm.dropzone.dragover().");n.preventDefault()}catch(n){var t="Exception in bwRequest.js.renderRequestForm.dropzone.drop(): "+n.message+", "+n.stack;console.log(t);alert(t)}});ct.addEventListener("drop",function(n){var r,i,u;try{if(console.log("In bwRequest.js.renderRequestForm.dropzone.drop()."),displayAlertDialog_Persistent("In bwRequest.js.renderRequestForm.dropzone.drop()."),n.preventDefault(),n.clipboardData?(console.log("In bwRequest.js.renderRequestForm.dropzone.drop(). Object is event.clipboardData."),r=!0):n.dataTransfer?(console.log("In bwRequest.js.renderRequestForm.dropzone.drop(). Object is event.dataTransfer."),r=!0):window.clipboardData?(console.log("In bwRequest.js.renderRequestForm.dropzone.drop(). Object is window.clipboardData."),r=!0):navigator.userAgent.toLowerCase().indexOf("firefox")>-1?alert('FIREFOX BROWSER CANNOT DRAG-AND-DROP EXTERNAL FILES. THERE IS A WORK-AROUND: Please right click on your source file, and choose "COPY". Subsequently, right click here and choose "PASTE".'):alert("Error in bwRequest.js.renderRequestForm.dropzone.drop(). Could not find a valid DataTransfer object. e: "+JSON.stringify(n)+", navigator.userAgent: "+navigator.userAgent),r==!0){var f=n.dataTransfer.getData("text/plain"),e=$(n.target).closest(".budgetrequestform").attr("bwbudgetrequestid"),t="";t+='<table style="width:100%;">';t+="   <tr>";t+='       <td style="width:90%;">';t+="           <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size:30pt;font-weight:bold;\">Add Supplemental/Addendum Request<\/span>";t+="           <br />";t+="       <\/td>";t+='       <td style="width:9%;"><\/td>';t+='       <td style="width:1%;cursor:pointer;vertical-align:top;">';t+='           <span class="dialogXButton" style="font-size:30pt;font-weight:bold;" onclick="$(\'#bwRequest_AddSupplementalToRequestDialog\').dialog(\'close\');">X<\/span>';t+="       <\/td>";t+="   <\/tr>";t+="<\/table>";t+='<input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';t+="<table>";t+="   <tr>";t+="       <td><\/td>";t+='       <td style="text-align:left;">';t+='           <span id="spanThereAreChangesToPublishText51" style="font-style:italic;color:black;font-size:20pt;">';t+="Confirm that you want to add the supplemental/addendum:";t+="           <\/span>";t+="       <\/td>";t+="       <td><\/td>";t+="   <\/tr>";t+="<\/table>";t+="<br />";t+="<div id=\"bwRequest_PermanentlyDeleteRequestDialog_PermanentlyDeleteRequestxxx\" class=\"divDialogButton\" onclick=\"$('.bwRequest').bwRequest('addSupplementalToRequest', '"+f+"', '"+e+"');\" >";t+="Add Supplemental";t+="<\/div>";t+="<br />";t+="<div class=\"divDialogButton\" onclick=\"$('#bwRequest_AddSupplementalToRequestDialog').dialog('close');\">";t+="Close/Cancel";t+="<\/div>";t+="<br /><br />";i=document.getElementById("bwRequest_AddSupplementalToRequestDialog");i||(i=document.createElement("div"),i.id="bwRequest_AddSupplementalToRequestDialog",i.style.display="none",document.body.appendChild(i));i.innerHTML=t;$("#bwRequest_AddSupplementalToRequestDialog").dialog({modal:!1,resizable:!1,closeOnEscape:!1,position:{my:"middle top+12",at:"middle top","of":window},width:"1200",dialogClass:"no-close",hide:!1,open:function(){try{}catch(n){console.log("Exception in xx.bwRequest_AddSupplementalToRequestDialog.open(): "+n.message+", "+n.stack);displayAlertDialog("Exception in xx.bwRequest_AddSupplementalToRequestDialog.open(): "+n.message+", "+n.stack)}},close:function(){$("#bwRequest_AddSupplementalToRequestDialog").dialog("destroy")}})}else alert("Error in bwRequest.js.renderRequestForm.dropzone.drop(). Could not find a valid DataTransfer object.")}catch(n){u="Exception in bwRequest.js.renderRequestForm.dropzone.drop(): "+n.message+", "+n.stack;console.log(u);alert(u)}})}console.log("Calling populateRequestForm(). xcx3452-2-2 bwBudgetRequest.bwRequestJson: "+JSON.stringify(n.bwRequestJson));gt=o.populateRequestForm(i,n.bwRequestJson,k);gt.then(function(){var r,f,e;try{if(r=document.getElementById("myCanvas"),r){var t=document.getElementsByTagName("body")[0],o=t.scrollWidth,s=Math.max(t.scrollHeight,document.documentElement.scrollHeight,t.offsetHeight,document.documentElement.offsetHeight,t.clientHeight,document.documentElement.clientHeight,t.scrollHeight,t.getBoundingClientRect().height);r.width=o;r.height=s}f=$("#"+i).dialog().closest(".ui-dialog").offset();f.left<0&&(console.log("THE AR DIALOG has been displayed too far to the left. xcxRepositioning here...xcx23214-2 left: "+f.left),$("#"+i).dialog({position:{my:"center top",at:"center top","of":window}}));try{window.opener&&(e="divRequestFormDialog_"+n.bwBudgetRequestId,console.log("xcx999334-2 Should be closing dialog window.opener.dialogId: "+e),window.opener.$("#"+e).dialog("close"))}catch(u){}}catch(u){console.log("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-4: "+u.message+", "+u.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-4: "+u.message+", "+u.stack)}})}catch(it){console.log("Exception in bwRequest.js.renderRequestForm.UserRole2.done(): "+it.message+", "+it.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.UserRole2.done(): "+it.message+", "+it.stack);alert("Exception in bwRequest.js.renderRequestForm.UserRole2.done(): "+it.message+", "+it.stack)}},error:function(n){var t;t=JSON.stringify(n).indexOf("The specified URL cannot be found.")>-1?"There has been an error contacting the server. A firewall or network appliance may be interrupting this traffic.":JSON.stringify(n);displayAlertDialog("Error in bwRequest.js.renderRequestForm.UserRole2.fail():1: "+t);console.log("Error in bwRequest.js.renderRequestForm.UserRole2.fail():1: "+JSON.stringify(n));alert("Error in bwRequest.js.renderRequestForm.UserRole2.fail():1: "+t)}})):(it=o.populateRequestForm(i,n.bwRequestJson,k),it.then(function(){var f,a,t,p,e,r,h,y;try{if(f=document.getElementById("myCanvas"),f){var u=document.getElementsByTagName("body")[0],w=u.scrollWidth,k=Math.max(u.scrollHeight,document.documentElement.scrollHeight,u.offsetHeight,document.documentElement.offsetHeight,u.clientHeight,document.documentElement.clientHeight,u.scrollHeight,u.getBoundingClientRect().height);f.width=w;f.height=k}if(a="",a+='<button xcx="xcx4242-2" onclick="$(\'#'+i+'\').dialog(\'close\');" class="BwButton200ForRequestForm" title="Close">Close<\/button>&nbsp;',o.renderRequestFormButtons(i,n.bwBudgetRequestId,n.bwRequestTypeId,a,"xcx445566-6-1",!1,c.WorkflowStep.Assign),t="",p=s.Steps.Step[v]["@FriendlyName"]?s.Steps.Step[v]["@FriendlyName"]:s.Steps.Step[v]["@Name"],t+='<span style="font-weight:bold;">',t+='   <span xcx="342352-1-2" style="cursor:pointer !important;text-decoration:underline;" title="View RACI workflow history..." onclick="$(\'.bwRequest\').bwRequest(\'displayRequestWorkflowAuditTrailDialog\', \''+n.Title+"', '"+String(n.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.bwRequestTypeId+"', '"+n.bwBudgetRequestId+"', '"+n.bwWorkflowId+"');\">",t+="       Workflow step: "+p,t+="   <\/span>",t+="<\/span>",t+="<br />",$("#"+i).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML=t,console.log("xcx987070-1 Display the checklists here... 10-25-2022"),e=JSON.parse(n.bwRequestJson).Checklists,e){for(r="",r+="Completed checklist(s):",r+="<br />",h=0;h<e.length;h++)y=JSON.parse(e[h]),r+='<span xcx="xcx8822567" style="cursor:pointer;text-decoration:underline;" ',r+="onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialogReadOnly', '"+y.bwChecklistTemplatesId+"', '"+n.ProjectTitle+"', '"+n.Title+"', '"+n.bwRequestType+"', '"+n.bwBudgetRequestId+"', '"+n.bwWorkflowId+"', '"+b+"');\">"+y.Title+"<\/span>",r+="<br />";$("#"+i).find("#spanRequestForm_Checklists")[0].innerHTML=r}else $("#"+i).find("#spanRequestForm_Checklists")[0].innerHTML=""}catch(l){console.log("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-3: "+l.message+", "+l.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-3: "+l.message+", "+l.stack)}}))}bt={bwTenantId:tenantId,bwWorkflowAppId:u,bwParticipantId:r,bwParticipantEmail:participantEmail,bwParticipantFriendlyName:participantFriendlyName,bwEnabledRequestTypes:ft,bwOrgId:b,bwOrgName:ut};kt=$("#"+i).find("#divBwLocationPicker").bwLocationPicker(bt)}}catch(st){console.log("Exception in bwRequest.js.renderRequestForm():21-1:requestDialogId: "+i+", "+st.message+", "+st.stack);displayAlertDialog_Persistent("Exception in bwRequest.js.renderRequestForm():21-1:requestDialogId: "+i+", "+st.message+", "+st.stack)}})}}catch(l){console.log("Exception in bwRequest.js.renderRequestForm():265: "+l.message+", "+l.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm():265: "+l.message+", "+l.stack)}}})}else alert("Error in renderRequestForm(). Unexpected value(s) for bwBudgetRequest.bwWorkflowAppId: "+!n.bwWorkflowAppId+", bwBudgetRequest.bwBudgetRequestId: "+n.bwBudgetRequestId),displayAlertDialog("Error in renderRequestForm(). Unexpected value(s) for bwBudgetRequest.bwWorkflowAppId: "+!n.bwWorkflowAppId+", bwBudgetRequest.bwBudgetRequestId: "+n.bwBudgetRequestId)}catch(s){console.log("Exception in bwRequest.js.renderRequestForm(): "+s.message+", "+s.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm(): "+s.message+", "+s.stack)}},renderRequestForm_ForTrashBin:function(n,t,i,r,u,f,e){var o,h,c;try{o=this;console.log("In renderRequestForm_ForTrashBin(). brData: "+JSON.stringify(n));n.bwBudgetRequest.bwWorkflowAppId&&n.bwBudgetRequest.bwBudgetRequestId?n.bwBudgetRequest.BudgetWorkflowStatus=="NOT_SUBMITTED"?(console.log("In bwRequest.js.displayRequestForm(). THIS MUST BE A NEW REQUEST xcx3434 brData.BudgetWorkflowStatus: "+n.BudgetWorkflowStatus),h=o.getRequestFormHtml(n.bwBudgetRequest.bwRequestTypeId,null,n.ConfigurationModifiedDate_BwForm,"xcx23452-3"),h.then(function(t){var f,s,e,i,l;try{if(t.message!=null)console.log("Error: "+t.message),$("#"+r).find("#divRequestFormDialogContent")[0].innerHTML=t.message;else{$("#"+r).find("#divRequestFormDialogContent")[0].innerHTML=t.html;$("#"+r).find("#budgetrequestform")[0].setAttribute("bwrequesttypeid",n.bwBudgetRequest.bwRequestTypeId);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwfiscalyear",n.bwBudgetRequest.bwFiscalYear);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwbudgetrequestid",n.bwBudgetRequest.bwBudgetRequestId);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwrequesttitle",n.bwBudgetRequest.Title);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwworkflowstatus_bwworkflowstepname",n.bwBudgetRequest.BudgetWorkflowStatus);f=n.bwBudgetRequest.OrgId;s=n.bwBudgetRequest.OrgName;f||(console.log("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+f+", bwOrgName: "+s),alert("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+f+", bwOrgName: "+s));$("#"+r).find("#budgetrequestform")[0].setAttribute("bworgid",f);$("#"+r).find("#budgetrequestform")[0].setAttribute("bworgname",s);var a=n.bwBudgetRequest.FunctionalAreaId,v=n.bwBudgetRequest.ManagerId,y=n.bwBudgetRequest.ManagerFriendlyName,p=n.bwBudgetRequest.ARStatus,h,c=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems;for(e=0;e<c.length;e++)if(n.bwBudgetRequest.bwRequestTypeId==c[e].bwRequestTypeId){h=c[e];break}i="";i+="                   <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">";i+=h?"                       New "+h.SingletonName+": ":"                       requesttype_not_found bwRequestTypeId:"+n.bwBudgetRequest.bwRequestTypeId+" ";i+='&nbsp;<span xcx="xcx3567-1" id="spanNewRequestEllipsesButton" class="spanButton2 context-menu-newrequesteditor" style="height:20px;width:150px;"> ... <\/span>';i+="<\/span>";$("#"+r).find("#spanRequestForm_Title")&&$("#"+r).find("#spanRequestForm_Title")[0]&&($("#"+r).find("#spanRequestForm_Title")[0].innerHTML=i);$("#"+r).find("#spanViewWorkflowParticipantsLink")[0].innerHTML="";$("#"+r).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML="";$("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML="";$("#"+r).find("#spanRequestForm_Error")[0].innerHTML="";$("#"+r).find("#spanRequestForm_Instructions")[0].innerHTML='Complete the form then click the "Submit" button.';o.renderRequestFormButtons(r,n.bwBudgetRequest.bwBudgetRequestId,n.bwBudgetRequest.bwRequestTypeId,i,"xcx445566-1-2");console.log("Calling populateRequestForm(). xcx3452-2-1");l=o.populateRequestForm(r,n.bwBudgetRequest.bwRequestJson,!0);l.then(function(){var i,u,f,s;try{if(i=document.getElementById("myCanvas"),i){var t=document.getElementsByTagName("body")[0],h=t.scrollWidth,c=Math.max(t.scrollHeight,document.documentElement.scrollHeight,t.offsetHeight,document.documentElement.offsetHeight,t.clientHeight,document.documentElement.clientHeight,t.scrollHeight,t.getBoundingClientRect().height);i.width=h;i.height=c}u=document.getElementById(r).getBoundingClientRect().left;u<0&&(console.log("THE AR DIALOG has been displayed too far to the left. xcxRepositioning here...xcx23214-3 left: "+u),alert("THE AR DIALOG has been displayed too far to the left. xcxRepositioning here...xcx23214-3 left: "+u),$("#"+r).dialog({position:{my:"center top",at:"center top","of":window}}));window.opener&&(f="divRequestFormDialog_"+n.bwBudgetRequest.bwBudgetRequestId,alert("xcx999334-3 Should be closing dialog window.opener.dialogId: "+f),console.log("xcx999334-3 Should be closing dialog window.opener.dialogId: "+f),window.opener.$("#"+f).dialog("close"));s=$("#"+r).find("#spanNewRequestEllipsesButton")[0];$(s).on("click",function(n){n.preventDefault();n.stopImmediatePropagation();$(this).contextMenu()});console.log("Displaying elipses context menu for request without a workflow (new request).");$.contextMenu({selector:".context-menu-newrequesteditor",callback:function(n){var t=$(this).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),r=$(this).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid"),f="divRequestFormDialog_"+t,u,i;n=="requestjson"?t?o.viewScrapedBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjson). Invalid value for bwBudgetRequestId: "+t):n=="requestjsondignostics"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx445"):n=="requestjsondb"?t?o.viewDatabaseBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjsondb). Invalid value for bwBudgetRequestId: "+t):n=="viewbwbudgetrequestjson"?t?o.viewDatabaseBwRequestJson2(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewbwbudgetrequestjson). Invalid value for bwBudgetRequestId: "+t):n=="requesthtmldb"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx4471"):n=="viewworkflowjson"?o.viewWorkflowStepAndRoleJson(workflow.Steps.Step[stepIndex]):n=="changetherequesttype"?t?o.changeTheRequestTypeForARequest(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(changetherequesttype). Invalid value for bwBudgetRequestId: "+t):n=="updatedailyoverduetasknotificationdate"?r?o.displayUpdateDailyOverdueTaskNotificationDateDialog(r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(updatedailyoverduetasknotificationdate). Invalid value for bwWorkflowTaskItemId: "+r):n=="viewtaskjson"?r?o.viewTaskJsonInDialog(r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewtaskjson). Invalid value for bwWorkflowTaskItemId: "+r):n=="deletethisrequest"?t?o.cmdDisplayDeleteBudgetRequestDialog(t,"this New Request"):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(deletethisrequest). Invalid value for bwBudgetRequestId: "+t):n=="setreminder"&&(t?(u=$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders(),u&&u.length&&u.length==1?$(".bwOneTimeRequestReminders").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,"this New Request"):(i=document.getElementById("divBwOneTimeRequestReminders"),i&&i.remove(),i=document.createElement("div"),i.id="divBwOneTimeRequestReminders",i.style.display="none",document.body.appendChild(i),$(i).bwOneTimeRequestReminders({}),$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,"this New Request"))):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(setreminder). Invalid value for bwBudgetRequestId: "+t))},items:{requestjson:{name:"Request JSON",icon:"edit"},requestjsondb:{name:"Request JSON from Database",icon:"edit"},deletethisrequest:{name:"Delete this Request",icon:"edit"},setreminder:{name:"Set a One-Time Reminder",icon:"edit"}}})}catch(e){console.log("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-1: "+e.message+", "+e.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-1: "+e.message+", "+e.stack)}})}}catch(u){console.log("Exception in bwRequest.js.renderRequestForm():21-1-2: "+u.message+", "+u.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm():21-1-2: "+u.message+", "+u.stack);alert("Exception in bwRequest.js.renderRequestForm():21-1-2: "+u.message+", "+u.stack)}})):(c={bwParticipantId_LoggedIn:u,bwActiveStateIdentifier:t,bwWorkflowAppId_LoggedIn:f,bwWorkflowAppId:f,bwBudgetRequestId:i},console.log("In ??(). xcx12325-2. Calling /workflowconfiguration5()."),$.ajax({url:o.options.operationUriPrefix+"_bw/workflowconfiguration5",type:"POST",data:c,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){console.log("xcx23123-2 Error in bwRequest.js.displayRequestForm(): "+t+" "+i);displayAlertDialog("xcx23123-2 Error in bwRequest.js.displayRequestForm(): "+t+" "+i)},success:function(t){var s,l;try{if(t.status!="SUCCESS")console.log(t.message),displayAlertDialog(t.message);else{console.log("HERE WE GO! WE HAVE A GOOD WORKFLOW JSON. This is the only place we should be creating a header for a form!!!! 2-11-2022");var a=t.Workflow[0],i=JSON.parse(t.Workflow[0].bwWorkflowJson),c=[];for(s=0;s<t.Tasks.length;s++)t.Tasks[s].WorkflowStepName==n.bwBudgetRequest.BudgetWorkflowStatus?c.push(t.Tasks[s]):t.Tasks[s].bwStatus=="Completed"&&t.Tasks[s].bwPercentComplete==100?console.log('AUDIT Success in bwRequest.js.displayRequestForm(). This task was completed for request "'+n.bwBudgetRequest.Title+'" ['+n.bwBudgetRequest.bwBudgetRequestId+"]. bwWorkflowTaskItemId: ["+t.Tasks[s].bwWorkflowTaskItemId+"]"):(console.log("AUDIT Error in bwRequest.js.displayRequestForm(): An unfinished task exists for this request which does not match the current workflow step of: "+n.bwBudgetRequest.BudgetWorkflowStatus+". The mismatched step is "+t.Tasks[s].WorkflowStepName),displayAlertDialog("AUDIT Error in bwRequest.js.displayRequestForm(): An unfinished task exists for this request which does not match the current workflow step of: "+n.bwBudgetRequest.BudgetWorkflowStatus+". The mismatched step is "+t.Tasks[s].WorkflowStepName));console.log("In bwRequest.js.renderRequestForm(). xcx235-4 getting ready to call getRequestFormHtml(). bwRequestTypeId: "+n.bwBudgetRequest.bwRequestTypeId);l=o.getRequestFormHtml(n.bwBudgetRequest.bwRequestTypeId,null,n.ConfigurationModifiedDate_BwForm,"xcx23452-4");l.then(function(s){var w,g,rt,nt,a,ut,ft,et,tt,h,v,p,d,y,b,l,ot,st,k,ht,lt,ct,at;try{if(s.message!=null)console.log("Error: "+s.message),$("#"+r).find("#divRequestFormDialogContent")[0].innerHTML=s.message;else{$("#"+r).find("#divRequestFormDialogContent")[0].innerHTML=s.html;$("#"+r).find("#spanViewWorkflowParticipantsLink")&&$("#"+r).find("#spanViewWorkflowParticipantsLink")[0]&&($("#"+r).find("#spanViewWorkflowParticipantsLink")[0].innerHTML="");$("#"+r).find("#budgetrequestform")[0].setAttribute("bwrequesttypeid",n.bwBudgetRequest.bwRequestTypeId);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwfiscalyear",n.bwBudgetRequest.bwFiscalYear);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwbudgetrequestid",n.bwBudgetRequest.bwBudgetRequestId);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwrequesttitle",n.bwBudgetRequest.Title);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwworkflowstatus_bwworkflowstepname",n.bwBudgetRequest.BudgetWorkflowStatus);w=n.bwBudgetRequest.OrgId;g=n.bwBudgetRequest.OrgName;w||(console.log("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+w+", bwOrgName: "+g),alert("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+w+", bwOrgName: "+g));$("#"+r).find("#budgetrequestform")[0].setAttribute("bworgid",w);$("#"+r).find("#budgetrequestform")[0].setAttribute("bworgname",g);var vt=n.bwBudgetRequest.FunctionalAreaId,yt=n.bwBudgetRequest.ManagerId,pt=n.bwBudgetRequest.ManagerFriendlyName,wt=n.bwBudgetRequest.ARStatus;for(bwApprovalLevelWorkflowToken=n.bwBudgetRequest.bwApprovalLevelWorkflowToken,nt=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems,l=0;l<nt.length;l++)if(n.bwBudgetRequest.bwRequestTypeId==nt[l].bwRequestTypeId){rt=nt[l];break}if(y="",y+="                   <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">",y+=rt?"                       "+rt.SingletonName+": ":"                       requesttype_not_found bwRequestTypeId:"+n.bwBudgetRequest.bwRequestTypeId+": ",y+='                       <span id="spanRequestFormBudgetRequestTitle" title="">',y+=n.bwBudgetRequest.Title,y+="                       <\/span>",y+='&nbsp;<span xcx="xcx3567-2-2" id="spanNewRequestEllipsesButton" class="spanButton2 context_menu_requestformellipses" style="height:20px;width:150px;"> ... <\/span>',y+="<\/span>",$("#"+r).find("#spanRequestForm_Title")&&$("#"+r).find("#spanRequestForm_Title")[0]&&($("#"+r).find("#spanRequestForm_Title")[0].innerHTML=y),t.Workflow.length==0)console.log("ERROR: Cannot locate workflow: "+n.bwBudgetRequest.bwWorkflowId),displayAlertDialog("ERROR: Cannot locate workflow: "+n.bwBudgetRequest.bwWorkflowId),tt="",tt='<span style="color:tomato;">ERROR: Could not find the workflow: '+n.bwBudgetRequest.bwWorkflowId+". <span style=\"cursor:pointer;text-decoration:underline;\" onclick=\"$('.bwRequest').bwRequest('reassignOrphanedRequestToAnActiveWorkflow', '"+n.bwBudgetRequest.bwBudgetRequestId+'\');">Click here to reassign to an active workflow for this "'+n.bwBudgetRequest.bwRequestType+'".<\/a><\/span>',$("#"+r).find("#spanRequestForm_Instructions")[0].innerHTML=tt;else{for(a=null,ut=null,l=0;l<i.Steps.Step.length;l++)if(ut=i.Steps.Step[l]["@Name"],ut==n.bwBudgetRequest.BudgetWorkflowStatus){a=l;break}ft=$("#"+r).find("#spanNewRequestEllipsesButton")[0];$(ft).on("click",function(n){n.preventDefault();n.stopImmediatePropagation();$(this).contextMenu()});if(et=$(".bwAuthentication").bwAuthentication("option","developerModeEnabled"),et==!0?(console.log("Displaying elipses context menu for request with a workflow (new request). xcx214-1"),alert("Displaying elipses context menu for request without a workflow (new request). xcx214-1"),$.contextMenu({selector:".context_menu_requestformellipses",callback:function(n){var t=$(this).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),r=$(this).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid"),f="divRequestFormDialog_"+t,u;n=="requestjson"?t?o.viewScrapedBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjson). Invalid value for bwBudgetRequestId: "+t):n=="requestjsondignostics"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx445"):n=="requestjsondb"?t?o.viewDatabaseBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjsondb). Invalid value for bwBudgetRequestId: "+t):n=="viewbwbudgetrequestjson"?t?o.viewDatabaseBwRequestJson2(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewbwbudgetrequestjson). Invalid value for bwBudgetRequestId: "+t):n=="requesthtmldb"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx4471"):n=="viewworkflowjson"?o.viewWorkflowStepAndRoleJson(i.Steps.Step[a]):n=="changetherequesttype"?t?o.changeTheRequestTypeForARequest(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(changetherequesttype). Invalid value for bwBudgetRequestId: "+t):n=="deletethisrequest"?(u=$(this).closest("#budgetrequestform")[0].getAttribute("bwrequesttitle"),t?o.cmdDisplayDeleteBudgetRequestDialog(t,u):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(deletethisrequest). Invalid value for bwBudgetRequestId: "+t)):n=="updatedailyoverduetasknotificationdate"?r?o.displayUpdateDailyOverdueTaskNotificationDateDialog(r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(updatedailyoverduetasknotificationdate). Invalid value for bwWorkflowTaskItemId: "+r):n=="viewtaskjson"&&(r?o.viewTaskJsonInDialog(r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewtaskjson). Invalid value for bwWorkflowTaskItemId: "+r))},items:{requestjson:{name:"Request JSON (scraped2) xcx2",icon:"edit"},requestjsondb:{name:"Request JSON from Database",icon:"edit"},viewbwbudgetrequestjson:{name:"Request JSON (bwBudgetRequest)",icon:"edit"},updatedailyoverduetasknotificationdate:{name:"Update DailyOverdueTaskNotificationDate",icon:"edit"},viewtaskjson:{name:"Task JSON",icon:"edit"},requestjsondignostics:{name:"Request JSON Diagnostics",icon:"edit"},requesthtmldb:{name:"Request Form HTML from Database xcx1-4",icon:"edit"},viewworkflowjson:{name:"View Workflow Step/Role Json",icon:"edit"},changetherequesttype:{name:"Change the Request Type",icon:"edit"},deletethisrequest:{name:"Delete this Requestxcx2",icon:"edit"}}})):(console.log("Displaying elipses context menu for request with a workflow (new request). xcx214-2"),$.contextMenu({selector:".context_menu_requestformellipses",callback:function(n){var t=$(this).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),f=$(this).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid"),e="divRequestFormDialog_"+t,r,u,i;n=="requestjson"?t?o.viewScrapedBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjson). Invalid value for bwBudgetRequestId: "+t):n=="requestjsondb"?t?o.viewDatabaseBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjsondb). Invalid value for bwBudgetRequestId: "+t):n=="updatedailyoverduetasknotificationdate"?f?o.displayUpdateDailyOverdueTaskNotificationDateDialog(f):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(updatedailyoverduetasknotificationdate). Invalid value for bwWorkflowTaskItemId: "+f):n=="changetherequesttype"?t?o.changeTheRequestTypeForARequest(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(changetherequesttype). Invalid value for bwBudgetRequestId: "+t):n=="deletethisrequest"?(r=$(this).closest("#budgetrequestform")[0].getAttribute("bwrequesttitle"),t?o.cmdDisplayDeleteBudgetRequestDialog(t,r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(deletethisrequest). Invalid value for bwBudgetRequestId: "+t)):n=="setreminder"&&(r=$(this).closest("#budgetrequestform")[0].getAttribute("bwrequesttitle"),t?(u=$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders(),u&&u.length&&u.length==1?$(".bwOneTimeRequestReminders").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,r):(i=document.getElementById("divBwOneTimeRequestReminders"),i&&i.remove(),i=document.createElement("div"),i.id="divBwOneTimeRequestReminders",i.style.display="none",document.body.appendChild(i),$(i).bwOneTimeRequestReminders({}),$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,r))):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(setreminder). Invalid value for bwBudgetRequestId: "+t))},items:{requestjson:{name:"Request JSON (scraped) xcx231234-2",icon:"edit"},requestjsondb:{name:"Request JSON (from database)",icon:"edit"},updatedailyoverduetasknotificationdate:{name:"Update DailyOverdueTaskNotificationDate",icon:"edit"},changetherequesttype:{name:"Change the Request Type",icon:"edit"},deletethisrequest:{name:"Delete this Request",icon:"edit"},setreminder:{name:"Set a One-Time Reminder",icon:"edit"}}})),a==null)displayAlertDialog("Error: Invalid workflow status xcx12435-2. Could not find the stepName to match brData.bwBudgetRequest.BudgetWorkflowStatus: "+n.bwBudgetRequest.BudgetWorkflowStatus),$("#"+r).find("#spanRequestForm_Error")[0].innerHTML="INVALIDWORKFLOWSTATUS  brData.bwBudgetRequest.BudgetWorkflowStatus:"+n.bwBudgetRequest.BudgetWorkflowStatus+", participantRoles: "+n.RequestingUser.ParticipantRole+", RACI role: "+selectedRole+", orgId: "+n.RequestingUser.OrgId,y="xNOBUTTONSINVALIDWORKFLOWSTATUS",o.renderRequestFormButtons(r,n.bwBudgetRequest.bwBudgetRequestId,n.bwBudgetRequest.bwRequestTypeId,y,"xcx445566-2",!1,"ERROR"),tt="xNOINSTRUCTIONSINVALIDWORKFLOWSTATUS",$("#"+r).find("#spanRequestForm_Instructions")[0].innerHTML=tt;else{if(h={status:null,message:"",RequestingUser:{ParticipantRole:n.RequestingUser.ParticipantRole,QualifyingRolesInThisOrg:n.RequestingUser.RoleIds,AssignedRolesForThisWorkflowStep:[]},WorkflowAdmin:{OnBehalfOfRolesForThisWorkflowStep:[]},WorkflowStep:{AssignedRole:{Role:null,RoleName:null,OnBehalfOf:null,bwWorkflowTaskItemId:null},AllRolesInThisWorkflowStep:[],BwWorkflowTask_Table:c,Assign:null}},h.RequestingUser.ParticipantRole=="owner"&&(h.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")||(h.RequestingUser.QualifyingRolesInThisOrg.push("ADMIN"),alert("This user is an owner, so adding the ADMIN role to RolesData.RequestingUser.QualifyingRolesInThisOrg: ADMIN"))),i.Steps.Step[a].Assign)if(i.Steps.Step[a].Assign&&i.Steps.Step[a].Assign.length)for(l=0;l<i.Steps.Step[a].Assign.length;l++)v=i.Steps.Step[a].Assign[l]["@Role"],h.WorkflowStep.AllRolesInThisWorkflowStep.push(v),h.RequestingUser.QualifyingRolesInThisOrg.indexOf(v)>-1&&(h.RequestingUser.AssignedRolesForThisWorkflowStep.includes(v)||(h.RequestingUser.AssignedRolesForThisWorkflowStep.push(v),console.log("xcx1234123-3 PUSHED INTO RolesData.RequestingUser.AssignedRolesForThisWorkflowStep: "+v)));else v=i.Steps.Step[a].Assign["@Role"],h.WorkflowStep.AllRolesInThisWorkflowStep.push(v),h.RequestingUser.QualifyingRolesInThisOrg.indexOf(v)>-1&&(h.RequestingUser.AssignedRolesForThisWorkflowStep.includes(v)||h.RequestingUser.AssignedRolesForThisWorkflowStep.push(v));else i.Steps.Step[a].Inform?(v=i.Steps.Step[a].Inform["@Role"],h.WorkflowStep.AllRolesInThisWorkflowStep.push(v),h.RequestingUser.QualifyingRolesInThisOrg.indexOf(v)>-1&&(h.RequestingUser.AssignedRolesForThisWorkflowStep.includes(v)||(h.RequestingUser.AssignedRolesForThisWorkflowStep.push(v),console.log("xcx1234123-1 This user has the assignment for this role in the workflow step. Adding it to RolesData.RequestingUser.AssignedRolesForThisWorkflowStep: "+v)))):alert("NOT INFORM ROLE xcx346754234");if(console.log("xcx1231234234 RolesData.WorkflowStep.AllRolesInThisWorkflowStep: "+JSON.stringify(h.WorkflowStep.AllRolesInThisWorkflowStep)),h.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(l=0;l<h.WorkflowStep.AllRolesInThisWorkflowStep.length;l++)h.RequestingUser.AssignedRolesForThisWorkflowStep.indexOf(h.WorkflowStep.AllRolesInThisWorkflowStep[l])>-1||h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.push(h.WorkflowStep.AllRolesInThisWorkflowStep[l]);for(p=0;p<h.WorkflowStep.BwWorkflowTask_Table.length;p++){for(d=0;d<h.RequestingUser.AssignedRolesForThisWorkflowStep.length;d++)if(h.WorkflowStep.BwWorkflowTask_Table[p].bwAssignedToRaciRoleAbbreviation==h.RequestingUser.AssignedRolesForThisWorkflowStep[d]){h.WorkflowStep.BwWorkflowTask_Table[p].bwStatus=="Completed"&&h.WorkflowStep.BwWorkflowTask_Table[p].bwPercentComplete==100?h.RequestingUser.AssignedRolesForThisWorkflowStep.splice(d,1):h.RequestingUser.AssignedRolesForThisWorkflowStep[d]={Role:h.WorkflowStep.BwWorkflowTask_Table[p].bwAssignedToRaciRoleAbbreviation,RoleName:null,bwWorkflowTaskItemId:h.WorkflowStep.BwWorkflowTask_Table[p].bwWorkflowTaskItemId};break}if(h.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(l=0;l<h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length;l++)if(h.WorkflowStep.BwWorkflowTask_Table[p].bwAssignedToRaciRoleAbbreviation==h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l]){h.WorkflowStep.BwWorkflowTask_Table[p].bwStatus=="Completed"?h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.splice(l,1):h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l]={Role:h.WorkflowStep.BwWorkflowTask_Table[p].bwAssignedToRaciRoleAbbreviation,RoleName:null,bwWorkflowTaskItemId:h.WorkflowStep.BwWorkflowTask_Table[p].bwWorkflowTaskItemId};break}}if(e&&e!="undefined"){for(l=0;l<h.RequestingUser.AssignedRolesForThisWorkflowStep.length;l++)if(e==h.RequestingUser.AssignedRolesForThisWorkflowStep[l].Role){h.WorkflowStep.AssignedRole={Role:h.RequestingUser.AssignedRolesForThisWorkflowStep[l].Role,RoleName:null,OnBehalfOf:!1,bwWorkflowTaskItemId:h.RequestingUser.AssignedRolesForThisWorkflowStep[l].bwWorkflowTaskItemId};h.WorkflowStep.Assign=i.Steps.Step[a].Assign;console.log("xcx23423-1 found matching role. Set RolesData.WorkflowStep.AssignedRole.Role: "+h.WorkflowStep.AssignedRole.Role+".");break}if(!h.WorkflowStep.AssignedRole.Role&&h.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(l=0;l<h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length;l++)if(e==h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l].Role){h.WorkflowStep.AssignedRole={Role:h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l].Role,RoleName:null,OnBehalfOf:!0,bwWorkflowTaskItemId:h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l].bwWorkflowTaskItemId};h.WorkflowStep.Assign=i.Steps.Step[a].Assign;console.log("xcx23423-2 found matching role. Set RolesData.WorkflowStep.AssignedRole: "+h.WorkflowStep.AssignedRole.Role+".");break}}else h.RequestingUser.AssignedRolesForThisWorkflowStep&&h.RequestingUser.AssignedRolesForThisWorkflowStep.length&&h.RequestingUser.AssignedRolesForThisWorkflowStep.length>0&&(h.WorkflowStep.AssignedRole={Role:h.RequestingUser.AssignedRolesForThisWorkflowStep[0].Role,RoleName:null,OnBehalfOf:!1,bwWorkflowTaskItemId:h.RequestingUser.AssignedRolesForThisWorkflowStep[0].bwWorkflowTaskItemId},h.WorkflowStep.Assign=i.Steps.Step[a].Assign,console.log("xcx23423-3 found role. Set RolesData.WorkflowStep.AssignedRole: "+h.WorkflowStep.AssignedRole.Role)),h.WorkflowStep.AssignedRole.Role||h.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")&&h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep&&h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length&&h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length>0&&(console.log("xcx123123 pick the first one..."),h.WorkflowStep.AssignedRole={Role:h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[0].Role,RoleName:null,OnBehalfOf:!0,bwWorkflowTaskItemId:h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[0].bwWorkflowTaskItemId},h.WorkflowStep.Assign=i.Steps.Step[a].Assign,console.log("xcx23423-2 found matching role. Set RolesData.WorkflowStep.AssignedRole: "+h.WorkflowStep.AssignedRole.Role));if(h.WorkflowStep.AssignedRole.Role)for($("#"+r).find("#budgetrequestform")[0].setAttribute("bwworkflowtaskitemid",h.WorkflowStep.AssignedRole.bwWorkflowTaskItemId),b=0;b<i.Steps.Step[a].Assign.length;b++){for(h.WorkflowStep.AssignedRole.Role==i.Steps.Step[a].Assign[b]["@Role"]&&(h.WorkflowStep.Assign=i.Steps.Step[a].Assign[b],h.WorkflowStep.AssignedRole.RoleName=h.WorkflowStep.Assign["@RoleName"]),l=0;l<h.RequestingUser.AssignedRolesForThisWorkflowStep.length;l++)if(h.RequestingUser.AssignedRolesForThisWorkflowStep[l].Role==i.Steps.Step[a].Assign[b]["@Role"]){h.RequestingUser.AssignedRolesForThisWorkflowStep[l].RoleName=i.Steps.Step[a].Assign[b]["@RoleName"];break}if(h.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(l=0;l<h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length;l++)if(h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l].Role==i.Steps.Step[a].Assign[b]["@Role"]){h.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[l].RoleName=i.Steps.Step[a].Assign[b]["@RoleName"];break}}else console.log("No roles have been asigned to this user. xcx4326665."),y=h.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?"No roles have been asigned to this user, but as an ADMIN you can edit this request.":"No roles have been asigned to this user. xcx2342355.",$("#"+r).find("#budgetrequestform").find("#spanRequestForm_Instructions").html(y);ot={RequestingUser:h.RequestingUser,WorkflowAdmin:h.WorkflowAdmin,WorkflowStep:{AssignedRole:h.WorkflowStep.AssignedRole,AllRolesInThisWorkflowStep:h.WorkflowStep.AllRolesInThisWorkflowStep}};console.log("xcx3243 RolesData: "+JSON.stringify(ot));h.WorkflowStep.Assign?(h.WorkflowStep.Assign||alert("xcx112233 NO VALUE FOR RolesData.WorkflowStep.Assign HERE..??????"),k=h.WorkflowStep.Assign["@AllowRequestModifications"],console.log(""),console.log("%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%"),console.log("The user plays a role in the workflow. allowRequestModifications: "+k+", RolesData.WorkflowStep.Assign: "+JSON.stringify(h.WorkflowStep.Assign)),console.log("%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%"),console.log(""),ht=h.WorkflowStep.Assign["@Role"],lt=h.WorkflowStep.Assign["@RoleName"],$.ajax({url:o.options.operationUriPrefix+"odata/UserRole2/"+f+"/"+ht,dataType:"json",contentType:"application/json",type:"Get"}).done(function(t){var u,y,st,rt,p,tt,v,nt,l,ut,s,c,it,d,f,b,ht;try{var b="",ft="",et="",ot="";t.length>0&&(ft=t[0].bwParticipantId,et=t[0].bwParticipantEmail,ot=t[0].bwParticipantFriendlyName);var ct={roleMember_participantId:ft,roleMember_participantEmail:et,roleMember_participantFriendlyName:ot},lt=i.Steps.Step[a]["@Name"],st=i.Steps.Step[a]["@FriendlyName"];if(k&&k!="undefined"||(k=!1),u="",y="",st=i.Steps.Step[a]["@FriendlyName"]?i.Steps.Step[a]["@FriendlyName"]:i.Steps.Step[a]["@Name"],y+='<span style="font-weight:bold;">',y+='   <span xcx="342352-1-xx" style="cursor:pointer !important;text-decoration:underline;" title="View RACI workflow history..." onclick="$(\'.bwRequest\').bwRequest(\'displayRequestWorkflowAuditTrailDialog\', \''+n.bwBudgetRequest.Title+"', '"+String(n.bwBudgetRequest.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.bwBudgetRequest.bwRequestTypeId+"', '"+n.bwBudgetRequest.bwBudgetRequestId+"', '"+n.bwBudgetRequest.bwWorkflowId+"');\">",y+="       Workflow step: "+st,y+="   <\/span>",y+="<\/span>",y+="<br />",rt="",n.RequestingUser.RoleIds.includes("ADMIN")||e?(u+='<table style="float:right;width:85%;">',u+="   <tr>",u+='       <td style="text-align:left;font-weight:normal;">',u+=y,u+="       <\/td>",u+="   <\/tr>",u+="   <tr>",u+='       <td style="text-align:left;font-weight:normal;">',u+="           Your role as "+h.WorkflowStep.Assign["@RoleCategory"]+": "+h.WorkflowStep.Assign["@Role"],u+='<div style="float:right">'+rt+"<\/div>",u+="       <\/td>",u+="   <\/tr>",u+="   <tr>",u+="       <td>",u+="           You are not allowed to modify this request, but you can add comments.",u+="       <\/td>",u+="   <\/tr>",u+="<\/table>"):rt+="This user does not belong to a role present in this workflow step",u+="<br />",$("#"+r).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML=u,console.log(">>>>>>>>>>>>>>>>> The role drop-down has been displayed."),$("#"+r).find("#spanRequestForm_Error")[0].innerHTML="",$("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML="",h.WorkflowStep.Assign["@Checklists"]){for(p=h.WorkflowStep.Assign["@Checklists"],console.log("xcx31241 This workflow assignment has checklists. WorkflowStep_Assign_Checklists: "+JSON.stringify(p)),tt=JSON.parse(n.bwBudgetRequest.bwRequestJson).Checklists,v=[],f=0;f<p.length;f++)if(tt)for(c=0;c<tt.length;c++)if(nt=JSON.parse(tt[c]),nt.bwChecklistTemplatesId==p[f].bwChecklistTemplatesId){d={bwChecklistTemplatesId:nt.bwChecklistTemplatesId,html:"<span style=\"cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialogReadOnly', '"+nt.bwChecklistTemplatesId+"', '"+n.bwBudgetRequest.ProjectTitle+"', '"+n.bwBudgetRequest.Title+"', '"+n.bwBudgetRequest.bwRequestType+"', '"+n.bwBudgetRequest.bwBudgetRequestId+"', '"+n.bwBudgetRequest.bwWorkflowId+"', '"+w+"');\">"+nt.Title+"<\/span>"};v.push(d);break}for(l=[],f=0;f<p.length;f++){for(ut=!1,c=0;c<v.length;c++)if(p[f].bwChecklistTemplatesId==v[c].bwChecklistTemplatesId){ut=!0;break}if(ut!=!0)for(c=0;c<n.OrganizationChecklists.length;c++)p[f].bwChecklistTemplatesId==n.OrganizationChecklists[c].bwChecklistTemplatesId&&(it=JSON.parse(n.OrganizationChecklists[c].ChecklistJson).Title,d={bwChecklistTemplatesId:n.OrganizationChecklists[c].bwChecklistTemplatesId,html:"<span style=\"cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialog', '"+n.OrganizationChecklists[c].bwChecklistTemplatesId+"', '"+String(n.bwBudgetRequest.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.bwBudgetRequest.Title+"', '"+n.bwBudgetRequest.bwRequestType+"', '"+n.bwBudgetRequest.bwBudgetRequestId+"', '"+n.bwBudgetRequest.bwWorkflowId+"', '"+w+"');\">"+it+"<\/span>"},l.push(d))}if(s="",s+="<div>",o.options.Checklists=n.OrganizationChecklists,n.Checklists.length>0){for(s+=n.Checklists.length==1?"Checklist to be completed for this request: ":"Checklists to be completed for this request: ",s+="<ul>",alert("xcx213421 brData.Checklists: "+JSON.stringify(n.Checklists)),f=0;f<n.Checklists.length;f++)for(c=0;c<n.OrganizationChecklists.length;c++)n.Checklists[f].bwChecklistTemplatesId==n.OrganizationChecklists[c].bwChecklistTemplatesId&&(it=JSON.parse(n.OrganizationChecklists[c].ChecklistJson).Title,d={bwChecklistTemplatesId:n.Checklists[f].bwChecklistTemplatesId,html:"<li style=\"cursor:pointer;text-decoration:underline;text-align:left;\" onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialog', '"+n.Checklists[f].bwChecklistTemplatesId+"', '"+String(n.bwBudgetRequest.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.bwBudgetRequest.Title+"', '"+n.bwBudgetRequest.bwRequestType+"', '"+n.bwBudgetRequest.bwBudgetRequestId+"', '"+n.bwBudgetRequest.bwWorkflowId+"', '"+w+"');\">"+it+"<\/li>"},s+=d.html,o.options.Checklists.push(n.Checklists[f]));s+="<\/ul>";s+="<\/div>"}if(v.length>0||l.length>0||l.length>0){if(s+="<div>",v.length>0)for(s+=v.length==1?"Completed checklist: ":"Completed checklists: ",f=0;f<v.length;f++)s+="<span xcx=\"xcx99205476\" style=\"white-space:nowrap;text-decoration:underline;\" onclick=\"$('.bwRequest').bwRequest('RequestARevisionToThisChecklist', 'false', '');\" title=\"The Checklist has been updated. Do you wish to request a revision before this step is completed? and still in this step!\">",s+="&nbsp;"+v[f].html,s+="<\/span>",s+="<br />";if(l.length>0){for(s+='<img width="11" height="11" style="cursor:pointer;vertical-align:top;" alt="" src="/images/red-dot.png">',s+="&nbsp;",s+=l.length==1?"Complete the following checklist before you Approve: ":"Complete the following checklist(s) before you Approve: ",s+="<ul>",f=0;f<l.length;f++)s+='<li style="cursor:pointer;text-decoration:underline;text-align:left;" >'+l[f].html+"<\/li>";s+="<\/ul>";s+="<br />"}s+="<\/div>"}$("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML=s}b="";b+="                        <button style=\"width:370px;color:tomato;padding: 7px 5px 5px 5px;\" onclick=\"$('.bwRequest').bwRequest('permanentlyDeleteThisRequestFromTheTrashbin', '"+n.bwBudgetRequest.bwBudgetRequestId+'\');" title="Permanently delete this request." class="BwButton250ForRequestForm"><span style="text-align:right;cursor:pointer;font-size:30pt;">X<\/span> Permanently Delete this Request<\/button>';b+="                        &nbsp;";b+="                        <button style=\"width:320px;color:green;padding: 0 5px 5px 5px;\" onclick=\"$('.bwRequest').bwRequest('recoverFromTheTrashBin', '"+n.bwBudgetRequest.bwBudgetRequestId+'\');" title=" Recover from the TrashBin." class="BwButton250ForRequestForm"><span style="text-align:right;cursor:pointer;font-size:30pt;"><\/span> Recover from the TrashBin<\/button>';b+="                        &nbsp;";$("#"+r).find("#spanRequestForm_Buttons")[0].innerHTML=b;$("#"+r).find("#spanRequestForm_Instructions")[0].innerHTML="";u="";h.WorkflowStep.Assign&&h.WorkflowStep.Assign["@Instructions"]?(u+=h.WorkflowStep.Assign["@Instructions"],console.log("WORKFLOW HAD VALID INSTRUCTIONS.xcx2231-1")):console.log("In bwRequest.js.xx(). COULDNOTLOCATEVALIDINSTTRUCTIONS.xcx2232-1");l&&l.length>0&&(u+="Complete the required checklists before approving this request.",u+="<br />");u&&u!="undefined"&&(console.log(""),console.log("**********"),console.log("In bwRequest.js.renderRequestForm(). Displaying instructions from the workflow JSON in the request form header. instructions: "+u),console.log("**********"),console.log(""),$("#"+r).find("#spanRequestForm_Instructions")[0].innerHTML=u,console.log("The instructions have been displayed."));console.log("Calling populateRequestForm(). xcx3452-2-2 brData.bwBudgetRequest.bwRequestJson: "+JSON.stringify(n.bwBudgetRequest.bwRequestJson));ht=o.populateRequestForm(r,n.bwBudgetRequest.bwRequestJson,k);ht.then(function(){var i,u,e;try{if(i=document.getElementById("myCanvas"),i){var t=document.getElementsByTagName("body")[0],o=t.scrollWidth,s=Math.max(t.scrollHeight,document.documentElement.scrollHeight,t.offsetHeight,document.documentElement.offsetHeight,t.clientHeight,document.documentElement.clientHeight,t.scrollHeight,t.getBoundingClientRect().height);i.width=o;i.height=s}u=document.getElementById(r).getBoundingClientRect().left;u<0&&(console.log("THE AR DIALOG has been displayed too far to the left. xcxRepositioning here...xcx23214-4 left: "+u),alert("THE AR DIALOG has been displayed too far to the left. xcxRepositioning here...xcx23214-4 left: "+u),$("#"+r).dialog({position:{my:"center top",at:"center top+200","of":window}}));try{window.opener&&(e="divRequestFormDialog_"+n.bwBudgetRequest.bwBudgetRequestId,console.log("xcx999334-2 Should be closing dialog window.opener.dialogId: "+e),window.opener.$("#"+e).dialog("close"))}catch(f){}}catch(f){console.log("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-4: "+f.message+", "+f.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-4: "+f.message+", "+f.stack)}})}catch(g){console.log("Exception in bwRequest.js.renderRequestForm.UserRole2.done(): "+g.message+", "+g.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.UserRole2.done(): "+g.message+", "+g.stack);alert("Exception in bwRequest.js.renderRequestForm.UserRole2.done(): "+g.message+", "+g.stack)}}).fail(function(n){var t;t=JSON.stringify(n).indexOf("The specified URL cannot be found.")>-1?"There has been an error contacting the server. A firewall or network appliance may be interrupting this traffic.":JSON.stringify(n);displayAlertDialog("Error in bwRequest.js.renderRequestForm.UserRole2.fail():2: "+t);console.log("Error in bwRequest.js.renderRequestForm.UserRole2.fail():2: "+JSON.stringify(n));alert("Error in bwRequest.js.renderRequestForm.UserRole2.fail():2: "+t)})):(st=o.populateRequestForm(r,n.bwBudgetRequest.bwRequestJson,k),st.then(function(){var e,v,t,p,s,u,c,y;try{if(e=document.getElementById("myCanvas"),e){var f=document.getElementsByTagName("body")[0],b=f.scrollWidth,k=Math.max(f.scrollHeight,document.documentElement.scrollHeight,f.offsetHeight,document.documentElement.offsetHeight,f.clientHeight,document.documentElement.clientHeight,f.scrollHeight,f.getBoundingClientRect().height);e.width=b;e.height=k}if(v="",v+='<button xcx="xcx4242-2" onclick="$(\'#'+r+'\').dialog(\'close\');" class="BwButton200ForRequestForm" title="Close">Close<\/button>&nbsp;',o.renderRequestFormButtons(r,n.bwBudgetRequest.bwBudgetRequestId,n.bwBudgetRequest.bwRequestTypeId,v,"xcx445566-6-2",!1,h.WorkflowStep.Assign),t="",p=i.Steps.Step[a]["@FriendlyName"]?i.Steps.Step[a]["@FriendlyName"]:i.Steps.Step[a]["@Name"],t+='<span style="font-weight:bold;">',t+='   <span xcx="342352-1-2" style="cursor:pointer !important;text-decoration:underline;" title="View RACI workflow history..." onclick="$(\'.bwRequest\').bwRequest(\'displayRequestWorkflowAuditTrailDialog\', \''+n.bwBudgetRequest.Title+"', '"+String(n.bwBudgetRequest.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.bwBudgetRequest.bwRequestTypeId+"', '"+n.bwBudgetRequest.bwBudgetRequestId+"', '"+n.bwBudgetRequest.bwWorkflowId+"');\">",t+="       Workflow step: "+p,t+="   <\/span>",t+="<\/span>",t+="<br />",$("#"+r).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML=t,displayAlertDialog("xcx987070-2 Display the checklists here... 10-25-2022"),s=JSON.parse(n.bwBudgetRequest.bwRequestJson).Checklists,s){for(u="",u+="Completed checklist(s):",u+="<br />",c=0;c<s.length;c++)y=JSON.parse(s[c]),u+='<span xcx="xcx8822567" style="cursor:pointer;text-decoration:underline;" ',u+="onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialogReadOnly', '"+y.bwChecklistTemplatesId+"', '"+n.bwBudgetRequest.ProjectTitle+"', '"+n.bwBudgetRequest.Title+"', '"+n.bwBudgetRequest.bwRequestType+"', '"+n.bwBudgetRequest.bwBudgetRequestId+"', '"+n.bwBudgetRequest.bwWorkflowId+"', '"+w+"');\">"+y.Title+"<\/span>",u+="<br />";$("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML=u}else $("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML=""}catch(l){console.log("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-3: "+l.message+", "+l.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-3: "+l.message+", "+l.stack)}}))}}ct={bwTenantId:tenantId,bwWorkflowAppId:f,bwParticipantId:u,bwParticipantEmail:participantEmail,bwParticipantFriendlyName:participantFriendlyName,bwEnabledRequestTypes:nt,bwOrgId:w,bwOrgName:g};at=$("#"+r).find("#divBwLocationPicker").bwLocationPicker(ct)}}catch(it){console.log("Exception in bwRequest.js.renderRequestForm():21-1:requestDialogId: "+r+", "+it.message+", "+it.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm():21-1:requestDialogId: "+r+", "+it.message+", "+it.stack)}})}}catch(h){console.log("Exception in bwRequest.js.renderRequestForm():265: "+h.message+", "+h.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm():265: "+h.message+", "+h.stack)}}})):(alert("Error in renderRequestForm(). Unexpected value(s) for brData.bwBudgetRequest.bwWorkflowAppId: "+!n.bwBudgetRequest.bwWorkflowAppId+", brData.bwBudgetRequest.bwBudgetRequestId: "+n.bwBudgetRequest.bwBudgetRequestId),displayAlertDialog("Error in renderRequestForm(). Unexpected value(s) for brData.bwBudgetRequest.bwWorkflowAppId: "+!n.bwBudgetRequest.bwWorkflowAppId+", brData.bwBudgetRequest.bwBudgetRequestId: "+n.bwBudgetRequest.bwBudgetRequestId))}catch(s){console.log("Exception in bwRequest.js.renderRequestForm(): "+s.message+", "+s.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm(): "+s.message+", "+s.stack)}},renderRequestForm_old:function(n,t,i,r,u,f,e){var o,h,c;try{o=this;console.log("In renderRequestForm_old(). brData: "+JSON.stringify(n));n.BudgetRequest.bwWorkflowAppId&&n.BudgetRequest.bwBudgetRequestId?n.BudgetRequest.BudgetWorkflowStatus=="NOT_SUBMITTED"?(console.log("In bwRequest.js.displayRequestForm(). THIS MUST BE A NEW REQUEST xcx3434 brData.BudgetWorkflowStatus: "+n.BudgetWorkflowStatus),alert("In bwRequest.js.displayRequestForm(). THIS MUST BE A NEW REQUEST xcx3434 brData.BudgetWorkflowStatus: "+n.BudgetWorkflowStatus),h=o.getRequestFormHtml(n.BudgetRequest.bwRequestTypeId,null,n.ConfigurationModifiedDate_BwForm,"xcx23452-5"),h.then(function(t){var f,s,e,i,l;try{if(t.message!=null)console.log("Error: "+t.message),$("#"+r).find("#divRequestFormDialogContent")[0].innerHTML=t.message;else{$("#"+r).find("#divRequestFormDialogContent")[0].innerHTML=t.html;$("#"+r).find("#budgetrequestform")[0].setAttribute("bwrequesttypeid",n.BudgetRequest.bwRequestTypeId);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwfiscalyear",n.BudgetRequest.bwFiscalYear);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwbudgetrequestid",n.BudgetRequest.bwBudgetRequestId);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwrequesttitle",n.BudgetRequest.Title);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwworkflowstatus_bwworkflowstepname",n.BudgetRequest.BudgetWorkflowStatus);f=n.BudgetRequest.OrgId;s=n.BudgetRequest.OrgName;f||(console.log("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+f+", bwOrgName: "+s),alert("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+f+", bwOrgName: "+s));$("#"+r).find("#budgetrequestform")[0].setAttribute("bworgid",f);$("#"+r).find("#budgetrequestform")[0].setAttribute("bworgname",s);var a=n.BudgetRequest.FunctionalAreaId,v=n.BudgetRequest.ManagerId,y=n.BudgetRequest.ManagerFriendlyName,p=n.BudgetRequest.ARStatus,h,c=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems;for(e=0;e<c.length;e++)if(n.BudgetRequest.bwRequestTypeId==c[e].bwRequestTypeId){h=c[e];break}i="";i+="                   <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">";i+=h?"                       New "+h.SingletonName+": ":"                       requesttype_not_found bwRequestTypeId:"+n.BudgetRequest.bwRequestTypeId+" ";i+='&nbsp;<span xcx="xcx3567-1" id="spanNewRequestEllipsesButton" class="spanButton2 context-menu-newrequesteditor" style="height:20px;width:150px;"> ... <\/span>';i+="<\/span>";$("#"+r).find("#spanRequestForm_Title")&&$("#"+r).find("#spanRequestForm_Title")[0]&&($("#"+r).find("#spanRequestForm_Title")[0].innerHTML=i);$("#"+r).find("#spanViewWorkflowParticipantsLink")[0].innerHTML="";$("#"+r).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML="";$("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML="";$("#"+r).find("#spanRequestForm_Error")[0].innerHTML="";$("#"+r).find("#spanRequestForm_Instructions")[0].innerHTML='Complete the form then click the "Submit" button.';o.renderRequestFormButtons(r,n.BudgetRequest,null,i,"xcx445566-1");console.log("Calling populateRequestForm(). xcx3452-2-1");l=o.populateRequestForm(r,n.BudgetRequest.bwRequestJson,!0);l.then(function(){var i,u,f,s;try{if(i=document.getElementById("myCanvas"),i){var t=document.getElementsByTagName("body")[0],h=t.scrollWidth,c=Math.max(t.scrollHeight,document.documentElement.scrollHeight,t.offsetHeight,document.documentElement.offsetHeight,t.clientHeight,document.documentElement.clientHeight,t.scrollHeight,t.getBoundingClientRect().height);i.width=h;i.height=c}u=document.getElementById(r).getBoundingClientRect().left;u<0&&(console.log("THE AR DIALOG has been displayed too far to the left. xcxRepositioning here...xcx23214-1 left: "+u),alert("THE AR DIALOG has been displayed too far to the left. xcxRepositioning here...xcx23214-1 left: "+u),$("#"+r).dialog({position:{my:"center top",at:"center top","of":window}}));window.opener&&(f="divRequestFormDialog_"+n.BudgetRequest.bwBudgetRequestId,alert("xcx999334-3 Should be closing dialog window.opener.dialogId: "+f),console.log("xcx999334-3 Should be closing dialog window.opener.dialogId: "+f),window.opener.$("#"+f).dialog("close"));s=$("#"+r).find("#spanNewRequestEllipsesButton")[0];$(s).on("click",function(n){n.preventDefault();n.stopImmediatePropagation();$(this).contextMenu()});console.log("Displaying elipses context menu for request without a workflow (new request).");$.contextMenu({selector:".context-menu-newrequesteditor",callback:function(n){var t=$(this).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),r=$(this).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid"),f="divRequestFormDialog_"+t,u,i;n=="requestjson"?t?o.viewScrapedBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjson). Invalid value for bwBudgetRequestId: "+t):n=="requestjsondignostics"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx445"):n=="requestjsondb"?t?o.viewDatabaseBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjsondb). Invalid value for bwBudgetRequestId: "+t):n=="viewbwbudgetrequestjson"?t?o.viewDatabaseBwRequestJson2(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewbwbudgetrequestjson). Invalid value for bwBudgetRequestId: "+t):n=="requesthtmldb"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx4471"):n=="viewworkflowjson"?o.viewWorkflowStepAndRoleJson(workflow.Steps.Step[stepIndex]):n=="changetherequesttype"?t?o.changeTheRequestTypeForARequest(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(changetherequesttype). Invalid value for bwBudgetRequestId: "+t):n=="updatedailyoverduetasknotificationdate"?r?o.displayUpdateDailyOverdueTaskNotificationDateDialog(r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(updatedailyoverduetasknotificationdate). Invalid value for bwWorkflowTaskItemId: "+r):n=="viewtaskjson"?r?o.viewTaskJsonInDialog(r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewtaskjson). Invalid value for bwWorkflowTaskItemId: "+r):n=="deletethisrequest"?t?o.cmdDisplayDeleteBudgetRequestDialog(t,"this New Request"):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(deletethisrequest). Invalid value for bwBudgetRequestId: "+t):n=="setreminder"&&(t?(u=$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders(),u&&u.length&&u.length==1?$(".bwOneTimeRequestReminders").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,"this New Request"):(i=document.getElementById("divBwOneTimeRequestReminders"),i&&i.remove(),i=document.createElement("div"),i.id="divBwOneTimeRequestReminders",i.style.display="none",document.body.appendChild(i),$(i).bwOneTimeRequestReminders({}),$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,"this New Request"))):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(setreminder). Invalid value for bwBudgetRequestId: "+t))},items:{requestjson:{name:"Request JSON",icon:"edit"},requestjsondb:{name:"Request JSON from Database",icon:"edit"},changetherequesttype:{name:"Change the Request Type",icon:"edit"},deletethisrequest:{name:"Delete this Request",icon:"edit"},setreminder:{name:"Set a One-Time Reminder",icon:"edit"}}})}catch(e){console.log("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-1: "+e.message+", "+e.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-1: "+e.message+", "+e.stack)}})}}catch(u){console.log("Exception in bwRequest.js.renderRequestForm():21-1-2: "+u.message+", "+u.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm():21-1-2: "+u.message+", "+u.stack);alert("Exception in bwRequest.js.renderRequestForm():21-1-2: "+u.message+", "+u.stack)}})):(c={bwParticipantId_LoggedIn:u,bwActiveStateIdentifier:t,bwWorkflowAppId_LoggedIn:f,bwWorkflowAppId:f,bwBudgetRequestId:i},$.ajax({url:o.options.operationUriPrefix+"_bw/workflowconfiguration5",type:"POST",data:c,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){console.log("xcx23123-2 Error in bwRequest.js.displayRequestForm(): "+t+" "+i);displayAlertDialog("xcx23123-2 Error in bwRequest.js.displayRequestForm(): "+t+" "+i)},success:function(t){var s,l,h,a;try{if(t.status!="SUCCESS")console.log(t.message),displayAlertDialog(t.message);else{if(t.Workflow?s=JSON.parse(t.Workflow[0].bwWorkflowJson):n.BudgetRequest.BudgetWorkflowStatus!="NOT_SUBMITTED"?(console.log("In bwRequest.js.displayRequestForm(). THERE IS NO WORKFLOW FOR THIS REQUEST TYPE. HOWEVER, BudgetWorkflowStatus SHOULD BE NOT_SUBMITTED. IT IS NOT. brData.BudgetRequest.BudgetWorkflowStatus: "+n.BudgetRequest.BudgetWorkflowStatus),alert("In bwRequest.js.displayRequestForm(). THERE IS NO WORKFLOW FOR THIS REQUEST TYPE. HOWEVER, BudgetWorkflowStatus SHOULD BE NOT_SUBMITTED. IT IS NOT. brData.BudgetRequest.BudgetWorkflowStatus: "+n.BudgetRequest.BudgetWorkflowStatus),displayAlertDialog_Persistent("In bwRequest.js.displayRequestForm(). brData: "+JSON.stringify(n))):(console.log("This request has no workflow. xcx4354376."),alert("This request has no workflow. xcx4354376.")),console.log("HERE WE GO! WE HAVE A GOOD WORKFLOW JSON. This is the only place we should be creating a header for a form!!!! 2-11-2022"),l=[],t.Tasks&&t.Tasks.length)for(h=0;h<t.Tasks.length;h++)t.Tasks[h].WorkflowStepName==n.BudgetRequest.BudgetWorkflowStatus?l.push(t.Tasks[h]):t.Tasks[h].bwStatus=="Completed"&&t.Tasks[h].bwPercentComplete==100?console.log('AUDIT Success in bwRequest.js.displayRequestForm(). This task was completed for request "'+n.BudgetRequest.Title+'" ['+n.BudgetRequest.bwBudgetRequestId+"]. bwWorkflowTaskItemId: ["+t.Tasks[h].bwWorkflowTaskItemId+"]"):(console.log("AUDIT Error in bwRequest.js.displayRequestForm(): An unfinished task exists for this request which does not match the current workflow step of: "+n.BudgetRequest.BudgetWorkflowStatus+". The mismatched step is "+t.Tasks[h].WorkflowStepName),displayAlertDialog("AUDIT Error in bwRequest.js.displayRequestForm(): An unfinished task exists for this request which does not match the current workflow step of: "+n.BudgetRequest.BudgetWorkflowStatus+". The mismatched step is "+t.Tasks[h].WorkflowStepName));console.log("In bwRequest.js.renderRequestForm(). xcx235-4 getting ready to call getRequestFormHtml(). bwRequestTypeId: "+n.BudgetRequest.bwRequestTypeId);a=o.getRequestFormHtml(n.BudgetRequest.bwRequestTypeId,null,n.ConfigurationModifiedDate_BwForm,"xcx23452-6");a.then(function(h){var w,it,rt,ut,v,st,vt,yt,c,y,d,ft,et,ht,p,tt,ct,lt,b,g,a,pt,nt,k,at,wt,bt,kt;try{if(h.message!=null)console.log("Error: "+h.message),$("#"+r).find("#divRequestFormDialogContent")[0].innerHTML=h.message;else{$("#"+r).find("#divRequestFormDialogContent")[0].innerHTML=h.html;$("#"+r).find("#spanViewWorkflowParticipantsLink")&&$("#"+r).find("#spanViewWorkflowParticipantsLink")[0]&&($("#"+r).find("#spanViewWorkflowParticipantsLink")[0].innerHTML="");$("#"+r).find("#budgetrequestform")[0].setAttribute("bwrequesttypeid",n.BudgetRequest.bwRequestTypeId);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwfiscalyear",n.BudgetRequest.bwFiscalYear);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwbudgetrequestid",n.BudgetRequest.bwBudgetRequestId);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwrequesttitle",n.BudgetRequest.Title);$("#"+r).find("#budgetrequestform")[0].setAttribute("bwworkflowstatus_bwworkflowstepname",n.BudgetRequest.BudgetWorkflowStatus);w=n.BudgetRequest.OrgId;it=n.BudgetRequest.OrgName;w||(console.log("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+w+", bwOrgName: "+it),alert("FATAL ERROR in bwRequest.js.renderRequestForm(). Empty values for org. bwOrgId: "+w+", bwOrgName: "+it));$("#"+r).find("#budgetrequestform")[0].setAttribute("bworgid",w);$("#"+r).find("#budgetrequestform")[0].setAttribute("bworgname",it);var dt=n.BudgetRequest.FunctionalAreaId,gt=n.BudgetRequest.ManagerId,ni=n.BudgetRequest.ManagerFriendlyName,ti=n.BudgetRequest.ARStatus;for(bwApprovalLevelWorkflowToken=n.BudgetRequest.bwApprovalLevelWorkflowToken,ut=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems,a=0;a<ut.length;a++)if(n.BudgetRequest.bwRequestTypeId==ut[a].bwRequestTypeId){rt=ut[a];break}if(b="",b+="                   <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">",b+=rt?"                       "+rt.SingletonName+": ":"                       requesttype_not_found bwRequestTypeId:"+n.BudgetRequest.bwRequestTypeId+": ",b+='                       <span id="spanRequestFormBudgetRequestTitle" title="">',b+=n.BudgetRequest.Title,b+="                       <\/span>",b+='&nbsp;<span xcx="xcx3567-2-1-2" id="spanNewRequestEllipsesButton" class="spanButton2 context_menu_requestformellipses" style="height:20px;width:150px;"> ... <\/span>',b+="<\/span>",$("#"+r).find("#spanRequestForm_Title")&&$("#"+r).find("#spanRequestForm_Title")[0]&&($("#"+r).find("#spanRequestForm_Title")[0].innerHTML=b),v=null,st=null,s)for(a=0;a<s.Steps.Step.length;a++)if(st=s.Steps.Step[a]["@Name"],st==n.BudgetRequest.BudgetWorkflowStatus){v=a;break}vt=$("#"+r).find("#spanNewRequestEllipsesButton")[0];$(vt).on("click",function(n){n.preventDefault();n.stopImmediatePropagation();$(this).contextMenu()});if(yt=$(".bwAuthentication").bwAuthentication("option","developerModeEnabled"),yt==!0?(console.log("Displaying elipses context menu for request with a workflow (new request). xcx214-1"),alert("Displaying elipses context menu for request without a workflow (new request). xcx214-1"),$.contextMenu({selector:".context_menu_requestformellipses",callback:function(n){var t=$(this).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),i=$(this).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid"),u="divRequestFormDialog_"+t,r;n=="requestjson"?t?o.viewScrapedBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjson). Invalid value for bwBudgetRequestId: "+t):n=="requestjsondignostics"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx445"):n=="requestjsondb"?t?o.viewDatabaseBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjsondb). Invalid value for bwBudgetRequestId: "+t):n=="viewbwbudgetrequestjson"?t?o.viewDatabaseBwRequestJson2(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewbwbudgetrequestjson). Invalid value for bwBudgetRequestId: "+t):n=="requesthtmldb"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx4471"):n=="viewworkflowjson"?o.viewWorkflowStepAndRoleJson(s.Steps.Step[v]):n=="changetherequesttype"?t?o.changeTheRequestTypeForARequest(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(changetherequesttype). Invalid value for bwBudgetRequestId: "+t):n=="deletethisrequest"?(r=$(this).closest("#budgetrequestform")[0].getAttribute("bwrequesttitle"),t?o.cmdDisplayDeleteBudgetRequestDialog(t,r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(deletethisrequest). Invalid value for bwBudgetRequestId: "+t)):n=="updatedailyoverduetasknotificationdate"?i?o.displayUpdateDailyOverdueTaskNotificationDateDialog(i):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(updatedailyoverduetasknotificationdate). Invalid value for bwWorkflowTaskItemId: "+i):n=="viewtaskjson"&&(i?o.viewTaskJsonInDialog(i):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewtaskjson). Invalid value for bwWorkflowTaskItemId: "+i))},items:{requestjson:{name:"Request JSON (scraped2) xcx2",icon:"edit"},requestjsondb:{name:"Request JSON from Database",icon:"edit"},viewbwbudgetrequestjson:{name:"Request JSON (bwBudgetRequest)",icon:"edit"},updatedailyoverduetasknotificationdate:{name:"Update DailyOverdueTaskNotificationDate",icon:"edit"},viewtaskjson:{name:"Task JSON",icon:"edit"},requestjsondignostics:{name:"Request JSON Diagnostics",icon:"edit"},requesthtmldb:{name:"Request Form HTML from Database xcx1-4",icon:"edit"},viewworkflowjson:{name:"View Workflow Step/Role Json",icon:"edit"},changetherequesttype:{name:"Change the Request Type",icon:"edit"},deletethisrequest:{name:"Delete this Requestxcx2",icon:"edit"}}})):(console.log("Displaying elipses context menu for request with a workflow (new request). xcx214-2"),$.contextMenu({selector:".context_menu_requestformellipses",callback:function(n){var t=$(this).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),r=$(this).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid"),e="divRequestFormDialog_"+t,u,f,i;n=="requestjson"?t?o.viewScrapedBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjson). Invalid value for bwBudgetRequestId: "+t):n=="requestjsondb"?t?o.viewDatabaseBwRequestJson(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(requestjsondb). Invalid value for bwBudgetRequestId: "+t):n=="viewbwbudgetrequestjson"?t?o.viewDatabaseBwRequestJson2(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewbwbudgetrequestjson). Invalid value for bwBudgetRequestId: "+t):n=="viewtaskjson"?r?o.viewTaskJsonInDialog(r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(viewtaskjson). Invalid value for bwWorkflowTaskItemId: "+r):n=="viewworkflowjson"?o.viewWorkflowStepAndRoleJson(s.Steps.Step[v]):n=="updatedailyoverduetasknotificationdate"?r?o.displayUpdateDailyOverdueTaskNotificationDateDialog(r):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(updatedailyoverduetasknotificationdate). Invalid value for bwWorkflowTaskItemId: "+r):n=="changetherequesttype"?t?o.changeTheRequestTypeForARequest(t):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(changetherequesttype). Invalid value for bwBudgetRequestId: "+t):n=="deletethisrequest"?(u=$(this).closest("#budgetrequestform")[0].getAttribute("bwrequesttitle"),t?o.cmdDisplayDeleteBudgetRequestDialog(t,u):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(deletethisrequest). Invalid value for bwBudgetRequestId: "+t)):n=="setreminder"&&(u=$(this).closest("#budgetrequestform")[0].getAttribute("bwrequesttitle"),t?(f=$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders(),f&&f.length&&f.length==1?$(".bwOneTimeRequestReminders").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,u):(i=document.getElementById("divBwOneTimeRequestReminders"),i&&i.remove(),i=document.createElement("div"),i.id="divBwOneTimeRequestReminders",i.style.display="none",document.body.appendChild(i),$(i).bwOneTimeRequestReminders({}),$(".bwOneTimeRequestReminders:first").bwOneTimeRequestReminders("cmdDisplaySetBudgetRequestReminderDialog",t,u))):displayAlertDialog("Error in bwRequest.js.renderRequestForm.contextMenu.callback(setreminder). Invalid value for bwBudgetRequestId: "+t))},items:{requestjson:{name:"Request JSON (scraped) xcx231234-3",icon:"edit"},requestjsondb:{name:"Request JSON (from database)",icon:"edit"},viewbwbudgetrequestjson:{name:"Request JSON (bwBudgetRequest)",icon:"edit"},viewtaskjson:{name:"Task JSON",icon:"edit"},viewworkflowjson:{name:"View Workflow Step/Role Json",icon:"edit"},updatedailyoverduetasknotificationdate:{name:"Update DailyOverdueTaskNotificationDate",icon:"edit"},changetherequesttype:{name:"Change the Request Type",icon:"edit"},deletethisrequest:{name:"Delete this Request",icon:"edit"},setreminder:{name:"Set a One-Time Reminder",icon:"edit"}}})),v==null)s?(nt=o.populateRequestForm(r,n.BudgetRequest.bwRequestJson,k),nt.then(function(){var c,u,l,t,f,i,e,h;try{if(c="xNOBUTTONSINVALIDWORKFLOWSTATUS",o.renderRequestFormButtons(r,n.BudgetRequest.bwBudgetRequestId,n.BudgetRequest.bwRequestTypeId,c,"xcx445566-4"),u='Error in bwRequest.js.renderRequestForm(). Invalid workflow step. The step "'+n.BudgetRequest.BudgetWorkflowStatus+'" must have been renamed or removed from the workflow for xxxs.',displayAlertDialog(u),console.log(u),$("#"+r).find("#spanRequestForm_Error")[0].innerHTML=u,l='Invalid workflow step. The step "'+n.BudgetRequest.BudgetWorkflowStatus+'" must have been renamed or removed from the workflow for xxxs. Select the Revise/Revert button to restart the request workflow.',$("#"+r).find("#spanRequestForm_Instructions")[0].innerHTML=l,t="",t+='<span style="font-weight:bold;">',t+='   <span xcx="342352-1-2" style="cursor:pointer !important;text-decoration:underline;" title="View RACI workflow history..." onclick="$(\'.bwRequest\').bwRequest(\'displayRequestWorkflowAuditTrailDialog\', \''+n.BudgetRequest.Title+"', '"+String(n.BudgetRequest.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.BudgetRequest.bwRequestTypeId+"', '"+n.BudgetRequest.bwBudgetRequestId+"', '"+n.BudgetRequest.bwWorkflowId+"');\">",t+="       Workflow step: [missing]",t+="   <\/span>",t+="<\/span>",t+="<br />",$("#"+r).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML=t,f=JSON.parse(n.BudgetRequest.bwRequestJson).Checklists,f){for(i="",i+="Completed checklist(s):",i+="<br />",e=0;e<f.length;e++)h=JSON.parse(f[e]),i+='<span xcx="xcx8822567" style="cursor:pointer;text-decoration:underline;" ',i+="onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialogReadOnly', '"+h.bwChecklistTemplatesId+"', '"+n.BudgetRequest.ProjectTitle+"', '"+n.BudgetRequest.Title+"', '"+n.BudgetRequest.bwRequestType+"', '"+n.BudgetRequest.bwBudgetRequestId+"', '"+n.BudgetRequest.bwWorkflowId+"', '"+w+"');\">"+h.Title+"<\/span>",i+="<br />";$("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML=i}else $("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML=""}catch(s){console.log("Exception in bwRequest.js.renderRequestForm().xcx123123435: "+s.message+", "+s.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm().xcx123123435: "+s.message+", "+s.stack)}})):(nt=o.populateRequestForm(r,n.BudgetRequest.bwRequestJson,k),nt.then(function(){try{}catch(n){console.log("Exception in bwRequest.js.renderRequestForm().xcx123123435-22: "+n.message+", "+n.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm().xcx123123435-22: "+n.message+", "+n.stack)}}));else{if(c={status:null,message:"",RequestingUser:{ParticipantRole:n.RequestingUser.ParticipantRole,QualifyingRolesInThisOrg:n.RequestingUser.RoleIds,AssignedRolesForThisWorkflowStep:[]},WorkflowAdmin:{OnBehalfOfRolesForThisWorkflowStep:[]},WorkflowStep:{AssignedRole:{Role:null,RoleName:null,OnBehalfOf:null,bwWorkflowTaskItemId:null},AllRolesInThisWorkflowStep:[],BwWorkflowTask_Table:l,Assign:null}},c.RequestingUser.ParticipantRole=="owner"&&(c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")||(c.RequestingUser.QualifyingRolesInThisOrg.push("ADMIN"),alert("This user is an owner, so adding the ADMIN role to RolesData.RequestingUser.QualifyingRolesInThisOrg: ADMIN"))),s.Steps.Step[v].Assign)if(s.Steps.Step[v].Assign&&s.Steps.Step[v].Assign.length)for(a=0;a<s.Steps.Step[v].Assign.length;a++)y=s.Steps.Step[v].Assign[a]["@Role"],c.WorkflowStep.AllRolesInThisWorkflowStep.push(y),c.RequestingUser.QualifyingRolesInThisOrg.indexOf(y)>-1&&(c.RequestingUser.AssignedRolesForThisWorkflowStep.includes(y)||(c.RequestingUser.AssignedRolesForThisWorkflowStep.push(y),console.log("xcx1234123-3 PUSHED INTO RolesData.RequestingUser.AssignedRolesForThisWorkflowStep: "+y)));else y=s.Steps.Step[v].Assign["@Role"],c.WorkflowStep.AllRolesInThisWorkflowStep.push(y),c.RequestingUser.QualifyingRolesInThisOrg.indexOf(y)>-1&&(c.RequestingUser.AssignedRolesForThisWorkflowStep.includes(y)||c.RequestingUser.AssignedRolesForThisWorkflowStep.push(y));else s.Steps.Step[v].Inform?(y=s.Steps.Step[v].Inform["@Role"],c.WorkflowStep.AllRolesInThisWorkflowStep.push(y),c.RequestingUser.QualifyingRolesInThisOrg.indexOf(y)>-1&&(c.RequestingUser.AssignedRolesForThisWorkflowStep.includes(y)||(c.RequestingUser.AssignedRolesForThisWorkflowStep.push(y),console.log("xcx1234123-1 This user has the assignment for this role in the workflow step. Adding it to RolesData.RequestingUser.AssignedRolesForThisWorkflowStep: "+y)))):alert("NOT INFORM ROLE xcx346754234");for(d=[],a=0;a<c.WorkflowStep.BwWorkflowTask_Table.length;a++)d.push(c.WorkflowStep.BwWorkflowTask_Table[a].bwAssignedToRaciRoleAbbreviation);if(d.length!=0){for(ft=[],a=0;a<c.WorkflowStep.AllRolesInThisWorkflowStep.length;a++)d.indexOf(c.WorkflowStep.AllRolesInThisWorkflowStep[a])>-1||(console.log("AUDIT Error in bwRequest.js.displayRequestForm(). missingFrom_BwWorkflowTask_Table: "+c.WorkflowStep.AllRolesInThisWorkflowStep[a]+". BwWorkflowTask_Table: "+JSON.stringify(d)+", result.Tasks: "+JSON.stringify(t.Tasks)),displayAlertDialog("AUDIT Error in bwRequest.js.displayRequestForm(). missingFrom_BwWorkflowTask_Table: "+c.WorkflowStep.AllRolesInThisWorkflowStep[a]+". BwWorkflowTask_Table: "+JSON.stringify(d)),ft.push(c.WorkflowStep.AllRolesInThisWorkflowStep[a]));for(et=[],a=0;a<d.length;a++)c.WorkflowStep.AllRolesInThisWorkflowStep.indexOf(d[a])>-1||et.push(d[a]);console.log("AUDIT Note: Comparing workflowTasks with existingTasks to make sure all tasks have been created, and also that there aren't too many existing tasks. Any errors will be list immediately below this line in the console. BwWorkflowTask_Table: "+JSON.stringify(d)+", RolesData.WorkflowStep.AllRolesInThisWorkflowStep: "+JSON.stringify(c.WorkflowStep.AllRolesInThisWorkflowStep)+", missingFrom_BwWorkflowTask_Table: "+JSON.stringify(ft)+", superfluousIn_BwWorkflowTask_Table: "+JSON.stringify(et));(ft.length>0||et.length>0)&&(ht="AUDIT Error in bwRequest.js.displayRequestForm(): Unexpected tasks for Request "+i+". missingFrom_BwWorkflowTask_Table: "+ft+", superfluousIn_BwWorkflowTask_Table: "+et,console.log(ht),displayAlertDialog(ht))}if(console.log("xcx1231234234 RolesData.WorkflowStep.AllRolesInThisWorkflowStep: "+JSON.stringify(c.WorkflowStep.AllRolesInThisWorkflowStep)),c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(a=0;a<c.WorkflowStep.AllRolesInThisWorkflowStep.length;a++)c.RequestingUser.AssignedRolesForThisWorkflowStep.indexOf(c.WorkflowStep.AllRolesInThisWorkflowStep[a])>-1||c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.push(c.WorkflowStep.AllRolesInThisWorkflowStep[a]);for(p=0;p<c.WorkflowStep.BwWorkflowTask_Table.length;p++){for(tt=0;tt<c.RequestingUser.AssignedRolesForThisWorkflowStep.length;tt++)if(c.WorkflowStep.BwWorkflowTask_Table[p].bwAssignedToRaciRoleAbbreviation==c.RequestingUser.AssignedRolesForThisWorkflowStep[tt]){c.WorkflowStep.BwWorkflowTask_Table[p].bwStatus=="Completed"&&c.WorkflowStep.BwWorkflowTask_Table[p].bwPercentComplete==100?c.RequestingUser.AssignedRolesForThisWorkflowStep.splice(tt,1):c.RequestingUser.AssignedRolesForThisWorkflowStep[tt]={Role:c.WorkflowStep.BwWorkflowTask_Table[p].bwAssignedToRaciRoleAbbreviation,RoleName:null,bwWorkflowTaskItemId:c.WorkflowStep.BwWorkflowTask_Table[p].bwWorkflowTaskItemId};break}if(c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(a=0;a<c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length;a++)if(c.WorkflowStep.BwWorkflowTask_Table[p].bwAssignedToRaciRoleAbbreviation==c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[a]){c.WorkflowStep.BwWorkflowTask_Table[p].bwStatus=="Completed"?c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.splice(a,1):c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[a]={Role:c.WorkflowStep.BwWorkflowTask_Table[p].bwAssignedToRaciRoleAbbreviation,RoleName:null,bwWorkflowTaskItemId:c.WorkflowStep.BwWorkflowTask_Table[p].bwWorkflowTaskItemId};break}}if(e&&e!="undefined"){for(a=0;a<c.RequestingUser.AssignedRolesForThisWorkflowStep.length;a++)if(e==c.RequestingUser.AssignedRolesForThisWorkflowStep[a].Role){c.WorkflowStep.AssignedRole={Role:c.RequestingUser.AssignedRolesForThisWorkflowStep[a].Role,RoleName:null,OnBehalfOf:!1,bwWorkflowTaskItemId:c.RequestingUser.AssignedRolesForThisWorkflowStep[a].bwWorkflowTaskItemId};c.WorkflowStep.Assign=s.Steps.Step[v].Assign;console.log("xcx23423-1 found matching role. Set RolesData.WorkflowStep.AssignedRole.Role: "+c.WorkflowStep.AssignedRole.Role+".");break}if(!c.WorkflowStep.AssignedRole.Role&&c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(a=0;a<c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length;a++)if(e==c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[a].Role){c.WorkflowStep.AssignedRole={Role:c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[a].Role,RoleName:null,OnBehalfOf:!0,bwWorkflowTaskItemId:c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[a].bwWorkflowTaskItemId};c.WorkflowStep.Assign=s.Steps.Step[v].Assign;console.log("xcx23423-2 found matching role. Set RolesData.WorkflowStep.AssignedRole: "+c.WorkflowStep.AssignedRole.Role+".");break}}else c.RequestingUser.AssignedRolesForThisWorkflowStep&&c.RequestingUser.AssignedRolesForThisWorkflowStep.length&&c.RequestingUser.AssignedRolesForThisWorkflowStep.length>0&&(c.WorkflowStep.AssignedRole={Role:c.RequestingUser.AssignedRolesForThisWorkflowStep[0].Role,RoleName:null,OnBehalfOf:!1,bwWorkflowTaskItemId:c.RequestingUser.AssignedRolesForThisWorkflowStep[0].bwWorkflowTaskItemId},c.WorkflowStep.Assign=s.Steps.Step[v].Assign,console.log("xcx23423-3 found role. Set RolesData.WorkflowStep.AssignedRole: "+c.WorkflowStep.AssignedRole.Role)),c.WorkflowStep.AssignedRole.Role||c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")&&c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep&&c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length&&c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length>0&&(console.log("xcx123123 pick the first one..."),c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[0]?(ct=c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[0].Role,lt=c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[0].bwWorkflowTaskItemId):(ct="ADMIN",lt=""),c.WorkflowStep.AssignedRole={Role:ct,RoleName:null,OnBehalfOf:!0,bwWorkflowTaskItemId:lt},c.WorkflowStep.Assign=s.Steps.Step[v].Assign,console.log("xcx23423-2 found matching role. Set RolesData.WorkflowStep.AssignedRole: "+c.WorkflowStep.AssignedRole.Role));if(c.WorkflowStep.AssignedRole.Role){if($("#"+r).find("#budgetrequestform")[0].setAttribute("bwworkflowtaskitemid",c.WorkflowStep.AssignedRole.bwWorkflowTaskItemId),s.Steps.Step[v].Assign&&s.Steps.Step[v].Assign.length)for(g=0;g<s.Steps.Step[v].Assign.length;g++){for(c.WorkflowStep.AssignedRole.Role==s.Steps.Step[v].Assign[g]["@Role"]&&(c.WorkflowStep.Assign=s.Steps.Step[v].Assign[g],c.WorkflowStep.AssignedRole.RoleName=c.WorkflowStep.Assign["@RoleName"]),a=0;a<c.RequestingUser.AssignedRolesForThisWorkflowStep.length;a++)if(c.RequestingUser.AssignedRolesForThisWorkflowStep[a].Role==s.Steps.Step[v].Assign[g]["@Role"]){c.RequestingUser.AssignedRolesForThisWorkflowStep[a].RoleName=s.Steps.Step[v].Assign[g]["@RoleName"];break}if(c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(a=0;a<c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length;a++)if(c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[a].Role==s.Steps.Step[v].Assign[g]["@Role"]){c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[a].RoleName=s.Steps.Step[v].Assign[g]["@RoleName"];break}}}else console.log("No roles have been asigned to this user."),b=c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN")?"No roles have been asigned to this user, but as an ADMIN you can edit this request.":"No roles have been asigned to this user. xcx666432.",$("#"+r).find("#budgetrequestform").find("#spanRequestForm_Instructions").html(b);pt={RequestingUser:c.RequestingUser,WorkflowAdmin:c.WorkflowAdmin,WorkflowStep:{AssignedRole:c.WorkflowStep.AssignedRole,AllRolesInThisWorkflowStep:c.WorkflowStep.AllRolesInThisWorkflowStep}};console.log("xcx3243 RolesData: "+JSON.stringify(pt));c.WorkflowStep.Assign?(c.WorkflowStep.Assign||alert("xcx112233 NO VALUE FOR RolesData.WorkflowStep.Assign HERE..??????"),k=c.WorkflowStep.Assign["@AllowRequestModifications"],console.log(""),console.log("%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%"),console.log("The user plays a role in the workflow. allowRequestModifications: "+k+", RolesData.WorkflowStep.Assign: "+JSON.stringify(c.WorkflowStep.Assign)),console.log("%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%"),console.log(""),at=c.WorkflowStep.Assign["@Role"],wt=c.WorkflowStep.Assign["@RoleName"],$.ajax({url:o.options.operationUriPrefix+"odata/UserRole2/"+f+"/"+at,dataType:"json",contentType:"application/json",type:"Get"}).done(function(t){var u,y,it,l,pt,ht,bt,ut,ft,b,et,p,tt,a,ct,f,h,ot,d,i,st,g,kt;try{var lt="",vt="",yt="";t.length>0&&(lt=t[0].bwParticipantId,vt=t[0].bwParticipantEmail,yt=t[0].bwParticipantFriendlyName);var dt={roleMember_participantId:lt,roleMember_participantEmail:vt,roleMember_participantFriendlyName:yt},gt=s.Steps.Step[v]["@Name"],it=s.Steps.Step[v]["@FriendlyName"];if(k&&k!="undefined"||(k=!1),u="",y="",it=s.Steps.Step[v]["@FriendlyName"]?s.Steps.Step[v]["@FriendlyName"]:s.Steps.Step[v]["@Name"],y+='<span style="font-weight:bold;">',y+='   <span xcx="342352-1-yy" style="cursor:pointer !important;text-decoration:underline;" title="View RACI workflow history..." onclick="$(\'.bwRequest\').bwRequest(\'displayRequestWorkflowAuditTrailDialog\', \''+n.BudgetRequest.Title+"', '"+String(n.BudgetRequest.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.BudgetRequest.bwRequestTypeId+"', '"+n.BudgetRequest.bwBudgetRequestId+"', '"+n.BudgetRequest.bwWorkflowId+"');\">",y+="       Workflow step: "+it,y+="   <\/span>",y+="<\/span>",y+="<br />",l="",n.RequestingUser.RoleIds.includes("ADMIN")||e){for(console.log("Role drop-down. THIS IS THE ONLY SPOT THIS SHOULD BE RENDERED. 10-7-2022"),l+="<select xcx=\"34234-1\" id=\"selectedRaciRole\" onchange=\"$('.bwRequest').bwRequest('selectedRaciRole_OnChange', this);\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 15pt;text-align: left;\" >",i=0;i<c.RequestingUser.AssignedRolesForThisWorkflowStep.length;i++)c.WorkflowStep.AssignedRole.Role==c.RequestingUser.AssignedRolesForThisWorkflowStep[i].Role?(c.RequestingUser.AssignedRolesForThisWorkflowStep[i].RoleName&&c.RequestingUser.AssignedRolesForThisWorkflowStep[i].Role||(c.RequestingUser.AssignedRolesForThisWorkflowStep[i].Role?c.RequestingUser.AssignedRolesForThisWorkflowStep[i].RoleName||(c.RequestingUser.AssignedRolesForThisWorkflowStep[i].Role=="ADMIN"?c.RequestingUser.AssignedRolesForThisWorkflowStep[i].RoleName="Workflow Administrator":alert("In xcx32536(). No RoleName value for Role: "+c.RequestingUser.AssignedRolesForThisWorkflowStep[i].Role)):alert("xcx1214-1 INVALID VALUE(S) FOR Role and/or RoleName while creating the role drop-down.")),l+='<option xcx="34234-1-1" style="font-size:30pt;" selected value="'+c.RequestingUser.AssignedRolesForThisWorkflowStep[i].Role+'" bwworkflowtaskitemid="'+c.RequestingUser.AssignedRolesForThisWorkflowStep[i].bwWorkflowTaskItemId+'"  xcx="xcx554-4">',l+=c.RequestingUser.AssignedRolesForThisWorkflowStep[i].RoleName+" ("+c.RequestingUser.AssignedRolesForThisWorkflowStep[i].Role+")",l+="<\/option>"):(pt="xcx2312 i: "+i+", RoleName/Role: "+c.RequestingUser.AssignedRolesForThisWorkflowStep[i].RoleName+" ("+c.RequestingUser.AssignedRolesForThisWorkflowStep[i].Role+")",console.log(pt),l+='<option xcx="34234-1-2" style="font-size:30pt;" value="'+c.RequestingUser.AssignedRolesForThisWorkflowStep[i].Role+'" bwworkflowtaskitemid="'+c.RequestingUser.AssignedRolesForThisWorkflowStep[i].bwWorkflowTaskItemId+'"  xcx="xcx554-4">',l+=c.RequestingUser.AssignedRolesForThisWorkflowStep[i].RoleName+" ("+c.RequestingUser.AssignedRolesForThisWorkflowStep[i].Role+")",l+="<\/option>",c.RequestingUser.AssignedRolesForThisWorkflowStep[i].RoleName&&c.RequestingUser.AssignedRolesForThisWorkflowStep[i].Role||alert("xcx1214-2 INVALID VALUES FOR Role and/or RoleName while creating the role drop-down."));if(c.RequestingUser.QualifyingRolesInThisOrg.includes("ADMIN"))for(i=0;i<c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep.length;i++)c.WorkflowStep.AssignedRole.Role==c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].Role?(l+='<option xcx="34234-1-3" style="font-size:30pt;" selected value="'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].Role+'" bwworkflowtaskitemid="'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].bwWorkflowTaskItemId+'"  xcx="xcx554-7">',l+='On behalf of "'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].RoleName+" ("+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].Role+')"',l+="<\/option>",c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].RoleName&&c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].Role||alert("xcx1214-3 INVALID VALUES FOR Role and/or RoleName while creating the role drop-down.")):(l+='<option xcx="34234-1-4" style="font-size:30pt;" value="'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].Role+'" bwworkflowtaskitemid="'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].bwWorkflowTaskItemId+'"  xcx="xcx554-7">',l+='On behalf of "'+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].RoleName+" ("+c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].Role+')"',l+="<\/option>",c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].RoleName&&c.WorkflowAdmin.OnBehalfOfRolesForThisWorkflowStep[i].Role||alert("xcx1214-4 INVALID VALUES FOR Role and/or RoleName while creating the role drop-down."));l+="<\/select>";k==!0?(u+='<table style="float:right;width:85%;">',u+="   <tr>",u+='       <td style="text-align:left;font-weight:normal;">',u+=y,u+="       <\/td>",u+="   <\/tr>",u+="   <tr>",u+='       <td style="text-align:left;font-weight:normal;">',u+="           Your role as "+c.WorkflowStep.Assign["@RoleCategory"]+": "+c.WorkflowStep.Assign["@Role"],u+='<div style="float:right">'+l+"<\/div>",u+="       <\/td>",u+="   <\/tr>",u+="   <tr>",u+="       <td>",u+="           You are allowed to modify this request.",u+="       <\/td>",u+="   <\/tr>",u+="<\/table>"):(u+='<table style="float:right;width:85%;">',u+="   <tr>",u+='       <td style="text-align:left;font-weight:normal;">',u+=y,u+="       <\/td>",u+="   <\/tr>",u+="   <tr>",u+='       <td style="text-align:left;font-weight:normal;">',u+="           Your role as "+c.WorkflowStep.Assign["@RoleCategory"]+": "+c.WorkflowStep.Assign["@Role"],u+='<div style="float:right">'+l+"<\/div>",u+="       <\/td>",u+="   <\/tr>",u+="   <tr>",u+="       <td>",u+="           You are not allowed to modify this request, but you can add comments.",u+="       <\/td>",u+="   <\/tr>",u+="<\/table>")}else l+="This user does not belong to a role present in this workflow step";if(u+="<br />",$("#"+r).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML=u,console.log(">>>>>>>>>>>>>>>>> The role drop-down has been displayed."),ht=$("#"+r).find("#selectedRaciRole")[0],bt=$(ht).find("option:selected").val(),bt?(ut=$(ht).find("option:selected").attr("bwworkflowtaskitemid"),ft=$("#"+r).find("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid"),ut&&ft&&ut==ft||displayAlertDialog("Unrecoverable error. Invalid values for bwWorkflowTaskItemId, either in the drop-down or in the form. selected_indropdown_bwWorkflowTaskItemId: "+ut+", form_bwWorkflowTaskItemId: "+ft+", request title: xcx21312, workflow step: "+it+", brData.BudgetRequest.bwRequestJson: "+JSON.stringify(n.BudgetRequest.bwRequestJson))):(alert("xcx12312-1 Error: The role drop-down does not have a selected value. This process cannot continue."),displayAlertDialog("Error: The role drop-down does not have a selected value. This process cannot continue.")),$("#"+r).find("#spanRequestForm_Error")[0].innerHTML="",$("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML="",c.WorkflowStep.Assign["@Checklists"]){for(b=c.WorkflowStep.Assign["@Checklists"],console.log("xcx31241 This workflow assignment has checklists. WorkflowStep_Assign_Checklists: "+JSON.stringify(b)),et=JSON.parse(n.BudgetRequest.bwRequestJson).Checklists,p=[],i=0;i<b.length;i++)if(et)for(h=0;h<et.length;h++)if(tt=JSON.parse(et[h]),tt.bwChecklistTemplatesId==b[i].bwChecklistTemplatesId){d={bwChecklistTemplatesId:tt.bwChecklistTemplatesId,html:"<span style=\"cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialogReadOnly', '"+tt.bwChecklistTemplatesId+"', '"+n.BudgetRequest.ProjectTitle+"', '"+n.BudgetRequest.Title+"', '"+n.BudgetRequest.bwRequestType+"', '"+n.BudgetRequest.bwBudgetRequestId+"', '"+n.BudgetRequest.bwWorkflowId+"', '"+w+"');\">"+tt.Title+"<\/span>"};p.push(d);break}for(a=[],i=0;i<b.length;i++){for(ct=!1,h=0;h<p.length;h++)if(b[i].bwChecklistTemplatesId==p[h].bwChecklistTemplatesId){ct=!0;break}if(ct!=!0)for(h=0;h<n.OrganizationChecklists.length;h++)b[i].bwChecklistTemplatesId==n.OrganizationChecklists[h].bwChecklistTemplatesId&&(ot=JSON.parse(n.OrganizationChecklists[h].ChecklistJson).Title,d={bwChecklistTemplatesId:n.OrganizationChecklists[h].bwChecklistTemplatesId,html:"<span style=\"cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialog', '"+n.OrganizationChecklists[h].bwChecklistTemplatesId+"', '"+String(n.BudgetRequest.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.BudgetRequest.Title+"', '"+n.BudgetRequest.bwRequestType+"', '"+n.BudgetRequest.bwBudgetRequestId+"', '"+n.BudgetRequest.bwWorkflowId+"', '"+w+"');\">"+ot+"<\/span>"},a.push(d))}if(f="",f+="<div>",o.options.Checklists=n.OrganizationChecklists,n.Checklists.length>0){for(f+=n.Checklists.length==1?"Checklist to be completed for this request: ":"Checklists to be completed for this request: ",f+="<ul>",alert("xcx213421 brData.Checklists: "+JSON.stringify(n.Checklists)),i=0;i<n.Checklists.length;i++)for(h=0;h<n.OrganizationChecklists.length;h++)n.Checklists[i].bwChecklistTemplatesId==n.OrganizationChecklists[h].bwChecklistTemplatesId&&(ot=JSON.parse(n.OrganizationChecklists[h].ChecklistJson).Title,d={bwChecklistTemplatesId:n.Checklists[i].bwChecklistTemplatesId,html:"<li style=\"cursor:pointer;text-decoration:underline;text-align:left;\" onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialog', '"+n.Checklists[i].bwChecklistTemplatesId+"', '"+String(n.BudgetRequest.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.BudgetRequest.Title+"', '"+n.BudgetRequest.bwRequestType+"', '"+n.BudgetRequest.bwBudgetRequestId+"', '"+n.BudgetRequest.bwWorkflowId+"', '"+w+"');\">"+ot+"<\/li>"},f+=d.html,o.options.Checklists.push(n.Checklists[i]));f+="<\/ul>";f+="<\/div>"}if(p.length>0||a.length>0||a.length>0){if(f+="<div>",p.length>0)for(f+=p.length==1?"Completed checklist: ":"Completed checklists: ",i=0;i<p.length;i++)f+="<span xcx=\"xcx99205476\" style=\"white-space:nowrap;text-decoration:underline;\" onclick=\"$('.bwRequest').bwRequest('RequestARevisionToThisChecklist', 'false', '');\" title=\"The Checklist has been updated. Do you wish to request a revision before this step is completed? and still in this step!\">",f+="&nbsp;"+p[i].html,f+="<\/span>",f+="<br />";if(a.length>0){for(f+='<img width="11" height="11" style="cursor:pointer;vertical-align:top;" alt="" src="/images/red-dot.png">',f+="&nbsp;",f+=a.length==1?"Complete the following checklist before you Approve: ":"Complete the following checklist(s) before you Approve: ",f+="<ul>",i=0;i<a.length;i++)f+='<li style="cursor:pointer;text-decoration:underline;text-align:left;" >'+a[i].html+"<\/li>";f+="<\/ul>";f+="<br />"}f+="<\/div>"}$("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML=f}o.renderRequestFormButtons(r,n.BudgetRequest.bwBudgetRequestId,n.BudgetRequest.bwRequestTypeId,"","xcx445566-7",!1,c.WorkflowStep.Assign,c.RequestingUser,dt,at,wt,gt,it,k,a);$("#"+r).find("#spanRequestForm_Instructions")[0].innerHTML="";u="";c.WorkflowStep.Assign&&c.WorkflowStep.Assign["@Instructions"]?(u+=c.WorkflowStep.Assign["@Instructions"],console.log("WORKFLOW HAD VALID INSTRUCTIONS.xcx2231-1")):console.log("In bwRequest.js.xx(). COULDNOTLOCATEVALIDINSTTRUCTIONS.xcx2232-1");a&&a.length>0&&(u+="Complete the required checklists before approving this request.",u+="<br />");u&&u!="undefined"&&(console.log(""),console.log("**********"),console.log("In bwRequest.js.renderRequestForm(). Displaying instructions from the workflow JSON in the request form header. instructions: "+u),console.log("**********"),console.log(""),$("#"+r).find("#spanRequestForm_Instructions")[0].innerHTML=u,console.log("The instructions have been displayed."));rt.closeoutsEnabled==!0&&(st="",st+="<br />",st+="<span style=\"text-decoration:underline;cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displayCloseoutInDialog', '"+n.BudgetRequest.bwBudgetRequestId+"', '"+n.BudgetRequest.bwRequestTypeId+"', '"+n.BudgetRequest.Title+'\');" xcx="xcx2134213-2" >[spanViewCloseoutButtonPlaceholder] View closeout.<\/span>',$("#"+r).find("#spanRequestForm_Instructions")[0].innerHTML+=st);rt.supplementalsEnabled==!0&&(g="",g+="<br />",g+="<span style=\"text-decoration:underline;cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displaySupplementalInDialog', '"+n.BudgetRequest.bwBudgetRequestId+"', '"+n.BudgetRequest.bwRequestTypeId+"', '"+n.BudgetRequest.Title+'\');" xcx="xcx2134213" >[list of supplementals]<\/span>',g+="<br />",g+="<span style=\"text-decoration:underline;cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displaySupplementalInDialog', '"+n.BudgetRequest.bwBudgetRequestId+"', '"+n.BudgetRequest.bwRequestTypeId+"', '"+n.BudgetRequest.Title+'\');" xcx="xcx2134213" >[spanCreateSupplementalRequestButtonPlaceholder]<\/span>',$("#"+r).find("#spanRequestForm_Instructions")[0].innerHTML+=g);console.log("Calling populateRequestForm(). xcx3452-2-2 brData.BudgetRequest.bwRequestJson: "+JSON.stringify(n.BudgetRequest.bwRequestJson));kt=o.populateRequestForm(r,n.BudgetRequest.bwRequestJson,k);kt.then(function(){var i,f,e;try{if(i=document.getElementById("myCanvas"),i){var t=document.getElementsByTagName("body")[0],o=t.scrollWidth,s=Math.max(t.scrollHeight,document.documentElement.scrollHeight,t.offsetHeight,document.documentElement.offsetHeight,t.clientHeight,document.documentElement.clientHeight,t.scrollHeight,t.getBoundingClientRect().height);i.width=o;i.height=s}f=$("#"+r).dialog().closest(".ui-dialog").offset();f.left<0&&(console.log("THE AR DIALOG has been displayed too far to the left. xcxRepositioning here...xcx23214-2 left: "+f.left),$("#"+r).dialog({position:{my:"center top",at:"center top","of":window}}));try{window.opener&&(e="divRequestFormDialog_"+n.BudgetRequest.bwBudgetRequestId,console.log("xcx999334-2 Should be closing dialog window.opener.dialogId: "+e),window.opener.$("#"+e).dialog("close"))}catch(u){}}catch(u){console.log("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-4: "+u.message+", "+u.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-4: "+u.message+", "+u.stack)}})}catch(nt){console.log("Exception in bwRequest.js.renderRequestForm.UserRole2.done(): "+nt.message+", "+nt.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.UserRole2.done(): "+nt.message+", "+nt.stack);alert("Exception in bwRequest.js.renderRequestForm.UserRole2.done(): "+nt.message+", "+nt.stack)}}).fail(function(n){var t;t=JSON.stringify(n).indexOf("The specified URL cannot be found.")>-1?"There has been an error contacting the server. A firewall or network appliance may be interrupting this traffic.":JSON.stringify(n);displayAlertDialog("Error in bwRequest.js.renderRequestForm.UserRole2.fail():3: "+t);console.log("Error in bwRequest.js.renderRequestForm.UserRole2.fail():3: "+JSON.stringify(n));alert("Error in bwRequest.js.renderRequestForm.UserRole2.fail():3: "+t)})):(nt=o.populateRequestForm(r,n.BudgetRequest.bwRequestJson,k),nt.then(function(){var f,a,t,p,e,i,h,y;try{if(f=document.getElementById("myCanvas"),f){var u=document.getElementsByTagName("body")[0],b=u.scrollWidth,k=Math.max(u.scrollHeight,document.documentElement.scrollHeight,u.offsetHeight,document.documentElement.offsetHeight,u.clientHeight,document.documentElement.clientHeight,u.scrollHeight,u.getBoundingClientRect().height);f.width=b;f.height=k}if(a="",a+='<button xcx="xcx4242-2" onclick="$(\'#'+r+'\').dialog(\'close\');" class="BwButton200ForRequestForm" title="Close">Close<\/button>&nbsp;',o.renderRequestFormButtons(r,n.BudgetRequest.bwBudgetRequestId,n.BudgetRequest.bwRequestTypeId,a,"xcx445566-6-1",!1,c.WorkflowStep.Assign),t="",p=s.Steps.Step[v]["@FriendlyName"]?s.Steps.Step[v]["@FriendlyName"]:s.Steps.Step[v]["@Name"],t+='<span style="font-weight:bold;">',t+='   <span xcx="342352-1-2" style="cursor:pointer !important;text-decoration:underline;" title="View RACI workflow history..." onclick="$(\'.bwRequest\').bwRequest(\'displayRequestWorkflowAuditTrailDialog\', \''+n.BudgetRequest.Title+"', '"+String(n.BudgetRequest.ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.BudgetRequest.bwRequestTypeId+"', '"+n.BudgetRequest.bwBudgetRequestId+"', '"+n.BudgetRequest.bwWorkflowId+"');\">",t+="       Workflow step: "+p,t+="   <\/span>",t+="<\/span>",t+="<br />",$("#"+r).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML=t,displayAlertDialog("xcx987070-3 Display the checklists here... 10-25-2022"),e=JSON.parse(n.BudgetRequest.bwRequestJson).Checklists,e){for(i="",i+="Completed checklist(s):",i+="<br />",h=0;h<e.length;h++)y=JSON.parse(e[h]),i+='<span xcx="xcx8822567" style="cursor:pointer;text-decoration:underline;" ',i+="onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialogReadOnly', '"+y.bwChecklistTemplatesId+"', '"+n.BudgetRequest.ProjectTitle+"', '"+n.BudgetRequest.Title+"', '"+n.BudgetRequest.bwRequestType+"', '"+n.BudgetRequest.bwBudgetRequestId+"', '"+n.BudgetRequest.bwWorkflowId+"', '"+w+"');\">"+y.Title+"<\/span>",i+="<br />";$("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML=i}else $("#"+r).find("#spanRequestForm_Checklists")[0].innerHTML=""}catch(l){console.log("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-3: "+l.message+", "+l.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm.populateRequestForm.then():xcx21312-3: "+l.message+", "+l.stack)}}))}bt={bwTenantId:tenantId,bwWorkflowAppId:f,bwParticipantId:u,bwParticipantEmail:participantEmail,bwParticipantFriendlyName:participantFriendlyName,bwEnabledRequestTypes:ut,bwOrgId:w,bwOrgName:it};kt=$("#"+r).find("#divBwLocationPicker").bwLocationPicker(bt)}}catch(ot){console.log("Exception in bwRequest.js.renderRequestForm():21-1:requestDialogId: "+r+", "+ot.message+", "+ot.stack);displayAlertDialog_Persistent("Exception in bwRequest.js.renderRequestForm():21-1:requestDialogId: "+r+", "+ot.message+", "+ot.stack)}})}}catch(c){console.log("Exception in bwRequest.js.renderRequestForm():265: "+c.message+", "+c.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm():265: "+c.message+", "+c.stack)}}})):(alert("Error in renderRequestForm(). Unexpected value(s) for brData.BudgetRequest.bwWorkflowAppId: "+!n.BudgetRequest.bwWorkflowAppId+", brData.BudgetRequest.bwBudgetRequestId: "+n.BudgetRequest.bwBudgetRequestId),displayAlertDialog("Error in renderRequestForm(). Unexpected value(s) for brData.BudgetRequest.bwWorkflowAppId: "+!n.BudgetRequest.bwWorkflowAppId+", brData.BudgetRequest.bwBudgetRequestId: "+n.BudgetRequest.bwBudgetRequestId))}catch(s){console.log("Exception in bwRequest.js.renderRequestForm(): "+s.message+", "+s.stack);displayAlertDialog("Exception in bwRequest.js.renderRequestForm(): "+s.message+", "+s.stack)}},displayCreateRequestForm:function(n){var t,e,o,i,r,s,f;try{console.log("In bwRequest.js.displayCreateRequestForm(). bwRequestTypeId: "+n);t=this;e=$(".bwAuthentication").bwAuthentication("option","participantId");try{$("#FormsEditorToolbox").dialog("close")}catch(u){}$("#divBwCircleDialog").bwCircleDialog("setWidgetOptionValue","OnResizeDisplayValues",null);n||(n=$(".bwAuthentication").bwAuthentication("option","LastSelected_bwRequestTypeId"),n||(o=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes"),i=o.EnabledItems[0],n=i.bwRequestTypeId),console.log("In bwRequest.js.displayCreateRequestForm(). Setting bwRequestTypeId to LastSelected_bwRequestTypeId: "+n));e?(r=document.getElementById("myCanvas"),r&&(s=r.getContext("2d"),s.clearRect(0,0,r.width,r.height),r.style.zIndex=-1),console.log("In bwRequest.js.displayCreateRequestForm(). xcx235-1 getting ready to call getRequestFormHtml(). bwRequestTypeId: "+n),f=this.getRequestFormHtml(n,!1,null,"xcx23452-7"),f.then(function(r){var s,h,c,l,a,e,o,f,v;try{if(r.status!="SUCCESS")s="Error in bwRequest.js.displayCreateRequestForm(): "+r.status+", "+r.message,console.log(s),displayAlertDialog(s);else if(console.log("We were displaying the form here with displayAlertDialog() or some reason. I commented it out. 7-10-2023."),console.log("xcx2131234-2 populating [divPageContent1]."),console.log("xcx2131234-2 populating [divPageContent1]."),console.log("xcx2131234-2 populating [divPageContent1]."),$("#divPageContent1").html(r.html),h=$("#divPageContent1").find(".budgetrequestform")[0],$(h).attr("bwrequesttitle","New"),c=$(".bwAuthentication").bwAuthentication("option","developerModeEnabled"),c==!0&&(l='<div id="xcx11111" style="float:left;vertical-align:top;">PIN AND ELLIPSES<\/div>',$("#divPageContent1").prepend(l)),console.log("In bwRequest.js.displayCreateRequestForm(). Setting form element xdFormLayout width to 750px."),document.getElementsByClassName("xdFormLayout")[0].style.width="750px",e=$(".bwAuthentication").bwAuthentication("getUrlParams").openrequest,e&&e.toString()&&e.toString().split("#")[0]&&(a=$(".bwAuthentication").bwAuthentication("getUrlParams").openrequest.toString().split("#")[0]),a){try{console.log("UUUUUUUUUUUUUUUUUUUUUUUUUUUUU xcx213123-1");console.log("xcx234324324-6 getUrlParams [request]");console.log("UUUUUUUUUUUUUUUUUUUUUUUUUUUUU  xcx213123-2");o=$(".bwAuthentication").bwAuthentication("getUrlParams").request.toString().split("#")[0]}catch(u){}try{f=$(".bwAuthentication").bwAuthentication("getUrlParams").taskid.toString().split("#")[0]}catch(u){}console.log("Calling scrapeBwRequestJson() of window.opener.. xcx23436-1 bwBudgetRequestId: "+o+", bwRequestTypeId: "+i.bwRequestTypeId+", bwWorkflowTaskItemId: "+f);console.log("Calling bwRequest.js.scrapeBwRequestJson(). xcx1231242-3");v=window.opener.$(".bwRequest").bwRequest("scrapeBwRequestJson",o);v.then(function(i){try{alert("Returning from scrapeBwRequestJson(). xcx2131241-3");var u="divRequestFormDialog_"+o;alert("xcx999334-1 Should be closing dialog dialogId: "+u);f?(console.log("Calling populateRequestForm for a popped-out window.... bwWorkflowTaskItemId: "+f+", bwRequestJson: "+JSON.stringify(i)),t.populateRequestForm("divPageContent1",JSON.stringify(i),!0)):(console.log("Calling populateNewRequestForm for a popped-out window.... bwWorkflowTaskItemId: "+f+", bwRequestJson: "+JSON.stringify(i)),t.populateNewRequestForm("divPageContent1",n,JSON.stringify(i)))}catch(r){console.log("Exception in displayCreateRequestForm.scrapeBwRequestJson(): "+r.message+", "+r.stack);displayAlertDialog("Exception in displayCreateRequestForm.scrapeBwRequestJson(): "+r.message+", "+r.stack);document.getElementById("txtDisplayJsonDialogJSON").innerHTML="Exception in displayCreateRequestForm.scrapeBwRequestJson(): "+r.message+", "+r.stack}}).catch(function(n){console.log("In displayCreateRequestForm(). Promise returned exception: "+n.message);displayAlertMessage("In displayCreateRequestForm(). Promise returned exception: "+n.message)})}else console.log('In bwRequest.js.displayCreateRequestForm(). Calling populateNewRequestForm() to display the New Request screen. The user must have clicked the "New Request" button in the left menu.'),t.populateNewRequestForm("divPageContent1",n)}catch(u){console.log("Exception in displayCreateRequestForm(): "+u.message+", "+u.stack);alert("Exception in displayCreateRequestForm(): "+u.message+", "+u.stack);document.getElementById("divPageContent1").innerHTML="Exception in displayCreateRequestForm(): "+u.message+", "+u.stack;document.getElementById("divRequestFormDialogContent").innerHTML="Exception in displayCreateRequestForm(): "+u.message+", "+u.stack}})):(displayAlertDialog("xcx235-2 getting ready to call getRequestFormHtml(). bwRequestTypeId: "+n+", participantId: "+e),f=this.getRequestFormHtml(n,!1,null,"xcx23452-8"),f.then(function(n){try{n.message!=null?(document.getElementById("divPageContent1").innerHTML=n.message,document.getElementById("divRequestFormDialogContent").innerHTML=n.message):i=="offlinerequest"?(document.getElementById("ArDialog").innerHTML=n.html,alert("xcx3253634758"),alert("Calling populateNewRequestForm_IndexDb(). xcx23436-1"),t.populateNewRequestForm_IndexDb("ArDialog",i)):(document.getElementById("divPageContent1").innerHTML=n.html,document.getElementById("divRequestFormDialogContent").innerHTML=n.html,alert("Calling populateNewRequestForm(). xcx23436-2"),t.populateNewRequestForm("divPageContent1",i))}catch(r){console.log("Exception in displayCreateRequestForm(): "+r.message+", "+r.stack);document.getElementById("divPageContent1").innerHTML="Exception in displayCreateRequestForm(): "+r.message+", "+r.stack;document.getElementById("divRequestFormDialogContent").innerHTML="Exception in displayCreateRequestForm(): "+r.message+", "+r.stack}}))}catch(u){console.log("Exception in displayCreateRequestForm(): "+u.message+", "+u.stack);displayAlertDialog("Exception in displayCreateRequestForm(): "+u.message+", "+u.stack)}},displayCreateRequestFormForMobile:function(n){var i,t,r,u;try{console.log("In displayCreateRequestFormForMobile().");alert("In displayCreateRequestFormForMobile().");i=this;participantId?(t=document.getElementById("myCanvas"),t&&(r=t.getContext("2d"),r.clearRect(0,0,t.width,t.height),t.style.zIndex=-1),alert("xcx235-3 getting ready to call getRequestFormHtml(). bwRequestType: "+n),u=this.getRequestFormHtml(n.bwRequestTypeId,!1,null,"xcx23452-9"),u.then(function(t){try{t.message!=null?document.getElementById("welcomePageNewRequestTab").innerHTML=t.message:(document.getElementById("welcomePageNewRequestTab").innerHTML=t.html,alert("Calling populateNewRequestForm(). xcx23436-3"),i.populateNewRequestForm("welcomePageNewRequestTab",n))}catch(r){console.log("Exception in displayCreateRequestFormForMobile(): "+r.message+", "+r.stack);document.getElementById("welcomePageNewRequestTab").innerHTML="Exception in displayCreateRequestFormForMobile(): "+r.message+", "+r.stack}})):(this.renderCreateRequestFullFormOffline(),this.renderNewRequestForm())}catch(f){console.log("Exception in displayCreateRequestFormForMobile(): "+f.message+", "+f.stack)}},initializeRequestFormWidgets:function(n,t,i,r,u,f){var g,a,v,w,y,o,b,e,c,l,k,h,d,s;try{if(console.log("In bwRequest.js.initializeRequestFormWidgets(). formWidget_CustomRenderingInstructions: "+JSON.stringify(u)),f&&f==!0){for(a=[],v=$(n).find(".ToggleRequiredAsterisk-On"),e=0;e<v.length;e++)w=v[e].closest(".xdTableOffsetRow").getAttribute("bwwidgetname"),a.push(w);for(y=$(n).find("[bwwidgetname]"),o=[],e=0;e<y.length;e++)b=y[e].getAttribute("bwwidgetname"),o.push(b);for(console.log("In bwRequest.js.initializeRequestFormWidgets(). Found these form elements in xcx123123123: "+JSON.stringify(o)),e=0;e<o.length;e++)if(c=$(n).find('[bwwidgetname="'+o[e]+'"]'),l=!1,a.indexOf(o[e])>-1&&(l=!0),k='{"'+o[e]+'": 0}',h=JSON.parse(k),h.bwWorkflowAppId=t.bwWorkflowAppId,h.bwBudgetRequestId=t.bwBudgetRequestId,console.log("In bwRequest.js.initializeRequestFormWidgets(). COMMENTED THIS LINE OUT 11- 7-2023. xcx2131313123."),h[o[e]]=t[o[e]],console.log("In bwRequest.js.initializeRequestFormWidgets(). Instantiating widget "+o[e]+" with jsonData: "+JSON.stringify(h)),d={displayContext:"form",jsonData:h,allowRequestModifications:i,bwRequestJson:t,renderAsARequiredField:l,customRenderingInstructions:u},g=o[e],o[e])try{$(c)[o[e]](d)}catch(p){s="xcx1234234235-2 Failed to instantiate widget for elementForInstantiatingTheWidget.length: "+c.length+", invoking widget widgetNames[i]: ["+o[e]+"]. elementForInstantiatingTheWidget.html(): "+$(c)[0].outerHTML+". I think this error only happens on the Ipad 2<<<<<<<<!! We need to figure out how to dynamiccally call/instantiate a widget on Safari Ipad 2. Exception: "+p.message+", "+p.stack;console.log(s);displayAlertDialog(s)}else s="In bwRequest.js.initializeRequestFormWidgets(). Invalid value for widgetNames[i]: "+o[e],console.log(s),displayAlertDialog(s)}else{for(a=[],v=$("#"+n).find(".ToggleRequiredAsterisk-On"),e=0;e<v.length;e++)w=v[e].closest(".xdTableOffsetRow").getAttribute("bwwidgetname"),a.push(w);for(y=$("#"+n).find("[bwwidgetname]"),o=[],e=0;e<y.length;e++)b=y[e].getAttribute("bwwidgetname"),o.push(b);for(console.log("In bwRequest.js.initializeRequestFormWidgets(). Found these form elements in requestDialogId: "+n+", "+JSON.stringify(o)),e=0;e<o.length;e++)if(c=$("#"+n).find('[bwwidgetname="'+o[e]+'"]'),l=!1,a.indexOf(o[e])>-1&&(l=!0),k='{"'+o[e]+'": 0}',h=JSON.parse(k),h.bwWorkflowAppId=t.bwWorkflowAppId,h.bwBudgetRequestId=t.bwBudgetRequestId,h.requestDialogId=n,h[o[e]]=t[o[e]],console.log("In bwRequest.js.initializeRequestFormWidgets(). Instantiating widget "+o[e]+" with jsonData: "+JSON.stringify(h)),d=u&&u[0].bwInvoiceGrid.CustomRenderingInstruction=="RENDER_FOR_PRINTED_INVOICE"?{displayContext:"printed_invoice1",jsonData:h,allowRequestModifications:i,bwRequestJson:t,renderAsARequiredField:l,customRenderingInstruction:u[0].bwInvoiceGrid.CustomRenderingInstruction}:{displayContext:"form",jsonData:h,allowRequestModifications:i,bwRequestJson:t,renderAsARequiredField:l,customRenderingInstructions:u},g=o[e],o[e])try{$(c)[o[e]](d)}catch(p){s="xcx1234234235-1 Failed to instantiate widget for elementForInstantiatingTheWidget.length: "+c.length+", invoking widget widgetNames[i]: ["+o[e]+"]. elementForInstantiatingTheWidget.html(): "+$(c)[0].outerHTML+". I think this error only happens on the Ipad 2<<<<<<<<!! We need to figure out how to dynamiccally call/instantiate a widget on Safari Ipad 2. Exception: "+p.message+", "+p.stack;console.log(s)}else s="In bwRequest.js.initializeRequestFormWidgets(). Invalid value for widgetNames[i]: "+o[e],console.log(s),displayAlertDialog(s)}}catch(p){s="Exception in bwRequest.js.initializeRequestFormWidgets(). It is possible that the bwFormHtml is trying to instantiate a form widget which no longer exists, or has been renamed. >>>>> erroredElementName: ["+g+']. To validate that this is an issue and to fix it, go to "Configuration > Forms" with the role of "Configuration Manager": '+p.message+", "+p.stack;console.log(s);displayAlertDialog(s);f!=!0?$("#"+n).find("#spanRequestForm_Error")[0].innerHTML=s:$(n).find("#spanRequestForm_Error")[0].innerHTML=s}},populateNewRequestForm:function(){var a,i,f,y,r,u,t,p;try{console.log("In bwRequest.js.populateNewRequestForm().");var s=this,w=!1,c=$(document).find(".budgetrequestform"),n;for(t=0;t<c.length;t++)if(a=$(c[t]).attr("bwrequesttitle"),a=="New"){w=!0;n=c[t];break}if(n){var l=$(n).attr("bwrequesttitle"),e=$(n).attr("bwrequesttypeid"),o=$(".bwAuthentication").bwAuthentication("option","NEW_REQUEST_LastSavedJson"),v;for(v=o?o:{},o&&(i=o.bwBudgetRequestId,$(n).attr("bwbudgetrequestid",i)),console.log("In bwRequest.js.populateNewRequestForm(). xcx21312312-1 should we be calling populateAttachments here?<<<<<<<<<<<<<< bwRequestTitle: "+l+", bwRequestTypeId: "+e+", bwBudgetRequestId: "+i),l=="New"&&e&&i?console.log("FOUND THE NEW REQUEST form. It has already been initialized. MORE CODING TO DO HERE. bwBudgetRequestId: "+i+", lastSavedJson: "+JSON.stringify(o)):l=="New"&&e&&!i?(f="In bwRequest.js.populateNewRequestForm(). INITIALIZING the NEW REQUEST form here.",console.log(f),i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),$(n).attr("bwbudgetrequestid",i)):alert("Error in xx(). xcx21312423. Invalid values for ther NEW REQUEST form. Fatal error."),this.initializeRequestFormWidgets(n,v,!0,null,null,!0),$(n).find("#spanViewWorkflowParticipantsLink").html(""),$(n).find("#spanRequestForm_WorkflowAndRoleDetails").html(""),$(n).find("#spanRequestForm_Checklists").html(""),$(n).find("#spanRequestForm_Error").html(""),$(n).find("#spanRequestForm_Instructions").html('Complete the form then click the "Submit" button.'),r="",console.log("COMMENTED THIS OUT 3-4-2024. <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< COMMENTED OUT THE INITIAL FORM BUTTONS. Is this ok? so far..."),y={bwBudgetRequestId:i,bwRequestTypeId:e},s.renderRequestFormButtons(n,y,null,r,"xcx445566-8",!0),r="",u=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems,console.log("DEV: Need to work on bwRequestTypeId integration here a bit more..."),console.log("Create the request type select element/drop down box. xcx1"),r+='<span style="font-size: 200%;"><strong>New <\/strong>',r+='   <select id="selectNewRequestFormRequestTypeDropDown" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1em; font-weight: bold; cursor: pointer;\'>',t=0;t<u.length;t++)r+=u[t].bwRequestTypeId==e?'<option value="'+u[t].bwRequestTypeId+'" selected >'+u[t].SingletonName+"<\/option>":'<option value="'+u[t].bwRequestTypeId+'" >'+u[t].SingletonName+"<\/option>";r+="   <\/select>";r+="<\/span>";$(n).find("#spanRequestForm_Title").html(r);$(n).find("#selectNewRequestFormRequestTypeDropDown").change(function(){try{console.log("In selectNewRequestFormRequestTypeDropDown.change(). xcx12346-1-1");var r=s.scrapeBwRequestJson(i);r.then(function(t){var f,r,o,h,c;try{if(t.status!="SUCCESS")f="Error in bwRequest.js.populateNewRequestForm.bwRequest.scrapeBwRequestJson():2. "+t.status+": "+t.message,console.log(f),displayAlertDialog(f);else{r=$(n).find("#spanRequestForm_Error")[0];r?($(r).html("Saving..."),setTimeout(function(){$(r).html("&nbsp;")},4e3)):alert("xcx1231231 UPDATING/SAVING bwRequestJson: "+JSON.stringify(t.bwRequestJson));$(".bwAuthentication").bwAuthentication("option","NEW_REQUEST_LastSavedJson",t.bwRequestJson);$("#divTopBar_Long").html("");var l=$(n).find("#selectNewRequestFormRequestTypeDropDown option:selected").text(),e=$(n).find("#selectNewRequestFormRequestTypeDropDown option:selected").val(),i={Abbreviation:e,RequestType:l,bwRequestTypeId:e};console.log("In selectNewRequestFormRequestTypeDropDown.change(). requestType: "+JSON.stringify(i));o=$(".bwAuthentication").bwAuthentication("option","participantId");h=$(".bwAuthentication").bwAuthentication("option","workflowAppId");data={bwParticipantId:o,bwWorkflowAppId:h,LastSelected_bwRequestTypeId:i.bwRequestTypeId};c=webserviceurl+"/bwparticipant/updateuserconfigurationselectednewrequestscreenrequesttype";$.ajax({url:c,type:"POST",data:data,headers:{Accept:"application/json; odata=verbose"},success:function(t){var u,f;try{if(t.status!="SUCCESS")u="Error in bwRequest.js.populateNewRequestForm.selectNewRequestFormRequestTypeDropDown.change.updateuserconfigurationselectednewrequestscreenrequesttype.success(). "+t.status+", "+t.message,console.log(u),displayAlertDialog(u);else{$(".bwAuthentication").bwAuthentication("option","LastSelected_bwRequestTypeId",i.bwRequestTypeId);$(n).attr("bwrequesttypeid",i.bwRequestTypeId);s.displayCreateRequestForm(i.bwRequestTypeId);f=$(".bwAuthentication").bwAuthentication("option","NEW_REQUEST_LastSavedJson");s.populateNewRequestForm("divPageContent1",i.bwRequestTypeId,JSON.stringify(f));try{i.Abbreviation=="recurringexpense"?($(n).find("#trNewRequestRecurringExpenseSection").show(),$(n).find("#dtRecurringExpenseReminderDate").datepicker()):$(n).find("#trNewRequestRecurringExpenseSection").hide()}catch(r){$(n).find("#spanRequestForm_Error")[0].innerHTML="Exception in populateNewRequestForm():xcx3: "+r.message+", "+r.stack;displayAlertDialog("Exception in populateNewRequestForm():xcx3: "+r.message+", "+r.stack)}}}catch(r){console.log("Exception in selectNewRequestFormRequestTypeDropDown.change():2: "+r.message+", "+r.stack);$(n).find("#spanRequestForm_Error")[0].innerHTML="Exception in selectNewRequestFormRequestTypeDropDown.change():2: "+r.message+", "+r.stack;displayAlertDialog("Exception in selectNewRequestFormRequestTypeDropDown.change():2: "+r.message+", "+r.stack)}},error:function(t,i,r){console.log("Error in selectNewRequestFormRequestTypeDropDown.change(): "+i+" "+r);displayAlertDialog("Error in selectNewRequestFormRequestTypeDropDown.change(): "+i+" "+r);$(n).find("#spanRequestForm_Error")[0].innerHTML="Error in selectNewRequestFormRequestTypeDropDown.change(): "+i+" "+r}})}}catch(u){console.log("Exception in timedCheckForAlertsForIosBadgeUpdateUsingTitle():8: "+u.message+", "+u.stack);displayAlertDialog("Exception in timedCheckForAlertsForIosBadgeUpdateUsingTitle():8: "+u.message+", "+u.stack)}}).catch(function(n){console.log("Exception in timedCheckForAlertsForIosBadgeUpdateUsingTitle():7: "+JSON.stringify(n));displayAlertDialog("Exception in timedCheckForAlertsForIosBadgeUpdateUsingTitle():7: "+JSON.stringify(n))})}catch(t){console.log("Exception in selectNewRequestFormRequestTypeDropDown.change(): "+t.message+", "+t.stack);$(n).find("#spanRequestForm_Error")[0].innerHTML="Exception in selectNewRequestFormRequestTypeDropDown.change(): "+t.message+", "+t.stack;displayAlertDialog("Exception in selectNewRequestFormRequestTypeDropDown.change(): "+t.message+", "+t.stack)}});p=$(n).find("#spanNewRequestEllipsesButton")[0];$(p).on("click",function(n){n.preventDefault();n.stopImmediatePropagation();$(this).contextMenu()})}else f="In bwRequest.js.populateNewRequestForm(). Could not find an existing NEW REQUEST form. This method must have been called by mistake.",console.log(f),displayAlertDialog(f)}catch(h){console.log("Exception in populateNewRequestForm(): "+h.message+", "+h.stack);displayAlertDialog("Exception in populateNewRequestForm(): "+h.message+", "+h.stack)}},populateNewRequestForm_IndexDb:function(n,t){var f,e,i,r,s,u,h;try{if(console.log("In bwRequest.js.populateNewRequestForm_IndexDb()."),alert("In bwRequest.js.populateNewRequestForm_IndexDb(). Should we be in displayRequestFormDialog()?"),f=this,alert("In bwRequest.js.populateNewRequestForm_IndexDb()."),$("#"+n).find("#budgetrequestform")[0].setAttribute("bwbudgetrequestid",t.bwBudgetRequestId),$("#"+n).find("#budgetrequestform")[0].setAttribute("bwrequesttitle","New"),$("#"+n).find("#budgetrequestform")[0].setAttribute("bworgid",t.bwOrgId),$("#"+n).find("#budgetrequestform")[0].setAttribute("bworgname",t.bwOrgName),t&&t.bwRequestTypeId?(e=t.bwRequestTypeId,console.log("SETTING FORM ATTRIBUTE bwRequestTypeId: "+e),$("#"+n).find("#budgetrequestform")[0].setAttribute("bwrequesttypeid",e)):(console.log("NO bwRequestJson.bwRequestTypeId <<<<<<<<<<<<<<<<<<<<<<<<<"),$("#"+n).find("#budgetrequestform")[0].setAttribute("bwrequesttypeid","")),f.initializeRequestFormWidgets(n,t,!0,!0),$("#"+n).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML="",$("#"+n).find("#spanRequestForm_Checklists")[0].innerHTML="",$("#"+n).find("#spanRequestForm_Instructions")[0].innerHTML='Complete the form then click the "Submit" button.',i="",i+="                        <button onclick=\"$('.bwRequest').bwRequest('saveRequestOnThisDevice', '"+t.bwBudgetRequestId+'\');" title="Save on this device." class="BwButton250ForRequestForm">Save (on this device)<\/button>',i+="                        &nbsp;",i+='                        <button name="startWorkflowButton" xcx="xcx22354235-4" id="startWorkflowButton" onclick="$(\'.bwRequest\').bwRequest(\'cmdCreateBudgetRequestAndStartWorkflow\', \''+t.bwBudgetRequestId+'\');" class="BwButton200ForRequestForm" title="Click here to Submit the request.">Submit<\/button>',i+="                        &nbsp;",i+="                        <button onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\" class=\"BwButton200ForRequestForm\">Cancel<\/button>",f.renderRequestFormButtons(n,t.bwBudgetRequestId,t.bwBudgetRequestId,i,"xcx445566-9",!0),i="",r=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems,r.length==1)s=r[0].bwRequestTypeId,i+='<span style="font-size: 200%;"><strong>New <\/strong><span style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1em; font-weight: bold; cursor: pointer;\'>'+s+"<\/span><\/span>",i+='&nbsp;&nbsp;<span xcx="xcx3567-4" id="spanNewRequestEllipsesButton" class="spanButton2 context-menu-newrequesteditor" style="height:20px;width:150px;"> ... <\/span>',$("#"+n).find("#spanRequestForm_Title")[0].innerHTML=i;else{for(console.log("DEV: Need to work on bwRequestTypeId integration here a bit more..."),console.log("Create the request type select element/drop down box. xcx2"),i+='<span style="font-size: 200%;"><strong>New <\/strong>',i+='   <select id="selectNewRequestFormRequestTypeDropDown" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1em; font-weight: bold; cursor: pointer;\'>',i+=e?'<option value="" >Select a request type...<\/option>':'<option value="" selected >Select a request type...<\/option>',u=0;u<r.length;u++)i+=e?r[u].bwRequestTypeId==e?'<option value="'+r[u].bwRequestTypeId+'" selected >'+r[u].SingletonName+"<\/option>":'<option value="'+r[u].bwRequestTypeId+'" >'+r[u].SingletonName+"<\/option>":'<option value="'+r[u].bwRequestTypeId+'" >'+r[u].SingletonName+"<\/option>";i+="   <\/select>";i+="<\/span>";i+='<span style="font-size: 200%;">&nbsp;<span xcx="xcx3567-5" id="spanNewRequestEllipsesButton" class="spanButton2 context-menu-newrequesteditor" style="height:20px;width:150px;"> ... <\/span><\/span>';$("#"+n).find("#spanRequestForm_Title")[0].innerHTML=i;$("#"+n).find("#selectNewRequestFormRequestTypeDropDown").change(function(){var e,o,s;try{console.log("In selectNewRequestFormRequestTypeDropDown.change(). Is this old code??? xcx12346-1-2");$("#divTopBar_Long").html("");var u=$("#"+n).find("#selectNewRequestFormRequestTypeDropDown option:selected").val(),h=$("#"+n).find("#selectNewRequestFormRequestTypeDropDown option:selected").text(),i={Abbreviation:u,RequestType:h,bwRequestTypeId:u};console.log("In selectNewRequestFormRequestTypeDropDown.change(). requestType: "+JSON.stringify(i));e=$(".bwAuthentication").bwAuthentication("option","participantId");o=$(".bwAuthentication").bwAuthentication("option","workflowAppId");data={bwParticipantId:e,bwWorkflowAppId:o,bwLastSelectedNewRequestType:i.RequestType};s=webserviceurl+"/bwparticipant/updateuserconfigurationselectednewrequestscreenrequesttype";$.ajax({url:s,type:"POST",timeout:ajaxTimeout,data:data,headers:{Accept:"application/json; odata=verbose"},success:function(r){try{if(r!="SUCCESS")displayAlertDialog(r);else{$("#"+n).find("#budgetrequestform")[0].setAttribute("bwrequesttypeid",i.bwRequestTypeId);t.bwRequestTypeId=i.bwRequestTypeId;window.location.href.indexOf("my.html")>-1?(alert("Calling displayCreateRequestForm(). xcx92954-1-2"),f.displayCreateRequestForm(i.bwRequestTypeId)):window.location.href.indexOf("ios8.html")>-1?(alert("Calling displayCreateRequestFormForMobile(). xcx92954-1-2"),f.displayCreateRequestFormForMobile(i.bwRequestTypeId)):(console.log("In bwRequest.populateNewRequestForm_IndexDb(). Note xcx13-1-2: Unexpected window.location."),alert("Calling displayRequestFormDialog_IndexDB(). Passing bwRequestJson hopefully it goes Ok. xcx92954-2-2"),f.displayRequestFormDialog_IndexDB(t.bwBudgetRequestId,"",t));try{i.Abbreviation=="recurringexpense"?($("#"+n).find("#trNewRequestRecurringExpenseSection").show(),$("#"+n).find("#dtRecurringExpenseReminderDate").datepicker()):$("#"+n).find("#trNewRequestRecurringExpenseSection").hide()}catch(u){$("#"+n).find("#spanRequestForm_Error")[0].innerHTML="Exception in populateNewRequestForm():xcx3: "+u.message+", "+u.stack;displayAlertDialog("Exception in populateNewRequestForm():xcx3: "+u.message+", "+u.stack)}}}catch(u){console.log("Exception in selectNewRequestFormRequestTypeDropDown.change():2: "+u.message+", "+u.stack);$("#"+n).find("#spanRequestForm_Error")[0].innerHTML="Exception in selectNewRequestFormRequestTypeDropDown.change():2: "+u.message+", "+u.stack;displayAlertDialog("Exception in selectNewRequestFormRequestTypeDropDown.change():2: "+u.message+", "+u.stack)}},error:function(t,i,r){console.log("Error in selectNewRequestFormRequestTypeDropDown.change(): "+i+" "+r);$("#"+n).find("#spanRequestForm_Error")[0].innerHTML="Error in selectNewRequestFormRequestTypeDropDown.change(): "+i+" "+r;displayAlertDialog("Error in selectNewRequestFormRequestTypeDropDown.change(): "+i+" "+r)}})}catch(r){console.log("Exception in selectNewRequestFormRequestTypeDropDown.change(): "+r.message+", "+r.stack);$("#"+n).find("#spanRequestForm_Error")[0].innerHTML="Exception in selectNewRequestFormRequestTypeDropDown.change(): "+r.message+", "+r.stack;displayAlertDialog("Exception in selectNewRequestFormRequestTypeDropDown.change(): "+r.message+", "+r.stack)}})}h=$("#"+n).find("#spanNewRequestEllipsesButton")[0];$(h).on("click",function(n){n.preventDefault();n.stopImmediatePropagation();$(this).contextMenu()});try{alert("Displaying elipses context menu for request without a workflow (new request). xcx3");$.contextMenu({selector:".context-menu-newrequesteditor",callback:function(t){try{var r=$(this).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid");t=="requestjson"?f.viewScrapedBwRequestJson(n):t=="requestjsondignostics"?displayAlertDialog("This functionality is incomplete. Coming soon! xcx445"):t=="requestjsondb"?f.viewDatabaseBwRequestJson(r):t=="requesthtmldb"&&displayAlertDialog("This functionality is incomplete. Coming soon! xcx4471")}catch(i){$("#"+n).find("#spanRequestForm_Error")[0].innerHTML="Exception in populateNewRequestForm():xcx3: "+i.message+", "+i.stack}},items:{requestjson:{name:"Request JSON",icon:"edit"},requestjsondb:{name:"Request JSON from Database",icon:"edit"},requestjsondignostics:{name:"Request JSON Diagnostics",icon:"edit"},requesthtmldb:{name:"Request Form HTML from Database  xcx1-2",icon:"edit"}}})}catch(o){$("#"+n).find("#spanRequestForm_Error")[0].innerHTML="Exception in populateNewRequestForm():xcx2: "+o.message+", "+o.stack}}catch(o){console.log("Exception in populateNewRequestForm_IndexDb(): "+o.message+", "+o.stack);$("#"+n).find("#spanRequestForm_Error")[0].innerHTML="Exception in populateNewRequestForm_IndexDb(): "+o.message+", "+o.stack}},displayArInDialog:function(n,t,i,r,u,f,e,o,s){var it,w,k,h,d,g,b,c,nt,tt,y,p,a,l;try{if(console.log("In bwRequest.js.displayArInDialog(). budgetRequestId: "+t+", bwWorkflowTaskItemId: "+e+", TrashBin: "+n),it=this,w=window,window.opener&&(w=window.opener),k=0,h=w.$(".bwAuthentication:first").bwAuthentication("option","poppedOutRequestWindows"),h&&h.length&&(k=h.length),d=!1,!(s&&s==!0)){if(h&&h.length&&h.length>0)for(c=0;c<h.length;c++)if(h[c].bwBudgetRequestId==t){h[c].windowObjectReference.closed?(console.log("Error? in bwRequest.js.displayArInDialog(). The popped-out window was in the list, but does not actually exist."),h.splice(c,1)):(h[c].windowObjectReference.focus(),d=!0);break}console.log("In bwRequest.js.displayArInDialog(). There are "+k+" popped-out windows for us to check to make sure we don't display a request more than once.")}if(d==!0)l="This request is already being displayed in a popped-out window.",console.log(l),displayAlertDialog(l);else{for(b=document.getElementsByClassName("budgetrequestform"),c=0;c<b.length;c++)if(nt=$(b[c])[0].getAttribute("bwbudgetrequestid"),t==nt){g=$(b[c]);break}if(g)console.log(""),console.log("=========================================="),console.log("In bwRequest.js.displayArInDialog(). This request is already being displayed, so bringing it to the top. budgetRequestId: "+t),console.log("=========================================="),console.log(""),tt="divRequestFormDialog_"+t,$("#"+tt).dialog("moveToTop");else{e||(l="In displayArInDialog(). Invalid value for bwWorkflowTaskItemId: "+e+", xcx32423663473. This is Ok when it is a new request. It would be nice if we checked for bwRequest.BudgetWorkflowStatus == NOT_SUBMITTED here, but we don't have access to that data, do we?.",console.log(l));o&&console.log("In bwRequest.js.displayArInDialog(). bwRequestJson has been passed.");try{$("#divRowHoverDetails").dialog("close")}catch(v){}if(y=w.$(".bwAuthentication").bwAuthentication("option","participantId"),window.scrollTo(0,0),$(".bwActiveMenu").bwActiveMenu("adjustLeftSideMenu"),displayTaskDetailsBeforeRequests!=!0)console.log("In bwRequest.js.displayArInDialog(). IS THIS THE ONLY PLACE THIS SHOULD BE HAPPENING? 3-16-2022 xcx3243465"),n!=!0?(console.log("In displayArInDialog(). Calling displayRequestFormDialog(). TrashBin: "+n),this.displayRequestFormDialog(t,f,e,o)):(console.log("In displayArInDialog(). Calling displayRequestFormDialog_FromTrashBin(). TrashBin: "+n),this.displayRequestFormDialog_FromTrashBin(t,f,e,o));else if(console.log("In displayArInDialog(). Display the audit trail/approval trail first."),t||r)if(t||u){alert("In bwRequest.js.displayArInDialog(). This shows the AR in the dialog.");try{$("#spanArDialogTitle").empty();$("#spanArDialogTaskAuditTrail").empty();$("#spanArDialogViewBudgetRequestLink").empty();alert("xcx23425345");alert("Displaying ArDialog. xcx23425345-3-3");$("#ArDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:r+" ("+u+")",width:"720px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#ArDialog").dialog("close")});$(this).dialog("moveToTop")},close:function(){try{displayAlertDialog("In xcx23412(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-6")}catch(n){}}});$("#ArDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();$("#spanArDialogTitle").html(r+" ("+u+")x2");a=webserviceurl+"/bwworkflowtasks/getbybudgetrequestid/"+t;$.ajax({url:a,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var f,e,i,s,r;try{if(n.d.results.length==0)html="",html+="<table>",html+="   <tr>",html+="       <td>&nbsp;<\/td>",html+="   <\/tr>",html+="   <tr>",html+="       <td>",html+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+y+"', '"+u+"');\">Click here to view the Budget Request<\/a>",html+="       <\/td>",html+="   <\/tr>",html+="<\/table>",$("#spanArDialogViewBudgetRequestLink").html(html);else{for(f=[],f.push(n.d.results[0].bwAuthorId),e=0;e<n.d.results.length;e++)f.push(n.d.results[e].bwAssignedToId);for(i=[],s=0,r=0;r<f.length;r++)GetUserDetails[r]=$.Deferred(),GetUserDetails[r].done(function(r){var e,l,o,a,h;try{if(s+=1,i.push(r),s==f.length){for(e="",e+="<table>",e+="   <tr>",e+='       <td title="'+formatDateAndTimeFromBW(n.d.results[0].Created)+'">',l="",h=0;h<i.length;h++)i[h][0]==n.d.results[0].bwAuthorId&&(l=i[h][1]);for(e+='           <strike><span style="cursor:help;">xcx16'+formatDateFromBW(n.d.results[0].Created)+" - Request submitted by "+l+"<\/span><\/strike>",e+="       <\/td>",e+="   <\/tr>",e+="<\/table>",o=0;o<n.d.results.length;o++){if(e+="<table>",e+="   <tr>",e+='       <td title="'+formatDateAndTimeFromBW(n.d.results[o].Modified)+'">',n.d.results[o].bwPercentComplete==100&&n.d.results[o].bwStatus=="Completed")e+="       <strike>",e+='<span style="cursor:help;">xcx17'+formatDateFromBW(n.d.results[o].Modified)+" - "+n.d.results[o].bwTaskOutcome+" ["+n.d.results[o].bwAssignedToRaciRoleName+" ("+n.d.results[o].bwAssignedToRaciRoleAbbreviation+")]x<\/span>",e+="       <\/strike>";else{for(a="",h=0;h<i.length;h++)i[h][0]==n.d.results[o].bwAssignedToId&&(a=i[h][1]);e+="xcx18"+formatDateFromBW(n.d.results[o].Created)+" - "+n.d.results[o].bwTaskTitle+" assigned to "+a+" ["+n.d.results[o].bwAssignedToRaciRoleName+" ("+n.d.results[o].bwAssignedToRaciRoleAbbreviation+")]x"}e+="       <\/td>";e+="   <\/tr>";e+="<\/table>"}$("#spanArDialogTaskAuditTrail").html(e);e="";e+="<table>";e+="   <tr>";e+="       <td>&nbsp;<\/td>";e+="   <\/tr>";e+="   <tr>";e+="       <td>";e+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+y+"', '"+u+"');\">Click here to view the Budget Request<\/a>";e+="       <\/td>";e+="   <\/tr>";e+="<\/table>";$("#spanArDialogViewBudgetRequestLink").html(e);$("#ui-id-1").css("border-radius","20px 0 0 20px")}}catch(c){console.log("Exception in bwRequest.displayArInDialog():xcx335-7: "+c.message+", "+c.stack);displayAlertDialog("Exception in bwRequest.displayArInDialog():xcx335-7: "+c.message+", "+c.stack)}}).fail(function(){handleExceptionWithAlert("Error in bwRequest.displayArInDialog().GetUserDetails.fail()","GetUserDetails.fail()")}),getUserDetails(f[r],appWebUrl,r)}}catch(o){console.log("Exception in bwRequest.js.displayArInDialog():xcx335-6: "+o.message+", "+o.stack);displayAlertDialog("Exception in bwRequest.js.displayArInDialog():xcx335-6: "+o.message+", "+o.stack)}},error:function(n){var t="Error in bwRequest.js.displayArInDialog(). error: "+n;console.log(t);alert(t)}})}catch(v){l="Exception in bwRequest.js.displayArInDialog():2: "+v.message+", "+v.stack;console.log(l);alert(l)}}else alert("In bwRequest.js.displayArInDialog(). !appWebUrl && !budgetRequestId && !title."),a=webserviceurl+"/getbudgetrequestidfromtitle/"+r,$.ajax({url:a,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){try{t=n[0].bwBudgetRequestId;appWebUrl=globalUrlPrefix+globalUrlForWebServices;r=n[0].ProjectTitle;u=n[0].Title;try{$("#spanArDialogTitle").empty();$("#spanArDialogTaskAuditTrail").empty();$("#spanArDialogViewBudgetRequestLink").empty();alert("xcx23425345-2");alert("Displaying ArDialog. xcx23425345-3-2");$("#ArDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:r+" ("+u+")",width:"720px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#ArDialog").dialog("close")});$(this).dialog("moveToTop")},close:function(){try{displayAlertDialog("In xcx23412(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-5")}catch(n){}}});$("#ArDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();$("#spanArDialogTitle").html(r+" ("+u+")x1");var f=webserviceurl+"/bwworkflowtasks/getbybudgetrequestid/"+t;$.ajax({url:f,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var f,e,i,s,r;try{if(n.d.results.length!=0){for(f=[],f.push(n.d.results[0].bwAuthorId),e=0;e<n.d.results.length;e++)f.push(n.d.results[e].bwAssignedToId);for(i=[],s=0,r=0;r<f.length;r++)GetUserDetails[r]=$.Deferred(),GetUserDetails[r].done(function(r){var e,l,o,a,h;try{if(s+=1,i.push(r),s==f.length){for(e="",e+="<table>",e+="   <tr>",e+='       <td title="'+formatDateAndTimeFromBW(n.d.results[0].Created)+'">',l="",h=0;h<i.length;h++)i[h][0]==n.d.results[0].bwAuthorId&&(l=i[h][1]);for(e+='           <strike><span style="cursor:help;">xcx13'+formatDateFromBW(n.d.results[0].Created)+" - Request submitted by "+l+"[raci role 3]<\/span><\/strike>",e+="       <\/td>",e+="   <\/tr>",e+="<\/table>",o=0;o<n.d.results.length;o++){if(e+="<table>",e+="   <tr>",e+='       <td title="'+formatDateAndTimeFromBW(n.d.results[o].Modified)+'">',n.d.results[o].bwPercentComplete==100&&n.d.results[o].bwStatus=="Completed")e+="       <strike>",e+='<span style="cursor:help;">xcx14'+formatDateFromBW(n.d.results[o].Modified)+" - "+n.d.results[o].bwTaskOutcome+"[raci role 4]<\/span>",e+="       <\/strike>";else{for(a="",h=0;h<i.length;h++)i[h][0]==n.d.results[o].bwAssignedToId&&(a=i[h][1]);e+="xcx15"+formatDateFromBW(n.d.results[o].Created)+" - "+n.d.results[o].bwTaskTitle+" assigned to "+a}e+="       <\/td>";e+="   <\/tr>";e+="<\/table>"}$("#spanArDialogTaskAuditTrail").html(e);e="";e+="<table>";e+="   <tr>";e+="       <td>&nbsp;<\/td>";e+="   <\/tr>";e+="   <tr>";e+="       <td>";e+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+y+"', '"+u+"');\">Click here to view the Budget Request<\/a>";e+="       <\/td>";e+="   <\/tr>";e+="<\/table>";$("#spanArDialogViewBudgetRequestLink").html(e);$("#ui-id-1").css("border-radius","20px 0 0 20px")}}catch(c){console.log("Exception in bwRequest.displayArInDialog():xcx335-5: "+c.message+", "+c.stack);displayAlertDialog("Exception in bwRequest.displayArInDialog():xcx335-5: "+c.message+", "+c.stack)}}).fail(function(){handleExceptionWithAlert("Error in bwRequest.displayArInDialog().GetUserDetails.fail()","GetUserDetails.fail()")}),getUserDetails(f[r],appWebUrl,r)}}catch(o){console.log("Exception in bwRequest.displayArInDialog():xcx335-4: "+o.message+", "+o.stack);displayAlertDialog("Exception in bwRequest.displayArInDialog():xcx335-4: "+o.message+", "+o.stack)}},error:function(){handleExceptionWithAlert("Error in bwRequest.displayArInDialog()","1:"+errorCode+", "+errorMessage)}})}catch(i){handleExceptionWithAlert("Error in bwRequest.displayArInDialog()","2:"+i.message)}}catch(i){console.log("Exception in bwRequest.displayArInDialog():xcx335-3: "+i.message+", "+i.stack);displayAlertDialog("Exception in bwRequest.displayArInDialog():xcx335-3: "+i.message+", "+i.stack)}},error:function(){handleExceptionWithAlert("Error in bwRequest.displayArInDialog()","1:"+errorCode+", "+errorMessage)}});else{alert("In bwRequest.js.displayArInDialog(). This means we are coming from a .xsl, so we have to find the values.");t=$('span[xd\\:binding = "my:BudgetRequestId"]')[0].innerHTML;appWebUrl=this.options.operationUriPrefix;r=$('span[xd\\:binding = "my:Project_Name"]')[0].innerHTML;u=$('span[xd\\:binding = "my:Title"]')[0].innerHTML;try{$("#spanArDialogTitle").empty();$("#spanArDialogTaskAuditTrail").empty();$("#spanArDialogViewBudgetRequestLink").empty();alert("xcx23425345-3");alert("Displaying ArDialog. xcx23425345-3-1");$("#ArDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:r+" ("+u+")",width:"720px",dialogClass:"no-close",hide:!1,open:function(){try{console.log("In bwRequest.js.displayArInDialog.dialog.open(). THIS IS WHERE THE REQUEST GETS OPENED INTO THE LARGE REQUEST DIALOG.");$(".ui-widget-overlay").bind("click",function(){$("#ArDialog").dialog("close")});$(this).dialog("moveToTop");window.scrollTo(0,0)}catch(n){var t="Exception in bwRequest.js.displayArInDialog():910: "+n.message+", "+n.stack;console.log(t);displayAlertDialog(t)}},close:function(){try{displayAlertDialog("In xcx23412(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-4")}catch(n){}}});$("#ArDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();p="";p+=" ";p+="&nbsp;&nbsp;&nbsp;&nbsp;x11";p+=r+" ("+u+")";$("#spanArDialogTitle").html(p);a=webserviceurl+"/bwworkflowtasks/getbybudgetrequestid/"+t;$.ajax({url:a,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var f,e,i,s,r;try{if(n.d.results.length!=0){for(f=[],f.push(n.d.results[0].bwAuthorId),e=0;e<n.d.results.length;e++)f.push(n.d.results[e].bwAssignedToId);for(i=[],s=0,r=0;r<f.length;r++)GetUserDetails[r]=$.Deferred(),GetUserDetails[r].done(function(r){var e,l,o,a,h;try{if(s+=1,i.push(r),s==f.length){for(e="",e+="<table>",e+="   <tr>",e+='       <td title="'+formatDateAndTimeFromBW(n.d.results[0].Created)+'">',l="",h=0;h<i.length;h++)i[h][0]==n.d.results[0].bwAuthorId&&(l=i[h][1]);for(e+='           <strike><span style="cursor:help;">xcx10'+formatDateFromBW(n.d.results[0].Created)+" - Request submitted by "+l+"<\/span><\/strike>",e+="       <\/td>",e+="   <\/tr>",e+="<\/table>",o=0;o<n.d.results.length;o++){if(e+="<table>",e+="   <tr>",n.d.results[o].bwPercentComplete==100&&n.d.results[o].bwStatus=="Completed")e+='       <td title="'+formatDateAndTimeFromBW(n.d.results[o].Modified)+'">',e+="       <strike>",e+='<span style="cursor:help;">xcx11'+formatDateFromBW(n.d.results[o].Modified)+" - "+n.d.results[o].bwTaskOutcome+"[raci role1]<\/span>",e+="       <\/strike>",e+="       <\/td>";else{for(a="",h=0;h<i.length;h++)i[h][0]==n.d.results[o].bwAssignedToId&&(a=i[h][1]);e+='       <td title="'+formatDateAndTimeFromBW(n.d.results[o].Created)+'">';e+='<span style="cursor:help;">xcx12'+formatDateFromBW(n.d.results[o].Created)+" - "+n.d.results[o].bwTaskTitle+" assigned to "+a+"[raci role2]<\/span>";e+="       <\/td>"}e+="   <\/tr>";e+="<\/table>"}$("#spanArDialogTaskAuditTrail").html(e);e="";e+="<table>";e+="   <tr>";e+="       <td>&nbsp;<\/td>";e+="   <\/tr>";e+="   <tr>";e+="       <td>";e+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+y+"', '"+u+"');\">Click here to view the Budget Request<\/a>";e+="       <\/td>";e+="   <\/tr>";e+="<\/table>";$("#spanArDialogViewBudgetRequestLink").html(e);$("#ui-id-1").css("border-radius","20px 0 0 20px")}}catch(c){console.log("Exception in bwRequest.displayArInDialog():xcx335-2: "+c.message+", "+c.stack);displayAlertDialog("Exception in bwRequest.displayArInDialog():xcx335-2: "+c.message+", "+c.stack)}}).fail(function(){handleExceptionWithAlert("Error in bwRequest.displayArInDialog().GetUserDetails.fail()","GetUserDetails.fail()")}),getUserDetails(f[r],appWebUrl,r)}}catch(o){console.log("Exception in bwRequest.displayArInDialog():xcx335-1: "+o.message+", "+o.stack);displayAlertDialog("Exception in bwRequest.displayArInDialog():xcx335-1: "+o.message+", "+o.stack)}},error:function(){handleExceptionWithAlert("Error in bwRequest.displayArInDialog()","1:"+errorCode+", "+errorMessage)}})}catch(v){handleExceptionWithAlert("Error in bwRequest.displayArInDialog()","2:"+v.message)}}}}}catch(v){l="Exception in bwRequest.js.displayArInDialog():1: "+v.message+", "+v.stack;console.log(l);alert(l)}},displayCloseoutInDialog:function(n,t,i){var e,r,u,f;try{console.log("In displayCloseoutInDialog().");e=this;this.pinRequestDialog();r="divRequestCloseoutDialog_"+n;u="";u+='        <table style="width:100%;">';u+="            <tr>";u+='                <td style="width:90%;">';u+='                    <span id="divRequestFormContent"><\/span>';u+="                <\/td>";u+="            <\/tr>";u+="        <\/table>";u+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->';u+="        <br /><br />";f=document.getElementById(r);f||(f=document.createElement("div"),f.id=r,document.body.appendChild(f));f.innerHTML=u;$("#"+r).dialog({modal:!0,resizable:!0,closeOnEscape:!0,width:"800px",dialogClass:"no-close",hide:!1,position:{my:"middle top+12",at:"middle top","of":window},close:function(){console.log("");console.log("==========================================");console.log("In xcx34-1(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-x-3");console.log("==========================================");console.log("")},open:function(){var y,o,a,s,p,w,v,h,c,f,b,u;try{for(y=document.getElementById(r).parentNode,o=r+"_Parent",y.id=o,u="",u+='<table xcx="xcx3249-4" style="width:100%;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequestDialog\');">',u+="   <tr>",u+='       <td style="width:95%;">',u+='           <div id="slider_'+r+'" style="width:20%;cursor:pointer;"><\/div>',u+="       <\/td>",u+="       <td>",u+='           <span class="dialogXButton" style="font-size:25pt;cursor:pointer;width:100%;font-weight:bold;" onclick="$(\'#'+r.replace("_Parent","")+"').dialog('close');\">X<\/span>",u+="       <\/td>",u+="   <\/tr>",u+="<\/table>",document.getElementById(r).parentNode.querySelector(".ui-dialog-titlebar").innerHTML=u,u="",s=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems,f=0;f<s.length;f++)if(t==s[f].bwRequestTypeId){a=s[f];break}for(p=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),u+='<table style="width:100%;">',u+="   <tbody>",u+="       <tr>",u+='           <td colspan="4">',u+='               <span id="divCreateRequestFormContent_requestOrgClickableBreadcrumb" style="color:purple;font-size:8pt;">',u+="               <\/span>",u+="           <\/td>",u+="       <\/tr>",u+="       <tr>",u+='           <td width="5">',u+="           <\/td>",u+='           <td style="vertical-align:top;">',u+="               <span>",w="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),v=JSON.parse($(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier")),u+=v.status!="SUCCESS"?"[No image. Unauthorized. xcx213124-34556-34-234-3245]":'                   <img xcx="fewrwwa" id="divCreateRequestFormContent_imgRequestOrgImage" style="width:150px;height:150px;" src="'+e.options.operationUriPrefix+"_files/"+p+"/orgimages/root/orgimage.png?v="+w+"&ActiveStateIdentifier="+v.ActiveStateIdentifier+'">',u+="               <\/span>",u+="           <\/td>",u+='           <td style="text-align:left;" colspan="2">',u+='               <span class="xdlabel" id="spanRequestForm_Title">',u+="                   <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">",u+=a?a.SingletonName+": ":"requesttype_not_found bwRequestTypeId:"+t+": ",u+='                       <span id="spanRequestFormBudgetRequestTitle" title="">',u+=i,u+="                           <br />",u+='                           <span id="'+o+'_spanWorkflowGuidAndRequestTypeForTesting2" style="color:gray;font-size:small;"><\/span>',u+="                       <\/span>",u+="                   <\/span>",u+="               <\/span>",u+="               <br />",u+="           <\/td>",u+="       <\/tr>",u+="   <\/tbody>",u+="<\/table>",u+='<span id="'+o+'_Content"><\/span>',document.getElementById(r).innerHTML=u,c=document.getElementsByClassName("budgetrequestform"),f=0;f<c.length;f++)if(b=c[f].getAttribute("bwbudgetrequestid"),n==b){h=c[f];break}if(h){var k=$(h)[0].getAttribute("bworgid"),d=$(h).find(".bwLocationPicker:first").bwLocationPicker("option","store"),g=$(".bwAuthentication").bwAuthentication("renderTheOrgBreadcrumb2",d,k);$("#"+r).find("#divCreateRequestFormContent_requestOrgClickableBreadcrumb")[0].innerHTML=g.orgPathClickable;$("#slider_"+r).slider({min:50,max:200,value:100,slide:function(n,t){e.setZoom(t.value,r)}});e.setZoom(100,r);$(".ui-widget-overlay").bind("click",function(){$("#"+r).dialog("close")});u=`
                            
                            
                            
    <span id="XslFormBudgetRequestId" xd:binding="my:BudgetRequestId" class="bwHiddenField">
        <xsl:value-of select="my:BudgetRequestId" />
    </span>

    <div align="center">
        <table style="BORDER-BOTTOM-STYLE: none; BORDER-LEFT-STYLE: none; WIDTH: 654px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; BORDER-TOP-STYLE: none; TABLE-LAYOUT: fixed; BORDER-RIGHT-STYLE: none" class="xdFormLayout">
            <colgroup>
                <col style="WIDTH: 654px"></col>
            </colgroup>
            <tbody>
                <tr style="MIN-HEIGHT: 688px" class="xdTableContentRow">
                    <td class="xdTableContentCell" style="BORDER-BOTTOM: #d8d8d8 1pt solid; BORDER-LEFT: #d8d8d8 1pt solid; PADDING-BOTTOM: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; VERTICAL-ALIGN: top; BORDER-TOP: #d8d8d8 1pt solid; BORDER-RIGHT: #d8d8d8 1pt solid; PADDING-TOP: 0px">
                        <h1 style="FONT-WEIGHT: normal"></h1>
                        <div style="FONT-WEIGHT: normal">
                            <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 652px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                <colgroup>
                                    <col style="WIDTH: 125px"></col>
                                    <col style="WIDTH: 527px"></col>
                                </colgroup>
                                <tbody vAlign="top">
                                    <tr>
                                        <td>
                                            <div>
                                                <font size="2" face="Calibri">

                                                </font>
                                            </div>
                                        </td>
                                        <td>
                                            <div>
                                                <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 486px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                                    <colgroup>
                                                        <col style="WIDTH: 486px"></col>
                                                    </colgroup>
                                                    <tbody vAlign="top">
                                                        <tr>
                                                            <td>
                                                                <div>
                                                                    <font style="FONT-SIZE: 22pt" face="Calibri">Closeout</font>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <div>
                                                                    <font size="2" face="Calibri"></font>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div>
                                                <font size="2" face="Calibri"></font>
                                            </div>
                                        </td>
                                        <td>
                                            <div align="right">
                                                <!--<em>To return to the AR, close this browser window.</em>-->
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div>
                                                <font size="2" face="Calibri"></font>
                                            </div>
                                        </td>
                                        <td>
                                            <div align="right">
                                                <span class="xdlabel"></span><span hideFocus="1" class="xdTextBox" title="" tabIndex="-1" xd:disableEditing="yes" xd:xctname="PlainText" xd:CtrlId="CTRL59" xd:binding="my:GlobalError" style="BORDER-BOTTOM: #dcdcdc 1pt; TEXT-ALIGN: right; BORDER-LEFT: #dcdcdc 1pt; WIDTH: 100%; WHITE-SPACE: nowrap; COLOR: #ff0000; BORDER-TOP: #dcdcdc 1pt; BORDER-RIGHT: #dcdcdc 1pt">
                                                    <xsl:value-of select="my:GlobalError" />
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div align="right">
                            <span class="xdlabel"></span>
                        </div>
                        <div align="left">
                            <span class="xdlabel">
                                <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 652px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                    <colgroup>
                                        <col style="WIDTH: 652px"></col>
                                    </colgroup>
                                    <tbody vAlign="top">
                                        <tr>
                                            <td>
                                                <div>
                                                    <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 648px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                                        <colgroup>
                                                            <col style="WIDTH: 35px"></col>
                                                            <col style="WIDTH: 134px"></col>
                                                            <col style="WIDTH: 19px"></col>
                                                            <col style="WIDTH: 136px"></col>
                                                            <col style="WIDTH: 136px"></col>
                                                            <col style="WIDTH: 18px"></col>
                                                            <col style="WIDTH: 42px"></col>
                                                            <col style="WIDTH: 128px"></col>
                                                        </colgroup>
                                                        <tbody vAlign="top">
                                                            <tr style="MIN-HEIGHT: 26px">
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">BR #:</font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #f2f2f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <span hideFocus="1" class="xdTextBox" title="" xd:disableEditing="yes" xd:xctname="PlainText" xd:CtrlId="CTRL29" xd:binding="my:coARNumber" style="WIDTH: 100%; WHITE-SPACE: nowrap">
                                                                                <xsl:value-of select="my:coARNumber" />
                                                                            </span>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri"></font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">Location of Asset:</font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <span hideFocus="1" class="xdTextBox" title="" xd:xctname="PlainText" xd:CtrlId="CTRL32" xd:binding="my:coLocationOfEquipment" style="WIDTH: 100%">
                                                                            <xsl:value-of select="my:coLocationOfEquipment" />
                                                                        </span>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri"></font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">Date:</font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #f2f2f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <span hideFocus="1" class="xdTextBox  " title="" xd:disableEditing="yes" xd:xctname="PlainText" xd:CtrlId="CTRL34" xd:binding="my:coDate" style="WIDTH: 100%; WHITE-SPACE: nowrap">
                                                                                <xsl:value-of select="my:coDate" />
                                                                            </span>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 649px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                                        <colgroup>
                                                            <col style="WIDTH: 129px"></col>
                                                            <col style="WIDTH: 141px"></col>
                                                            <col style="WIDTH: 16px"></col>
                                                            <col style="WIDTH: 233px"></col>
                                                            <col style="WIDTH: 130px"></col>
                                                        </colgroup>
                                                        <tbody vAlign="top">
                                                            <tr>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #d8d8d8 1pt; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">SAP Internal Order #:</font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #f2f2f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; BORDER-TOP: #d8d8d8 1pt; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <span class="xdlabel">
                                                                                <span hideFocus="1" class="xdTextBox" title="" xd:disableEditing="yes" xd:xctname="PlainText" xd:CtrlId="CTRL35" xd:binding="my:coSAPInternalOrderNumber" style="WIDTH: 100%; WHITE-SPACE: nowrap">
                                                                                    <xsl:value-of select="my:coSAPInternalOrderNumber" />
                                                                                </span>
                                                                            </span>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #d8d8d8 1pt; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri"></font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #d8d8d8 1pt; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">Cost Center:</font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; BORDER-TOP: #d8d8d8 1pt; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <span class="xdlabel">
                                                                                <span hideFocus="1" class="xdTextBox" title="" xd:xctname="PlainText" xd:CtrlId="CTRL36" xd:binding="my:coCostCenter" style="WIDTH: 100%; WHITE-SPACE: nowrap">
                                                                                    <xsl:value-of select="my:coCostCenter" />
                                                                                </span>
                                                                            </span>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="BORDER-BOTTOM-STYLE: none; BORDER-BOTTOM-COLOR: ; PADDING-BOTTOM: 1px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; PADDING-TOP: 1px">
                                                <div>
                                                    <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 649px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                                        <colgroup>
                                                            <col style="WIDTH: 87px"></col>
                                                            <col style="WIDTH: 562px"></col>
                                                        </colgroup>
                                                        <tbody vAlign="top">
                                                            <tr>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <font size="2" face="Calibri">Description:</font>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #f2f2f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <span hideFocus="1" class="xdTextBox" title="" xd:disableEditing="yes" xd:xctname="PlainText" xd:CtrlId="CTRL37" xd:binding="my:coProjectTitle" style="WIDTH: 100%; WHITE-SPACE: nowrap">
                                                                                <xsl:value-of select="my:coProjectTitle" />
                                                                            </span>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="BORDER-TOP-COLOR: ; BORDER-TOP-STYLE: none">
                                                <div>
                                                    <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 648px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                                        <colgroup>
                                                            <col style="WIDTH: 157px"></col>
                                                            <col style="WIDTH: 139px"></col>
                                                            <col style="WIDTH: 122px"></col>
                                                            <col style="WIDTH: 100px"></col>
                                                            <col style="WIDTH: 130px"></col>
                                                        </colgroup>
                                                        <tbody vAlign="top">
                                                            <tr>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #f2f2f2 1pt; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">Estimated Amount Closed:</font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; BORDER-TOP: #f2f2f2 1pt; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <span hideFocus="1" class="xdTextBox  xdBehavior_Formatting" title="" contentEditable="true" xd:xctname="PlainText" xd:CtrlId="CTRL39" xd:binding="my:coEstimatedAmountClosed" xd:datafmt="&quot;currency&quot;,&quot;numDigits:2;negativeOrder:0;positiveOrder:0;currencyLocale:1033;&quot;" xd:boundProp="xd:num" style="TEXT-ALIGN: right; WIDTH: 100%; WHITE-SPACE: nowrap">
                                                                                <xsl:attribute name="xd:num">
                                                                                    <xsl:value-of select="my:coEstimatedAmountClosed" />
                                                                                </xsl:attribute>
                                                                                <xsl:choose>
                                                                                    <xsl:when test="function-available('xdFormatting:formatString')">
                                                                                        <xsl:value-of select="xdFormatting:formatString(my:coEstimatedAmountClosed,&quot;currency&quot;,&quot;numDigits:2;negativeOrder:0;positiveOrder:0;currencyLocale:1033;&quot;)" />
                                                                                    </xsl:when>
                                                                                    <xsl:otherwise>
                                                                                        <xsl:value-of select="my:coEstimatedAmountClosed" />
                                                                                    </xsl:otherwise>
                                                                                </xsl:choose>
                                                                            </span>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #f2f2f2 1pt; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri"></font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #f2f2f2 1pt; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">Budget Amount:</font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #f2f2f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; BORDER-TOP: #f2f2f2 1pt; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <span class="xdlabel">
                                                                                <span hideFocus="1" class="xdTextBox  xdBehavior_Formatting" title="" contentEditable="true" xd:xctname="PlainText" xd:CtrlId="CTRL38" xd:binding="my:coBudgetAmount" xd:datafmt="&quot;currency&quot;,&quot;numDigits:2;negativeOrder:0;positiveOrder:0;currencyLocale:1033;&quot;" xd:boundProp="xd:num" style="WIDTH: 100%">
                                                                                    <xsl:attribute name="xd:num">
                                                                                        <xsl:value-of select="my:coBudgetAmount" />
                                                                                    </xsl:attribute>
                                                                                    <xsl:choose>
                                                                                        <xsl:when test="function-available('xdFormatting:formatString')">
                                                                                            <xsl:value-of select="xdFormatting:formatString(my:coBudgetAmount,&quot;currency&quot;,&quot;numDigits:2;negativeOrder:0;positiveOrder:0;currencyLocale:1033;&quot;)" />
                                                                                        </xsl:when>
                                                                                        <xsl:otherwise>
                                                                                            <xsl:value-of select="my:coBudgetAmount" />
                                                                                        </xsl:otherwise>
                                                                                    </xsl:choose>
                                                                                </span>
                                                                            </span>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 649px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                                        <colgroup>
                                                            <col style="WIDTH: 128px"></col>
                                                            <col style="WIDTH: 257px"></col>
                                                            <col style="WIDTH: 11px"></col>
                                                            <col style="WIDTH: 71px"></col>
                                                            <col style="WIDTH: 182px"></col>
                                                        </colgroup>
                                                        <tbody vAlign="top">
                                                            <tr style="MIN-HEIGHT: 31px">
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">Asset Replaced:</font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <span hideFocus="1" class="xdTextBox" title="" xd:xctname="PlainText" xd:CtrlId="CTRL41" xd:binding="my:coEquipmentReplaced" style="WIDTH: 100%">
                                                                                <xsl:value-of select="my:coEquipmentReplaced" />
                                                                            </span>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri"></font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">Property #:</font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <span hideFocus="1" class="xdTextBox" title="" xd:xctname="PlainText" xd:CtrlId="CTRL42" xd:binding="my:coPropertyNumber" style="WIDTH: 100%">
                                                                                <xsl:value-of select="my:coPropertyNumber" />
                                                                            </span>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 648px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                                        <colgroup>
                                                            <col style="WIDTH: 172px"></col>
                                                            <col style="WIDTH: 476px"></col>
                                                        </colgroup>
                                                        <tbody vAlign="top">
                                                            <tr>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; VERTICAL-ALIGN: top; BORDER-TOP: #d8d8d8 1pt; PADDING-TOP: 4px">
                                                                    <div align="left">
                                                                        <font size="2" face="Calibri">Where is the Asset Now:</font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; BORDER-TOP: #d8d8d8 1pt; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 321px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                                                            <colgroup>
                                                                                <col style="WIDTH: 174px"></col>
                                                                                <col style="WIDTH: 40px"></col>
                                                                                <col style="WIDTH: 107px"></col>
                                                                            </colgroup>
                                                                            <tbody vAlign="top">
                                                                                <tr>
                                                                                    <td style="BACKGROUND-COLOR: #e0e8f2">
                                                                                        <div>
                                                                                            <font size="2" face="Calibri">
                                                                                                <input class="xdBehavior_Boolean" title="" value="" type="checkbox" xd:xctname="CheckBox" xd:CtrlId="CTRL43" xd:binding="my:coOnSiteButOutOfService" xd:boundProp="xd:value" xd:onValue="true" xd:offValue="false">
                                                                                                <xsl:attribute name="xd:value">
                                                                                                    <xsl:value-of select="my:coOnSiteButOutOfService" />
                                                                                                </xsl:attribute>
                                                                                                <xsl:if test="my:coOnSiteButOutOfService=&quot;true&quot;">
                                                                                                    <xsl:attribute name="CHECKED">CHECKED</xsl:attribute>
                                                                                                </xsl:if>
                                                                                                </input>On site but out of service
                                                                                            </font>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td style="BACKGROUND-COLOR: #e0e8f2">
                                                                                        <div>
                                                                                            <font size="2" face="Calibri"></font>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td style="BACKGROUND-COLOR: #e0e8f2">
                                                                                        <div>
                                                                                            <font size="2" face="Calibri">
                                                                                                <input class="xdBehavior_Boolean" title="" value="" type="checkbox" xd:xctname="CheckBox" xd:CtrlId="CTRL45" xd:binding="my:coScrapped" xd:boundProp="xd:value" xd:onValue="true" xd:offValue="false">
                                                                                                <xsl:attribute name="xd:value">
                                                                                                    <xsl:value-of select="my:coScrapped" />
                                                                                                </xsl:attribute>
                                                                                                <xsl:if test="my:coScrapped=&quot;true&quot;">
                                                                                                    <xsl:attribute name="CHECKED">CHECKED</xsl:attribute>
                                                                                                </xsl:if>
                                                                                                </input>Scrapped
                                                                                            </font>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td style="BACKGROUND-COLOR: #e0e8f2">
                                                                                        <div>
                                                                                            <font size="2" face="Calibri">
                                                                                                <input class="xdBehavior_Boolean" title="" value="" type="checkbox" xd:xctname="CheckBox" xd:CtrlId="CTRL44" xd:binding="my:coInStorage" xd:boundProp="xd:value" xd:onValue="true" xd:offValue="false">
                                                                                                <xsl:attribute name="xd:value">
                                                                                                    <xsl:value-of select="my:coInStorage" />
                                                                                                </xsl:attribute>
                                                                                                <xsl:if test="my:coInStorage=&quot;true&quot;">
                                                                                                    <xsl:attribute name="CHECKED">CHECKED</xsl:attribute>
                                                                                                </xsl:if>
                                                                                                </input>In storage
                                                                                            </font>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td style="BACKGROUND-COLOR: #e0e8f2">
                                                                                        <div>
                                                                                            <font size="2" face="Calibri"></font>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td style="BACKGROUND-COLOR: #e0e8f2">
                                                                                        <div>
                                                                                            <font size="2" face="Calibri">
                                                                                                <input class="xdBehavior_Boolean" title="" value="" type="checkbox" xd:xctname="CheckBox" xd:CtrlId="CTRL46" xd:binding="my:coTransfer" xd:boundProp="xd:value" xd:onValue="true" xd:offValue="false">
                                                                                                <xsl:attribute name="xd:value">
                                                                                                    <xsl:value-of select="my:coTransfer" />
                                                                                                </xsl:attribute>
                                                                                                <xsl:if test="my:coTransfer=&quot;true&quot;">
                                                                                                    <xsl:attribute name="CHECKED">CHECKED</xsl:attribute>
                                                                                                </xsl:if>
                                                                                                </input>Transfer
                                                                                            </font>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <font size="2" face="Calibri">Explanation:</font>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <!--<font color="#ff0000" size="1" face="Calibri">If your project has a write off this must be filled out. If it was sent somewhere please provide information.</font>-->
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; PADDING-TOP: 4px">
                                                <div>
                                                    <font size="2" face="Calibri">
                                                        <span hideFocus="1" class="xdTextBox" title="" xd:xctname="PlainText" xd:CtrlId="CTRL47" xd:binding="my:coExplanation" xd:datafmt="&quot;string&quot;,&quot;plainMultiline&quot;" style="OVERFLOW-X: auto; OVERFLOW-Y: auto; WIDTH: 100%; WORD-WRAP: break-word; WHITE-SPACE: normal; HEIGHT: 63px">
                                                            <xsl:choose>
                                                                <xsl:when test="function-available('xdFormatting:formatString')">
                                                                    <xsl:value-of select="xdFormatting:formatString(my:coExplanation,&quot;string&quot;,&quot;plainMultiline&quot;)" disable-output-escaping="yes" />
                                                                </xsl:when>
                                                                <xsl:otherwise>
                                                                    <xsl:value-of select="my:coExplanation" disable-output-escaping="yes" />
                                                                </xsl:otherwise>
                                                            </xsl:choose>
                                                        </span>
                                                    </font>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 649px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                                        <colgroup>
                                                            <col style="WIDTH: 104px"></col>
                                                            <col style="WIDTH: 223px"></col>
                                                            <col style="WIDTH: 24px"></col>
                                                            <col style="WIDTH: 147px"></col>
                                                            <col style="WIDTH: 151px"></col>
                                                        </colgroup>
                                                        <tbody vAlign="top">
                                                            <tr>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <span class="xdlabel">Manager:</span>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #f2f2f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <span hideFocus="1" class="xdTextBox" title="" xd:xctname="PlainText" xd:CtrlId="CTRL48" xd:binding="my:coProjectManager" style="WIDTH: 100%">
                                                                            <xsl:value-of select="my:coProjectManager" />
                                                                        </span>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri"></font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <font size="2" face="Calibri">Placed Into Service Date:</font>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 4px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 10px; BORDER-TOP: #d8d8d8 1pt solid; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <span hideFocus="1" class="xdTextBox xdBehavior_Formatting" title="" contentEditable="true" tabIndex="0" xd:xctname="PlainText" xd:CtrlId="CTRL60" xd:binding="my:coPlacedIntoServiceDate" xd:datafmt="&quot;date&quot;,&quot;dateFormat:Short Date;&quot;" xd:boundProp="xd:num" style="WIDTH: 100%">
                                                                                <xsl:attribute name="xd:num">
                                                                                    <xsl:value-of select="my:coPlacedIntoServiceDate" />
                                                                                </xsl:attribute>
                                                                                <xsl:choose>
                                                                                    <xsl:when test="function-available('xdFormatting:formatString')">
                                                                                        <xsl:value-of select="xdFormatting:formatString(my:coPlacedIntoServiceDate,&quot;date&quot;,&quot;dateFormat:Short Date;&quot;)" />
                                                                                    </xsl:when>
                                                                                    <xsl:otherwise>
                                                                                        <xsl:value-of select="my:coPlacedIntoServiceDate" />
                                                                                    </xsl:otherwise>
                                                                                </xsl:choose>
                                                                            </span>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <font size="3"></font>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <font size="3">
                                                        <strong>Asset</strong>
                                                    </font>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <!--<font color="#ff0000" size="1">List all equipment that will be listed on the asset registrar. This must be broken down as to how it might be replaced.</font>-->
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <table style="BORDER-BOTTOM-STYLE: none; BORDER-LEFT-STYLE: none; WIDTH: 648px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; BORDER-TOP-STYLE: none; TABLE-LAYOUT: fixed; BORDER-RIGHT-STYLE: none" class="xdRepeatingTable msoUcTable" title="" border="1" xd:CtrlId="CTRL24" xd:widgetIndex="0">
                                                        <colgroup>
                                                            <col style="WIDTH: 253px"></col>
                                                            <col style="WIDTH: 76px"></col>
                                                            <col style="WIDTH: 94px"></col>
                                                            <col style="WIDTH: 92px"></col>
                                                            <col style="WIDTH: 133px"></col>
                                                        </colgroup>
                                                        <tbody class="xdTableHeader">
                                                            <tr>
                                                                <td style="TEXT-ALIGN: center; BORDER-LEFT: medium none; PADDING-BOTTOM: 1px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 5px; BORDER-RIGHT: medium none; PADDING-TOP: 1px">
                                                                    <div>New Asset Description</div>
                                                                    <div>(include serial # and model #, if necessary)</div>
                                                                </td>
                                                                <td style="TEXT-ALIGN: center; BORDER-LEFT: medium none; PADDING-BOTTOM: 1px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 5px; BORDER-RIGHT: medium none; PADDING-TOP: 1px">New Property Number</td>
                                                                <td style="TEXT-ALIGN: center; BORDER-LEFT: medium none; PADDING-BOTTOM: 1px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 5px; BORDER-RIGHT: medium none; PADDING-TOP: 1px">Cost With Installation</td>
                                                                <td style="TEXT-ALIGN: center; BORDER-LEFT: medium none; PADDING-BOTTOM: 1px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 5px; BORDER-RIGHT: medium none; PADDING-TOP: 1px">Estimated UsefulLife (in years)</td>
                                                                <td style="TEXT-ALIGN: center; BORDER-LEFT: medium none; PADDING-BOTTOM: 1px; BACKGROUND-COLOR: #e0e8f2; PADDING-LEFT: 5px; PADDING-RIGHT: 5px; BORDER-RIGHT: medium none; PADDING-TOP: 1px">Category</td>
                                                            </tr>
                                                        </tbody>
                                                        <tbody xd:xctname="repeatingtable">
                                                            <xsl:for-each select="my:coEquipmentGroup/my:coAssetRegistrarEquipment">
                                                                <tr>
                                                                    <td style="BORDER-LEFT: medium none; PADDING-BOTTOM: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 1px; VERTICAL-ALIGN: top; BORDER-RIGHT: medium none; PADDING-TOP: 4px">
                                                                        <span hideFocus="1" class="xdTextBox" title="" tabIndex="0" xd:xctname="PlainText" xd:CtrlId="CTRL50" xd:binding="my:coNewAssetDescription" style="WIDTH: 100%">
                                                                            <xsl:value-of select="my:coNewAssetDescription" />
                                                                        </span>
                                                                    </td>
                                                                    <td style="BORDER-LEFT: medium none; PADDING-BOTTOM: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 1px; VERTICAL-ALIGN: top; BORDER-RIGHT: medium none; PADDING-TOP: 4px">
                                                                        <span hideFocus="1" class="xdTextBox xdBehavior_Formatting" title="" contentEditable="true" tabIndex="0" xd:xctname="PlainText" xd:CtrlId="CTRL51" xd:binding="my:coNewPropertyNumber" xd:datafmt="&quot;number&quot;,&quot;numDigits:0;negativeOrder:1;&quot;" xd:boundProp="xd:num" style="TEXT-ALIGN: center; WIDTH: 100%; WHITE-SPACE: nowrap">
                                                                            <xsl:attribute name="xd:num">
                                                                                <xsl:value-of select="my:coNewPropertyNumber" />
                                                                            </xsl:attribute>
                                                                            <xsl:choose>
                                                                                <xsl:when test="function-available('xdFormatting:formatString')">
                                                                                    <xsl:value-of select="xdFormatting:formatString(my:coNewPropertyNumber,&quot;number&quot;,&quot;numDigits:0;negativeOrder:1;&quot;)" />
                                                                                </xsl:when>
                                                                                <xsl:otherwise>
                                                                                    <xsl:value-of select="my:coNewPropertyNumber" />
                                                                                </xsl:otherwise>
                                                                            </xsl:choose>
                                                                        </span>
                                                                    </td>
                                                                    <td style="BORDER-LEFT: medium none; PADDING-BOTTOM: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 1px; VERTICAL-ALIGN: top; BORDER-RIGHT: medium none; PADDING-TOP: 4px">
                                                                        <span hideFocus="1" class="xdTextBox xdBehavior_Formatting" title="" contentEditable="true" tabIndex="0" xd:xctname="PlainText" xd:CtrlId="CTRL52" xd:binding="my:coCostWithInstallation" xd:datafmt="&quot;currency&quot;,&quot;numDigits:2;negativeOrder:0;positiveOrder:0;currencyLocale:1033;&quot;" xd:boundProp="xd:num" style="WIDTH: 100%">
                                                                            <xsl:attribute name="xd:num">
                                                                                <xsl:value-of select="my:coCostWithInstallation" />
                                                                            </xsl:attribute>
                                                                            <xsl:choose>
                                                                                <xsl:when test="function-available('xdFormatting:formatString')">
                                                                                    <xsl:value-of select="xdFormatting:formatString(my:coCostWithInstallation,&quot;currency&quot;,&quot;numDigits:2;negativeOrder:0;positiveOrder:0;currencyLocale:1033;&quot;)" />
                                                                                </xsl:when>
                                                                                <xsl:otherwise>
                                                                                    <xsl:value-of select="my:coCostWithInstallation" />
                                                                                </xsl:otherwise>
                                                                            </xsl:choose>
                                                                        </span>
                                                                    </td>
                                                                    <td style="BORDER-LEFT: medium none; PADDING-BOTTOM: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 1px; VERTICAL-ALIGN: top; BORDER-RIGHT: medium none; PADDING-TOP: 4px">
                                                                        <span hideFocus="1" class="xdTextBox xdBehavior_Formatting" title="" contentEditable="true" tabIndex="0" xd:xctname="PlainText" xd:CtrlId="CTRL53" xd:binding="my:coEstimatedUsefulLife" xd:datafmt="&quot;number&quot;,&quot;numDigits:0;negativeOrder:1;&quot;" xd:boundProp="xd:num" style="TEXT-ALIGN: center; WIDTH: 100%; WHITE-SPACE: nowrap">
                                                                            <xsl:attribute name="xd:num">
                                                                                <xsl:value-of select="my:coEstimatedUsefulLife" />
                                                                            </xsl:attribute>
                                                                            <xsl:choose>
                                                                                <xsl:when test="function-available('xdFormatting:formatString')">
                                                                                    <xsl:value-of select="xdFormatting:formatString(my:coEstimatedUsefulLife,&quot;number&quot;,&quot;numDigits:0;negativeOrder:1;&quot;)" />
                                                                                </xsl:when>
                                                                                <xsl:otherwise>
                                                                                    <xsl:value-of select="my:coEstimatedUsefulLife" />
                                                                                </xsl:otherwise>
                                                                            </xsl:choose>
                                                                        </span>
                                                                    </td>
                                                                    <td style="BORDER-LEFT: medium none; PADDING-BOTTOM: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 1px; VERTICAL-ALIGN: top; BORDER-RIGHT: medium none; PADDING-TOP: 4px">
                                                                        <select class="xdComboBox xdBehavior_Select" title="" size="1" tabIndex="0" xd:xctname="dropdown" xd:CtrlId="CTRL57" xd:binding="my:coCategory" xd:boundProp="value" style="WIDTH: 100%">
                                                                            <xsl:attribute name="value">
                                                                                <xsl:value-of select="my:coCategory" />
                                                                            </xsl:attribute>
                                                                            <option>
                                                                                <xsl:if test="my:coCategory=&quot;&quot;">
                                                                                    <xsl:attribute name="selected">selected</xsl:attribute>
                                                                                </xsl:if>Select...
                                                                            </option>
                                                                            <option value="1 - Building">
                                                                                <xsl:if test="my:coCategory=&quot;1 - Building&quot;">
                                                                                    <xsl:attribute name="selected">selected</xsl:attribute>
                                                                                </xsl:if>1 - Building
                                                                            </option>
                                                                            <option value="2 - Land Improvements">
                                                                                <xsl:if test="my:coCategory=&quot;2 - Land Improvements&quot;">
                                                                                    <xsl:attribute name="selected">selected</xsl:attribute>
                                                                                </xsl:if>2 - Land Improvements
                                                                            </option>
                                                                            <option value="3 - Machinery &amp; Equip.">
                                                                                <xsl:if test="my:coCategory=&quot;3 - Machinery &amp; Equip.&quot;">
                                                                                    <xsl:attribute name="selected">selected</xsl:attribute>
                                                                                </xsl:if>3 - Machinery &amp; Equip.
                                                                            </option>
                                                                            <option value="4 - Office Furn./Fix/Equip.">
                                                                                <xsl:if test="my:coCategory=&quot;4 - Office Furn./Fix/Equip.&quot;">
                                                                                    <xsl:attribute name="selected">selected</xsl:attribute>
                                                                                </xsl:if>4 - Office Furn./Fix/Equip.
                                                                            </option>
                                                                            <option value="5 - Office Equip. w/Tech.">
                                                                                <xsl:if test="my:coCategory=&quot;5 - Office Equip. w/Tech.&quot;">
                                                                                    <xsl:attribute name="selected">selected</xsl:attribute>
                                                                                </xsl:if>5 - Office Equip. w/Tech.
                                                                            </option>
                                                                            <option value="6 - Software Upgrades">
                                                                                <xsl:if test="my:coCategory=&quot;6 - Software Upgrades&quot;">
                                                                                    <xsl:attribute name="selected">selected</xsl:attribute>
                                                                                </xsl:if>6 - Software Upgrades
                                                                            </option>
                                                                            <option value="7 - Automobile">
                                                                                <xsl:if test="my:coCategory=&quot;7 - Automobile&quot;">
                                                                                    <xsl:attribute name="selected">selected</xsl:attribute>
                                                                                </xsl:if>7 - Automobile
                                                                            </option>
                                                                            <option value="8 - Leasehold Improvement">
                                                                                <xsl:if test="my:coCategory=&quot;8 - Leasehold Improvement&quot;">
                                                                                    <xsl:attribute name="selected">selected</xsl:attribute>
                                                                                </xsl:if>8 - Leasehold Improvement
                                                                            </option>
                                                                        </select>
                                                                    </td>
                                                                </tr>
                                                            </xsl:for-each>
                                                        </tbody>
                                                    </table>
                                                    <div class="optionalPlaceholder" xd:xmlToEdit="coAssetRegistrarEquipment_75" tabIndex="0" xd:action="xCollection::insert" style="WIDTH: 648px">Insert item</div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 649px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                                        <colgroup>
                                                            <col style="WIDTH: 253px"></col>
                                                            <col style="WIDTH: 78px"></col>
                                                            <col style="WIDTH: 92px"></col>
                                                            <col style="WIDTH: 96px"></col>
                                                            <col style="WIDTH: 130px"></col>
                                                        </colgroup>
                                                        <tbody vAlign="top">
                                                            <tr>
                                                                <td>
                                                                    <div>
                                                                        <font size="2" face="Calibri"></font>
                                                                    </div>
                                                                </td>
                                                                <td style="PADDING-BOTTOM: 4px; PADDING-LEFT: 1px; PADDING-RIGHT: 1px; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <strong>Total Cost (amount closed):</strong>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                                <td style="PADDING-BOTTOM: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 5px; PADDING-TOP: 4px">
                                                                    <div>
                                                                        <font size="2" face="Calibri">
                                                                            <span hideFocus="1" class="xdTextBox  xdBehavior_Formatting" title="" contentEditable="true" xd:xctname="PlainText" xd:CtrlId="CTRL55" xd:binding="my:coTotalEquipmentCost" xd:datafmt="&quot;currency&quot;,&quot;numDigits:2;negativeOrder:0;positiveOrder:0;currencyLocale:1033;&quot;" xd:boundProp="xd:num" style="WIDTH: 82px; HEIGHT: 19px">
                                                                                <xsl:attribute name="xd:num">
                                                                                    <xsl:value-of select="my:coTotalEquipmentCost" />
                                                                                </xsl:attribute>
                                                                                <xsl:choose>
                                                                                    <xsl:when test="function-available('xdFormatting:formatString')">
                                                                                        <xsl:value-of select="xdFormatting:formatString(my:coTotalEquipmentCost,&quot;currency&quot;,&quot;numDigits:2;negativeOrder:0;positiveOrder:0;currencyLocale:1033;&quot;)" />
                                                                                    </xsl:when>
                                                                                    <xsl:otherwise>
                                                                                        <xsl:value-of select="my:coTotalEquipmentCost" />
                                                                                    </xsl:otherwise>
                                                                                </xsl:choose>
                                                                            </span>
                                                                        </font>
                                                                    </div>
                                                                </td>
                                                                <td>
                                                                    <div>
                                                                        <font size="2" face="Calibri"></font>
                                                                    </div>
                                                                </td>
                                                                <td>
                                                                    <div>
                                                                        <font size="2" face="Calibri"></font>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <div>
                                                    <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 648px; BORDER-COLLAPSE: collapse; WORD-WRAP: break-word; TABLE-LAYOUT: fixed; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="xdLayout" border="1" borderColor="buttontext">
                                                        <colgroup>
                                                            <col style="WIDTH: 249px"></col>
                                                            <col style="WIDTH: 369px"></col>
                                                            <col style="WIDTH: 30px"></col>
                                                        </colgroup>
                                                        <tbody vAlign="top">
                                                            <tr>
                                                                <td style="BORDER-BOTTOM: #f2f2f2 1pt solid">
                                                                    <div>
                                                                        <font size="2" face="Calibri"></font>
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #f2f2f2 1pt solid">
                                                                    <div>
                                                                        <!--<font color="#ff0000" size="1" face="Calibri">Total Cost must equal Amount Closed. </font>-->
                                                                    </div>
                                                                </td>
                                                                <td style="BORDER-BOTTOM: #f2f2f2 1pt solid">
                                                                    <div>
                                                                        <font size="2" face="Calibri"></font>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div>
                                                    <font size="2" face="Calibri"></font>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </span>
                        </div>
                        <div />
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
                            
                            `;$("#"+o+"_Content").html(u)}else displayAlertDialog("In bwRequest.js.displayCloseoutInDialog(). Could not find the form for bwBudgetRequestId: "+n)}catch(l){console.log("Exception in displayCloseoutInDialog().dialog.open(): "+l.message+", "+l.stack);displayAlertDialog("Exception in displayCloseoutInDialog().dialog.open(): "+l.message+", "+l.stack)}}});$("#"+r).dialog("moveToTop");console.log("xcx213123 dialog moveToTop")}catch(o){console.log("Exception in displayCloseoutInDialog(): "+o.message+", "+o.stack);displayAlertDialog("Exception in displayCloseoutInDialog(): "+o.message+", "+o.stack)}},hideRequestAndPrepareToRenderAlerts:function(){try{console.log("In hideRequestAndPrepareToRenderAlerts().");var n="";n+='<div id="divHomePageAlert"><\/div>';document.getElementById("welcomePageMyTasksTab").innerHTML=n;renderAlerts()}catch(t){console.log("Exception in hideRequestAndPrepareToRenderAlerts(): "+t.message+", "+t.stack)}},displayArInMobileTab:function(n,t,i,r,u,f){var h,o,e;try{h=this;try{$("#divRowHoverDetails").dialog("close")}catch(s){}if(displayTaskDetailsBeforeRequests!=!0)this.displayRequestFormForMobile(t,participantId,u,f);else if(t||r)if(n||t||i||u)try{$("#spanArDialogTitle").empty();$("#spanArDialogTaskAuditTrail").empty();$("#spanArDialogViewBudgetRequestLink").empty();alert("Displaying ArDialog. xcx23425345-3-6");$("#ArDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:r+" ("+u+")",width:"720px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#ArDialog").dialog("close")})},close:function(){try{displayAlertDialog("In xcx23412(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-9")}catch(n){}}});$("#ArDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();$("#spanArDialogTitle").html(r+" ("+u+")x2");e=webserviceurl+"/bwworkflowtasks/getbybudgetrequestid/"+t;$.ajax({url:e,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){var e,o,r,s,f;if(i.d.results.length==0)html="",html+="<table>",html+="   <tr>",html+="       <td>&nbsp;<\/td>",html+="   <\/tr>",html+="   <tr>",html+="       <td>",html+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+participantId+"', '"+u+"');\">Click here to view the Budget Request<\/a>",html+="       <\/td>",html+="   <\/tr>",html+="<\/table>",$("#spanArDialogViewBudgetRequestLink").html(html);else{for(e=[],e.push(i.d.results[0].bwAuthorId),o=0;o<i.d.results.length;o++)e.push(i.d.results[o].bwAssignedToId);for(r=[],s=0,f=0;f<e.length;f++)GetUserDetails[f]=$.Deferred(),GetUserDetails[f].done(function(n){var f,c,o,l,h;if(s+=1,r.push(n),s==e.length){for(f="",f+="<table>",f+="   <tr>",f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[0].Created)+'">',c="",h=0;h<r.length;h++)r[h][0]==i.d.results[0].bwAuthorId&&(c=r[h][1]);for(f+='           <strike><span style="cursor:help;">xcx16'+formatDateFromBW(i.d.results[0].Created)+" - Request submitted by "+c+"<\/span><\/strike>",f+="       <\/td>",f+="   <\/tr>",f+="<\/table>",o=0;o<i.d.results.length;o++){if(f+="<table>",f+="   <tr>",f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[o].Modified)+'">',i.d.results[o].bwPercentComplete==100&&i.d.results[o].bwStatus=="Completed")f+="       <strike>",f+='<span style="cursor:help;">xcx17'+formatDateFromBW(i.d.results[o].Modified)+" - "+i.d.results[o].bwTaskOutcome+" ["+i.d.results[o].bwAssignedToRaciRoleName+" ("+i.d.results[o].bwAssignedToRaciRoleAbbreviation+")]x<\/span>",f+="       <\/strike>";else{for(l="",h=0;h<r.length;h++)r[h][0]==i.d.results[o].bwAssignedToId&&(l=r[h][1]);f+="xcx18"+formatDateFromBW(i.d.results[o].Created)+" - "+i.d.results[o].bwTaskTitle+" assigned to "+l+" ["+i.d.results[o].bwAssignedToRaciRoleName+" ("+i.d.results[o].bwAssignedToRaciRoleAbbreviation+")]x"}f+="       <\/td>";f+="   <\/tr>";f+="<\/table>"}$("#spanArDialogTaskAuditTrail").html(f);f="";f+="<table>";f+="   <tr>";f+="       <td>&nbsp;<\/td>";f+="   <\/tr>";f+="   <tr>";f+="       <td>";f+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+participantId+"', '"+u+"');\">Click here to view the Budget Request<\/a>";f+="       <\/td>";f+="   <\/tr>";f+="<\/table>";$("#spanArDialogViewBudgetRequestLink").html(f);$("#ui-id-1").css("border-radius","20px 0 0 20px")}}).fail(function(){handleExceptionWithAlert("Error in bwRequest.displayArInMobileTab().GetUserDetails.fail()","GetUserDetails.fail()")}),getUserDetails(e[f],n,f)}},error:function(){handleExceptionWithAlert("Error in bwRequest.displayArInMobileTab()","1:"+errorCode+", "+errorMessage)}})}catch(s){handleExceptionWithAlert("Error in bwRequest.displayArInMobileTab()","2:"+s.message)}else e=webserviceurl+"/getbudgetrequestidfromtitle/"+r,$.ajax({url:e,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){t=i[0].bwBudgetRequestId;n=globalUrlPrefix+globalUrlForWebServices;r=i[0].ProjectTitle;u=i[0].Title;try{$("#spanArDialogTitle").empty();$("#spanArDialogTaskAuditTrail").empty();$("#spanArDialogViewBudgetRequestLink").empty();alert("Displaying ArDialog. xcx23425345-3-5");$("#ArDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:r+" ("+u+")",width:"720px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#ArDialog").dialog("close")})},close:function(){try{displayAlertDialog("In xcx23412(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-8")}catch(n){}}});$("#ArDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();$("#spanArDialogTitle").html(r+" ("+u+")x1");var f=webserviceurl+"/bwworkflowtasks/getbybudgetrequestid/"+t;$.ajax({url:f,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){var e,o,r,s,f;if(i.d.results.length!=0){for(e=[],e.push(i.d.results[0].bwAuthorId),o=0;o<i.d.results.length;o++)e.push(i.d.results[o].bwAssignedToId);for(r=[],s=0,f=0;f<e.length;f++)GetUserDetails[f]=$.Deferred(),GetUserDetails[f].done(function(n){var f,c,o,l,h;if(s+=1,r.push(n),s==e.length){for(f="",f+="<table>",f+="   <tr>",f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[0].Created)+'">',c="",h=0;h<r.length;h++)r[h][0]==i.d.results[0].bwAuthorId&&(c=r[h][1]);for(f+='           <strike><span style="cursor:help;">xcx13'+formatDateFromBW(i.d.results[0].Created)+" - Request submitted by "+c+"[raci role 3]<\/span><\/strike>",f+="       <\/td>",f+="   <\/tr>",f+="<\/table>",o=0;o<i.d.results.length;o++){if(f+="<table>",f+="   <tr>",f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[o].Modified)+'">',i.d.results[o].bwPercentComplete==100&&i.d.results[o].bwStatus=="Completed")f+="       <strike>",f+='<span style="cursor:help;">xcx14'+formatDateFromBW(i.d.results[o].Modified)+" - "+i.d.results[o].bwTaskOutcome+"[raci role 4]<\/span>",f+="       <\/strike>";else{for(l="",h=0;h<r.length;h++)r[h][0]==i.d.results[o].bwAssignedToId&&(l=r[h][1]);f+="xcx15"+formatDateFromBW(i.d.results[o].Created)+" - "+i.d.results[o].bwTaskTitle+" assigned to "+l}f+="       <\/td>";f+="   <\/tr>";f+="<\/table>"}$("#spanArDialogTaskAuditTrail").html(f);f="";f+="<table>";f+="   <tr>";f+="       <td>&nbsp;<\/td>";f+="   <\/tr>";f+="   <tr>";f+="       <td>";f+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+participantId+"', '"+u+"');\">Click here to view the Budget Request<\/a>";f+="       <\/td>";f+="   <\/tr>";f+="<\/table>";$("#spanArDialogViewBudgetRequestLink").html(f);$("#ui-id-1").css("border-radius","20px 0 0 20px")}}).fail(function(){handleExceptionWithAlert("Error in bwRequest.displayArInMobileTab().GetUserDetails.fail()","GetUserDetails.fail()")}),getUserDetails(e[f],n,f)}},error:function(){handleExceptionWithAlert("Error in bwRequest.displayArInMobileTab()","1:"+errorCode+", "+errorMessage)}})}catch(e){handleExceptionWithAlert("Error in bwRequest.displayArInMobileTab()","2:"+e.message)}},error:function(){handleExceptionWithAlert("Error in bwRequest.displayArInMobileTab()","1:"+errorCode+", "+errorMessage)}});else{t=$('span[xd\\:binding = "my:BudgetRequestId"]')[0].innerHTML;n=this.options.operationUriPrefix;r=$('span[xd\\:binding = "my:Project_Name"]')[0].innerHTML;u=$('span[xd\\:binding = "my:Title"]')[0].innerHTML;try{$("#spanArDialogTitle").empty();$("#spanArDialogTaskAuditTrail").empty();$("#spanArDialogViewBudgetRequestLink").empty();alert("Displaying ArDialog. xcx23425345-3-4");$("#ArDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:r+" ("+u+")",width:"720px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#ArDialog").dialog("close")})},close:function(){try{displayAlertDialog("In xcx23412(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-7")}catch(n){}}});$("#ArDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();o="";o+=" ";o+="&nbsp;&nbsp;&nbsp;&nbsp;x11";o+=r+" ("+u+")";$("#spanArDialogTitle").html(o);e=webserviceurl+"/bwworkflowtasks/getbybudgetrequestid/"+t;$.ajax({url:e,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){var e,o,r,s,f;if(i.d.results.length!=0){for(e=[],e.push(i.d.results[0].bwAuthorId),o=0;o<i.d.results.length;o++)e.push(i.d.results[o].bwAssignedToId);for(r=[],s=0,f=0;f<e.length;f++)GetUserDetails[f]=$.Deferred(),GetUserDetails[f].done(function(n){var f,c,o,l,h;if(s+=1,r.push(n),s==e.length){for(f="",f+="<table>",f+="   <tr>",f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[0].Created)+'">',c="",h=0;h<r.length;h++)r[h][0]==i.d.results[0].bwAuthorId&&(c=r[h][1]);for(f+='           <strike><span style="cursor:help;">xcx10'+formatDateFromBW(i.d.results[0].Created)+" - Request submitted by "+c+"<\/span><\/strike>",f+="       <\/td>",f+="   <\/tr>",f+="<\/table>",o=0;o<i.d.results.length;o++){if(f+="<table>",f+="   <tr>",i.d.results[o].bwPercentComplete==100&&i.d.results[o].bwStatus=="Completed")f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[o].Modified)+'">',f+="       <strike>",f+='<span style="cursor:help;">xcx11'+formatDateFromBW(i.d.results[o].Modified)+" - "+i.d.results[o].bwTaskOutcome+"[raci role1]<\/span>",f+="       <\/strike>",f+="       <\/td>";else{for(l="",h=0;h<r.length;h++)r[h][0]==i.d.results[o].bwAssignedToId&&(l=r[h][1]);f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[o].Created)+'">';f+='<span style="cursor:help;">xcx12'+formatDateFromBW(i.d.results[o].Created)+" - "+i.d.results[o].bwTaskTitle+" assigned to "+l+"[raci role2]<\/span>";f+="       <\/td>"}f+="   <\/tr>";f+="<\/table>"}$("#spanArDialogTaskAuditTrail").html(f);f="";f+="<table>";f+="   <tr>";f+="       <td>&nbsp;<\/td>";f+="   <\/tr>";f+="   <tr>";f+="       <td>";f+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+participantId+"', '"+u+"');\">Click here to view the Budget Request<\/a>";f+="       <\/td>";f+="   <\/tr>";f+="<\/table>";$("#spanArDialogViewBudgetRequestLink").html(f);$("#ui-id-1").css("border-radius","20px 0 0 20px")}}).fail(function(){handleExceptionWithAlert("Error in bwRequest.displayArInMobileTab().GetUserDetails.fail()","GetUserDetails.fail()")}),getUserDetails(e[f],n,f)}},error:function(){handleExceptionWithAlert("Error in bwRequest.displayArInMobileTab()","1:"+errorCode+", "+errorMessage)}})}catch(s){handleExceptionWithAlert("Error in bwRequest.displayArInMobileTab()","2:"+s.message)}}}catch(s){console.log("Exception in displayArInMobileTab(): "+s.message+", "+s.stack)}},pinRequest:function(n,t,i){var s,o;try{console.log("In bwRequest.js.pinRequest().");s=this;i!=!0?ShowActivitySpinner("Un-pinning the request..."):ShowActivitySpinner("Pinning the request...");var r=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),f=$(".bwAuthentication").bwAuthentication("option","participantId"),e=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");data={bwParticipantId_LoggedIn:f,bwActiveStateIdentifier:e,bwWorkflowAppId_LoggedIn:r,Pinned:i,bwParticipantId:f,bwBudgetRequestId:n,bwWorkflowAppId:r};o=webserviceurl+"/pinrequest";$.ajax({url:o,type:"POST",data:data,headers:{Accept:"application/json; odata=verbose"},success:function(u){var c,l,s,u,v,h,b,o;try{if(HideActivitySpinner(),console.log("In bwRequest.js.pinRequest(). Calling window.scrollTo(0, 0)."),window.scrollTo(0,0),u.status!="SUCCESS")console.log(u.message),displayAlertDialog(u.message);else{if(i==!0){for(c="The request has been Pinned.",l=$(".bwAuthentication:first").bwAuthentication("option","ACTIVE_REQUESTS"),o=0;o<l.length;o++)if(l[o].bwBudgetRequestId==n){s=l[o];break}if(s){if($(".bwAuthentication:first").bwAuthentication("option","PINNED_REQUESTS")?$(".bwAuthentication:first").bwAuthentication("option","PINNED_REQUESTS").push(s):(v=[],v.push(s),$(".bwAuthentication:first").bwAuthentication("option","PINNED_REQUESTS",v)),document.getElementById(t)){var y=document.getElementById(t).parentNode,p=$(y).find(".pinButton"),w='<div title="un-pin" class="pinButton" style="display:inline-block;font-size:18pt;cursor:pointer !important;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequest\', \''+n+"', '"+t+'\', false);"><img src="/images/unpin.png" style="width:50px;height:50px;cursor:pointer !important;" /><\/div>';$(p).replaceWith(w)}$(".bwExecutiveSummariesCarousel2:first").bwExecutiveSummariesCarousel2("expandOrCollapseAlertsSection","functionalAreaRow_bwExecutiveSummariesCarousel2_6","alertSectionImage_bwExecutiveSummariesCarousel2_6","alertSectionRow_bwExecutiveSummariesCarousel2_6");$(".bwExecutiveSummariesCarousel2:first").bwExecutiveSummariesCarousel2("expandOrCollapseAlertsSection","functionalAreaRow_bwExecutiveSummariesCarousel2_6","alertSectionImage_bwExecutiveSummariesCarousel2_6","alertSectionRow_bwExecutiveSummariesCarousel2_6")}else console.log("In bwRequest.js.pinRequest(). We tried to find the request locally, but we don't have it yet... so asking the server for it. This was a half-hearted attempt to find it, I am sure we could do better someday."),u={bwParticipantId_LoggedIn:f,bwActiveStateIdentifier:e,bwWorkflowAppId_LoggedIn:r,bwWorkflowAppId:r,bwBudgetRequestId:n,isActive:!0,bwRequestType:"ALL"},$.ajax({url:webserviceurl+"/getsinglebudgetrequest",type:"POST",data:u,headers:{Accept:"application/json; odata=verbose"},error:function(n,i,r){$(".bwPageScrollingHandler").bwPageScrollingHandler("CloseDialogAndPreventNextWindowScrollEvent",t);n.status==401?(console.log('HTTP 401 "Unauthorized".'),console.log('HTTP 401 "Unauthorized".'),console.log("Error in bwRequest.js.displayRequestForm.getsinglebudgetrequest(). xcx213124-1-1 Unauthorized. Please refresh your browser and log in again. jqXHR.status: "+n.status+", settings: "+i+", errorThrown: "+r),console.log('HTTP 401 "Unauthorized".'),console.log('HTTP 401 "Unauthorized".')):(console.log("Error in bwRequest.js.pinRequest():1: "+i+", "+r+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n)),alert("Error in bwRequest.js.pinRequest():1: "+i+", "+r+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n)))},success:function(i){var u;try{if(console.log("In bwRequest.js.pinRequest.getsinglebudgetrequest.success()."),i.status!="SUCCESS")console.log("Error in bwRequest.js.pinRequest.getsinglebudgetrequest.success(): "+JSON.stringify(i)),displayAlertDialog("Error in bwRequest.js.pinRequest.getsinglebudgetrequest.success(): "+JSON.stringify(i));else{if(s=i.results.BudgetRequest,$(".bwAuthentication:first").bwAuthentication("option","PINNED_REQUESTS")?$(".bwAuthentication:first").bwAuthentication("option","PINNED_REQUESTS").push(s):(u=[],u.push(s),$(".bwAuthentication:first").bwAuthentication("option","PINNED_REQUESTS",u)),document.getElementById(t)){var f=document.getElementById(t).parentNode,e=$(f).find(".pinButton"),o='<div title="un-pin" class="pinButton" style="display:inline-block;font-size:18pt;cursor:pointer !important;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequest\', \''+n+"', '"+t+'\', false);"><img src="/images/unpin.png" style="width:50px;height:50px;cursor:pointer !important;" /><\/div>';$(e).replaceWith(o)}$(".bwExecutiveSummariesCarousel2:first").bwExecutiveSummariesCarousel2("expandOrCollapseAlertsSection","functionalAreaRow_bwExecutiveSummariesCarousel2_6","alertSectionImage_bwExecutiveSummariesCarousel2_6","alertSectionRow_bwExecutiveSummariesCarousel2_6");$(".bwExecutiveSummariesCarousel2:first").bwExecutiveSummariesCarousel2("expandOrCollapseAlertsSection","functionalAreaRow_bwExecutiveSummariesCarousel2_6","alertSectionImage_bwExecutiveSummariesCarousel2_6","alertSectionRow_bwExecutiveSummariesCarousel2_6")}}catch(r){console.log("Exception in bwRequest.js.pinRequest():2: "+r.message+", "+r.stack);displayAlertDialog("Exception in bwRequest.js.pinRequest():2: "+r.message+", "+r.stack)}}})}else if(i==!1){for(c="The request has been Un-Pinned.",h=$(".bwAuthentication:first").bwAuthentication("option","PINNED_REQUESTS"),o=0;o<h.length;o++)if(h[o].bwBudgetRequestId==n){b=o;break}if(h.splice(b,1),$(".bwAuthentication:first").bwAuthentication("option","PINNED_REQUESTS",h),document.getElementById(t)){var y=document.getElementById(t).parentNode,p=$(y).find(".pinButton"),w='<div title="pin" class="pinButton" style="display:inline-block;font-size:18pt;cursor:pointer !important;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequest\', \''+n+"', '"+t+'\', true);"><img src="/images/pin.png" style="width:50px;height:50px;cursor:pointer !important;" /><\/div>';$(p).replaceWith(w)}$(".bwExecutiveSummariesCarousel2:first").bwExecutiveSummariesCarousel2("expandOrCollapseAlertsSection","functionalAreaRow_bwExecutiveSummariesCarousel2_6","alertSectionImage_bwExecutiveSummariesCarousel2_6","alertSectionRow_bwExecutiveSummariesCarousel2_6");$(".bwExecutiveSummariesCarousel2:first").bwExecutiveSummariesCarousel2("expandOrCollapseAlertsSection","functionalAreaRow_bwExecutiveSummariesCarousel2_6","alertSectionImage_bwExecutiveSummariesCarousel2_6","alertSectionRow_bwExecutiveSummariesCarousel2_6")}else c="Error: Unexpected response.";console.log(c);$(".bwExecutiveSummariesCarousel2:first").bwExecutiveSummariesCarousel2("updatePinnedRequests")}}catch(a){HideActivitySpinner();console.log("Exception in bwRequest.js.pinRequest():2: "+a.message+", "+a.stack);displayAlertDialog("Exception in bwRequest.js.pinRequest():2: "+a.message+", "+a.stack)}},error:function(n,t,i){HideActivitySpinner();console.log("Error in bwRequest.js.pinRequest./pinrequest(): "+i);displayAlertDialog("Error in bwRequest.js.pinRequest./pinrequest(): "+i)}})}catch(u){HideActivitySpinner();console.log("Exception in bwRequest.js.pinRequest(): "+u.message+", "+u.stack);displayAlertDialog("Exception in bwRequest.js.pinRequest(): "+u.message+", "+u.stack)}},addToPriorityGrup:function(){try{console.log("In bwRequest.js.addToPriorityGrup().");alert("In bwRequest.js.addToPriorityGrup(). This functionality is incomplete. Coming soon!");var t=this}catch(n){console.log("Exception in bwRequest.js.addToPriorityGrup(): "+n.message+", "+n.stack);displayAlertDialog("Exception in bwRequest.js.addToPriorityGrup(): "+n.message+", "+n.stack)}},cmdDeleteBudgetRequest:function(n){var u,f;try{console.log("In bwRequest.js.cmdDeleteBudgetRequest().");var e=this,i=$(".bwAuthentication").bwAuthentication("option","participantId"),r=$(".bwAuthentication").bwAuthentication("option","workflowAppId");$("#divWorkingOnItDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Working on it...",width:"800",dialogClass:"no-close",hide:!1});$("#divWorkingOnItDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();u=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");data={bwParticipantId_LoggedIn:i,bwActiveStateIdentifier:u,bwWorkflowAppId_LoggedIn:r,bwBudgetRequestId:n,bwWorkflowAppId:r,participantId:i};f=webserviceurl+"/putthisrequestinthetrashbin";$.ajax({url:f,type:"POST",data:data,headers:{Accept:"application/json; odata=verbose"},success:function(t){var i,r;try{if(displayAlertDialog(t.message),t.status!="SUCCESS")$("#divWorkingOnItDialog").dialog("close"),$("#divRequestFormDialog_"+n).dialog("close"),displayAlertDialog(t.message);else if($("#divWorkingOnItDialog").dialog("close"),$("#divRequestFormDialog_"+n).dialog("option","bwForceClose",!0),setTimeout(function(){$("#divRequestFormDialog_"+n).dialog("close");$("#divAlertDialog").dialog("close")},1500),console.log("Preparing to hide the deleted executive summary. bwBudgetRequestId: "+n+". xcx2353264"),i=$(".executiveSummaryInCarousel"),i&&i.length&&i.length>0)for(r=0;r<i.length;r++)$(i[r]).attr("bwbudgetrequestid")==n&&$(i[r]).attr("style","display:none;")}catch(u){console.log("Exception in bwRequest.js.cmdDeleteBudgetRequest():2: "+u.message+", "+u.stack);alert("Exception in bwRequest.js.cmdDeleteBudgetRequest():2: "+u.message+", "+u.stack)}},error:function(n,t,i){try{alert("Error in bwRequest.js.cmdDeleteBudgetRequest(): "+i)}catch(r){console.log("Error in bwRequest.js.cmdDeleteBudgetRequest():3: "+r.message+", "+r.stack);displayAlertDialog("Error in bwRequest.js.cmdDeleteBudgetRequest():3: "+r.message+", "+r.stack)}}})}catch(t){console.log("Exception in bwRequest.js.cmdDeleteBudgetRequest(): "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.cmdDeleteBudgetRequest(): "+t.message+", "+t.stack);alert("Exception in bwRequest.js.cmdDeleteBudgetRequest(): "+t.message+", "+t.stack)}},cmdDisplayDeleteBudgetRequestDialog:function(n,t){var u;try{console.log("In bwRequest.js.cmdDisplayDeleteBudgetRequestDialog().");var f=this,r=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),e=$(".bwAuthentication").bwAuthentication("option","participantId"),o=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");data={bwParticipantId_LoggedIn:e,bwActiveStateIdentifier:o,bwWorkflowAppId_LoggedIn:r,bwBudgetRequestId:n,bwWorkflowAppId:r};u=webserviceurl+"/bwworkflow/itemizebudgetrequestdependencies";$.ajax({url:u,type:"POST",data:data,headers:{Accept:"application/json; odata=verbose"},success:function(i){var r;try{i.status!="SUCCESS"?displayAlertDialog(JSON.stringify(i)):($("#DeleteABudgetRequestDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"Delete "+n,width:"570px",dialogClass:"no-close",hide:!1,buttons:{"Delete Budget Request":{text:"Delete Budget Request, supplementals and tasks",id:"btnDeleteABudgetRequest",disabled:"true",click:function(){console.log("In bwRequest.js.cmdDisplayDeleteBudgetRequestDialog.DeleteABudgetRequestDialog.click(). Calling cmdDeleteBudgetRequest(). bwBudgetRequestId: "+n);f.cmdDeleteBudgetRequest(n);$(this).dialog("close")}},Cancel:function(){$(this).dialog("close")}},open:function(){var n,t;try{n="";n+=i.NumberOfIncompleteTasksForBudgetRequest==0&&i.NumberOfCompletedTasksForBudgetRequest==0&&i.NumberOfSupplementals==0?"This Request has no dependencies, and can be deleted immediately.":"When this Request is deleted, the following will also be deleted:";(i.NumberOfIncompleteTasksForBudgetRequest>0||i.NumberOfCompletedTasksForBudgetRequest>0)&&(n+="<ul>",i.NumberOfIncompleteTasksForBudgetRequest>0&&(n+='<li style="color:red;"><span style="color:black;">'+i.NumberOfIncompleteTasksForBudgetRequest+" incomplete Task(s)<\/span><\/li>"),i.NumberOfCompletedTasksForBudgetRequest>0&&(n+='<li style="color:red;"><span style="color:black;">'+i.NumberOfCompletedTasksForBudgetRequest+" completed Task(s)<\/span><\/li>"),n+="<\/ul>");i.NumberOfSupplementals>0&&(n+="Also, "+i.NumberOfSupplementals+" Supplemental Request(s) will be deleted, along with the following:",n+="<ul>",i.NumberOfIncompleteTasksForSupplementals>0&&(n+='<li style="color:red;"><span style="color:black;">'+i.NumberOfIncompleteTasksForSupplementals+" incomplete Task(s)<\/span><\/li>"),i.NumberOfCompletedTasksForSupplementals>0&&(n+='<li style="color:red;"><span style="color:black;">'+i.NumberOfCompletedTasksForSupplementals+" complete Task(s)<\/span><\/li>"),n+="<\/ul>");document.getElementById("spanDeleteABudgetRequestDialogDependencyDetails").innerHTML=n}catch(r){t="Exception in xcx2131312: "+r.message+", "+r.stack;console.log(t);alert(t)}}}),$("#DeleteABudgetRequestDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),document.getElementById("spanDeleteABudgetRequestDialogTitle").innerHTML="Delete "+t+".");i.NumberOfIncompleteTasksForBudgetRequest==0&&i.NumberOfCompletedTasksForBudgetRequest==0&&i.NumberOfSupplementals==0?(r=$("#DeleteABudgetRequestDialog").dialog("option","buttons"),$.each(r,function(t,i){i.id==="btnDeleteABudgetRequest"&&(i.text="Delete "+n,i.disabled=!1)}),$("#DeleteABudgetRequestDialog").dialog("option","buttons",r)):(r=$("#DeleteABudgetRequestDialog").dialog("option","buttons"),$.each(r,function(n,t){t.id==="btnDeleteABudgetRequest"&&(t.text="Delete the Budget Request and all related items",t.disabled=!1,t.style="color:red;")}),$("#DeleteABudgetRequestDialog").dialog("option","buttons",r))}catch(u){console.log("Exception in bwRequest.js.cmdDisplayDeleteBudgetRequestDialog():2: "+u.message+", "+u.stack);displayAlertDialog("Exception in bwRequest.js.cmdDisplayDeleteBudgetRequestDialog():2: "+u.message+", "+u.stack)}},error:function(n,t,i){displayAlertDialog("Error in bwRequest.js.cmdDisplayDeleteBudgetRequestDialog().itemizebudgetrequestdependencies xcx332-1: "+i)}})}catch(i){console.log("Exception in bwRequest.js.cmdDisplayDeleteBudgetRequestDialog(): "+i.message+", "+i.stack);displayAlertDialog("Exception in bwRequest.js.cmdDisplayDeleteBudgetRequestDialog(): "+i.message+", "+i.stack)}},saveDailyOverdueTaskNotificationDate:function(n){var i;try{console.log("In saveDailyOverdueTaskNotificationDate().");var f=this,r=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),u=document.getElementById("divBwUpdateDailyOverdueTaskNotificationDate_Dialog_DailyOverdueTaskNotificationDate").value;data={bwWorkflowAppId:r,bwWorkflowTaskItemId:n,DailyOverdueTaskNotificationDate:u};i=webserviceurl+"/bwworkflow/savetaskdailyoverduetasknotificationdate";$.ajax({url:i,type:"POST",data:data,headers:{Accept:"application/json; odata=verbose"},success:function(n){n.message!="SUCCESS"?displayAlertDialog(JSON.stringify(n.message)):$("#divBwUpdateDailyOverdueTaskNotificationDate_Dialog").dialog("close")},error:function(n,t,i){displayAlertDialog("Error in bwRequest.js.saveDailyOverdueTaskNotificationDate(): "+i)}})}catch(t){console.log("Exception in saveDailyOverdueTaskNotificationDate(): "+t.message+", "+t.stack);displayAlertDialog("Exception in saveDailyOverdueTaskNotificationDate(): "+t.message+", "+t.stack)}},displayUpdateDailyOverdueTaskNotificationDateDialog:function(n){var t;try{console.log("In bwRequest.js.displayUpdateDailyOverdueTaskNotificationDateDialog(). bwWorkflowTaskItemId: "+n);var f=this,r=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),u=document.getElementById("divBwUpdateDailyOverdueTaskNotificationDate_Dialog");u||(t="",t+='<div style="display:none;" id="divBwUpdateDailyOverdueTaskNotificationDate_Dialog">',t+='   <table style="width:100%;">',t+="       <tr>",t+='           <td style="width:90%;">',t+="               <span id=\"spanAddAnOrgItemDialogTitle\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">Update DailyOverdueTaskNotificationDate<\/span>",t+="           <\/td>",t+='           <td style="width:9%;"><\/td>',t+='           <td style="width:1%;cursor:pointer;vertical-align:top;">',t+="               <span class=\"dialogXButton\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size: 30pt;font-weight:bold;\" onclick=\"$('#divBwUpdateDailyOverdueTaskNotificationDate_Dialog').dialog('close');\">X<\/span>",t+="           <\/td>",t+="       <\/tr>",t+="   <\/table>",t+="   <br /><br />",t+='   <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->',t+='<span id="divBwUpdateDailyOverdueTaskNotificationDate_Dialog_Content"><\/span>',t+="<\/div>",$(document.body).prepend(t));$("#divBwUpdateDailyOverdueTaskNotificationDate_Dialog").dialog({modal:!0,resizable:!1,closeOnEscape:!0,width:"700",dialogClass:"no-close",hide:!1,close:function(){$("#divBwUpdateDailyOverdueTaskNotificationDate_Dialog").dialog("destroy")},open:function(){var t,u;try{t="";t+="   <span id=\"spanAddAnOrgItemDialogInvitationDescriptionText\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 20pt;\"><\/span>";t+='   <span style="font-family: calibri;">Change this value then click the Save button.<br />DailyOverdueTaskNotificationDate:<\/span>';t+="   <br />";t+="   <input type=\"text\" id=\"divBwUpdateDailyOverdueTaskNotificationDate_Dialog_DailyOverdueTaskNotificationDate\" style=\"WIDTH: 50%;font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 20pt;\" />";t+="   <br /><br /><br />";t+='   <span style="font-family: calibri;">Now<\/span>';t+="   <br />";t+="   <input type=\"text\" id=\"divBwUpdateDailyOverdueTaskNotificationDate_Dialog_Now\" disabled style=\"WIDTH: 50%;font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 20pt;\" />";t+="   <br /><br /><br />";t+="   <div class=\"divSignInButton\" style=\"width:90%;text-align:center;line-height:1.1em;font-weight:bold;\" onclick=\"$('.bwRequest').bwRequest('saveDailyOverdueTaskNotificationDate', '"+n+"');\">";t+="       Save";t+="   <\/div>";t+="   <br /><br />";t+='   <div class="divSignInButton" style="width: 90%; text-align: center; line-height: 1.1em; font-weight: bold;" onclick="$(\'#divBwUpdateDailyOverdueTaskNotificationDate_Dialog\').dialog(\'close\');">';t+="       Close";t+="   <\/div>";t+="   <br /><br />";$("#divBwUpdateDailyOverdueTaskNotificationDate_Dialog_Content").html(t);$(".ui-widget-overlay").bind("click",function(){$("#divBwUpdateDailyOverdueTaskNotificationDate_Dialog").dialog("close")});data={bwWorkflowAppId:r,bwWorkflowTaskItemId:n};u=webserviceurl+"/bwworkflow/gettaskdailyoverduetasknotificationdate";$.ajax({url:u,type:"POST",data:data,headers:{Accept:"application/json; odata=verbose"},success:function(n){var t,i;n.message!="SUCCESS"||(t=n.DailyOverdueTaskNotificationDate,document.getElementById("divBwUpdateDailyOverdueTaskNotificationDate_Dialog_DailyOverdueTaskNotificationDate").value=t,i=new Date,document.getElementById("divBwUpdateDailyOverdueTaskNotificationDate_Dialog_Now").value=i.toISOString())},error:function(n,t,i){displayAlertDialog("Error in bwRequest.js.displayUpdateDailyOverdueTaskNotificationDateDialog().itemizebudgetrequestdependencies  xcx332-2: "+i)}})}catch(i){console.log("Exception in bwRequest.js.displayUpdateDailyOverdueTaskNotificationDateDialog(): "+i.message+", "+i.stack);displayAlertDialog("Exception in bwRequest.js.displayUpdateDailyOverdueTaskNotificationDateDialog(): "+i.message+", "+i.stack)}}})}catch(i){console.log("Exception in bwRequest.js.displayUpdateDailyOverdueTaskNotificationDateDialog(): "+i.message+", "+i.stack);displayAlertDialog("Exception in bwRequest.js.displayUpdateDailyOverdueTaskNotificationDateDialog(): "+i.message+", "+i.stack)}},LaunchIntoSeparateWindow:function(n,t,i){var r,o;try{console.log("");console.log("/////////////////////////////////////");console.log("In bwRequest.js.LaunchIntoSeparateWindow().");console.log("/////////////////////////////////////");console.log("");var u=document.getElementById(n).getBoundingClientRect(),s=u.bottom-u.top,h=u.right-u.left,c=JSON.parse($(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier")).ActiveStateIdentifier,l=this.options.operationUriPrefix+"?ActiveStateIdentifier="+c+"&request="+t+"&taskid="+i+"&openrequest=1",e=window.open(l,n,"toolbar=no,width="+h+",height="+s+",left=5500,top=200,status=no,scrollbars=no,resize=no,location=0");e?(r=$(".bwAuthentication:first").bwAuthentication("option","poppedOutRequestWindows"),r&&r.length||(r=[]),o={windowWidgetType:"bwRequest",requestDialogId:n,bwBudgetRequestId:t,bwWorkflowTaskItemId:i,windowObjectReference:e},r.push(o),$(".bwAuthentication:first").bwAuthentication({poppedOutRequestWindows:r})):(console.log("The window wasn't allowed to open. This is likely caused by built-in popup blockers."),displayAlertDialog("The window wasn't allowed to open. This is likely caused by built-in popup blockers."))}catch(f){console.log("Exception in bwRequest.js.LaunchIntoSeparateWindow(): "+f.message+", "+f.stack);displayAlertDialog("Exception in bwRequest.js.LaunchIntoSeparateWindow(): "+f.message+", "+f.stack)}},LaunchIntoHomeWindow:function(n){var r,i;try{console.log("In bwRequest.js.LaunchIntoHomeWindow(). bwBudgetRequestId: "+n);r=this;console.log("Calling bwRequest.js.scrapeBwRequestJson(). xcx1231242-4");i=$(".bwRequest").bwRequest("scrapeBwRequestJson",n);i.then(function(t){var f,i,e,r,o;try{console.log("Returning from scrapeBwRequestJson(). xcx2131241-4");try{f=$(".bwAuthentication").bwAuthentication("getUrlParams").taskid.toString().split("#")[0]}catch(u){console.log("Caught exception in bwRequest.js.LaunchIntoHomeWindow(): Cannot set bwWorkflowTaskItemId, url param [taskid] is not present.")}if(console.log("In bwRequest.js.LaunchIntoHomeWindow(). Calling displayArInDialog from a popped-out window.... bwBudgetRequestId: "+n+", bwWorkflowTaskItemId: "+f+", bwRequestJson: "+JSON.stringify(t)),i=window.opener.$(".bwAuthentication:first").bwAuthentication("option","poppedOutRequestWindows"),e=!1,i&&i.length&&i.length>0)for(r=0;r<i.length;r++)if(i[r].bwBudgetRequestId==n){e=!0;i.splice(r,1);$(".bwAuthentication:first").bwAuthentication({poppedOutRequestWindows:i});break}e!=!0?(o="Unrecoverable error in bwRequest.js.LaunchIntoHomeWindow(). The request window did not exist in the poppedOutRequestWindows array. bwBudgetRequestId: "+n,console.log(o),displayAlertDialog(o)):(window.opener.$(".bwRequest").bwRequest("displayArInDialog","https://budgetworkflow.com",n,"","","","",f,t),window.close())}catch(u){console.log("Exception in bwRequest.js.LaunchIntoHomeWindow.scrapeBwRequestJson(): "+u.message+", "+u.stack);displayAlertDialog("Exception in bwRequest.js.LaunchIntoHomeWindow.scrapeBwRequestJson(): "+u.message+", "+u.stack)}}).catch(function(n){alert("In LaunchIntoHomeWindow(). Promise returned exception: "+n.message)})}catch(t){console.log("Exception in bwRequest.js.LaunchIntoHomeWindow(): "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.LaunchIntoHomeWindow(): "+t.message+", "+t.stack)}},displayRequestFormInNewBrowserWindow:function(n){var i;try{console.log("In bwRequest.js.displayRequestFormInNewBrowserWindow().");var r=this,f=window.opener.$(".bwAuthentication").bwAuthentication("option","tenantId"),e=window.opener.$(".bwAuthentication").bwAuthentication("option","workflowAppId"),u=window.opener.$(".bwAuthentication").bwAuthentication("option","participantId"),o=window.opener.$(".bwAuthentication").bwAuthentication("option","participantEmail"),s=window.opener.$(".bwAuthentication").bwAuthentication("option","participantFriendlyName");this.options.store=window.opener.$(".bwRequest").bwRequest("option","store");this.options.Checklists=window.opener.$(".bwRequest").bwRequest("option","Checklists");this.options.operationUriPrefix=window.opener.$(".bwRequest").bwRequest("option","operationUriPrefix");this.options.Workflows=window.opener.$(".bwRequest").bwRequest("option","Workflows");this.options.CurrentWorkflow=window.opener.$(".bwRequest").bwRequest("option","CurrentWorkflow");this.options.ActiveForms=window.opener.$(".bwRequest").bwRequest("option","ActiveForms");n||(console.log("Error in displayRequestFormInNewBrowserWindow(). Unexpected value for budgetRequestId: "+n),displayAlertDialog("Error in displayRequestFormInNewBrowserWindow(). Unexpected value for budgetRequestId: "+n));u?setTimeout(function(){console.log("xcx12312423 in bwRequest.js.xx() setTimeout to set the zoom...maybe come back and review sometime...");$("#slider_"+n).slider({min:50,max:200,value:100,slide:function(t,i){r.setZoom(i.value,n)}});r.setZoom(100,n)},1e3):(i="",i+="<br />In bwRequest.js.displayRequestFormInNewBrowserWindow(). Unexpected value for participantId: "+u+".<br />",$(window.document.body).append(i))}catch(t){console.log("Exception in bwRequest.js.displayRequestFormInNewBrowserWindow: "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestFormInNewBrowserWindow: "+t.message+", "+t.stack)}},pullBackAllPoppedOutWindowsToMasterWindow_OnClick:function(){var u,n,t;try{if(console.log("In bwRequest.js.pullBackAllPoppedOutWindowsToMasterWindow_OnClick(). This functionality is incomplete. Coming soon!"),u=this,n=$(".bwAuthentication:first").bwAuthentication("option","poppedOutRequestWindows"),console.log("Calling bwRequest.js.scrapeBwRequestJson(). xcx1231242-4-22"),n&&n.length&&n.length>0)for(t=0;t<n.length;t++){var r=n[t].bwBudgetRequestId,f=n[t].bwWorkflowTaskItemId,o=n[t].windowObjectReference,e=this.scrapeBwRequestJson(r);e.then(function(n){try{console.log("Returning from scrapeBwRequestJson(). xcx2131241-4-22");var i=window;window.opener&&(i=window.opener);window.$(".bwRequest").bwRequest("displayArInDialog","https://budgetworkflow.com",r,"","","","",f,n,!0)}catch(t){console.log("Exception in bwRequest.js.LaunchIntoHomeWindow.scrapeBwRequestJson(): "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.LaunchIntoHomeWindow.scrapeBwRequestJson(): "+t.message+", "+t.stack)}}).catch(function(n){alert("In LaunchIntoHomeWindow(). Promise returned exception: "+n.message)})}}catch(i){console.log("Exception in bwRequest.js.pullBackAllPoppedOutWindowsToMasterWindow_OnClick(): "+i.message+", "+i.stack);displayAlertDialog("Exception in bwRequest.js.pullBackAllPoppedOutWindowsToMasterWindow_OnClick(): "+i.message+", "+i.stack)}},displayRequestFormDialog:function(n,t,i,r){var e,s,u,f,o,a,c,l;try{console.log("In bwRequest.js.displayRequestFormDialog(). budgetRequestId: "+n+", selectedRaciRole: "+t+", bwWorkflowTaskItemId: "+i);e=this;window.scrollTo(0,0);$(".bwActiveMenu").bwActiveMenu("adjustLeftSideMenu");n||displayAlertDialog("Error in bwRequest.js.displayRequestFormDialog(). Unexpected value for budgetRequestId: "+n);r&&console.log("In bwRequest.js.displayRequestFormDialog(). bwRequestJson has been passed.");s=$(".bwAuthentication").bwAuthentication("option","participantId");s?(u="divRequestFormDialog_"+n,f="",f+='        <table style="width:100%;" class="context-menu-requestdialog">',f+="            <tr>",f+='                <td style="width:90%;">',f+='                    <span id="divRequestFormDialogContent"><\/span>',f+="                <\/td>",f+="            <\/tr>",f+="        <\/table>",f+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->',f+="        <br /><br />",o=document.getElementById(u),o||(o=document.createElement("div"),o.id=u,document.body.appendChild(o)),o.innerHTML=f,$("#"+u).dialog("instance")&&(console.log("xcx23142 foudn this is this ok? it checks for an existing dialog and closes it if it si there... nto sure this is necessary. 12-16-2023."),$("#"+u).dialog("close")),a="In bwRequest.js.displayRequestFormDialog(). THIS IS THE ONLY PLACE THIS SHOULD BE HAPPENING. THE DIALOG IS BEING DISPLAYED AND POSITIONED ETC. 12-16-2023. xcx23425345-4",console.log("####################"),console.log("####################"),console.log("####################"),console.log(a),console.log("####################"),console.log("####################"),console.log("####################"),window.opener?(console.log("In bwRequest.js.displayRequestFormDialog(). Popped out window."),c={at:"top"}):(l=window.innerWidth/7,console.log("xcx888747 THIS IS THE POSITIONG OF THE REQUEST DIALOG. 7 seems to be the magic number. width1: "+l),c={my:"center top",at:"center-"+l+" top","of":window,collision:"fit"}),$("#"+u).dialog({position:c,modal:!1,closeOnEscape:!0,width:"800px",dialogClass:"no-close",hide:!1,beforeClose:function(){var t,r,f;try{if(console.log(">>>>>>>>> In beforeClose(). xcx21323453-1."),t=$("#"+u).dialog("option","bwForceClose"),console.log(""),console.log("=========================================="),console.log("COME HERE TO ENABLE THE CHECK TO SEE IF THERE IS ANYTHING TO BE SAVED BEFORE THE REQUEST IS CLOSED. The request form is being closed. Do we need to check if the user may be losing any changes? bwForceClose: "+t+". xcx12312-x-2"),console.log("=========================================="),console.log(""),window.opener?console.log("In bwRequest.js.dialog.beforeClose(). bwForceClose: "+t+". This is a popped out window."):console.log("In bwRequest.js.dialog.beforeClose(). bwForceClose: "+t+". This is NOT a popped out window."),console.log("In bwRequest.js.displayRequestFormDialog(). bwForceClose: "+t),t===undefined)r='Unrecoverable error in bwRequest.js.displayRequestFormDialog(). This request dialog is missing property "bwForceClose".',console.log(r),displayAlertDialog(r);else return t==!0?!0:(console.log("xcx553423-1. In displayRequestFormDialog.dialog.beforeClose(). Calling checkIfThereHaveBeenAnyChanges()."),f=e.checkIfThereHaveBeenAnyChanges(n),f.then(function(n){var r,i,t;try{$("#"+u).dialog("option","bwForceClose",!1);n.status!="SUCCESS"?(console.log("Error in bwRequest.js.displayRequestFormDialog(). Unexpected error when checking if there have been any changes. results: "+JSON.stringify(n)),displayAlertDialog("Error in bwRequest.js.displayRequestFormDialog(). Unexpected error when checking if there have been any changes. results: "+JSON.stringify(n))):n.results=="YES_CHANGES_TO_SAVE"?(console.log("You have made changes to this request. You cannot close it until you save your changes."),r="divPromptToSaveRequestChangesDialog",i=document.getElementById(r),i||(i=document.createElement("div"),i.id=r,i.style.display="none",document.body.appendChild(i),t="",t+='        <table style="width:100%;">',t+="            <tr>",t+='                <td style="width:90%;">',t+="                    <br /><br />",t+='                    <span style="font-size:25pt;font-weight:bold;">Save changes to this request before closing it?<\/span>',t+="                    <br /><br />",t+='                    <span style="font-size:25pt;font-weight:normal;">Your changes will be lost if you don\'t save them.<\/span>',t+="                <\/td>",t+="            <\/tr>",t+="        <\/table>",t+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->',t+="        <br /><br />",i.innerHTML=t),$("#"+r).dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:"Save Changes xcx1-2",width:"720",dialogClass:"no-close",hide:!1,buttons:{Save:function(){try{$(".bwRequest").bwRequest("saveAndPublishTheRequest",u,"true","").then(function(n){try{n.status=="SUCCESS"?($("#"+u).dialog("option","bwForceClose",!0),$("#"+u).dialog("close"),$("#divPromptToSaveRequestChangesDialog").dialog("close")):n.status=="REFUSED_SAVE_CHANGED_ORGID"?$("#divPromptToSaveRequestChangesDialog").dialog("close"):$("#divPromptToSaveRequestChangesDialog").dialog("close")}catch(t){displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog.checkIfThereHaveBeenAnyChanges.Save.saveAndPublishTheRequest(): "+t.message+", "+t.stack)}}).catch(function(n){displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog.checkIfThereHaveBeenAnyChanges.Save(). Unexpected exception saving the request: "+JSON.stringify(n))})}catch(n){displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog.checkIfThereHaveBeenAnyChanges.Save(): "+n.message+", "+n.stack)}},"Don't Save and Lose Changes":function(){try{this.style.color="red";$("#"+u).dialog("option","bwForceClose",!0);$("#"+u).dialog("close");$("#divPromptToSaveRequestChangesDialog").dialog("close")}catch(n){displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog.checkIfThereHaveBeenAnyChanges.DontSave(): "+n.message+", "+n.stack)}},Cancel:function(){$("#divPromptToSaveRequestChangesDialog").dialog("close")}},open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divPromptToSaveRequestChangesDialog").dialog("close")})},close:function(){window.scrollTo(0,0);$(".bwActiveMenu").bwActiveMenu("adjustLeftSideMenu")}})):n.results=="NO_CHANGES_TO_SAVE"?(console.log("xcx21314. NO_CHANGES_TO_SAVE."),$("#"+u).dialog("option","bwForceClose",!0),console.log("xcx123324523 closing the dialog. requestDialogId: "+u),$("#"+u).dialog("close")):(console.log("Error in bwRequest.js.displayRequestFormDialog.dialog.beforeClose.checkIfThereHaveBeenAnyChanges(). Unexpected value from checkIfThereHaveBeenAnyChanges(). results: "+JSON.stringify(n)),displayAlertDialog("Error in bwRequest.js.displayRequestFormDialog.dialog.beforeClose.checkIfThereHaveBeenAnyChanges(). Unexpected value from checkIfThereHaveBeenAnyChanges(). results: "+JSON.stringify(n)))}catch(f){console.log("Exception in bwRequest.js.displayRequestFormDialog.dialog.beforeClose.checkIfThereHaveBeenAnyChanges():2: "+f.message+", "+f.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog.dialog.beforeClose.checkIfThereHaveBeenAnyChanges():2: "+f.message+", "+f.stack)}}).catch(function(n){console.log("Exception in bwRequest.js.displayRequestFormDialog.dialog.beforeClose.checkIfThereHaveBeenAnyChanges():1: "+JSON.stringify(n));displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog.dialog.beforeClose.checkIfThereHaveBeenAnyChanges():1: "+JSON.stringify(n))}),!1)}catch(i){console.log("Exception in bwRequest.js.displayRequestFormDialog.dialog.beforeClose(): "+i.message+", "+i.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog.dialog.beforeClose(): "+i.message+", "+i.stack)}},close:function(n){try{console.log(">>>>>>> In close(). xcx21323453-1.");e.options.numberOfRequestFormsCurrentlyDisplayed-=1;window.opener?(alert("xcx213134 in close(). This is a popped out window, so we need to check if the user is losing any changes."),window.close()):(console.log(">>>>>>>> xcx213134 in close(). This is NOT A popped out window."),$("#"+n.target.id).remove())}catch(t){console.log("Exception in bwRequest.js.displayRequestFormDialog.dialog.close(): "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog.dialog.close(): "+t.message+", "+t.stack)}},open:function(){var l,a,f,c,o,s;try{if(this.bwForceClose=!1,$("#"+u).css("overflow","hidden"),l=document.getElementById(u).parentNode,a=u+"_Parent",l.id=a,console.log("In bwRequest.js.PrintIndividualRequestReport xcx1 Creating the element..."),f="",f+="<table xcx=\"xcx3249-2-1\" style=\"width:100%;\" onclick=\"$('.bwRequest').bwRequest('pinRequestDialog');\" ondblclick=\"$('.bwRequest').bwRequest('zoomAndCenter', '"+u+"');\" >",f+="   <tr>",f+='       <td style="width:95%;">',f+='           <div id="slider_'+n+'" style="width:20%;cursor:pointer;"><\/div>',f+="       <\/td>",f+=`       <td style="vertical-align:middle;width:5%;padding:0;border:0;margin:0;">
                                                <span style="font-size:28pt;font-weight:bold;float:right;border:1px solid white;color:white;padding:0 10px 0 10px;font-family:Courier New;opacity:0.8;cursor:pointer;" onclick="$('.bwRequest').bwRequest('addToPriorityGrupxx', '' + budgetRequestId + '', '' + 'requestDialogId' + '', true);event.stopPropagation();">
                                                    <img xcx="xcx2205004" src="images/clock_small.png" style="width:50px;height:50px;cursor:pointer !important;" />
                                                </span>
                                            </td>`,f+='       <td style="vertical-align:middle;width:5%;padding:0;border:0;margin:0;">',f+="           <span style=\"font-size:28pt;font-weight:bold;float:right;border:1px solid white;color:white;padding:0 10px 0 10px;font-family:Courier New;opacity:0.8;cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('addToPriorityGrup', '"+n+"', 'requestDialogId', true);event.stopPropagation();\">!<\/span>",f+="       <\/td>",f+='       <td style="vertical-align:middle;width:5%;padding:0;border:0;margin:0;">',c=!1,o=$(".bwAuthentication:first").bwAuthentication("option","PINNED_REQUESTS"),o&&o.length)for(s=0;s<o.length;s++)o[s].bwBudgetRequestId==n&&(c=!0);f+=c!=!0?'           <div title="pin" class="pinButton" style="display:inline-block;font-size:18pt;cursor:pointer !important;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequest\', \''+n+"', '"+u+'\', true);"><img src="/images/pin.png" style="width:50px;height:50px;cursor:pointer !important;" /><\/div>':'           <div title="un-pin" class="pinButton" style="display:inline-block;font-size:18pt;cursor:pointer !important;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequest\', \''+n+"', '"+u+'\', false);"><img src="/images/unpin.png" style="width:50px;height:50px;cursor:pointer !important;" /><\/div>';f+="       <\/td>";f+='       <td style="vertical-align:top;width:5%;padding:0;border:0;margin:0;">';f+='           <span id="'+u+"_spanRequestPrintButton\" style=\"text-align:right;cursor:pointer;font-size:30pt;\" onclick=\"$('.bwRequest').bwRequest('reloadAndRefreshTheRequest', '"+u+"', '"+n+"', '"+i+"');\">";f+="               ";f+="           <\/span>";f+="       <\/td>";f+='       <td style="vertical-align:top;width:5%;padding:0;border:0;margin:0;">';window.opener?(f+='                   <span id="'+u+"_spanRequestPrintButton\" style=\"text-align:right;cursor:pointer;font-size:30pt;\" onclick=\"$('.bwRequest').bwRequest('LaunchIntoHomeWindow', '"+n+"');\">",f+="                       ",f+="                   <\/span>"):(f+='           <span id="'+u+"_spanRequestPrintButton\" style=\"text-align:right;cursor:pointer;font-size:30pt;\" onclick=\"$('.bwRequest').bwRequest('LaunchIntoSeparateWindow', '"+u+"', '"+n+"', '"+i+"');\">",f+="               ",f+="           <\/span>");f+="       <\/td>";f+='       <td style="vertical-align:middle;width:5%;padding:0;border:0;margin:0;">';f+='           <span title="print" class="printButton" dev="xcx32424-1-1" style="font-size:18pt;cursor:pointer !important;" onclick="$(\'.bwPrintButton\').bwPrintButton(\'PrintIndividualRequestReport\', \''+u+"');\">";f+='               <img src="/images/iosprinter_blue.png" style="width:50px;height:50px;cursor:pointer !important;" />';f+="           <\/span>";f+="       <\/td>";f+="       <td>&nbsp;&nbsp;<\/td>";f+="       <td>";f+="           <span class=\"dialogXButton\" style=\"font-size:25pt;cursor:pointer;width:100%;font-weight:bold;\" onclick=\"$('.bwPageScrollingHandler').bwPageScrollingHandler('CloseDialogAndPreventNextWindowScrollEvent', '"+u.replace("_Parent","")+"');\">X<\/span>";f+="       <\/td>";f+="   <\/tr>";f+="<\/table>";document.getElementById(u).parentNode.querySelector(".ui-dialog-titlebar").innerHTML=f;$("#slider_"+n).slider({min:50,max:200,value:100,slide:function(n,t){e.setZoom(t.value,u)}});e.setZoom(100,u);$(".ui-widget-overlay").bind("click",function(){$("#"+u).dialog("close")});console.log("Calling displayRequestForm(). bwRequestJson: "+JSON.stringify(r));e.displayRequestForm(n,u,"",t,r)}catch(h){console.log("Exception in bwRequest.js.displayRequestFormDialog.dialog.open(): "+h.message+", "+h.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog.dialog.open(): "+h.message+", "+h.stack)}}}),$("#"+u).dialog("option","bwForceClose",!1),console.log("In bwRequest.js.displayRequestFormDialog(). Changing z-index here. Why?? Is it necessary? xcx123124-1. TURNING OFF FOR NOW. 7-1-2024.")):(displayAlertDialog("In displayRequestFormDialog(). Unexpected value for participantId: "+s),this.displayOfflineRequestFormDialog(n,s))}catch(h){console.log("Exception in bwRequest.js.displayRequestFormDialog():1: "+h.message+", "+h.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog():1: "+h.message+", "+h.stack)}},displayRequestFormDialog_FromTrashBin:function(n,t,i,r){var e,u,f,o,c,l,a;try{console.log("In bwRequest.js.displayRequestFormDialog_FromTrashBin(). budgetRequestId: "+n+", selectedRaciRole: "+t+", bwWorkflowTaskItemId: "+i);e=this;window.scrollTo(0,0);$(".bwActiveMenu").bwActiveMenu("adjustLeftSideMenu");n||displayAlertDialog("Error in bwRequest.js.displayRequestFormDialog_FromTrashBin(). Unexpected value for budgetRequestId: "+n);r&&console.log("In bwRequest.js.displayRequestFormDialog_FromTrashBin(). bwRequestJson has been passed.");var v=$(".bwAuthentication").bwAuthentication("option","tenantId"),y=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),h=$(".bwAuthentication").bwAuthentication("option","participantId"),p=$(".bwAuthentication").bwAuthentication("option","participantEmail"),w=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName");if(h){u="divRequestFormDialog_"+n;f="";f+='        <table style="width:100%;" class="context-menu-requestdialog">';f+="            <tr>";f+='                <td style="width:90%;">';f+='                    <span id="divRequestFormDialogContent"><\/span>';f+="                <\/td>";f+="            <\/tr>";f+="        <\/table>";f+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->';f+="        <br /><br />";o=document.getElementById(u);o||(o=document.createElement("div"),o.id=u,document.body.appendChild(o));o.innerHTML=f;$("#"+u).dialog("instance")&&$("#"+u).dialog("close");e.options.numberOfRequestFormsCurrentlyDisplayed+=1;c=e.options.numberOfRequestFormsCurrentlyDisplayed*50;l=e.options.numberOfRequestFormsCurrentlyDisplayed*50;console.log("In bwRequest.js.displayRequestFormDialog_FromTrashBin(). THIS IS THE ONLY PLACE THIS SHOULD BE HAPPENING. 4-3-2023 xcx23425345-4");a=window.opener?{at:"top"}:{my:"left top",at:"right+"+c+" bottom+"+l,"of":"#divTopBar_OrganizationName"};$("#"+u).dialog({position:a,modal:!1,closeOnEscape:!0,width:"800px",dialogClass:"no-close",hide:!1,beforeClose:function(){try{alert("In beforeClose(). xcx21323453-2. DO WE EVER GET HERE? 5-10-2024.");console.log("");console.log("==========================================");console.log("xcx123124 dialog.beforeClose().COME HERE TO ENABLE THE CHECK TO SEE IF THERE IS ANYTHING TO BE SAVED BEFORE THE REQUEST IS CLOSED. The request form is being closed. Do we need to check if the user may be losing any changes? xcx12312-x-2");console.log("==========================================");console.log("")}catch(n){console.log("Exception in bwRequest.js.displayRequestFormDialog_FromTrashBin.dialog.beforeClose(): "+n.message+", "+n.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog_FromTrashBin.dialog.beforeClose(): "+n.message+", "+n.stack)}},close:function(){try{console.log(">>>>>>> xcx213134 in bwRequest.js.displayRequestFormDialog_FromTrashBin.dialog.close().");e.options.numberOfRequestFormsCurrentlyDisplayed-=1;window.opener&&window.close()}catch(n){console.log("Exception in bwRequest.js.displayRequestFormDialog_FromTrashBin.dialog.close(): "+n.message+", "+n.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog_FromTrashBin.dialog.close(): "+n.message+", "+n.stack)}},open:function(){var s,h,f;try{console.log("In xcx2342132314 dialog.open() <<<<<<<<< 4-19-2023");this.bwForceClose=!1;$("#"+u).css("overflow","hidden");s=document.getElementById(u).parentNode;h=u+"_Parent";s.id=h;f="";f+="<table xcx=\"xcx3249-2-2\" style=\"width:100%;background-color:tomato;\" onclick=\"$('.bwRequest').bwRequest('pinRequestDialog');\" ondblclick=\"$('.bwRequest').bwRequest('zoomAndCenter', '"+u+"');\" >";f+="   <tr>";f+='       <td style="width:95%;">';f+='           <div id="slider_'+n+'" style="width:20%;cursor:pointer;"><\/div>';f+="       <\/td>";f+='       <td style="vertical-align:middle;width:5%;padding:0;border:0;margin:0;">';f+='           <span style="color:white;font-size:25pt;font-weight:bold;">TrashBinned Request<\/span>';f+="       <\/td>";f+='       <td style="vertical-align:top;width:5%;padding:0;border:0;margin:0;">';window.opener?(f+='           <span id="'+u+"_spanRequestPrintButton\" style=\"text-align:right;cursor:pointer;font-size:30pt;\" onclick=\"$('.bwRequest').bwRequest('LaunchIntoHomeWindow', '"+n+"');\">",f+="               ",f+="           <\/span>"):(f+='           <span id="'+u+"_spanRequestPrintButton\" style=\"text-align:right;cursor:pointer;font-size:30pt;\" onclick=\"$('.bwRequest').bwRequest('LaunchIntoSeparateWindow', '"+u+"', '"+n+"', '"+i+"');\">",f+="               2",f+="           <\/span>");f+="       <\/td>";f+='       <td style="vertical-align:middle;width:5%;padding:0;border:0;margin:0;">';f+='           <span title="print" class="printButton" dev="xcx32424-1-2" style="font-size:18pt;cursor:pointer !important;" onclick="$(\'.bwPrintButton\').bwPrintButton(\'PrintIndividualRequestReport\', \''+u+"');\">";f+='               <img src="/images/iosprinter_blue.png" style="width:50px;height:50px;cursor:pointer !important;" />';f+="           <\/span>";f+="       <\/td>";f+="       <td>&nbsp;&nbsp;<\/td>";f+="       <td>";f+="           <span class=\"dialogXButton\" style=\"font-size:25pt;cursor:pointer;width:100%;font-weight:bold;\" onclick=\"$('.bwPageScrollingHandler').bwPageScrollingHandler('CloseDialogAndPreventNextWindowScrollEvent', '"+u.replace("_Parent","")+"');\">X<\/span>";f+="       <\/td>";f+="   <\/tr>";f+="<\/table>";document.getElementById(u).parentNode.querySelector(".ui-dialog-titlebar").innerHTML=f;$("#slider_"+n).slider({min:50,max:200,value:100,slide:function(n,t){e.setZoom(t.value,u)}});e.setZoom(100,u);$(".ui-widget-overlay").bind("click",function(){$("#"+u).dialog("close")});e.displayRequestForm_ForTrashBin(n,u,"",t,r)}catch(o){console.log("Exception in bwRequest.js.displayRequestFormDialog_FromTrashBin.dialog.open(): "+o.message+", "+o.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog_FromTrashBin.dialog.open(): "+o.message+", "+o.stack)}}});$("#"+u).dialog("option","bwForceClose",!1);alert("In bwRequest.js.displayRequestFormDialog_FromTrashBin(). Changing z-index here. Why?? Is it necessary? xcx123124-2.");try{$(".ui-widget-overlay")[0].style.zIndex=9}catch(s){console.log("Caught Exception: SHOULD NOT NEED THIS TRY-CATCH BUT A QUICK FIX FOR NOW.xcx9248. "+s.message+", "+s.stack)}$("#"+u).dialog().parents(".ui-dialog")[0].style.zIndex=10}else displayAlertDialog("In displayRequestFormDialog_FromTrashBin(). Unexpected value for participantId: "+h),this.displayOfflineRequestFormDialog(n,h)}catch(s){console.log("Exception in bwRequest.js.displayRequestFormDialog_FromTrashBin():1: "+s.message+", "+s.stack);displayAlertDialog("Exception in bwRequest.js.displayRequestFormDialog_FromTrashBin():1: "+s.message+", "+s.stack)}},displayRequestFormDialog_IndexDB:function(n,t,i){var t,f,r,u,e;try{if(t=$(".bwAuthentication").bwAuthentication("option","participantId"),console.log("In displayRequestFormDialog_IndexDB(). budgetRequestId: "+n+", participantId: "+t+", indexDbCursorValue: "+JSON.stringify(i)),alert("In displayRequestFormDialog_IndexDB(). budgetRequestId: "+n+", participantId: "+t+", indexDbCursorValue: "+JSON.stringify(i)),f=this,t){console.log("In displayRequestFormDialog_IndexDB(). The user is logged in. Note that displayOfflineRequestFormDialog() method renders the top buttons ok, we will need this part....<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< ");r="divRequestFormDialog_"+n;u="";u+='        <table style="width:100%;" class="context-menu-requestdialog">';u+="            <tr>";u+='                <td style="width:90%;">';u+='                    <span id="divRequestFormDialogContent"><\/span>';u+="                <\/td>";u+="            <\/tr>";u+="        <\/table>";u+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->';u+="        <br /><br />";e=document.getElementById(r);e||(e=document.createElement("div"),e.id=r,document.body.appendChild(e));e.innerHTML=u;console.log("xcx233532 removed this 4-7-2022 3-53pm adt");f.options.numberOfRequestFormsCurrentlyDisplayed+=1;var c=f.options.numberOfRequestFormsCurrentlyDisplayed*50,h=f.options.numberOfRequestFormsCurrentlyDisplayed*50,o=i;console.log("Instantiating dialog xcx243253562 yJog: "+h);alert("Instantiating dialog xcx243253562 yJog: "+h);$("#"+r).dialog({position:{my:"left top",at:"right+"+c+" bottom+"+h,"of":"#divTopBar_OrganizationName"},modal:!1,resizable:!1,draggable:{containment:"window"},closeOnEscape:!0,width:"800px",dialogClass:"no-close",hide:!1,close:function(){displayAlertDialog("In xcx8707(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-x");f.options.numberOfRequestFormsCurrentlyDisplayed-=1},open:function(){var i,u,t,e;$("#"+r).css("overflow","hidden");i=document.getElementById(r).parentNode;u=r+"_Parent";i.id=u;t="";t+='<table xcx="xcx3249-3" style="width:100%;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequestDialog\');">';t+="   <tr>";t+='       <td style="width:95%;">';t+='           <div id="slider_'+n+'" style="width:20%;cursor:pointer;"><\/div>';t+="       <\/td>";t+='       <td style="vertical-align:middle;width:5%;padding:0;border:0;margin:0;">';console.log("In bwRequest.js.PrintIndividualRequestReport(). Rendering this button. xcx2");t+='           <span title="print" class="printButton" dev="xcx32424-2" style="font-size:18pt;cursor:pointer !important;" onclick="$(\'#divBwPrintButton\').bwPrintButton(\'PrintIndividualRequestReport\', \''+r+"');\">";t+='               <img src="/images/iosprinter_blue.png" style="width:50px;height:50px;cursor:pointer !important;" />';t+="           <\/span>";t+="       <\/td>";t+="       <td>";t+='           <span class="dialogXButton" style="font-size:25pt;cursor:pointer;width:100%;" onclick="$(\'#'+r.replace("_Parent","")+"').dialog('close');\">X<\/span>";t+="       <\/td>";t+="   <\/tr>";t+="<\/table>";document.getElementById(r).parentNode.querySelector(".ui-dialog-titlebar").innerHTML=t;$("#slider_"+n).slider({min:0,max:100,value:100,slide:function(n,t){f.setZoom(t.value,r)}});$(".ui-widget-overlay").bind("click",function(){$("#"+r).dialog("close")});o?(console.log("In bwRequest.js.displayRequestFormDialog_IndexDB(). Getting ready to call getRequestFormHtml(). bwRequestType: "+o.bwRequestType),e=f.getRequestFormHtml(o.bwRequestTypeId,!0,null,"xcx23452-10"),e.then(function(n){try{n.message!=null?$("#"+r).find("#divRequestFormDialogContent")[0].innerHTML=n.message:($("#"+r).find("#divRequestFormDialogContent")[0].innerHTML=n.html,console.log("Calling populateNewRequestForm_IndexDb(). xcx23436-4 but actually calling populateNewRequestForm_IndexDb!!!"),f.populateNewRequestForm_IndexDb(r,o))}catch(t){console.log("Exception in displayRequestFormDialog():21-2: "+t.message+", "+t.stack)}})):alert("INVALID bwRequestJson RETURNED. THIS PROCESS CANNOT CONTINUE.xcx41202012")}});alert("In bwRequest.js.displayRequestFormDialog_IndexDB(). Changing z-index here. Why?? Is it necessary? xcx123124-3.");try{$(".ui-widget-overlay")[0].style.zIndex=9}catch(s){console.log("Caught Exception: SHOULD NOT NEED THIS TRY-CATCH BUT A QUICK FIX FOR NOW.xcx9248. "+s.message+", "+s.stack)}$("#"+r).dialog().parents(".ui-dialog")[0].style.zIndex=10}else console.log("In displayRequestFormDialog_IndexDB(). Are you not logged in? This functionality is incomplete. Coming soon! xcx78366. Note that displayOfflineRequestFormDialog() method renders the top buttons ok, we will need this part....<<<<< "),displayAlertDialog("In displayRequestFormDialog_IndexDB(). Are you not logged in? This functionality is incomplete. Coming soon! xcx78366")}catch(s){console.log("Exception in displayRequestFormDialog_IndexDB: "+s.message+", "+s.stack)}},displayRequestFormForMobile:function(n,t,i,r){var f,e,u,o;try{console.log("In displayRequestFormForMobile(). budgetRequestId: "+n+", participantId: "+t);alert("In displayRequestFormForMobile(). budgetRequestId: "+n+", participantId: "+t);f=this;e="";e+='<span id="welcomePageMyTasksTabSpanTag1" ';e+="  onmouseover=\"this.style.cursor='pointer';this.style.textDecoration='underline';var taskTabContent = document.getElementById('welcomePageMyTasksTabSpanTag1').innerHTML;document.getElementById('welcomePageMyTasksTabSpanTag1').innerHTML = '<< Tasks (6)*';\" ";e+="  onmouseout=\"this.style.textDecoration='none';document.getElementById('welcomePageMyTasksTabSpanTag1').innerHTML = taskTabContent;\" ";e+="  onclick=\"$('.bwRequest').bwRequest('hideRequestAndPrepareToRenderAlerts');\" ";e+=">";e+=i+' <span style="color:red;font-weight:bold;">';e+=" (6*)<\/span>";e+="<\/span>";document.getElementById("welcomePageMyTasksTabTitle").innerHTML=e;$("#welcomePageTabs").tabs("option","active",1);t?(u="welcomePageMyTasksTab",o=webserviceurl+"/bwbudgetrequests/"+tenantId+"/"+workflowAppId+"/"+n+"/"+t,$.ajax({url:o,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){try{if(n.BudgetRequests&&n.BudgetRequests[0].bwRequestJson&&n.BudgetRequests[0].bwRequestJson!=""){var e=JSON.parse(n.BudgetRequests[0].bwRequestJson);$.ajax({url:f.options.operationUriPrefix+"odata/WorkflowConfiguration5/"+tenantId+"/"+workflowAppId+"/"+n.BudgetRequests[0].bwBudgetRequestId,dataType:"json",contentType:"application/json",type:"Get",timeout:f.options.ajaxTimeout}).done(function(i){var c,e,o,s;try{i.value.length==0?alert("ERROR: Cannot locate workflowxcx92 for bwBudgetRequestId: "+n.BudgetRequests[0].bwBudgetRequestId):(c=i.value[0],e=JSON.parse(i.value[0].bwWorkflowJson),alert("xcx235-6 getting ready to call getRequestFormHtml(). bwRequestType: "+n.BudgetRequests[0].bwRequestType),o={Abbreviation:n.BudgetRequests[0].bwRequestType,RequestType:n.BudgetRequests[0].bwRequestType,bwRequestTypeId:n.BudgetRequests[0].bwRequestType},s=f.getRequestFormHtml(o.bwRequestTypeId,null,null,"xcx23452-12"),s.then(function(o){var rt,vt,c,yt,kt,ut,p,g,ft,h,dt,nt,d,s,it,ct,et,ot,pt,st,wt,b,lt,l,ht,gt,ni,ri;try{if(o.message!=null)$("#"+u).find("#divRequestFormDialogContent")[0].innerHTML=o.message;else{$("#welcomePageMyTasksTab")[0].innerHTML=o.html;$("#"+u).find("#budgetrequestform")[0].setAttribute("bwbudgetrequestid",n.BudgetRequests[0].bwBudgetRequestId);rt=n.BudgetRequests[0].OrgId;vt=n.BudgetRequests[0].OrgName;$("#"+u).find("#budgetrequestform")[0].setAttribute("bworgid",rt);$("#"+u).find("#budgetrequestform")[0].setAttribute("bworgname",vt);var ui=n.BudgetRequests[0].FunctionalAreaId,fi=n.BudgetRequests[0].ManagerId,ei=n.BudgetRequests[0].ManagerFriendlyName,oi=n.BudgetRequests[0].ARStatus,bt=n.BudgetRequests[0].BudgetWorkflowStatus;if(bwApprovalLevelWorkflowToken=n.BudgetRequests[0].bwApprovalLevelWorkflowToken,s="",s+="                   <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">",s+="                       Budget Requestxcx2: ",s+='                       <span id="spanRequestFormBudgetRequestTitle" title="">',s+=n.BudgetRequests[0].Title,s+="                       <\/span>",s+='&nbsp;<span xcx="xcx3567-6" id="spanNewRequestEllipsesButton" class="spanButton2 context-menu-newrequesteditor" style="height:20px;width:150px;"> ... <\/span>',s+="<\/span>",$("#"+u).find("#spanRequestForm_Title")[0].innerHTML=s,i.value.length==0)h="",h='<span style="color:tomato;">ERROR: Could not find the workflow: '+n.BudgetRequests[0].bwWorkflowId+". <span style=\"cursor:pointer;text-decoration:underline;\" onclick=\"$('.bwRequest').bwRequest('reassignOrphanedRequestToAnActiveWorkflow', '"+n.BudgetRequests[0].bwBudgetRequestId+'\');">Click here to reassign to an active workflow for this "'+n.BudgetRequests[0].bwRequestType+'".<\/a><\/span>',$("#"+u).find("#spanRequestForm_Instructions")[0].innerHTML=h;else{for(c=null,yt=null,l=0;l<e.Steps.Step.length;l++)if(yt=e.Steps.Step[l]["@Name"],yt==bt){c=l;break}if(c==null)$("#"+u).find("#spanRequestForm_Error")[0].innerHTML="INVALIDWORKFLOWSTATUS workflowStatus:"+bt+", participantRoles: "+n.RequestingUser.ParticipantRole+", RACI role: "+w+", orgId: "+n.RequestingUser.OrgId,s="xNOBUTTONSINVALIDWORKFLOWSTATUS",f.renderRequestFormButtons(u,n.BudgetRequests[0].bwBudgetRequestId,n.BudgetRequests[0].bwBudgetRequestId,s,"xcx445566-10"),h="xNOINSTRUCTIONSINVALIDWORKFLOWSTATUS",$("#"+u).find("#spanRequestForm_Instructions")[0].innerHTML=h;else{kt=$("#"+u).find("#spanNewRequestEllipsesButton")[0];$(kt).on("click",function(n){n.preventDefault();n.stopImmediatePropagation();$(this).contextMenu()});var w="",a=[],v=null;if(e.Steps.Step[c].Assign&&e.Steps.Step[c].Assign.length)for(p=0;p<e.Steps.Step[c].Assign.length;p++)w=e.Steps.Step[c].Assign[p]["@Role"],n.RequestingUser.RoleIds.indexOf(w)>-1?(a.includes(w)||a.push(w),v=e.Steps.Step[c].Assign[p]):n.RequestingUser.ParticipantRole=="owner"?(a.includes(w)||a.push(w),v=e.Steps.Step[c].Assign[p],w="ADMIN",a.includes(w)||a.push(w)):alert("Error matching admin role for the owner. This process cannot continue.xcx2-2");else e.Steps.Step[c].Assign&&n.RequestingUser.RoleIds.indexOf(e.Steps.Step[c].Assign["@Role"])>-1?(w=e.Steps.Step[c].Assign["@Role"],a.includes(w)||a.push(w),v=e.Steps.Step[c].Assign):n.RequestingUser.ParticipantRole=="owner"?(w="ADMIN",a.includes(w)||a.push(w),v=e.Steps.Step[c].Assign):alert("Error matching admin role for the owner. The process cannot continue.2");if(s="",r)if(e.Steps.Step[c].Assign)for(p=0;p<e.Steps.Step[c].Assign.length;p++)r.indexOf(e.Steps.Step[c].Assign[p]["@Role"])>-1&&r==e.Steps.Step[c].Assign[p]["@Role"]&&(v=e.Steps.Step[c].Assign[p]);else console.log("THERE IS NO ASSIGN ROLE IN THIS STEP!!!!! This is probably because this means the ADMIN has to intervene to move the workflow along."),s+="THERE IS NO ASSIGN ROLE IN THIS STEP!!!!! This is probably because this means the ADMIN has to intervene to move the workflow along.",s+='<button title="adminMoveWorkflowToNextStep" class="BwButton350" onclick="$(\'.bwRequest\').bwRequest(\'adminMoveWorkflowToNextStep\');">ADMIN - MOVE TO NEXT STEP<\/button>',s+="<br />";else if(a.includes("ADMIN")&&a.length>1)for(ut=0;ut<a.length;ut++)if(a[ut]!="ADMIN"){for(w=a[ut],p=0;p<e.Steps.Step[c].Assign.length;p++)n.RequestingUser.RoleIds.indexOf(e.Steps.Step[c].Assign[p]["@Role"])>-1&&w==e.Steps.Step[c].Assign[p]["@Role"]&&(v=e.Steps.Step[c].Assign[p]);break}if(v)for(g=0;g<v.Action.length;g++)ft=v.Action[g]["@JavaScript"],ft?s+='<button onclick="'+ft+'" class="BwButton200ForRequestForm" title="'+v.Action[g].Tooltip+'">'+v.Action[g]["@Name"]+"<\/button>&nbsp;":(console.log(""),console.log("In displayRequestFormForMobile(). ERROR CREATING BUTTONS: NO ACTION JAVASCRIPT SET IN THE WORKFLOW FOR THIS ACTION: "+v.Action[g]["@Name"]+". This process cannot continue. xcx2341-2"),console.log(""),ft="alert('In displayRequestFormForMobile(). ERROR CREATING BUTTONS: NO ACTION JAVASCRIPT SET IN THE WORKFLOW FOR THIS ACTION: "+v.Action[g]["@Name"]+". This process cannot continue. xcx2341-2');",s+='<button onclick="'+ft+'" class="BwButton200ForRequestForm" title="'+v.Action[g].Tooltip+'">xcx1'+v.Action[g]["@Name"]+"<\/button>&nbsp;");if(s+="<button onclick=\"$('#"+u+'\').dialog(\'close\');" class="BwButton200ForRequestForm" title="Close">Close<\/button>&nbsp;',f.renderRequestFormButtons(u,n.BudgetRequests[0].bwBudgetRequestId,n.BudgetRequests[0].bwBudgetRequestId,s,"xcx445566-11"),h="",h+='<span id="bwStepIndex" style="display:none;">'+c+"<\/span>",dt=e.Steps.Step[c]["@FriendlyName"]?e.Steps.Step[c]["@FriendlyName"]:e.Steps.Step[c]["@Name"],h+='<span xcx="342352-2" style="cursor:pointer;text-decoration:underline;" title="View RACI workflow history..." onclick="$(\'.bwRequest\').bwRequest(\'displayRequestWorkflowAuditTrailDialog\', \''+n.BudgetRequests[0].Title+"', '"+String(n.BudgetRequests[0].ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.BudgetRequests[0].bwRequestType+"', '"+n.BudgetRequests[0].bwBudgetRequestId+"', '"+n.BudgetRequests[0].bwWorkflowId+"');\">",h+="Current workflow step: "+dt,h+="<\/span>",e.Steps.Step[c]["@Timeout"]&&(h+="&nbsp;("+e.Steps.Step[c]["@Timeout"]+" "+e.Steps.Step[c]["@TimeoutUnits"]+")"),h+="&nbsp;",nt="RACI: ",nt+="\n",nt+="R = Responsible (also Recommender)  ",nt+="\n",nt+="A = Accountable (also Approver or final approving authority)  ",nt+="\n",nt+="C = Consulted (sometimes Consultant or counsel)  ",nt+="\n",nt+="I = Informed (also Informee)  ",h+="<br />",h+='<span style="cursor:help;" title="'+nt+'">Your RACI rolexcx2: <\/span>',h+='<select  xcx="34234-2" id="selectedRaciRole" onchange="$(\'.bwRequest\').bwRequest(\'selectedRaciRole_OnChange\', this);">',r)for(d=0;d<a.length;d++)r==a[d]?(h+='<option selected value="'+a[d]+'">',h+=a[d],h+="<\/option>"):(h+='<option value="'+a[d]+'">',h+=a[d],h+="<\/option>");else for(d=0;d<a.length;d++)h+='<option value="'+a[d]+'">',h+=a[d],h+="<\/option>";h+="<\/select>";h+="<br />";$("#"+u).find("#spanRequestForm_WorkflowAndRoleDetails")[0].innerHTML=h;s="";s+="<table>";n.RequestingUser.ParticipantRole=="owner"?(s+="  <tr>",s+='    <td colspan="2">',s+='    <span onclick="$(\'.bwRequest\').bwRequest(\'viewThisBudgetRequestSystemDetailsDialog\');" style="text-decoration:underline;cursor:pointer;" title="xClick here to view details about this budget request system...">',s+="    You are the owner of this budget request system.xcx2",s+="    <\/span>",s+="    <\/td>",s+="  <\/tr>"):(s+="  <tr>",s+="    <td>participantRolesXCX2:<\/td>",s+="    <td>"+n.RequestingUser.ParticipantRole+"<\/td>",s+="  <\/tr>");s+="<\/table>";$("#"+u).find("#spanRequestForm_Error")[0].innerHTML=s;var y="",k=[],tt=[];if(v){if(console.log("I HATE THIS BUT I AM GOING TO REMOVE DUPLICATES HERE. BAD PRACTICE!!!!!!!!!!!!!!!!!!!!!!!! 4-16-2020."),it=v["@Cond"],ct=[],it&&it.split("$ChecklistsRequired~")[1]&&(et=it.split("$ChecklistsRequired~")[1].split(","),et)){for(ot=0;ot<et.length;ot++)ct.includes(et[ot])||ct.push(et[ot]);it="$ChecklistsRequired~"+ct.toString()}for(pt=JSON.parse(n.BudgetRequests[0].bwRequestJson).Checklists,b=0;b<pt.length;b++)if(st=JSON.parse(pt[b]),st.bwChecklistTemplatesId==at[l]){lt={bwChecklistTemplatesId:st.bwChecklistTemplatesId,html:"<span style=\"cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialogReadOnly', '"+st.bwChecklistTemplatesId+"', '"+n.BudgetRequests[0].ProjectTitle+"', '"+n.BudgetRequests[0].Title+"', '"+n.BudgetRequests[0].bwRequestType+"', '"+n.BudgetRequests[0].bwBudgetRequestId+"', '"+n.BudgetRequests[0].bwWorkflowId+"', '"+rt+"');\">"+st.Title+"<\/span>"};k.push(lt);break}if(it){if(it.indexOf("$ChecklistsRequired~")>-1){var p=it.split("$ChecklistsRequired~")[1],ii=p.split("&")[0],at=ii.split(",");for(f.options.Checklists=[],l=0;l<at.length;l++){for(wt=!1,b=0;b<k.length;b++)if(k[b].bwChecklistTemplatesId==at[l]){wt=!0;break}if(wt==!1)for(b=0;b<n.Checklists.length;b++)n.Checklists[b].bwChecklistTemplatesId==at[l]&&(lt={bwChecklistTemplatesId:n.Checklists[b].bwChecklistTemplatesId,html:"<span style=\"cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('displayChecklistInDialog', '"+n.Checklists[b].bwChecklistTemplatesId+"', '"+String(n.BudgetRequests[0].ProjectTitle).replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+n.BudgetRequests[0].Title+"', '"+n.BudgetRequests[0].bwRequestType+"', '"+n.BudgetRequests[0].bwBudgetRequestId+"', '"+n.BudgetRequests[0].bwWorkflowId+"', '"+rt+"');\">"+JSON.parse(n.Checklists[b].ChecklistJson).Title+"<\/span>"},tt.push(lt),f.options.Checklists.push(n.Checklists[b]))}if(k.length>0)for(y+=k.length==1?"Completed checklist: ":"Completed checklistsxcx2312: ",k=f.removeDuplicates(JSON.parse(JSON.stringify(k))),l=0;l<k.length;l++)y+="<span style=\"white-space:nowrap;text-decoration:underline;\" onclick=\"$('.bwRequest').bwRequest('RequestARevisionToThisChecklist', 'false', '');\" title=\"The Checklist has been updated. Do you wish to request a revision before this step is completed? and still in this step!\">",y+="&nbsp;"+k[l].html,y+="<\/span>",y+="<br />";if(tt.length>0)for(y+=tt.length==1?"Pending checklist(s): ":"Pending checklist(s) xcx232143-2: ",l=0;l<tt.length;l++)y+='&nbsp;<span style="text-decoration:underline;">'+tt[l].html+"<\/span>",y+="<br />";if(tt.length>0){for(y+='<img width="11" height="11" style="cursor:pointer;vertical-align:top;" alt="" src="/images/red-dot.png">',y+="&nbsp;",y+=tt.length==1?"Complete the following checklist before you Approve: ":"Complete the following checklist(s) before you Approve: ",l=0;l<tt.length;l++)y+="<br />",y+='&nbsp;<span style="text-decoration:underline;">'+tt[l].html+"<\/span>";y+="<br />"}$("#"+u).find("#spanRequestForm_Checklists")[0].innerHTML=y}}else if(alert("xcx123124 not cond"),k.length>0)for(y+=k.length==1?"Completed checklist: ":"Completed checklistsxcx2312: ",k=f.removeDuplicates(JSON.parse(JSON.stringify(k))),l=0;l<k.length;l++)y+="<span style=\"white-space:nowrap;text-decoration:underline;\" onclick=\"$('.bwRequest').bwRequest('RequestARevisionToThisChecklist', 'false', '');\" title=\"The Checklist has been updated. Do you wish to request a revision before this step is completed? and still in this step!\">",y+="&nbsp;"+k[l].html,y+="<\/span>",y+="<br />"}h="";v&&v["@Instructions"]?(h+=v["@Instructions"],h+="WORKFLOW HAD VALID INSTRUCTIONS.xcx2231-2"):h+="COULDNOTLOCATEVALIDINSTTRUCTIONS.xcx2232-2";tt.length>0&&(h+="Complete the required checklists before approving this request.",h+="<br />");$("#"+u).find("#spanRequestForm_Instructions")[0].innerHTML=h;ht=v["@AllowRequestModifications"];ht&&ht!="undefined"||(ht=!1);alert("Calling populateRequestForm(). xcx3452-3");gt=f.populateRequestForm(u,n.BudgetRequests[0].bwRequestJson,ht);gt.then(function(){var t;try{if(t=document.getElementById("myCanvas"),t){var n=document.getElementsByTagName("body")[0],r=n.scrollWidth,u=Math.max(n.scrollHeight,document.documentElement.scrollHeight,n.offsetHeight,document.documentElement.offsetHeight,n.clientHeight,document.documentElement.clientHeight,n.scrollHeight,n.getBoundingClientRect().height);t.width=r;t.height=u}}catch(i){console.log("Exception in displayRequestFormForMobile.populateRequestForm.then(): "+i.message+", "+i.stack);displayAlertDialog("Exception in displayRequestFormForMobile.populateRequestForm.then(): "+i.message+", "+i.stack)}})}}ni={bwTenantId:tenantId,bwWorkflowAppId:workflowAppId,bwParticipantId:t,bwParticipantEmail:participantEmail,bwParticipantFriendlyName:participantFriendlyName,bwEnabledRequestTypes:bwEnabledRequestTypes,bwOrgId:rt,bwOrgName:vt};ri=$("#"+u).find("#divBwLocationPicker").bwLocationPicker(ni)}}catch(ti){console.log("Exception in displayRequestFormForMobile():21: "+ti.message+", "+ti.stack)}}))}catch(h){console.log("Exception in displayRequestFormForMobile():265: "+h.message+", "+h.stack)}})}else alert("INVALID bwRequestJson RETURNED. THIS PROCESS CANNOT CONTINUE.xcx4120202")}catch(i){console.log("Exception in displayRequestFormForMobile():2: "+i.message+", "+i.stack)}},error:function(n,t,i){console.log("Error in displayRequestFormForMobile():1: "+t+", "+i+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n));displayAlertDialog("Error in displayRequestFormForMobile():1: "+t+", "+i+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n))}})):this.displayOfflineRequestFormDialog(n,t)}catch(s){console.log("Exception in displayRequestFormForMobile: "+s.message+", "+s.stack)}},populateRequestForm:function(n,t,i,r){console.log("***************");console.log("In bwRequest.js.populateRequestForm(). This is the only place where the population should be taking place. allowRequestModifications: "+i+", formWidget_CustomRenderingInstructions: "+JSON.stringify(r));console.log("***************");var u=this;return new Promise(function(f,e){var h,c,o,s;try{console.log("In populateRequestForm().");h=JSON.parse(t);console.log("In populateRequestForm(). bwRequestJson2: "+JSON.stringify(h));c=h.bwBudgetRequestId;c?(u.initializeRequestFormWidgets(n,h,i,!1,r),s={status:"SUCCESS"},f(s)):(o="Error in bwRequest.js.populateRequestForm(). Unexpected value for bwBudgetRequestId: "+c+", bwRequestJson2: "+JSON.stringify(h),console.log(o),displayAlertDialog(o),s={status:"ERROR",message:o},e(s))}catch(l){o="Exception in bwRequest.js.populateRequestForm(): "+l.message+", "+l.stack;console.log(o);displayAlertDialog(o);s={status:"EXCEPTION",message:o};e(s)}})},displayOfflineRequestFormDialog:function(n,t){var t,r,o,f,u,s;try{try{t=$(".bwAuthentication").bwAuthentication("option","participantId")}catch(e){}console.log("In displayOfflineRequestFormDialog() budgetRequestId: "+n+", participantId: "+t);alert("In displayOfflineRequestFormDialog() budgetRequestId: "+n+", participantId: "+t);$("#divRequestFormDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divRequestFormDialog").dialog("close")})}});this.renderCreateRequestFullFormOffline();var h="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),i=[];if(i=[],r=["budgetrequest","Budget Request","selected"],i.push(r),r=["quoterequest","Quote Request",""],i.push(r),r=["expenserequest","Reimbursement Request",""],i.push(r),r=["recurringexpense","Recurring Expense",""],i.push(r),r=["capitalplanproject","Capital Plan Project",""],i.push(r),r=["workorder","Work Order",""],i.push(r),o="capitalplanproject",$("#dtEstimatedStartDate").datepicker(),$("#dtEstimatedEndDate").datepicker(),$("#dtEstimatedStartDate").change(function(n){var t,r,i;console.log("In dtEstimatedStartDate.change()xcx3. value: "+n.target.value);t=$("#dtEstimatedStartDate").datepicker("getDate");r=$("#dtEstimatedEndDate").datepicker("getDate");t!==null&&r!==null&&(i=Date.daysBetween(t,r),console.log("daysTotal: "+i),i==-1?console.log("Invalid date range"):console.log(i+" days"));thiz.options.store.EstimatedStartDate=t;thiz.renderSpendForecast()}),$("#dtEstimatedEndDate").change(function(n){var r,t,i;console.log("In dtEstimatedEndDate.change(). value: "+n.target.value);r=$("#dtEstimatedStartDate").datepicker("getDate");t=$("#dtEstimatedEndDate").datepicker("getDate");r!==null&&t!==null&&(i=Date.daysBetween(r,t),console.log("daysTotal: "+i),i==-1?console.log("Invalid date range"):console.log(i+" days"));thiz.options.store.EstimatedEndDate=t;thiz.renderSpendForecast()}),f="",i.length==1)f+='<span style="font-size: 200%;">New <strong>'+i[0][1]+"<\/strong><\/span>",document.getElementById("spanRequestForm_Title").innerHTML=f;else{for(f+='<span style="font-size: 200%;">New <strong>',f+='<select id="selectNewRequestFormRequestTypeDropDown-DOESTHISEVERGETUSED" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: .5em; font-weight: bold; cursor: pointer;\'>',u=0;u<i.length;u++)f+=i[u][0]==o?'<option value="'+i[u][0]+'" '+i[u][2]+" selected >"+i[u][1]+"<\/option>":'<option value="'+i[u][0]+'" '+i[u][2]+">"+i[u][1]+"<\/option>";f+="<\/select>";f+="<\/span>";try{document.getElementById("spanRequestForm_Title").innerHTML=f}catch(e){console.log("Caught Exception in displayOfflineRequestFormDialog()xcx12436: "+e.message+", "+e.stack)}$("#selectNewRequestFormRequestTypeDropDown").change(function(){var n,i;alert("In  selectNewRequestFormRequestTypeDropDown.change(). Is this old code??? xcx12346-2");$("#divTopBar_Long").html("");n=$("#selectNewRequestFormRequestTypeDropDown option:selected").val();o=n;data={bwParticipantId:t,bwWorkflowAppId:workflowAppId,bwLastSelectedNewRequestType:o};i=webserviceurl+"/bwparticipant/updateuserconfigurationselectednewrequestscreenrequesttype";$.ajax({url:i,type:"POST",data:data,headers:{Accept:"application/json; odata=verbose"},success:function(t){t!="SUCCESS"?displayAlertDialog(t):n=="recurringexpense"?($("#trNewRequestRecurringExpenseSection").show(),$("#dtRecurringExpenseReminderDate").datepicker()):$("#trNewRequestRecurringExpenseSection").hide()},error:function(n,t,i){displayAlertDialog("Error in my.js.cmdChooseSelectedWorkflow(): "+t+" "+i)}})})}$(".bwCoreComponent").bwCoreComponent("populateTheYearDropdown","selectFiscalYear",!1);this.populateFunctionalAreas();this.populateLocations();s="Project Manager";$("#spanRequestForm_ManagerTitle").html(s);try{document.getElementById("spanNewRequestDetailsLabel").innerHTML='<span class="xdlabel">Justification details:<\/span>&nbsp;<span style="color:red;font-size:medium;">*<\/span>';document.getElementById("spanNewRequestStartDateLabel").innerHTML='<span class="xdlabel">Start date (estimated):<\/span>';document.getElementById("spanNewRequestEndDateLabel").innerHTML='<span class="xdlabel">End date (estimated):<\/span>'}catch(e){console.log("Caught Exception in displayOfflineRequestFormDialog()xcx0074: "+e.message+", "+e.stack)}$("#trNewRequestAttachmentsSection").show();$("#trNewRequestBarcodeAttachmentsSection").hide()}catch(e){console.log("Exception in displayOfflineRequestFormDialog(): "+e.message+", "+e.stack)}},removeFromWorkflow:function(n){var t,u;try{console.log("In bwRequest.js.removeFromWorkflow().");var e=this,i="divRemoveRequestFromWorkflow",r=document.getElementById(i);r||(r=document.createElement("div"),r.id=i,document.body.appendChild(r));t="";t+='        <table style="width:100%;">';t+="            <tr>";t+='                <td style="width:90%;">';t+='                    <span id="divRemoveRequestFromWorkflow_Content"><\/span>';t+="                <\/td>";t+="            <\/tr>";t+="        <\/table>";t+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->';t+="        <br /><br />";r.innerHTML=t;$("#"+i).dialog({modal:!0,resizable:!0,closeOnEscape:!0,width:"800px",dialogClass:"no-close",hide:!1,position:{my:"middle top+12",at:"middle top","of":window},close:function(){},open:function(){var t,r;try{t="";t+='        <table style="width:100%;">';t+="            <tr>";t+='                <td style="width:90%;">';t+='                    <span id="" style="color: #3f3f3f;font-size: 60pt;font-weight:bold;">Delete Workflow from Request<\/span>';t+="                <\/td>";t+='                <td style="width:9%;"><\/td>';t+='                <td style="width:1%;cursor:pointer;vertical-align:top;">';t+=`                    <span class="dialogXButton" style="font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size: 120pt;font-weight:bold;" onclick="$('#`+i+`').dialog('close');">X</span>`;t+="                <\/td>";t+="            <\/tr>";t+="        <\/table>";t+="        <br /><br />";t+=`
                    
                    <div style="font-size:35pt;">This request will have the workflow removed immediately. <br /<br /> This deletion cannot be reversed.<br /<br /> Save your changes prior to performing this operation.</div>
                    <br /<br />
                    <div id="divSetBudgetRequestReminderDialog_SaveReminderButton" class="divDialogButton" onclick="$('.bwRequest:first').bwRequest('deleteWorkflowFromRequest', '`+n+`');">Delete</div>
                    <br /<br />
                    <div id="divSetBudgetRequestReminderDialog_SaveReminderButton" class="divDialogButton" onclick="$('#`+i+`').dialog('close');">Cancel</div>
                    <br /<br />
                    
                        `;$("#divRemoveRequestFromWorkflow_Content").html(t)}catch(u){r="Exception in bwRequest.js.removeFromWorkflow.dialog.open(): "+u.message+", "+u.stack;console.log(r);displayAlertDialog(r)}}})}catch(f){u="Exception in bwRequest.js.removeFromWorkflow(): "+f.message+", "+f.stack;console.log(u);displayAlertDialog(u)}},deleteWorkflowFromRequest:function(n){var t;try{console.log("In bwRequest.js.deleteWorkflowFromRequest().");ShowActivitySpinner("Deleting the workflow from the request...");var r=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),u=$(".bwAuthentication").bwAuthentication("option","participantId"),f=$(".bwAuthentication").bwAuthentication("option","participantEmail"),e=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),o=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),s={bwParticipantId_LoggedIn:u,bwActiveStateIdentifier:o,bwWorkflowAppId_LoggedIn:r,bwBudgetRequestId:n,bwParticipantEmail:f,bwParticipantFriendlyName:e};$.ajax({url:webserviceurl+"/deleteworkflowfromrequest",type:"POST",data:s,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){HideActivitySpinner();var r="Error in bwRequest.js.deleteWorkflowFromRequest.error(): "+t+", "+i+", data: "+JSON.stringify(n);console.log(r);displayAlertDialog(r)},success:function(t){var i;try{HideActivitySpinner();t.status!="SUCCESS"?(i="Error in bwRequest.js.deleteWorkflowFromRequest.success(): "+t.status+", "+t.message,console.log(i),displayAlertDialog(i)):(console.log("The Workflow has been removed from the request."),displayAlertDialog("The Workflow has been removed from the request."),$("#divRemoveRequestFromWorkflow").dialog("close"),$("#divRequestWorkflowAuditTrailDialog_"+n).dialog("close"),$("#divRequestFormDialog_"+n).dialog("close"))}catch(r){HideActivitySpinner();i="Exception in bwRequest.js.deleteWorkflowFromRequest.success():2: "+r.message+", "+r.stack;console.log(i);displayAlertDialog(i)}}})}catch(i){HideActivitySpinner();t="Exception in bwRequest.js.deleteWorkflowFromRequest(): "+i.message+", "+i.stack;console.log(t);displayAlertDialog(t)}},displayRequestWorkflowAuditTrailDialog:function(n,t,i,r,u){var o,f,e,s;try{console.log("In displayRequestWorkflowAuditTrailDialog().");o=this;this.pinRequestDialog();f="divRequestWorkflowAuditTrailDialog_"+r;e="";e+='        <table style="width:100%;">';e+="            <tr>";e+='                <td style="width:90%;">';e+='                    <span id="divRequestFormContent"><\/span>';e+="                <\/td>";e+="            <\/tr>";e+="        <\/table>";e+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->';e+="        <br /><br />";s=document.getElementById(f);s||(s=document.createElement("div"),s.id=f,document.body.appendChild(s));s.innerHTML=e;$("#"+f).dialog({modal:!0,resizable:!0,closeOnEscape:!0,width:"1050px",dialogClass:"no-close",hide:!1,position:{my:"middle top+12",at:"middle top","of":window},close:function(){console.log("");console.log("==========================================");console.log("In xcx34-1(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-x-3");console.log("==========================================");console.log("")},open:function(){var b,h,e,y,c,k,d,p,w,l,a,s,g,nt;try{for(b=document.getElementById(f).parentNode,h=f+"_Parent",b.id=h,e="",e+='<table xcx="xcx3249-4" style="width:100%;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequestDialog\');">',e+="   <tr>",e+='       <td style="width:95%;">',e+='           <div id="slider_'+f+'" style="width:20%;cursor:pointer;"><\/div>',e+="       <\/td>",e+="       <td>",e+='           <span class="dialogXButton" style="font-size:25pt;cursor:pointer;width:100%;font-weight:bold;" onclick="$(\'#'+f.replace("_Parent","")+"').dialog('close');\">X<\/span>",e+="       <\/td>",e+="   <\/tr>",e+="<\/table>",document.getElementById(f).parentNode.querySelector(".ui-dialog-titlebar").innerHTML=e,e="",c=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems,s=0;s<c.length;s++)if(i==c[s].bwRequestTypeId){y=c[s];break}for(k=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),e+='<table style="width:100%;">',e+="   <tbody>",e+="       <tr>",e+='           <td colspan="4">',e+='               <span id="divCreateRequestFormContent_requestOrgClickableBreadcrumb" style="color:purple;font-size:8pt;">',e+="               <\/span>",e+="           <\/td>",e+="       <\/tr>",e+="       <tr>",e+='           <td width="5">',e+="           <\/td>",e+='           <td style="vertical-align:top;">',e+="               <span>",d="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),p=JSON.parse($(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier")),e+=p.status!="SUCCESS"?"[No image. Unauthorized. xcx213124-34556-34-234-3245]":'                   <img xcx="fewrwwa" id="divCreateRequestFormContent_imgRequestOrgImage" style="width:150px;height:150px;" src="'+o.options.operationUriPrefix+"_files/"+k+"/orgimages/root/orgimage.png?v="+d+"&ActiveStateIdentifier="+p.ActiveStateIdentifier+'">',e+="               <\/span>",e+="           <\/td>",e+='           <td style="text-align:left;" colspan="2">',e+='               <span class="xdlabel" id="spanRequestForm_Title">',e+="                   <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">",e+=y?y.SingletonName+": ":"requesttype_not_found bwRequestTypeId:"+i+": ",e+='                       <span id="spanRequestFormBudgetRequestTitle" title="">',e+=n,e+="                           <br />",e+='                           <span id="'+h+'_spanWorkflowGuidAndRequestTypeForTesting2" style="color:gray;font-size:small;"><\/span>',e+="                       <\/span>",e+="                   <\/span>",e+="               <\/span>",w=$(".bwAuthentication").bwAuthentication("option","participantRole"),(w=="owner"||w=="configurationmanager")&&(e+="               <div style=\"float:right;\"><button xcx=\"xcx54356457\" onclick=\"$('.bwRequest').bwRequest('removeFromWorkflow', '"+r+"', '"+i+'\');" class="BwButton300ForRequestForm" title="Remove the workflow from this request...">Remove from Workflow<\/button><\/div>'),e+="               <br />",e+="           <\/td>",e+="       <\/tr>",e+="   <\/tbody>",e+="<\/table>",e+='<span id="'+h+'_Content"><\/span>',document.getElementById(f).innerHTML=e,a=document.getElementsByClassName("budgetrequestform"),s=0;s<a.length;s++)if(g=a[s].getAttribute("bwbudgetrequestid"),r==g){l=a[s];break}if(l){var tt=$(l)[0].getAttribute("bworgid"),it=$(l).find(".bwLocationPicker:first").bwLocationPicker("option","store"),rt=$(".bwAuthentication").bwAuthentication("renderTheOrgBreadcrumb2",it,tt);$("#"+f).find("#divCreateRequestFormContent_requestOrgClickableBreadcrumb")[0].innerHTML=rt.orgPathClickable;$("#slider_"+f).slider({min:50,max:200,value:100,slide:function(n,t){o.setZoom(t.value,f)}});o.setZoom(100,f);$(".ui-widget-overlay").bind("click",function(){$("#"+f).dialog("close")});nt=o.loadWorkflowsAndCurrentWorkflow2(i);nt.then(function(){try{o.renderWorkflowAuditTrail(h,i,n,t,r,u)}catch(f){console.log("Exception in bwWorkflowEditor._create().loadWorkflowsAndCurrentWorkflow(): "+f.message+", "+f.stack);displayAlertDialog("Exception in bwWorkflowEditor._create().loadWorkflowsAndCurrentWorkflow(): "+f.message+", "+f.stack)}})}else displayAlertDialog("In bwRequest.js.displayRequestWorkflowAuditTrailDialog(). Could not find the form for bwBudgetRequestId: "+r)}catch(v){console.log("Exception in displayRequestWorkflowAuditTrailDialog().dialog.open(): "+v.message+", "+v.stack);displayAlertDialog("Exception in displayRequestWorkflowAuditTrailDialog().dialog.open(): "+v.message+", "+v.stack)}}}).dialog("moveToTop");console.log("xcx213123 dialog moveToTop(). Does this work?")}catch(h){console.log("Exception in displayRequestWorkflowAuditTrailDialog(): "+h.message+", "+h.stack);displayAlertDialog("Exception in displayRequestWorkflowAuditTrailDialog(): "+h.message+", "+h.stack)}},displayRequestWorkflowAuditTrailDialog2:function(n,t,i,r,u){var s,f,e,o;try{console.log("In displayRequestWorkflowAuditTrailDialog2().");s=this;this.pinRequestDialog();f="divRequestWorkflowAuditTrailDialog_"+r;e="";e+='        <table style="width:100%;">';e+="            <tr>";e+='                <td style="width:90%;">';e+='                    <span id="divRequestFormContent"><\/span>';e+="                <\/td>";e+="            <\/tr>";e+="        <\/table>";e+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->';e+="        <br /><br />";o=document.getElementById(f);o||(o=document.createElement("div"),o.id=f,document.body.appendChild(o));o.innerHTML=e;$("#"+f).dialog({modal:!0,resizable:!0,closeOnEscape:!0,width:"1050px",dialogClass:"no-close",hide:!1,position:{my:"middle top+12",at:"middle top","of":window},close:function(){console.log("");console.log("==========================================");console.log("In xcx34-1(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-x-3");console.log("==========================================");console.log("")},open:function(){var w,h,e,v,c,b,k,y,p,l,o,d,g,nt;try{for(w=document.getElementById(f).parentNode,h=f+"_Parent",w.id=h,e="",e+='<table xcx="xcx3249-4" style="width:100%;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequestDialog\');">',e+="   <tr>",e+='       <td style="width:95%;">',e+='           <div id="slider_'+f+'" style="width:20%;cursor:pointer;"><\/div>',e+="       <\/td>",e+="       <td>",e+='           <span class="dialogXButton" style="font-size:25pt;cursor:pointer;width:100%;font-weight:bold;" onclick="$(\'#'+f.replace("_Parent","")+"').dialog('close');\">X<\/span>",e+="       <\/td>",e+="   <\/tr>",e+="<\/table>",document.getElementById(f).parentNode.querySelector(".ui-dialog-titlebar").innerHTML=e,e="",c=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems,o=0;o<c.length;o++)if(i==c[o].bwRequestTypeId){v=c[o];break}for(b=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),e+='<table style="width:100%;">',e+="   <tbody>",e+="       <tr>",e+='           <td colspan="4">',e+='               <span id="divCreateRequestFormContent_requestOrgClickableBreadcrumb" style="color:purple;font-size:8pt;">',e+="               <\/span>",e+="           <\/td>",e+="       <\/tr>",e+="       <tr>",e+='           <td width="5">',e+="           <\/td>",e+='           <td style="vertical-align:top;">',e+="               <span>",k="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),y=JSON.parse($(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier")),e+=y.status!="SUCCESS"?"[No image. Unauthorized. xcx213124-34556-34-234-3245]":'                   <img xcx="fewrwwa" id="divCreateRequestFormContent_imgRequestOrgImage" style="width:150px;height:150px;" src="'+s.options.operationUriPrefix+"_files/"+b+"/orgimages/root/orgimage.png?v="+k+"&ActiveStateIdentifier="+y.ActiveStateIdentifier+'">',e+="               <\/span>",e+="           <\/td>",e+='           <td style="text-align:left;" colspan="2">',e+='               <span class="xdlabel" id="spanRequestForm_Title">',e+="                   <span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">",e+=v?v.SingletonName+": ":"requesttype_not_found bwRequestTypeId:"+i+": ",e+='                       <span id="spanRequestFormBudgetRequestTitle" title="">',e+=n,e+="                           <br />",e+='                           <span id="'+h+'_spanWorkflowGuidAndRequestTypeForTesting2" style="color:gray;font-size:small;"><\/span>',e+="                       <\/span>",e+="                   <\/span>",e+="               <\/span>",e+="               <br />",e+="           <\/td>",e+="       <\/tr>",e+="   <\/tbody>",e+="<\/table>",e+='<span id="'+h+'_Content"><\/span>',document.getElementById(f).innerHTML=e,l=document.getElementsByClassName("executiveSummaryInCarousel"),o=0;o<l.length;o++)if(d=l[o].getAttribute("bwbudgetrequestid"),r==d){p=l[o];break}p?(g=$(p)[0].getAttribute("bworgid"),nt=s.loadWorkflowsAndCurrentWorkflow2(i),nt.then(function(){try{s.renderWorkflowAuditTrail2(h,i,n,t,r,u,g)}catch(f){console.log("Exception in bwWorkflowEditor._create().loadWorkflowsAndCurrentWorkflow(): "+f.message+", "+f.stack);displayAlertDialog("Exception in bwWorkflowEditor._create().loadWorkflowsAndCurrentWorkflow(): "+f.message+", "+f.stack)}})):displayAlertDialog("In bwRequest.js.displayRequestWorkflowAuditTrailDialog2(). Could not find the form for bwBudgetRequestId: "+r)}catch(a){console.log("Exception in displayRequestWorkflowAuditTrailDialog2().dialog.open(): "+a.message+", "+a.stack);displayAlertDialog("Exception in displayRequestWorkflowAuditTrailDialog2().dialog.open(): "+a.message+", "+a.stack)}}});$("#"+f).dialog("moveToTop");console.log("xcx213123 dialog moveToTop")}catch(h){console.log("Exception in displayRequestWorkflowAuditTrailDialog2(): "+h.message+", "+h.stack);displayAlertDialog("Exception in displayRequestWorkflowAuditTrailDialog2(): "+h.message+", "+h.stack)}},renderWorkflowAuditTrail:function(n,t,i,r,u){try{console.log("In renderWorkflowAuditTrail().");var f=this,s="divRequestFormDialog_"+u+"_Parent",e=$("#"+s).find("#budgetrequestform")[0].getAttribute("bworgid"),h=$("#"+s).find("#budgetrequestform")[0].getAttribute("bwrequesttypeid");if(e){var c=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),l=$(".bwAuthentication").bwAuthentication("option","participantId"),a=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),v={bwParticipantId_LoggedIn:l,bwActiveStateIdentifier:a,bwWorkflowAppId_LoggedIn:c,bwWorkflowAppId:c,bwRequestTypeId:h,bwOrgId:e},y=this.options.operationUriPrefix+"odata/racirolesandparticipants";$.ajax({url:y,type:"POST",data:v,headers:{Accept:"application/json; odata=verbose"},success:function(t){var a,o,b,tt,y,wt,bt,kt,w,g,rt,ut,k,ft,gt,c,dt,st,l,nt,yt,at,ot,v,p,pt;try{if(a=t,console.log("In renderWorkflowPeoplePicker():2:."),a.length==0)displayAlertDialog("ERROR: Cannot locate workflowxcx9 for bwBudgetRequestId: "+u);else{var ni=a.Workflow,s=JSON.parse(a.Workflow.bwWorkflowJson),e="";if(s==null)e+='<span style="font-size:24pt;color:red;">NO DATA<\/span>';else{if(e+="<style>",e+=".titlecell {",e+="    vertical-align:top;",e+="    padding-top:3px;",e+="    padding-bottom:3px;",e+="    padding-left:5px;",e+="    padding-right:10px;",e+="    white-space:nowrap;",e+="    color:grey;",e+="    text-decoration:underline;",e+="}",e+=".steprowcell {",e+="    vertical-align:top;",e+="    padding-top:10px;",e+="    padding-bottom:10px;",e+="    padding-left:5px;",e+="    padding-right:5px;",e+="    white-space:nowrap;",e+="}",e+=".steprow-hidden {",e+="    visibility: collapse;",e+="}",e+=".steprow:hover {",e+="    background-color: lightgoldenrodyellow;",e+="}",e+=".stepheadercell:hover {",e+="    background-color: gainsboro !important;",e+="}",e+=".activeEditRow {",e+="    background-color: #EBF6F9;",e+="}",e+=".ui-progressbar {",e+="    position: relative;",e+="}",e+=".progress-label {",e+="    position: absolute;",e+="    left: 10%;",e+="    top: 4px;",e+="    font-weight: bold;",e+="    color: black;",e+="    text-shadow: 1px 1px 0 #fff;",e+="}",e+="#progressbar .ui-progressbar-value {",e+="    background-color: cyan;",e+="}",e+=".transparent-dialog {",e+="  background: transparent;",e+="  border: none;",e+="}",e+=".transparent-dialog .ui-widget-header {",e+="  border: none;",e+="  background: transparent;",e+="}",e+=".transparent-dialog .ui-widget-content {",e+="  background: transparent;",e+="}",e+="<\/style>",e+="<br />",e+="<span id=\"xcx449956-1\" title=\"Expand or Collapse ALL...\" onclick=\"$('.bwRequest').bwRequest('expandOrCollapseAllWorkflowSteps', '"+n+'\');" style="width:200px;padding:5px 10px 5px 10px;margin:0 0 0 20px;white-space:nowrap;vertical-align:top;border:1px solid lightblue;cursor:pointer;font-weight:normal;font-size:20pt;">                           <span style="display:inline-block;">+/-<\/span>                       <\/span>',e+="<table>",e+="   <tr>",e+='       <td style="vertical-align:top;">',e+='<table border="1" style="border-color:#d8d8d8;">',s){for(o=0;o<s.Steps.Step.length;o++)if(b=s.Steps.Step[o]["@Name"],!0)if(tt=s.Steps.Step[o]["@FriendlyName"],b=="Create"?tt="Create":b=="Revise"?tt="Revise":b=="Admin"&&(tt="Admin"),y="#f5f6f7",e+='<tr id="stepheaderrow_'+o+'" style="border:0px;cursor:pointer;">',e+='  <td colspan="11" class="stepheadercell" style="font-weight:bold;padding:10px;background-color:'+y+';" >',e+='    <table style="width:100%;">',e+="      <tr>",e+="        <td style=\"\" onclick=\"$('.bwRequest').bwRequest('expandOrCollapseWorkflowStep2', 'stepname_"+o+"', 'stepimage_"+o+"', 'steprow-"+b.toLowerCase()+"_"+o+"_0', '"+n+"');\">",e+='          <span style="white-space:nowrap;">',e+='            <span id="stepname_'+o+'" class="stepname" bwStepName="'+b+'" bwStepFriendlyName="'+tt+'" style="cursor:pointer;vertical-align:middle;" >',e+='              <img id="stepimage_'+o+'" src="images/drawer-open.png" title="collapse" style="cursor:pointer;width:45px;height:45px;vertical-align:middle;"  />',e+=tt,wt=n+"_"+b+"_warningSign",e+='              <span id="'+wt+'" xcx="xcx12312_1"><\/span>',e+="            <\/span>",e+="          <\/span>",e+="        <\/td>",e+="        <td style=\"\" onclick=\"$('.bwRequest').bwRequest('expandOrCollapseWorkflowStep2', 'stepname_"+o+"', 'stepimage_"+o+"', 'steprow-"+b.toLowerCase()+"_"+o+"_0', '"+n+"');\">",e+="        <\/td>",e+='        <td style="text-align:center;">',s.Steps.Step[o]["@Name"]=="Collaboration"&&(bt=s.Steps.Step[o]["@Timeout"],kt=s.Steps.Step[o]["@TimeoutUnits"],e+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+bt+"&nbsp"+kt,e+='<input autocomplete="off" class="bwRequestJson hasDatepicker" id="dtBwRequest_Workflow_Consensus_'+u+'" type="text" value="Or select a date..." style="cursor:pointer;WIDTH: 60%;font-family: \'Segoe UI Light\',\'Segoe UI\',\'Segoe\',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 20pt;TEXT-ALIGN: left;">'),e+='           <table style="width:100%;">',e+="               <tr>",e+="                   <td><\/td>",e+="                   <td><\/td>",e+="                   <td><\/td>",e+="                   <td><\/td>",e+='                   <td style="text-align:right;">',e+="                   <\/td>",e+="               <\/tr>",e+="           <\/table>",e+="        <\/td>",e+="      <\/tr>",e+="    <\/table>",e+="  <\/td>",e+="<\/tr>",b=="Create"||b=="Revise"||b=="Admin"){if(s.Steps.Step[o].Assign){for(e+='<tr id="steprow-'+b.toLowerCase()+"_"+o+'_0" class="steprow steprow_'+o+'" style="cursor:pointer;display:none;" title="This role assignment cannot be changed, it is a part of the core workflow functionality." >',e+='  <td style="width:30px;"><\/td>',f.options.displayRoleIdColumn&&(e+='<td xcx="sssdg" style="background-color:'+y+';" class="roleid steprowcell" bwRoleId="'+s.Steps.Step[o].Assign["@Role"]+'" bwOldValue="'+s.Steps.Step[o].Assign["@Role"]+'">'+s.Steps.Step[o].Assign["@Role"]+"<\/td>"),rt=[],k=0;k<s.Steps.Step[o].Assign.length;k++)rt.push(s.Steps.Step[o].Assign[k]["@Role"]);for(ut=[],k=0;k<s.Steps.Step[o].Assign.length;k++)ut.push(s.Steps.Step[o].Assign[k]["@RoleCategory"]);rt.length==1&&ut.length==1?(w=rt[0],g=ut[0]):alert("Unexpected value for roleNames/roleCategories: "+JSON.stringify(rt)+", "+JSON.stringify(ut));e+='<td xcx="ttys" style="background-color:'+y+';" class="rolename steprowcell" onMouseOver="this.style.backgroundColor=\'lightgoldenrodyellow\';this.style.color=\'red\';" onMouseOut="this.style.backgroundColor=\''+y+"';this.style.color='black';\" bwStepname=\""+s.Steps.Step[o]["@Name"]+'" bwRoleId="'+s.Steps.Step[o].Assign["@Role"]+'" bwOldValue="'+w+'">';e+="Role: "+w;e+="<\/td>";e+='<td class="steprowcell">';e+=' <span xcx="jjdgr" id="rolecategory-assign_'+o+"_"+c+'" class="rolecategory" bwStepname="'+s.Steps.Step[o]["@Name"]+'" bwRoleId="'+w+'" bwOldValue="'+g+'" style="cursor:pointer;" title="Double-click to edit the role category...">';e+=g;e+=" <\/span>";e+="<\/td>";ft=s.Steps.Step[o].Assign&&s.Steps.Step[o].Assign.length?s.Steps.Step[o].Assign[0].Action["@Name"]:s.Steps.Step[o].Assign.Action["@Name"];ft=ft?"&nbsp;"+ft:"";e+='<td xcx="aadgf" colspan="1" class="tasks steprowcell" bwStepname="'+s.Steps.Step[o]["@Name"]+'" bwRoleId="'+w+'" >'+ft+"<\/td>";e+='<td xcx="llsd" class="steprowaudittasktrail" bwStepname="'+s.Steps.Step[o]["@Name"]+'" bwStepIndex="'+o+'" bwRoleId="'+w+'" ><\/td>';e+="<\/tr>"}}else{if(s.Steps.Step[o].Inform&&s.Steps.Step[o].Inform.length&&s.Steps.Step[o].Inform.length>0)for(c=0;c<s.Steps.Step[o].Inform.length;c++){dt="steprow-inform_"+o+"_"+c;st="";e+='<tr id="steprow-inform_'+o+"_"+c+'" class="steprow'+st+" steprow_"+o+'" style="cursor:pointer;display:none;" >';e+='  <td style="width:30px;"><\/td>';f.options.displayRoleIdColumn&&s.Steps.Step[o].Inform[c]&&(e+=s.Steps.Step[o].Inform[c]["@Role"]?'<td style="background-color:'+y+';" class="roleid steprowcell" bwroleid="'+s.Steps.Step[o].Inform[c]["@Role"]+'" bwOldValue="'+s.Steps.Step[o].Inform[c]["@Role"]+'">'+s.Steps.Step[o].Inform[c]["@Role"]+"<\/td>":'<td style="background-color:'+y+';" class="roleid steprowcell" bwroleid="'+s.Steps.Step[o].Inform[c]["@Role"]+'" bwOldValue="'+s.Steps.Step[o].Inform[c]["@Role"]+'">'+s.Steps.Step[o].Inform[c]["@IdField"]+"<\/td>");var w="",et="",g="";s.Steps.Step[o].Inform[c]&&(w=s.Steps.Step[o].Inform[c]["@RoleName"],et=s.Steps.Step[o].Inform[c]["@Role"],g="Inform");e+='<td xcx="xcx23536-1" style="background-color:'+y+';" class="rolename steprowcell" onMouseOver="this.style.backgroundColor=\'lightgoldenrodyellow\';" onMouseOut="this.style.backgroundColor=\''+y+'\';" bwStepname="'+s.Steps.Step[o]["@Name"]+'" bwroleid="'+s.Steps.Step[o].Inform[c]["@Role"]+'" bwOldValue="'+w+'">';gt=!0;gt?(e+='<span style="font-size:12pt;">',e+=w,e+="<\/span>"):(e+='<span style="color:red;font-size:12pt;font-style:italic;">',e+=w,e+="<\/span>");e+="<\/td>";l="RACI: ";l+="\n";l+="R = Responsible (also Recommender)  ";l+="\n";l+="A = Accountable (also Approver or final approving authority)  ";l+="\n";l+="C = Consulted (sometimes Consultant or counsel)  ";l+="\n";l+="I = Informed (also Informee)  ";e+='<td title="'+l+'" style="color:grey;">'+g+"<\/td>";e+='  <td class="steprowbuttons steprowcell" style="background-color:'+y+';width:80px;text-align:right;padding-right:15px;" >';var ht="",d="",ct="",lt="",it=!1;for(v=0;v<a.RolesAndUsers.length;v++){for(p=0;p<a.RolesAndUsers[v].Roles.length;p++)if(et==a.RolesAndUsers[v].Roles[p].RoleId&&(ht=a.RolesAndUsers[v].Roles[p].ParticipantId,d=a.RolesAndUsers[v].Roles[p].ParticipantFriendlyName,ct=a.RolesAndUsers[v].Roles[p].ParticipantEmail,lt=a.RolesAndUsers[v].OrgName,it=!0),it==!0)break;if(it==!0)break}d&&(e+="<span xcx=\"xcx234566-3\" style=\"cursor:pointer;color:purple;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+ht+"', '"+d+"', '"+ct+"');\">",e+=d,e+=" ("+lt+")",e+="<\/span>");e+="  <\/td>";e+='<td xcx="ppas" class="steprowaudittasktrail" bwStepname="'+s.Steps.Step[o]["@Name"]+'" bwStepIndex="'+o+'" bwRoleId="'+s.Steps.Step[o].Inform[c]["@Role"]+'" ><\/td>';e+="<\/tr>"}if(s.Steps.Step[o].Assign&&s.Steps.Step[o].Assign.length>0)for(c=0;c<s.Steps.Step[o].Assign.length;c++){dt="steprow-assign_"+o+"_"+c;st="";e+='<tr id="steprow-assign_'+o+"_"+c+'" class="steprow'+st+" steprow_"+o+'" style="cursor:pointer;display:none;" >';e+='  <td style="width:30px;"><\/td>';f.options.displayRoleIdColumn&&(e+='<td style="background-color:'+y+';" class="roleid steprowcell" bwroleid="'+s.Steps.Step[o].Assign[c]["@Role"]+'" bwOldValue="'+s.Steps.Step[o].Assign[c]["@Role"]+'">'+s.Steps.Step[o].Assign[c]["@Role"]+"<\/td>");var w="",et="",g="";if(s.Steps.Step[o].Assign[c]&&(w=s.Steps.Step[o].Assign[c]["@RoleName"],et=s.Steps.Step[o].Assign[c]["@Role"],g=s.Steps.Step[o].Assign[c]["@RoleCategory"]),e+='<td xcx="xcx23536-2" style="background-color:'+y+';" class="rolename steprowcell" onMouseOver="this.style.backgroundColor=\'lightgoldenrodyellow\';" onMouseOut="this.style.backgroundColor=\''+y+'\';" bwStepname="'+s.Steps.Step[o]["@Name"]+'" bwroleid="'+s.Steps.Step[o].Assign[c]["@Role"]+'" bwOldValue="'+w+'">',e+=w+" ("+et+")",e+="<br />",e+="<\/td>",l="RACI: ",l+="\n",l+="R = Responsible (also Recommender)  ",l+="\n",l+="A = Accountable (also Approver or final approving authority)  ",l+="\n",l+="C = Consulted (sometimes Consultant or counsel)  ",l+="\n",l+="I = Informed (also Informee)  ",nt="",s.Steps.Step[o].Assign[c]["@Cond"]&&(yt=s.Steps.Step[o].Assign[c]["@Cond"],yt.indexOf("$ChecklistsRequired~")>-1)){for(nt='<span style="cursor:pointer;" title="This role has checklist(s) to complete: ',at=f.options.Checklists,ot=0;ot<at.length;ot++)yt.indexOf(at[ot].bwChecklistTemplatesId)>-1&&(nt+="\n",nt+=JSON.parse(at[ot].ChecklistJson).Title);nt+='">';nt+="<span onclick=\"alert('This functionality is incomplete. Coming soon! This will display all of the checklists for this request...xcx2');\">&nbsp;&nbsp<\/span>"}e+='<td title="'+l+'" style="color:grey;">'+g+nt+"<\/td>";e+='<td class="steprowbuttons steprowcell" style="background-color:'+y+';width:80px;text-align:right;padding-right:15px;" >';var ht="",d="",ct="",lt="",it=!1;for(v=0;v<a.RolesAndUsers.length;v++){for(p=0;p<a.RolesAndUsers[v].Roles.length;p++)if(et==a.RolesAndUsers[v].Roles[p].RoleId&&(ht=a.RolesAndUsers[v].Roles[p].ParticipantId,d=a.RolesAndUsers[v].Roles[p].ParticipantFriendlyName,ct=a.RolesAndUsers[v].Roles[p].ParticipantEmail,lt=a.RolesAndUsers[v].OrgName,it=!0),it==!0)break;if(it==!0)break}d&&(e+="<span test=\"xcxtest2\" style=\"cursor:pointer;color:purple;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+ht+"', '"+d+"', '"+ct+"');\">",e+=d,e+=" ("+lt+")",e+="<\/span>");e+="<\/td>";e+='<td xcx="ppors" class="steprowaudittasktrail" bwStepname="'+s.Steps.Step[o]["@Name"]+'" bwStepIndex="'+o+'" bwRoleId="'+s.Steps.Step[o].Assign[c]["@Role"]+'" ><\/td>';e+="<\/tr>"}}}else e+="<tr>",e+="  <td>",e+="    NO WORKFLOW JSON. CANNOT PROCEED. xcx32456-3",e+="  <\/td>",e+="<\/tr>";e+="<\/table>";e+="       <\/td>";e+="       <td>&nbsp;&nbsp;<\/td>";e+='       <td style="vertical-align:top;">';e+='           <span id="'+n+'_spanWorkflowAuditTrailSummary">['+n+"_spanWorkflowAuditTrailSummary]<\/span>";e+="       <\/td>";e+="   <\/tr>";e+="<\/table>";e+='<div style="display:none;" id="divOrgMultiPickerDialog">';e+='  <table style="width:100%;">';e+="    <tr>";e+='      <td style="width:90%;">';e+='        <span id="spanOrgMultiPickerDialogTitle" style="color: #3f3f3f;font-size:30pt;font-weight:bold;">Location(s)<\/span>';e+="      <\/td>";e+='      <td style="width:9%;"><\/td>';e+='      <td style="width:1%;cursor:pointer;vertical-align:top;">';e+="        <span class=\"dialogXButton\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:30pt;font-weight:bold;\" onclick=\"$('#divOrgMultiPickerDialog').dialog('close');\">X<\/span>";e+="      <\/td>";e+="    <\/tr>";e+="  <\/table>";e+="  <br /><br />";e+='  <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';e+="  <span id=\"spanOrgMultiPickerDialogContent\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 20pt;\"><\/span><br />";e+="  <br /><br />";e+='  <input type="button" value="SAVE" onclick="$(\'.bwWorkflowEditor\').bwWorkflowEditor(\'orgMultiPickerDialog_RenderResults\');" />';e+="  <br /><br />";e+="<\/div>";e+='<div style="display:none;" id="divMessageDialog">';e+='  <table style="width:100%;">';e+="    <tr>";e+='      <td style="width:90%;">';e+='        <span id="spanMessageDialogTitle" style="color: #3f3f3f;font-size:30pt;font-weight:bold;">[spanMessageDialogTitle]<\/span>';e+="      <\/td>";e+='      <td style="width:9%;"><\/td>';e+='      <td style="width:1%;cursor:pointer;vertical-align:top;">';e+="        <span class=\"dialogXButton\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:30pt;font-weight:bold;\" onclick=\"$('#divMessageDialog').dialog('close');\">X<\/span>";e+="      <\/td>";e+="    <\/tr>";e+="  <\/table>";e+="  <br /><br />";e+='  <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';e+="  <span id=\"spanMessageDialogContentTop\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 20pt;\">[spanMessageDialogContentTop]<\/span>";e+="    <br />";e+="    <br />";e+="    <br />";e+='    <span id="spanMessageDialogContentBottom" style="font-weight:bold;cursor:pointer;">';e+="      [spanMessageDialogContentBottom]";e+="    <\/span>";e+="  <br /><br />";e+="<\/div>";e+='<div style="display:none;" id="divWorkflowActionsUnderlyingPropertiesDialog">';e+='  <table style="width:100%;">';e+="    <tr>";e+='      <td style="width:90%;">';e+='        <span id="spanWorkflowActionsUnderlyingPropertiesDialog" style="color: #3f3f3f;font-size:30pt;font-weight:bold;">Action Properties<\/span>';e+="                    <br />";e+="                    <span id=\"spanWorkflowActionsUnderlyingPropertiesDialogSubTitle\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size:12pt;font-weight:normal;\">[spanWorkflowActionsUnderlyingPropertiesDialogSubTitle]<\/span>";e+="      <\/td>";e+='      <td style="width:9%;"><\/td>';e+='      <td style="width:1%;cursor:pointer;vertical-align:top;">';e+="        <span class=\"dialogXButton\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:30pt;font-weight:bold;\" onclick=\"$('#divWorkflowActionsUnderlyingPropertiesDialog').dialog('close');\">X<\/span>";e+="      <\/td>";e+="    <\/tr>";e+="  <\/table>";e+="  <br /><br />";e+='  <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';e+='  <span id="spanWorkflowActionsUnderlyingPropertiesDialogContentTop">[spanWorkflowActionsUnderlyingPropertiesDialogContentTop]<\/span>';e+="    <br />";e+="    <br />";e+="    <br />";e+='    <span id="spanWorkflowActionsUnderlyingPropertiesDialogContentBottom" style="font-weight:bold;cursor:pointer;">';e+="    <\/span>";e+="  <br /><br />";e+="<\/div>";e+='<div style="display:none;" id="divProgressBarDialog">';e+='<div id="progressbar" class="ui-progressbar"><div class="progress-label">Loading...<\/div><\/div>';e+="<\/div>"}document.getElementById(n+"_Content").innerHTML=e;pt=$("#"+n+"_Content").find("#dtBwRequest_Workflow_Consensus_"+u);pt&&(console.log("xcx1234235346 Instantiating the consensus datepicker."),$(pt).datepicker());f.populateWorkflowAuditTrailSummary(i,r,u,n,h,s)}}catch(vt){console.log("Exception in renderWorkflowAuditTrail().xx.Get: "+vt.message+", "+vt.stack);displayAlertDialog("Exception in renderWorkflowAuditTrail().xx.Get: "+vt.message+", "+vt.stack)}},error:function(n,t,i){HideActivitySpinner();var r="Error in bwRequest.js.renderWorkflowAuditTrail.racirolesandparticipants.error(): "+i+", data: "+JSON.stringify(n);console.log(r);displayAlertDialog(r)}})}else console.log("In renderWorkflowAuditTrail(). INVALID bwOrgId: "+e+". This process cannot continue."),displayAlertDialog("In renderWorkflowAuditTrail(). INVALID bwOrgId: "+e+". This process cannot continue.")}catch(o){console.log("Exception in bwRequest.js.renderWorkflowAuditTrail(): "+o.message+", "+o.stack);displayAlertDialog("Exception in bwRequest.js.renderWorkflowAuditTrail(): "+o.message+", "+o.stack)}},renderWorkflowAuditTrail2:function(n,t,i,r,u,f,e){var o;try{if(console.log("In renderWorkflowAuditTrail2()."),o=this,e){var h=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),c=$(".bwAuthentication").bwAuthentication("option","participantId"),l=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),a={bwParticipantId_LoggedIn:c,bwActiveStateIdentifier:l,bwWorkflowAppId_LoggedIn:h,bwWorkflowAppId:h,bwRequestTypeId:t,bwOrgId:e},v=this.options.operationUriPrefix+"odata/racirolesandparticipants";$.ajax({url:v,type:"POST",data:a,headers:{Accept:"application/json; odata=verbose"},success:function(f){var a,s,b,tt,y,pt,wt,bt,w,g,rt,ut,k,ft,dt,c,kt,st,l,nt,yt,at,ot,v,p;try{if(a=f,console.log("In renderWorkflowPeoplePicker():2:."),a.length==0)displayAlertDialog("ERROR: Cannot locate workflowxcx9 for bwBudgetRequestId: "+u);else{var gt=a.Workflow,h=JSON.parse(a.Workflow.bwWorkflowJson),e="";if(h==null)e+='<span style="font-size:24pt;color:red;">NO DATA<\/span>';else{if(e+="<style>",e+=".titlecell {",e+="    vertical-align:top;",e+="    padding-top:3px;",e+="    padding-bottom:3px;",e+="    padding-left:5px;",e+="    padding-right:10px;",e+="    white-space:nowrap;",e+="    color:grey;",e+="    text-decoration:underline;",e+="}",e+=".steprowcell {",e+="    vertical-align:top;",e+="    padding-top:10px;",e+="    padding-bottom:10px;",e+="    padding-left:5px;",e+="    padding-right:5px;",e+="    white-space:nowrap;",e+="}",e+=".steprow-hidden {",e+="    visibility: collapse;",e+="}",e+=".steprow:hover {",e+="    background-color: lightgoldenrodyellow;",e+="}",e+=".stepheadercell:hover {",e+="    background-color: gainsboro !important;",e+="}",e+=".activeEditRow {",e+="    background-color: #EBF6F9;",e+="}",e+=".ui-progressbar {",e+="    position: relative;",e+="}",e+=".progress-label {",e+="    position: absolute;",e+="    left: 10%;",e+="    top: 4px;",e+="    font-weight: bold;",e+="    color: black;",e+="    text-shadow: 1px 1px 0 #fff;",e+="}",e+="#progressbar .ui-progressbar-value {",e+="    background-color: cyan;",e+="}",e+=".transparent-dialog {",e+="  background: transparent;",e+="  border: none;",e+="}",e+=".transparent-dialog .ui-widget-header {",e+="  border: none;",e+="  background: transparent;",e+="}",e+=".transparent-dialog .ui-widget-content {",e+="  background: transparent;",e+="}",e+="<\/style>",e+="<br />",e+="<span id=\"xcx449956-2\" title=\"Expand or Collapse ALL...\" onclick=\"$('.bwRequest').bwRequest('expandOrCollapseAllWorkflowSteps', '"+n+'\');" style="width:200px;padding:5px 10px 5px 10px;margin:0 0 0 20px;white-space:nowrap;vertical-align:top;border:1px solid lightblue;cursor:pointer;font-weight:normal;font-size:20pt;">                           <span style="display:inline-block;">+/-<\/span>                       <\/span>',e+="<table>",e+="   <tr>",e+='       <td style="vertical-align:top;">',e+='<table border="1" style="border-color:#d8d8d8;">',h){for(s=0;s<h.Steps.Step.length;s++)if(b=h.Steps.Step[s]["@Name"],!0)if(tt=h.Steps.Step[s]["@FriendlyName"],b=="Create"?tt="Create":b=="Revise"?tt="Revise":b=="Admin"&&(tt="Admin"),y="#f5f6f7",e+='<tr id="stepheaderrow_'+s+"\" style=\"border:0px;cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('expandOrCollapseWorkflowStep2', 'stepname_"+s+"', 'stepimage_"+s+"', 'steprow-"+b.toLowerCase()+"_"+s+"_0', '"+n+"');\">",e+='  <td colspan="11" class="stepheadercell" style="font-weight:bold;padding:10px;background-color:'+y+';" >',e+='    <table style="width:100%;">',e+="      <tr>",e+="        <td>",e+='          <span style="white-space:nowrap;">',e+='            <span id="stepname_'+s+'" class="stepname" bwStepName="'+b+'" bwStepFriendlyName="'+tt+'" style="cursor:pointer;vertical-align:middle;" >',e+='              <img id="stepimage_'+s+'" src="images/drawer-open.png" title="collapse" style="cursor:pointer;width:45px;height:45px;vertical-align:middle;"  />',e+=tt,h.Steps.Step[s]["@Name"]=="Collaboration"&&(pt=h.Steps.Step[s]["@Timeout"],wt=h.Steps.Step[s]["@TimeoutUnits"],e+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+pt+"&nbsp"+wt),bt=n+"_"+b+"_warningSign",e+='              <span id="'+bt+'" xcx="xcx12312_2"><\/span>',e+="            <\/span>",e+="          <\/span>",e+="        <\/td>",e+="        <td><\/td>",e+='        <td style="text-align:center;">',e+='           <table style="width:100%;">',e+="               <tr>",e+="                   <td><\/td>",e+="                   <td><\/td>",e+="                   <td><\/td>",e+="                   <td><\/td>",e+='                   <td style="text-align:right;">',e+="                   <\/td>",e+="               <\/tr>",e+="           <\/table>",e+="        <\/td>",e+="      <\/tr>",e+="    <\/table>",e+="  <\/td>",e+="<\/tr>",b=="Create"||b=="Revise"||b=="Admin"){if(h.Steps.Step[s].Assign){for(e+='<tr id="steprow-'+b.toLowerCase()+"_"+s+'_0" class="steprow steprow_'+s+'" style="cursor:pointer;display:none;" title="This role assignment cannot be changed, it is a part of the core workflow functionality." >',e+='  <td style="width:30px;"><\/td>',o.options.displayRoleIdColumn&&(e+='<td xcx="sssdg" style="background-color:'+y+';" class="roleid steprowcell" bwRoleId="'+h.Steps.Step[s].Assign["@Role"]+'" bwOldValue="'+h.Steps.Step[s].Assign["@Role"]+'">'+h.Steps.Step[s].Assign["@Role"]+"<\/td>"),rt=[],k=0;k<h.Steps.Step[s].Assign.length;k++)rt.push(h.Steps.Step[s].Assign[k]["@Role"]);for(ut=[],k=0;k<h.Steps.Step[s].Assign.length;k++)ut.push(h.Steps.Step[s].Assign[k]["@RoleCategory"]);rt.length==1&&ut.length==1?(w=rt[0],g=ut[0]):console.log("Unexpected value for roleNames/roleCategories: "+JSON.stringify(rt)+", "+JSON.stringify(ut));e+='<td xcx="ttys" style="background-color:'+y+';" class="rolename steprowcell" onMouseOver="this.style.backgroundColor=\'lightgoldenrodyellow\';this.style.color=\'red\';" onMouseOut="this.style.backgroundColor=\''+y+"';this.style.color='black';\" bwStepname=\""+h.Steps.Step[s]["@Name"]+'" bwRoleId="'+h.Steps.Step[s].Assign["@Role"]+'" bwOldValue="'+w+'">';e+="Role: "+w;e+="<\/td>";e+='<td class="steprowcell">';e+=' <span xcx="jjdgr" id="rolecategory-assign_'+s+"_"+c+'" class="rolecategory" bwStepname="'+h.Steps.Step[s]["@Name"]+'" bwRoleId="'+w+'" bwOldValue="'+g+'" style="cursor:pointer;" title="Double-click to edit the role category...">';e+=g;e+=" <\/span>";e+="<\/td>";ft=h.Steps.Step[s].Assign&&h.Steps.Step[s].Assign.length?h.Steps.Step[s].Assign[0].Action["@Name"]:h.Steps.Step[s].Assign.Action["@Name"];ft=ft?"&nbsp;"+ft:"";e+='<td xcx="aadgf" colspan="1" class="tasks steprowcell" bwStepname="'+h.Steps.Step[s]["@Name"]+'" bwRoleId="'+w+'" >'+ft+"<\/td>";e+='<td xcx="llsd" class="steprowaudittasktrail" bwStepname="'+h.Steps.Step[s]["@Name"]+'" bwStepIndex="'+s+'" bwRoleId="'+w+'" ><\/td>';e+="<\/tr>"}}else{if(h.Steps.Step[s].Inform&&h.Steps.Step[s].Inform.length&&h.Steps.Step[s].Inform.length>0)for(c=0;c<h.Steps.Step[s].Inform.length;c++){kt="steprow-inform_"+s+"_"+c;st="";e+='<tr id="steprow-inform_'+s+"_"+c+'" class="steprow'+st+" steprow_"+s+'" style="cursor:pointer;display:none;" >';e+='  <td style="width:30px;"><\/td>';o.options.displayRoleIdColumn&&h.Steps.Step[s].Inform[c]&&(e+=h.Steps.Step[s].Inform[c]["@Role"]?'<td style="background-color:'+y+';" class="roleid steprowcell" bwroleid="'+h.Steps.Step[s].Inform[c]["@Role"]+'" bwOldValue="'+h.Steps.Step[s].Inform[c]["@Role"]+'">'+h.Steps.Step[s].Inform[c]["@Role"]+"<\/td>":'<td style="background-color:'+y+';" class="roleid steprowcell" bwroleid="'+h.Steps.Step[s].Inform[c]["@Role"]+'" bwOldValue="'+h.Steps.Step[s].Inform[c]["@Role"]+'">'+h.Steps.Step[s].Inform[c]["@IdField"]+"<\/td>");var w="",et="",g="";h.Steps.Step[s].Inform[c]&&(w=h.Steps.Step[s].Inform[c]["@RoleName"],et=h.Steps.Step[s].Inform[c]["@Role"],g="Inform");e+='<td xcx="xcx23536-1" style="background-color:'+y+';" class="rolename steprowcell" onMouseOver="this.style.backgroundColor=\'lightgoldenrodyellow\';" onMouseOut="this.style.backgroundColor=\''+y+'\';" bwStepname="'+h.Steps.Step[s]["@Name"]+'" bwroleid="'+h.Steps.Step[s].Inform[c]["@Role"]+'" bwOldValue="'+w+'">';dt=!0;dt?(e+='<span style="font-size:12pt;">',e+=w,e+="<\/span>"):(e+='<span style="color:red;font-size:12pt;font-style:italic;">',e+=w,e+="<\/span>");e+="<\/td>";l="RACI: ";l+="\n";l+="R = Responsible (also Recommender)  ";l+="\n";l+="A = Accountable (also Approver or final approving authority)  ";l+="\n";l+="C = Consulted (sometimes Consultant or counsel)  ";l+="\n";l+="I = Informed (also Informee)  ";e+='<td title="'+l+'" style="color:grey;">'+g+"<\/td>";e+='  <td class="steprowbuttons steprowcell" style="background-color:'+y+';width:80px;text-align:right;padding-right:15px;" >';var ht="",d="",ct="",lt="",it=!1;for(v=0;v<a.RolesAndUsers.length;v++){for(p=0;p<a.RolesAndUsers[v].Roles.length;p++)if(et==a.RolesAndUsers[v].Roles[p].RoleId&&(ht=a.RolesAndUsers[v].Roles[p].ParticipantId,d=a.RolesAndUsers[v].Roles[p].ParticipantFriendlyName,ct=a.RolesAndUsers[v].Roles[p].ParticipantEmail,lt=a.RolesAndUsers[v].OrgName,it=!0),it==!0)break;if(it==!0)break}d&&(e+="<span xcx=\"xcx234566-3\" style=\"cursor:pointer;color:purple;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+ht+"', '"+d+"', '"+ct+"');\">",e+=d,e+=" ("+lt+")",e+="<\/span>");e+="  <\/td>";e+='<td xcx="ppas" class="steprowaudittasktrail" bwStepname="'+h.Steps.Step[s]["@Name"]+'" bwStepIndex="'+s+'" bwRoleId="'+h.Steps.Step[s].Inform[c]["@Role"]+'" ><\/td>';e+="<\/tr>"}if(h.Steps.Step[s].Assign&&h.Steps.Step[s].Assign.length>0)for(c=0;c<h.Steps.Step[s].Assign.length;c++){kt="steprow-assign_"+s+"_"+c;st="";e+='<tr id="steprow-assign_'+s+"_"+c+'" class="steprow'+st+" steprow_"+s+'" style="cursor:pointer;display:none;" >';e+='  <td style="width:30px;"><\/td>';o.options.displayRoleIdColumn&&(e+='<td style="background-color:'+y+';" class="roleid steprowcell" bwroleid="'+h.Steps.Step[s].Assign[c]["@Role"]+'" bwOldValue="'+h.Steps.Step[s].Assign[c]["@Role"]+'">'+h.Steps.Step[s].Assign[c]["@Role"]+"<\/td>");var w="",et="",g="";if(h.Steps.Step[s].Assign[c]&&(w=h.Steps.Step[s].Assign[c]["@RoleName"],et=h.Steps.Step[s].Assign[c]["@Role"],g=h.Steps.Step[s].Assign[c]["@RoleCategory"]),e+='<td xcx="xcx23536-2" style="background-color:'+y+';" class="rolename steprowcell" onMouseOver="this.style.backgroundColor=\'lightgoldenrodyellow\';" onMouseOut="this.style.backgroundColor=\''+y+'\';" bwStepname="'+h.Steps.Step[s]["@Name"]+'" bwroleid="'+h.Steps.Step[s].Assign[c]["@Role"]+'" bwOldValue="'+w+'">',e+=w+" ("+et+")",e+="<br />",e+="<\/td>",l="RACI: ",l+="\n",l+="R = Responsible (also Recommender)  ",l+="\n",l+="A = Accountable (also Approver or final approving authority)  ",l+="\n",l+="C = Consulted (sometimes Consultant or counsel)  ",l+="\n",l+="I = Informed (also Informee)  ",nt="",h.Steps.Step[s].Assign[c]["@Cond"]&&(yt=h.Steps.Step[s].Assign[c]["@Cond"],yt.indexOf("$ChecklistsRequired~")>-1)){for(nt='<span style="cursor:pointer;" title="This role has checklist(s) to complete: ',at=o.options.Checklists,ot=0;ot<at.length;ot++)yt.indexOf(at[ot].bwChecklistTemplatesId)>-1&&(nt+="\n",nt+=JSON.parse(at[ot].ChecklistJson).Title);nt+='">';nt+="<span onclick=\"alert('This functionality is incomplete. Coming soon! This will display all of the checklists for this request...xcx2');\">&nbsp;&nbsp<\/span>"}e+='<td title="'+l+'" style="color:grey;">'+g+nt+"<\/td>";e+='<td class="steprowbuttons steprowcell" style="background-color:'+y+';width:80px;text-align:right;padding-right:15px;" >';var ht="",d="",ct="",lt="",it=!1;for(v=0;v<a.RolesAndUsers.length;v++){for(p=0;p<a.RolesAndUsers[v].Roles.length;p++)if(et==a.RolesAndUsers[v].Roles[p].RoleId&&(ht=a.RolesAndUsers[v].Roles[p].ParticipantId,d=a.RolesAndUsers[v].Roles[p].ParticipantFriendlyName,ct=a.RolesAndUsers[v].Roles[p].ParticipantEmail,lt=a.RolesAndUsers[v].OrgName,it=!0),it==!0)break;if(it==!0)break}d&&(e+="<span test=\"xcxtest2\" style=\"cursor:pointer;color:purple;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+ht+"', '"+d+"', '"+ct+"');\">",e+=d,e+=" ("+lt+")",e+="<\/span>");e+="<\/td>";e+='<td xcx="ppors" class="steprowaudittasktrail" bwStepname="'+h.Steps.Step[s]["@Name"]+'" bwStepIndex="'+s+'" bwRoleId="'+h.Steps.Step[s].Assign[c]["@Role"]+'" ><\/td>';e+="<\/tr>"}}}else e+="<tr>",e+="  <td>",e+="    NO WORKFLOW JSON. CANNOT PROCEED. xcx32456-3",e+="  <\/td>",e+="<\/tr>";e+="<\/table>";e+="       <\/td>";e+="       <td>&nbsp;&nbsp;<\/td>";e+='       <td style="vertical-align:top;">';e+='           <span id="'+n+'_spanWorkflowAuditTrailSummary">['+n+"_spanWorkflowAuditTrailSummary]<\/span>";e+="       <\/td>";e+="   <\/tr>";e+="<\/table>";e+='<div style="display:none;" id="divOrgMultiPickerDialog">';e+='  <table style="width:100%;">';e+="    <tr>";e+='      <td style="width:90%;">';e+='        <span id="spanOrgMultiPickerDialogTitle" style="color: #3f3f3f;font-size:30pt;font-weight:bold;">Location(s)<\/span>';e+="      <\/td>";e+='      <td style="width:9%;"><\/td>';e+='      <td style="width:1%;cursor:pointer;vertical-align:top;">';e+="        <span class=\"dialogXButton\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:30pt;font-weight:bold;\" onclick=\"$('#divOrgMultiPickerDialog').dialog('close');\">X<\/span>";e+="      <\/td>";e+="    <\/tr>";e+="  <\/table>";e+="  <br /><br />";e+='  <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';e+="  <span id=\"spanOrgMultiPickerDialogContent\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 20pt;\"><\/span><br />";e+="  <br /><br />";e+='  <input type="button" value="SAVE" onclick="$(\'.bwWorkflowEditor\').bwWorkflowEditor(\'orgMultiPickerDialog_RenderResults\');" />';e+="  <br /><br />";e+="<\/div>";e+='<div style="display:none;" id="divMessageDialog">';e+='  <table style="width:100%;">';e+="    <tr>";e+='      <td style="width:90%;">';e+='        <span id="spanMessageDialogTitle" style="color: #3f3f3f;font-size:30pt;font-weight:bold;">[spanMessageDialogTitle]<\/span>';e+="      <\/td>";e+='      <td style="width:9%;"><\/td>';e+='      <td style="width:1%;cursor:pointer;vertical-align:top;">';e+="        <span class=\"dialogXButton\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:30pt;font-weight:bold;\" onclick=\"$('#divMessageDialog').dialog('close');\">X<\/span>";e+="      <\/td>";e+="    <\/tr>";e+="  <\/table>";e+="  <br /><br />";e+='  <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';e+="  <span id=\"spanMessageDialogContentTop\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 20pt;\">[spanMessageDialogContentTop]<\/span>";e+="    <br />";e+="    <br />";e+="    <br />";e+='    <span id="spanMessageDialogContentBottom" style="font-weight:bold;cursor:pointer;">';e+="      [spanMessageDialogContentBottom]";e+="    <\/span>";e+="  <br /><br />";e+="<\/div>";e+='<div style="display:none;" id="divWorkflowActionsUnderlyingPropertiesDialog">';e+='  <table style="width:100%;">';e+="    <tr>";e+='      <td style="width:90%;">';e+='        <span id="spanWorkflowActionsUnderlyingPropertiesDialog" style="color: #3f3f3f;font-size:30pt;font-weight:bold;">Action Properties<\/span>';e+="                    <br />";e+="                    <span id=\"spanWorkflowActionsUnderlyingPropertiesDialogSubTitle\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size:12pt;font-weight:normal;\">[spanWorkflowActionsUnderlyingPropertiesDialogSubTitle]<\/span>";e+="      <\/td>";e+='      <td style="width:9%;"><\/td>';e+='      <td style="width:1%;cursor:pointer;vertical-align:top;">';e+="        <span class=\"dialogXButton\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:30pt;font-weight:bold;\" onclick=\"$('#divWorkflowActionsUnderlyingPropertiesDialog').dialog('close');\">X<\/span>";e+="      <\/td>";e+="    <\/tr>";e+="  <\/table>";e+="  <br /><br />";e+='  <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';e+='  <span id="spanWorkflowActionsUnderlyingPropertiesDialogContentTop">[spanWorkflowActionsUnderlyingPropertiesDialogContentTop]<\/span>';e+="    <br />";e+="    <br />";e+="    <br />";e+='    <span id="spanWorkflowActionsUnderlyingPropertiesDialogContentBottom" style="font-weight:bold;cursor:pointer;">';e+="    <\/span>";e+="  <br /><br />";e+="<\/div>";e+='<div style="display:none;" id="divProgressBarDialog">';e+='<div id="progressbar" class="ui-progressbar"><div class="progress-label">Loading...<\/div><\/div>';e+="<\/div>"}document.getElementById(n+"_Content").innerHTML=e;o.populateWorkflowAuditTrailSummary(i,r,u,n,t,h)}}catch(vt){console.log("Exception in renderWorkflowAuditTrail2().xx.Get: "+vt.message+", "+vt.stack);displayAlertDialog("Exception in renderWorkflowAuditTrail2().xx.Get: "+vt.message+", "+vt.stack)}},error:function(n,t,i){HideActivitySpinner();var r="Error in bwRequest.js.renderWorkflowAuditTrail2.racirolesandparticipants.error(): "+i+", data: "+JSON.stringify(n);console.log(r);displayAlertDialog(r)}})}else console.log("In renderWorkflowAuditTrail2(). INVALID bwOrgId: "+e+". This process cannot continue."),displayAlertDialog("In renderWorkflowAuditTrail2(). INVALID bwOrgId: "+e+". This process cannot continue.")}catch(s){console.log("Exception in bwRequest.js.renderWorkflowAuditTrail2(): "+s.message+", "+s.stack);displayAlertDialog("Exception in bwRequest.js.renderWorkflowAuditTrail2(): "+s.message+", "+s.stack)}},populateWorkflowAuditTrailSummary:function(n,t,i,r,u,f){try{console.log("In populateWorkflowAuditTrailSummary().");var e=this,s=webserviceurl+"/bwworkflowtasks/getbybudgetrequestid/"+i;$.ajax({url:s,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var t,c,a,d,v,h,w,p,y,tt,it,b,o,l,rt,s;try{if(n.d.results.length==0)t="",t+="NO DATA",$("#"+r+"_spanWorkflowAuditTrailSummary").html(t);else{for(s=0;s<e.options.requestWorkflowTasks.length;s++)i==e.options.requestWorkflowTasks[s].bwBudgetRequestId&&e.options.requestWorkflowTasks.splice(s,1);for(e.options.requestWorkflowTasks.push({bwBudgetRequestId:i,bwRequestTypeId:u,workflowTaskItems:n.d.results}),t="",c=$("#"+r).find(".steprowaudittasktrail"),s=0;s<c.length;s++)if(a=c[s].getAttribute("bwStepname"),a&&a.toLowerCase()=="create"){l=bwCommonScripts.getBudgetWorkflowStandardizedDate(n.d.results[0].Created);t="";t+='<strike xcx="xcx3246677"><span style="font-weight:normal;color:darkgray;">'+l+"<\/span>";t+="<br />";t+='<span xcx="xcx27-15">Request submitted by ';t+="   <span style=\"color:purple;font-weight:bold;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+n.d.results[0].bwAssignedToId+"', '"+n.d.results[0].bwAssignedToFriendlyName+"', '"+n.d.results[0].bwAssignedToEmail+"', 'undefined');\">"+n.d.results[0].bwAssignedToFriendlyName+"<\/span>";t+="<\/span><\/strike>";c[s].innerHTML=t;c[s].setAttribute("bwTaskStatus","completed");break}for(o=0;o<n.d.results.length;o++)for(s=0;s<c.length;s++)a=c[s].getAttribute("bwStepname"),d=c[s].getAttribute("bwRoleId"),a&&a.toLowerCase()==n.d.results[o].WorkflowStepName.toLowerCase()&&d==n.d.results[o].bwAssignedToRaciRoleAbbreviation&&(v="",h="",n.d.results[o].bwPercentComplete==100&&n.d.results[o].bwStatus=="Completed"?(w=n.d.results[o].bwTaskOutcome,w.toLowerCase().indexOf("task completed by the system")>-1&&(w+=" On behalf of "+n.d.results[o].bwAssignedToFriendlyName+" ["+n.d.results[o].bwAssignedToEmail+"] ["+n.d.results[o].bwAssignedToId+"]."),v="completed",h+='       <strike xcx="xcx123423525">',l=bwCommonScripts.getBudgetWorkflowStandardizedDate(n.d.results[o].Modified),h+='          <span style="font-weight:normal;color:darkgray;">'+l+"<\/span>",h+="          <br />",h+='          <span xcx="xcx32566">',h+="<span style=\"color:purple;font-weight:bold;cursor:pointer;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+n.d.results[o].bwAssignedToId+"', '"+n.d.results[o].bwAssignedToFriendlyName+"', '"+n.d.results[o].bwAssignedToEmail+"', 'undefined');\">"+n.d.results[o].bwAssignedToFriendlyName+"<\/span>",h+=w,h+="<\/span>",h+=" ["+n.d.results[o].bwAssignedToRaciRoleName+" ("+n.d.results[o].bwAssignedToRaciRoleAbbreviation+")]<\/span>",h+="       <\/strike>",h+="<br />",h+="<button class=\"BwButton\" onclick=\"$('.bwRequest').bwRequest('revertACompletedTask', '"+i+"', '"+u+"', '"+n.d.results[o].bwWorkflowTaskItemId+"', this);\">Revert<\/button>"):(v="assigned",l=bwCommonScripts.getBudgetWorkflowStandardizedDate(n.d.results[o].Created),h+='       <span style="font-weight:normal;color:darkgray;">'+l+"<\/span>",h+="       <br />",h+='       <span xcx="xcx27-16">',h+=n.d.results[o].bwTaskTitle+" assigned to ",h+="<span style=\"color:purple;font-weight:bold;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+n.d.results[o].bwAssignedToId+"', '"+n.d.results[o].bwAssignedToFriendlyName+"', '"+n.d.results[o].bwAssignedToEmail+"', 'undefined');\">"+n.d.results[o].bwAssignedToFriendlyName+"<\/span>",h+=" ["+n.d.results[o].bwAssignedToRaciRoleName+" ("+n.d.results[o].bwAssignedToRaciRoleAbbreviation+")]",h+="<\/span>"),t="",t+="<table>",t+="   <tr>",t+='       <td title="'+$(".bwAuthentication").bwAuthentication("formatDateAndTimeFromBW","' + wtItems.d.results[ri].Modified + '")+'">',t+=h,t+="       <\/td>",t+="   <\/tr>",t+="<\/table>",c[s].innerHTML+=t,c[s].setAttribute("bwTaskStatus",v));for(p=$("#"+r).find(".stepname"),y=0;y<p.length;y++){var g=!1,nt=!1,a=p[y].getAttribute("bwStepName");for(s=0;s<c.length;s++)tt=c[s].getAttribute("bwStepname"),a==tt&&(v=c[s].getAttribute("bwTaskStatus"),v=="completed"?g=!0:v=="assigned"&&(nt=!0));nt==!0?(console.log("tomato"),p[y].style.color="tomato",console.log("xcx123123 stepAssigned == true, stepName: "+a+", bwTaskStatus: "+v),it=r+"_"+a+"_warningSign",document.getElementById(it).innerHTML="",b=y,$(".bwRequest").bwRequest("expandOrCollapseWorkflowStep2","stepname_"+b,"stepimage_"+b,"steprow-"+a.toLowerCase()+"_"+b+"_0",r)):g==!0&&(console.log("green"),p[y].style.color="green")}for(t="",t+='<table bwRelatedItemId="'+n.d.results[0].bwRelatedItemId+'">',t+="   <tr>",t+='       <td style="font-family:Verdana,Geneva,Tahoma,sans-serif;font-size:10pt;" title="'+$(".bwAuthentication").bwAuthentication("formatDateAndTimeFromBW","' + wtItems.d.results[0].Created + '")+'">',l=bwCommonScripts.getBudgetWorkflowStandardizedDate(n.d.results[0].Created),t+='       <strike xcx="xcx22343"><span style="font-weight:normal;color:darkgray;">'+l+"<\/span>",t+="       <br />",t+="       Request submitted by "+n.d.results[0].bwAuthorFriendlyName+"<\/span><\/strike>",t+="       <\/td>",t+="   <\/tr>",t+="<\/table>",o=0;o<n.d.results.length;o++){if(t+='<table bwRelatedItemId="'+n.d.results[0].bwRelatedItemId+'">',t+="   <tr>",t+='       <td style="font-family:Verdana,Geneva,Tahoma,sans-serif;font-size:10pt;" title="'+$(".bwAuthentication").bwAuthentication("formatDateAndTimeFromBW","' + wtItems.d.results[ri].Modified + '")+'" >',n.d.results[o].bwPercentComplete==100&&n.d.results[o].bwStatus=="Completed")l=bwCommonScripts.getBudgetWorkflowStandardizedDate(n.d.results[o].Modified),t+='       <strike xcx="xcx2134666"><span style="font-weight:normal;color:darkgray;">'+l+"<\/span>",t+="       <br />",t+='       <span xcx="xcx26">',t+="<span style=\"color:purple;font-weight:bold;cursor:pointer;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+n.d.results[o].bwAssignedToId+"', '"+n.d.results[o].bwAssignedToFriendlyName+"', '"+n.d.results[o].bwAssignedToEmail+"', 'undefined');\">"+n.d.results[o].bwAssignedToFriendlyName+"<\/span>",t+=n.d.results[o].bwTaskOutcome,t+="<\/span>",t+="["+n.d.results[o].bwAssignedToRaciRoleName+"("+n.d.results[o].bwAssignedToRaciRoleAbbreviation+")]<\/span>",t+="       <\/strike>";else{for(l=bwCommonScripts.getBudgetWorkflowStandardizedDate(n.d.results[o].Created),t+='<span style="font-weight:normal;color:darkgray;">'+l+"<\/span>",t+="<br />",t+='<span xcx="xcx27-1">'+n.d.results[o].bwTaskTitle+" assigned to ",s=0;s<f.Steps.Step.length;s++)if(n.d.results[o].WorkflowStepName==f.Steps.Step[s]["@Name"]){rt=!0;break}t+='   <span xcx="xcx123555" style="color:purple;font-weight:bold;cursor:pointer;" ';t+="       onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+n.d.results[o].bwAssignedToId+"', '"+n.d.results[o].bwAssignedToFriendlyName+"', '"+n.d.results[o].bwAssignedToEmail+"', '');\" ";t+="   >";t+=n.d.results[o].bwAssignedToFriendlyName;t+="   <\/span>";t+=" ["+n.d.results[o].bwAssignedToRaciRoleName+" ("+n.d.results[o].bwAssignedToRaciRoleAbbreviation+")]";t+="<\/span>";rt||(t+='<span style="color:tomato;">MISSING WORKFLOW STEP "'+n.d.results[o].WorkflowStepName+'"<\/span>')}t+="       <\/td>";t+="   <\/tr>";t+="<\/table>"}$("#"+r+"_spanWorkflowAuditTrailSummary").html(t);$("#ui-id-1").css("border-radius","20px 0 0 20px")}}catch(k){console.log("Exception in populateWorkflowAuditTrailSummary():2: "+k.message+", "+k.stack);displayAlertDialog("Exception in populateWorkflowAuditTrailSummary():2: "+k.message+", "+k.stack)}},error:function(){console.log("Error in bwRequest.populateWorkflowAuditTrailSummary().1:"+errorCode+", "+errorMessage);displayAlertDialog("Error in bwRequest.populateWorkflowAuditTrailSummary().1:"+errorCode+", "+errorMessage)}})}catch(o){console.log("Exception in populateWorkflowAuditTrailSummary(): "+o.message+", "+o.stack);displayAlertDialog("Exception in populateWorkflowAuditTrailSummary(): "+o.message+", "+o.stack)}},expandOrCollapseAllWorkflowSteps:function(n){var t,i,r;try{for(console.log("In bwRequest.js.expandOrCollapseAllWorkflowSteps()."),t=document.getElementById(n).getElementsByClassName("steprow"),i=t[0].style.display,r=0;r<t.length;r++)i=="none"?t[r].style.display="table-row":i=="table-row"?t[r].style.display="none":(console.log("In expandOrCollapseAllWorkflowSteps(). Unexpected value for display: "+i),displayAlertDialog("In expandOrCollapseAllWorkflowSteps(). Unexpected value for display: "+i))}catch(u){console.log("Exception in bwRequest.js.expandOrCollapseAllWorkflowSteps(): "+u.message+", "+u.stack);displayAlertDialog("Exception in bwRequest.js.expandOrCollapseAllWorkflowSteps(): "+u.message+", "+u.stack)}},displayNewRequestWorkflowParticipantsDialog:function(n){var e,s,o,r,t,i,u;try{console.log("In displayNewRequestWorkflowParticipantsDialog().");o=$(n).closest("#budgetrequestform")[0];e=o.getAttribute("bwbudgetrequestid");s=o.getAttribute("bwrequesttypeid");this.pinRequestDialog();r=this;t="divNewRequestWorkflowParticipantsDialog_"+e;$("#"+t).is(":visible")&&$("#"+t).dialog("close");i="";i+='        <table style="width:100%;">';i+="            <tr>";i+='                <td style="width:90%;">';i+='                    <span id="divRequestFormContent"><\/span>';i+="                <\/td>";i+="            <\/tr>";i+="        <\/table>";i+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->';i+="        <br /><br />";u=document.getElementById(t);u||(u=document.createElement("div"),u.id=t,document.body.appendChild(u));u.innerHTML=i;$("#"+t).dialog({modal:!0,resizable:!0,closeOnEscape:!0,width:"900px",dialogClass:"no-close",hide:!1,position:{my:"middle top+12",at:"middle top","of":window},close:function(){console.log("In xcx3sad4(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-x-4")},open:function(){var l,u,i,o,a,v,h,c,y;try{l=document.getElementById(t).parentNode;u=t+"_Parent";l.id=u;i="";i+='<table xcx="xcx3249-6" style="width:100%;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequestDialog\');">';i+="   <tr>";i+='       <td style="width:95%;">';i+='           <div id="slider_'+t+'" style="width:20%;cursor:pointer;"><\/div>';i+="       <\/td>";i+="       <td>";i+='           <span class="dialogXButton" style="font-size:25pt;cursor:pointer;width:100%;" onclick="$(\'#'+t.replace("_Parent","")+"').dialog('close');\">X<\/span>";i+="       <\/td>";i+="   <\/tr>";i+="<\/table>";document.getElementById(t).parentNode.querySelector(".ui-dialog-titlebar").innerHTML=i;i="";o=$(n).closest("#budgetrequestform")[0].getAttribute("bworgid");a=$(n).closest("#budgetrequestform")[0].getAttribute("bworgname");i+='<div id="budgetrequestworkflowparticipantsdialog" class="context-menu-newrequesteditorxx" align="left" bwbudgetrequestid="" bwworkflowtaskitemid="" bwrequesttypeid="" orgid="" orgname="">';i+='<table style="BORDER-TOP-STYLE: none; WORD-WRAP: break-word; BORDER-LEFT-STYLE: none; BORDER-COLLAPSE: collapse; TABLE-LAYOUT: fixed; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none;" class="xdFormLayout">';i+="    <colgroup>";i+='        <col style="" />';i+="    <\/colgroup>";i+="    <tbody>";i+='        <tr class="xdTableContentRow">';i+='            <td style="display:block;BORDER-TOP: #d8d8d8 1pt solid; BORDER-RIGHT: #d8d8d8 1pt solid; VERTICAL-ALIGN: top; BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; BORDER-LEFT: #d8d8d8 1pt solid; PADDING-RIGHT: 0px" class="xdTableContentCell">';i+="                <div />";i+='                <table style="width:100%;">';i+="                    <tr>";i+='                        <td colspan="4">';i+='                           <span id="'+t+'_requestOrgClickableBreadcrumb" style="color:purple;font-size:8pt;">'+a+"<\/span>";i+="                       <\/td>";i+="                    <\/tr>";i+="                    <tr>";i+='                        <td width="5px"><\/td>';i+="                        <td>";i+="                   <span>";i+='<img id="'+t+'_imgRequestOrgImage" src="'+r.options.operationUriPrefix+'images/corporeal.png" style="width:100px;height:100px;"/>';v="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)});c=JSON.parse($(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"));h=c.status!="SUCCESS"?"[No image. Unauthorized. xcx213124-34556-34-234-3245-xx]":r.options.operationUriPrefix+"_files/"+workflowAppId+"/orgimages/"+o+"/orgimage.png?v="+v+"&ActiveStateIdentifier="+c.ActiveStateIdentifier;$.get(h).done(function(){setTimeout(function(){$("#"+t+"_imgRequestOrgImage").attr("src",h)},500)}).fail(function(){});i+="                   <\/span>";i+="                        <\/td>";i+='                        <td colspan="2" style="text-align:right;">';i+='                           &nbsp;&nbsp;<span id="'+u+'_BwRequestType" style="font-size:1em;">';i+="                               [._BwRequestType]";i+="                           <\/span>";i+="                           <br />";i+='                           <span id="'+u+'_WorkflowGuid" style="color:gray;">[._WorkflowGuid]<\/span>';i+="                        <\/td>";i+="                    <\/tr>";i+="                <\/table>";i+='<span id="'+u+'_Content"><\/span>';document.getElementById(t).innerHTML=i;$("#slider_"+t).slider({min:50,max:200,value:100,slide:function(n,i){r.setZoom(i.value,t)}});r.setZoom(100,t);$(".ui-widget-overlay").bind("click",function(){$("#"+t).dialog("close")});y=r.loadWorkflowsAndCurrentWorkflow2(s);y.then(function(n){try{r.renderNewRequestWorkflowParticipants(u,n.bwWorkflowId,e,o)}catch(t){console.log("Exception in bwWorkflowEditor._create().loadWorkflowsAndCurrentWorkflow(): "+t.message+", "+t.stack);alert("Exception in bwWorkflowEditor._create().loadWorkflowsAndCurrentWorkflow(): "+t.message+", "+t.stack)}})}catch(f){console.log("Exception in displayNewRequestWorkflowParticipantsDialog().dialog.open(): "+f.message+", "+f.stack);alert("Exception in displayNewRequestWorkflowParticipantsDialog().dialog.open(): "+f.message+", "+f.stack)}}});alert("In bwRequest.js.displayNewRequestWorkflowParticipantsDialog(). Changing z-index here. Why?? Is it necessary? xcx123124-4.");try{$(".ui-widget-overlay")[0].style.zIndex=9;$("#"+t).dialog().parents(".ui-dialog")[0].style.zIndex=10}catch(f){}}catch(f){console.log("Exception in displayNewRequestWorkflowParticipantsDialog(): "+f.message+", "+f.stack);alert("Exception in displayNewRequestWorkflowParticipantsDialog(): "+f.message+", "+f.stack)}},expandOrCollapseWorkflowStep:function(n,t,i){var u,r;try{console.log("In expandOrCollapseWorkflowStep("+n+", "+t+", "+i+").");var h=t.split("stepimage_")[1],e="steprow_"+h,f=document.getElementById(t),o=this.options.operationUriPrefix+"images/drawer-close.png",c=this.options.operationUriPrefix+"images/drawer-open.png",l=document.getElementById(i);if(f.src==o)for(f.src=c,u=document.getElementsByClassName(e),r=0;r<u.length;r++)u[r].style.display="none";else for(f.src=o,u=document.getElementsByClassName(e),r=0;r<u.length;r++)u[r].style.display="table-row"}catch(s){console.log("Exception in expandOrCollapseWorkflowStep(): "+s.message+", "+s.stack)}},renderNewRequestWorkflowParticipants:function(n,t,i,r){var u,e,o,f,h;try{for(console.log("In renderNewRequestWorkflowParticipants()."),u=this,o=document.querySelectorAll("#budgetrequestform"),f=0;f<o.length;f++)if(h=o[f].getAttribute("bwbudgetrequestid"),i==h){e=o[f];break}e||alert("In bwRequest.js.renderNewRequestWorkflowParticipants(). Could not find the form for bwBudgetRequestId: "+i);var l=e.getAttribute("bwrequesttypeid"),r=e.getAttribute("bworgid"),c=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),a=$(".bwAuthentication").bwAuthentication("option","participantId"),v=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),y={bwParticipantId_LoggedIn:a,bwActiveStateIdentifier:v,bwWorkflowAppId_LoggedIn:c,bwWorkflowAppId:c,bwRequestTypeId:l,bwOrgId:r},p=this.options.operationUriPrefix+"odata/racirolesandparticipants";$.ajax({url:p,type:"POST",data:y,headers:{Accept:"application/json; odata=verbose"},success:function(t){var s,et,e,r,st,a,ht,ct,at,o,lt,d,c,w,ot,ut,k,h,l,f,v;try{if(s=t,console.log("In renderWorkflowPeoplePicker():2:."),s.length==0)displayAlertDialog("ERROR: Cannot locate workflowxcx9 for bwBudgetRequestId: "+i);else{if(et=s.Workflow,e=JSON.parse(s.Workflow.bwWorkflowJson),document.getElementById(n+"_BwRequestType").innerHTML=et.bwRequestTypeId,document.getElementById(n+"_WorkflowGuid").innerHTML=et.bwWorkflowId,r="",e==null)r+='<span style="font-size:24pt;color:red;">NO DATA<\/span>';else{if(r+="<style>",r+=".titlecell {",r+="    vertical-align:top;",r+="    padding-top:3px;",r+="    padding-bottom:3px;",r+="    padding-left:5px;",r+="    padding-right:10px;",r+="    white-space:nowrap;",r+="    color:grey;",r+="    text-decoration:underline;",r+="}",r+=".steprowcell {",r+="    vertical-align:top;",r+="    padding-top:10px;",r+="    padding-bottom:10px;",r+="    padding-left:5px;",r+="    padding-right:5px;",r+="    white-space:nowrap;",r+="}",r+=".steprow-hidden {",r+="    visibility: collapse;",r+="}",r+=".steprow:hover {",r+="    background-color: lightgoldenrodyellow;",r+="}",r+=".stepheadercell:hover {",r+="    background-color: gainsboro !important;",r+="}",r+=".activeEditRow {",r+="    background-color: #EBF6F9;",r+="}",r+=".ui-progressbar {",r+="    position: relative;",r+="}",r+=".progress-label {",r+="    position: absolute;",r+="    left: 10%;",r+="    top: 4px;",r+="    font-weight: bold;",r+="    color: black;",r+="    text-shadow: 1px 1px 0 #fff;",r+="}",r+="#progressbar .ui-progressbar-value {",r+="    background-color: cyan;",r+="}",r+=".transparent-dialog {",r+="  background: transparent;",r+="  border: none;",r+="}",r+=".transparent-dialog .ui-widget-header {",r+="  border: none;",r+="  background: transparent;",r+="}",r+=".transparent-dialog .ui-widget-content {",r+="  background: transparent;",r+="}",r+=".ui-corner-all {",r+="    border-color: #FFE1AC !important;",r+="}",r+="<\/style>",r+='<span style="cursor:pointer;" onclick="alert(\'This functionality is incomplete. Coming soon!\');">[+/-] xcx234266<\/span>',r+='<table border="1" style="border-color:#d8d8d8;">',e){for(f=0;f<e.Steps.Step.length;f++)if(v=e.Steps.Step[f]["@Name"],!0&&(st=e.Steps.Step[f]["@FriendlyName"],a="#f5f6f7",v!="Create"&&v!="Revise"&&v!="Admin")){if(r+='<tr id="stepheaderrow_'+f+"\" style=\"border:0px;cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('expandOrCollapseWorkflowStep', 'stepname_"+f+"', 'stepimage_"+f+"', 'steprow-"+v.toLowerCase()+"_"+f+"_0');\">",r+='  <td colspan="11" class="stepheadercell" style="font-weight:bold;padding:10px;background-color:'+a+';" >',r+='    <table style="width:100%;">',r+="      <tr>",r+="        <td>",r+='          <span style="white-space:nowrap;">',r+='            <span id="stepname_'+f+'" class="stepname" style="cursor:pointer;vertical-align:middle;" >',r+='              <img id="stepimage_'+f+'" src="images/drawer-open.png" title="collapse" style="cursor:pointer;width:45px;height:45px;vertical-align:middle;"  />',r+="              &nbsp;"+st,e.Steps.Step[f]["@Name"]=="Collaboration"&&(ht=e.Steps.Step[f]["@Timeout"],ct=e.Steps.Step[f]["@TimeoutUnits"],r+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+ht+"&nbsp"+ct),r+="            <\/span>",r+="          <\/span>",r+="        <\/td>",r+="        <td><\/td>",r+='        <td style="text-align:center;">',r+='           <table style="width:100%;">',r+="               <tr>",r+="                   <td><\/td>",r+="                   <td><\/td>",r+="                   <td><\/td>",r+="                   <td><\/td>",r+='                   <td style="text-align:right;">',v.toLowerCase()=="admin",r+="                   <\/td>",r+="               <\/tr>",r+="           <\/table>",r+="        <\/td>",r+="      <\/tr>",r+="    <\/table>",r+="  <\/td>",r+="<\/tr>",e.Steps.Step[f].Inform&&e.Steps.Step[f].Inform.length&&e.Steps.Step[f].Inform.length>0)for(o=0;o<e.Steps.Step[f].Inform.length;o++){lt="steprow-inform_"+f+"_"+o;d="";r+='<tr id="steprow-inform_'+f+"_"+o+'" class="steprow'+d+" steprow_"+f+'" style="cursor:pointer;display:none;" >';r+='  <td style="width:30px;"><\/td>';u.options.displayRoleIdColumn&&e.Steps.Step[f].Inform[o]&&(r+=e.Steps.Step[f].Inform[o]["@Role"]?'<td style="background-color:'+a+';" class="roleid steprowcell" bwroleid="'+e.Steps.Step[f].Inform[o]["@Role"]+'" bwOldValue="'+e.Steps.Step[f].Inform[o]["@Role"]+'">'+e.Steps.Step[f].Inform[o]["@Role"]+"<\/td>":'<td style="background-color:'+a+';" class="roleid steprowcell" bwroleid="'+e.Steps.Step[f].Inform[o]["@Role"]+'" bwOldValue="'+e.Steps.Step[f].Inform[o]["@Role"]+'">'+e.Steps.Step[f].Inform[o]["@IdField"]+"<\/td>");var p="",g="",nt="";e.Steps.Step[f].Inform[o]&&(p=e.Steps.Step[f].Inform[o]["@RoleName"],g=e.Steps.Step[f].Inform[o]["@Role"],nt="Inform");r+='<td xcx="xcx23536-3" style="background-color:'+a+';" class="rolename steprowcell" onMouseOver="this.style.backgroundColor=\'lightgoldenrodyellow\';" onMouseOut="this.style.backgroundColor=\''+a+'\';" bwStepname="'+e.Steps.Step[f]["@Name"]+'" bwroleid="'+e.Steps.Step[f].Inform[o]["@Role"]+'" bwOldValue="'+p+'">';at=!0;at?(r+='<span style="font-size:12pt;">',r+=p,r+="<\/span>"):(r+='<span style="color:red;font-size:12pt;font-style:italic;">',r+=p,r+="<\/span>");r+="<\/td>";c="RACI: ";c+="\n";c+="R = Responsible (also Recommender)  ";c+="\n";c+="A = Accountable (also Approver or final approving authority)  ";c+="\n";c+="C = Consulted (sometimes Consultant or counsel)  ";c+="\n";c+="I = Informed (also Informee)  ";r+='<td title="'+c+'" style="color:grey;">'+nt+"<\/td>";r+='  <td class="steprowbuttons steprowcell" style="background-color:'+a+';width:80px;text-align:right;padding-right:15px;" >';var tt="",y="",it="",rt="",b=!1;for(h=0;h<s.RolesAndUsers.length;h++){if(s.RolesAndUsers[h].Roles&&s.RolesAndUsers[h].Roles.length)for(l=0;l<s.RolesAndUsers[h].Roles.length;l++)if(g==s.RolesAndUsers[h].Roles[l].RoleId&&(tt=s.RolesAndUsers[h].Roles[l].ParticipantId,y=s.RolesAndUsers[h].Roles[l].ParticipantFriendlyName,it=s.RolesAndUsers[h].Roles[l].ParticipantEmail,rt=s.RolesAndUsers[h].OrgName,b=!0),b==!0)break;if(b==!0)break}y&&(r+="<span xcx=\"xcx234566-4\" style=\"cursor:pointer;color:orange;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+tt+"', '"+y+"', '"+it+"');\">",r+=y,r+=" ("+rt+")",r+="<\/span>");r+="  <\/td>";r+="<\/tr>"}if(e.Steps.Step[f].Assign&&e.Steps.Step[f].Assign.length>0)for(o=0;o<e.Steps.Step[f].Assign.length;o++){lt="steprow-assign_"+f+"_"+o;d="";r+='<tr id="steprow-assign_'+f+"_"+o+'" class="steprow'+d+" steprow_"+f+'" style="cursor:pointer;display:none;" >';r+='  <td style="width:30px;"><\/td>';u.options.displayRoleIdColumn&&(r+='<td style="background-color:'+a+';" class="roleid steprowcell" bwroleid="'+e.Steps.Step[f].Assign[o]["@Role"]+'" bwOldValue="'+e.Steps.Step[f].Assign[o]["@Role"]+'">'+e.Steps.Step[f].Assign[o]["@Role"]+"<\/td>");var p="",g="",nt="";if(e.Steps.Step[f].Assign[o]&&(p=e.Steps.Step[f].Assign[o]["@RoleName"],g=e.Steps.Step[f].Assign[o]["@Role"],nt=e.Steps.Step[f].Assign[o]["@RoleCategory"]),r+='<td xcx="xcx23536-4" style="background-color:'+a+';" class="rolename steprowcell" onMouseOver="this.style.backgroundColor=\'lightgoldenrodyellow\';" onMouseOut="this.style.backgroundColor=\''+a+'\';" bwStepname="'+e.Steps.Step[f]["@Name"]+'" bwroleid="'+e.Steps.Step[f].Assign[o]["@Role"]+'" bwOldValue="'+p+'">',r+=p,r+="<br />",r+="<\/td>",c="RACI: ",c+="\n",c+="R = Responsible (also Recommender)  ",c+="\n",c+="A = Accountable (also Approver or final approving authority)  ",c+="\n",c+="C = Consulted (sometimes Consultant or counsel)  ",c+="\n",c+="I = Informed (also Informee)  ",w="",e.Steps.Step[f].Assign[o]["@Cond"]&&(ot=e.Steps.Step[f].Assign[o]["@Cond"],ot.indexOf("$ChecklistsRequired~")>-1)){for(w='<span style="cursor:pointer;" title="This role has checklist(s) to complete: ',ut=u.options.Checklists,k=0;k<ut.length;k++)ot.indexOf(ut[k].bwChecklistTemplatesId)>-1&&(w+="\n",w+=JSON.parse(ut[k].ChecklistJson).Title);w+='">';w+="&nbsp;xcx1&nbsp<\/span>"}r+='<td title="'+c+'" style="color:grey;">'+nt+w+"<\/td>";r+='<td class="steprowbuttons steprowcell" style="background-color:'+a+';width:80px;text-align:right;padding-right:15px;" >';var tt="",y="",it="",rt="",b=!1;for(h=0;h<s.RolesAndUsers.length;h++){if(s.RolesAndUsers[h].Roles&&s.RolesAndUsers[h].Roles.length)for(l=0;l<s.RolesAndUsers[h].Roles.length;l++)if(g==s.RolesAndUsers[h].Roles[l].RoleId&&(tt=s.RolesAndUsers[h].Roles[l].ParticipantId,y=s.RolesAndUsers[h].Roles[l].ParticipantFriendlyName,it=s.RolesAndUsers[h].Roles[l].ParticipantEmail,rt=s.RolesAndUsers[h].OrgName,b=!0),b==!0)break;if(b==!0)break}y&&(r+="<span test=\"xcxtest2\" style=\"cursor:pointer;color:purple;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+tt+"', '"+y+"', '"+it+"');\">",r+=y,r+=" ("+rt+")",r+="<\/span>");r+="<\/td>";r+="<\/tr>"}}}else r+="<tr>",r+="  <td>",r+="    NO WORKFLOW JSON. CANNOT PROCEED. xcx32456-4",r+="  <\/td>",r+="<\/tr>";r+="<\/table>";r+='<div style="display:none;" id="divOrgMultiPickerDialog">';r+='  <table style="width:100%;">';r+="    <tr>";r+='      <td style="width:90%;">';r+='        <span id="spanOrgMultiPickerDialogTitle" style="color: #3f3f3f;font-size:30pt;font-weight:bold;">Location(s)<\/span>';r+="      <\/td>";r+='      <td style="width:9%;"><\/td>';r+='      <td style="width:1%;cursor:pointer;vertical-align:top;">';r+="        <span class=\"dialogXButton\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:30pt;font-weight:bold;\" onclick=\"$('#divOrgMultiPickerDialog').dialog('close');\">X<\/span>";r+="      <\/td>";r+="    <\/tr>";r+="  <\/table>";r+="  <br /><br />";r+='  <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';r+="  <span id=\"spanOrgMultiPickerDialogContent\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 20pt;\"><\/span><br />";r+="  <br /><br />";r+='  <input type="button" value="SAVE" onclick="$(\'.bwWorkflowEditor\').bwWorkflowEditor(\'orgMultiPickerDialog_RenderResults\');" />';r+="  <br /><br />";r+="<\/div>";r+='<div style="display:none;" id="divMessageDialog">';r+='  <table style="width:100%;">';r+="    <tr>";r+='      <td style="width:90%;">';r+='        <span id="spanMessageDialogTitle" style="color: #3f3f3f;font-size:30pt;font-weight:bold;">[spanMessageDialogTitle]<\/span>';r+="      <\/td>";r+='      <td style="width:9%;"><\/td>';r+='      <td style="width:1%;cursor:pointer;vertical-align:top;">';r+="        <span class=\"dialogXButton\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:30pt;font-weight:bold;\" onclick=\"$('#divMessageDialog').dialog('close');\">X<\/span>";r+="      <\/td>";r+="    <\/tr>";r+="  <\/table>";r+="  <br /><br />";r+='  <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';r+="  <span id=\"spanMessageDialogContentTop\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 20pt;\">[spanMessageDialogContentTop]<\/span>";r+="    <br />";r+="    <br />";r+="    <br />";r+='    <span id="spanMessageDialogContentBottom" style="font-weight:bold;cursor:pointer;">';r+="      [spanMessageDialogContentBottom]";r+="    <\/span>";r+="  <br /><br />";r+="<\/div>";r+='<div style="display:none;" id="divWorkflowActionsUnderlyingPropertiesDialog">';r+='  <table style="width:100%;">';r+="    <tr>";r+='      <td style="width:90%;">';r+='        <span id="spanWorkflowActionsUnderlyingPropertiesDialog" style="color: #3f3f3f;font-size:30pt;font-weight:bold;">Action Properties<\/span>';r+="                    <br />";r+="                    <span id=\"spanWorkflowActionsUnderlyingPropertiesDialogSubTitle\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size:12pt;font-weight:normal;\">[spanWorkflowActionsUnderlyingPropertiesDialogSubTitle]<\/span>";r+="      <\/td>";r+='      <td style="width:9%;"><\/td>';r+='      <td style="width:1%;cursor:pointer;vertical-align:top;">';r+="        <span class=\"dialogXButton\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:30pt;font-weight:bold;\" onclick=\"$('#divWorkflowActionsUnderlyingPropertiesDialog').dialog('close');\">X<\/span>";r+="      <\/td>";r+="    <\/tr>";r+="  <\/table>";r+="  <br /><br />";r+='  <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and showing the keyboard. -->';r+='  <span id="spanWorkflowActionsUnderlyingPropertiesDialogContentTop">[spanWorkflowActionsUnderlyingPropertiesDialogContentTop]<\/span>';r+="    <br />";r+="    <br />";r+="    <br />";r+='    <span id="spanWorkflowActionsUnderlyingPropertiesDialogContentBottom" style="font-weight:bold;cursor:pointer;">';r+="    <\/span>";r+="  <br /><br />";r+="<\/div>";r+='<div style="display:none;" id="divProgressBarDialog">';r+='<div id="progressbar" class="ui-progressbar"><div class="progress-label">Loading...<\/div><\/div>';r+="<\/div>"}for(document.getElementById(n+"_Content").innerHTML=r,u.setZoom(80,n.replace("_Parent","")),f=0;f<e.Steps.Step.length;f++)v=e.Steps.Step[f]["@Name"],v!="Create"&&v!="Revise"&&v!="Admin"&&u.expandOrCollapseWorkflowStep("stepname_"+f,"stepimage_"+f,"steprow-collaboration_"+f+"_0")}}catch(ft){console.log("Exception in renderNewRequestWorkflowParticipants().xx.Get: "+ft.message+", "+ft.stack);displayAlertDialog("Exception in renderNewRequestWorkflowParticipants(): "+ft.message+", "+ft.stack)}},error:function(n,t,i){HideActivitySpinner();var r="Error in bwRequest.js.renderNewRequestWorkflowParticipants.racirolesandparticipants.error(): "+i+", data: "+JSON.stringify(n);console.log(r);displayAlertDialog(r)}})}catch(s){console.log("Exception in bwRequest.js.renderNewRequestWorkflowParticipants: "+s.message+", "+s.stack);displayAlertDialog("Exception in renderNewRequestWorkflowParticipants: "+s.message+", "+s.stack)}},loadWorkflowsAndCurrentWorkflow2:function(n){try{console.log("In loadWorkflowsAndCurrentWorkflow2().");var t=this;return new Promise(function(i){try{console.log("In loadWorkflowsAndCurrentWorkflow2().2.");var u=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),e=$(".bwAuthentication").bwAuthentication("option","participantId"),o=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),f={bwParticipantId_LoggedIn:e,bwActiveStateIdentifier:o,bwWorkflowAppId_LoggedIn:u,bwWorkflowAppId:u,bwRequestTypeId:"ALL",isActive:!0};$.ajax({url:t.options.operationUriPrefix+"_bw/orgrolesconfiguration",type:"POST",data:f,headers:{Accept:"application/json; odata=verbose"},success:function(r){try{$.ajax({url:t.options.operationUriPrefix+"_bw/workflowconfiguration",type:"POST",data:f,headers:{Accept:"application/json; odata=verbose"},success:function(u){var f,e;try{for(t.options.CurrentWorkflow=null,t.options.Checklists=r.Checklists,console.log("LOADING .options.Workflows!!!!!! xcx4478993 <<<<<<<<<<<<<<<<<<<<"),t.options.Workflows=u.value,f=0;f<t.options.Workflows.length;f++)if(t.options.Workflows[f].bwRequestTypeId==n&&t.options.Workflows[f].isActive==!0){t.options.CurrentWorkflow=t.options.Workflows[f];console.log("In loadWorkflowsAndCurrentWorkflow2(). Setting thiz.option.CurrentWorkflow for bwRequestTypeId: "+n+" xcx111774-6");break}t.options.CurrentWorkflow?(console.log(""),console.log("In loadWorkflowsAndCurrentWorkflow2().Workflow found for bwRequestTypeId: "+n),e={bwRequestType:n,bwWorkflowId:t.options.CurrentWorkflow.bwWorkflowId},i(e)):(console.log("In loadWorkflowsAndCurrentWorkflow2().No workflow found for bwRequestTypeId: "+n),displayAlertDialog("In loadWorkflowsAndCurrentWorkflow2().No workflow found for bwRequestTypeId: "+n),e={bwRequestType:n,bwWorkflowId:undefined},i(e))}catch(o){console.log("Exception in loadWorkflowsAndCurrentWorkflow2.Get:1: "+o.message+", "+o.stack);displayAlertDialog("Exception in loadWorkflowsAndCurrentWorkflow2.Get:1: "+o.message+", "+o.stack);i()}},error:function(n){console.log("In xx1.fail(): "+JSON.stringify(n));var t;t=JSON.stringify(n).indexOf("The specified URL cannot be found.")>-1?"There has been an error contacting the server. A firewall or network appliance may be interrupting this traffic.":JSON.stringify(n);alert("Exception in bwWorkflowEditor._create().xx.Get:2-1: "+t);console.log("Exception in bwWorkflowEditor._create().xx.Get:2-1: "+JSON.stringify(n));i()}})}catch(u){console.log("Exception in loadWorkflowsAndCurrentWorkflow2():2: "+u.message+", "+u.stack);displayAlertDialog("Exception in loadWorkflowsAndCurrentWorkflow2():2: "+u.message+", "+u.stack)}},error:function(n){console.log("In xx.fail(): "+JSON.stringify(n));var t;t=JSON.stringify(n).indexOf("The specified URL cannot be found.")>-1?"There has been an error contacting the server. A firewall or network appliance may be interrupting this traffic.":JSON.stringify(n);alert("Exception in bwWorkflowEditor._create().xx.Get:2-2: "+t);console.log("Exception in bwWorkflowEditor._create().xx.Get:2-2: "+JSON.stringify(n))}})}catch(r){console.log("Exception in loadWorkflowsAndCurrentWorkflow2():2: "+r.message+", "+r.stack);displayAlertDialog("Exception in loadWorkflowsAndCurrentWorkflow2():2: "+r.message+", "+r.stack)}})}catch(i){console.log("Exception in loadWorkflowsAndCurrentWorkflow2(): "+i.message+", "+i.stack);displayAlertDialog("Exception in loadWorkflowsAndCurrentWorkflow2(): "+i.message+", "+i.stack)}},revertACompletedTask2:function(n,t,i,r,u){var f,s,e,h;try{for(console.log("In revertACompletedTask2()."),u=JSON.parse(decodeURIComponent(u)),f=[],s=$(".bwRequest_RevertWorkflowStep_Confirmation_dialog_NotifyCheckbox:checkbox:checked"),e=0;e<s.length;e++)h=$(s[e]).attr("roleid"),f.push(h);alert("xcx123234 notification_roleId_Array: "+JSON.stringify(f));var a=$("#bwRequest_RevertWorkflowStep_Confirmation_dialog_EmailContents").html(),c=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),l=$(".bwAuthentication").bwAuthentication("option","participantId"),v=$(".bwAuthentication").bwAuthentication("option","participantEmail"),y=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),p=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),w={bwParticipantId_LoggedIn:l,bwActiveStateIdentifier:p,bwWorkflowAppId_LoggedIn:c,bwWorkflowAppId:c,bwBudgetRequestId:n,bwRequestTypeId:t,bwWorkflowTaskItemId:i,bwstepindex:r,requestWorkflowTasks:JSON.stringify(this.options.requestWorkflowTasks),EmailContents:a,NotificationRoleIdArray:JSON.stringify(f),ChangedRoleAssignments:JSON.stringify(u),ModifiedById:l,ModifiedByEmail:v,ModifiedByFriendlyName:y};$.ajax({url:this.options.operationUriPrefix+"_bw/revertcompletedtasks",type:"POST",data:w,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){console.log("Error in bwRequest.js.displayRequestForm.revertcompletedtasks(): "+t+" "+i);displayAlertDialog("Error in bwRequest.js.displayRequestForm.revertcompletedtasks(): "+t+" "+i)},success:function(n){try{n.status!="SUCCESS"?(console.log(n.message),displayAlertDialog(n.message)):displayAlertDialog(n.message)}catch(t){console.log("Exception in revertACompletedTask2():2: "+t.message+", "+t.stack);displayAlertDialog("Exception in revertACompletedTask2():2: "+t.message+", "+t.stack)}}})}catch(o){console.log("Exception in revertACompletedTask2(): "+o.message+", "+o.stack);displayAlertDialog("Exception in revertACompletedTask2(): "+o.message+", "+o.stack)}},revertACompletedTask:function(n,t,i,r){var l,e,a,o,v,f,u,d,s,h;try{if(console.log("In revertACompletedTask(). bwBudgetRequestId: "+n+", bwRequestTypeId: "+t),r){var y=$(r).closest(".steprowaudittasktrail"),w=$(y).attr("bwstepname"),c=$(y).attr("bwstepindex"),b=$(y).attr("bwroleid"),k=$(y).attr("bwtaskstatus");if(w&&!isNaN(c)&&b&&k){for(u=0;u<this.options.Workflows.length;u++)if(t==this.options.Workflows[u].bwRequestTypeId){l=JSON.parse(this.options.Workflows[u].bwWorkflowJson);break}if(l.Steps.Step[c]["@Name"]!=w)alert("Error xcx213235425: Failed to validate bwstepindex and bwstepname values.");else{if(e=[],l.Steps.Step.length-1>c){for(a=[],u=0;u<this.options.requestWorkflowTasks.length;u++)if(n==this.options.requestWorkflowTasks[u].bwBudgetRequestId)for(o=0;o<this.options.requestWorkflowTasks[u].workflowTaskItems.length;o++)a.push(this.options.requestWorkflowTasks[u].workflowTaskItems[o]);for(u=Number(c)+1;u<l.Steps.Step.length;u++)for(o=0;o<l.Steps.Step[u].Assign.length;o++)for(v=0;v<a.length;v++)a[v].WorkflowStepName==l.Steps.Step[u]["@Name"]&&e.push(a[v])}if(e.length==0)alert("THERE ARE NO ADDITIONAL TASKS TO ROLLBACK.");else for(f={results:{changedRoleAssignments:{removedRoleAssignments:[]}}},u=0;u<e.length;u++)d={bwWorkflowTaskItemId:e[u].bwWorkflowTaskItemId,ParticipantId:e[u].bwAssignedToId,ParticipantEmail:e[u].bwAssignedToEmail,ParticipantFriendlyName:e[u].bwAssignedToFriendlyName,RoleName:e[u].bwAssignedToRaciRoleName,RoleId:e[u].bwAssignedToRaciRoleAbbreviation,bwTaskTitle:e[u].bwTaskTitle},f.results.changedRoleAssignments.removedRoleAssignments.push(d);s="bwRequest_RevertWorkflowStep_Confirmation_dialog";h=document.getElementById(s);h||(h=document.createElement("div"),h.id=s,document.body.appendChild(h));$("#"+s).dialog({modal:!0,resizable:!0,closeOnEscape:!0,width:"900px",hide:!1,position:{my:"middle top+12",at:"middle top","of":window},close:function(){console.log("In xcx1234647-2(). Dialog "+s+"is being closed.")},open:function(){var r,u,e;try{for(r="",r+="<table style=\"width:100%;\" onclick=\"$('.bwRequest').bwRequest('pinRequestDialog');\">",r+="   <tr>",r+='       <td style="width:95%;">',r+="       <\/td>",r+="       <td>",r+="           <span class=\"dialogXButton\" style=\"font-size:25pt;cursor:pointer;width:100%;font-weight:bold;\" onclick=\"$('.bwPageScrollingHandler').bwPageScrollingHandler('CloseDialogAndPreventNextWindowScrollEvent', '"+s.replace("_Parent","")+"');\">X<\/span>",r+="       <\/td>",r+="   <\/tr>",r+="<\/table>",h.parentNode.querySelector(".ui-dialog-titlebar").innerHTML=r,r="",r+="<span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">",r+="These task(s) are being rolled-back.",r+="<\/span>",r+="<br /><br />",r+="These people will have to complete their tasks again.",r+="<ul>",u=0;u<f.results.changedRoleAssignments.removedRoleAssignments.length;u++)r+='<li style="color:red;">',r+='<span style="color:black;">',r+="<span style=\"color:purple;font-weight:bold;cursor:pointer;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+f.results.changedRoleAssignments.removedRoleAssignments[u].ParticipantId+"', '"+f.results.changedRoleAssignments.removedRoleAssignments[u].ParticipantFriendlyName+"', '"+f.results.changedRoleAssignments.removedRoleAssignments[u].ParticipantEmail+"', 'undefined');\">",r+=f.results.changedRoleAssignments.removedRoleAssignments[u].ParticipantFriendlyName,r+="<\/span>",r+=" - "+f.results.changedRoleAssignments.removedRoleAssignments[u].RoleName+" ("+f.results.changedRoleAssignments.removedRoleAssignments[u].RoleId+")<\/span>",r+='<span style="color:black;padding-left:50px;"><input class="bwRequest_RevertWorkflowStep_Confirmation_dialog_NotifyCheckbox" roleid="'+f.results.changedRoleAssignments.removedRoleAssignments[u].RoleId+'" type="checkbox" checked="checked" />&nbsp;Notify<\/span>',r+='<span style="color:black;padding-left:50px;font-style:italic;" title="bwWorkflowTaskItemId: '+f.results.changedRoleAssignments.removedRoleAssignments[u].bwWorkflowTaskItemId+'">Task: "'+f.results.changedRoleAssignments.removedRoleAssignments[u].bwTaskTitle+'"<\/span>',r+="<\/li>";r+="<\/ul>";r+="<br />";r+="Include an email message:";r+="<br />";r+='<span id="bwRequest_RevertWorkflowStep_Confirmation_dialog_EmailContents" class="xdTextBoxRequired bwRequestJson" title="" contenteditable="true" style="WORD-WRAP: break-word; HEIGHT: 90px; WHITE-SPACE: normal; OVERFLOW-X: auto; OVERFLOW-Y: auto; WIDTH: 100%;BACKGROUND-COLOR: white;font-family: \'Segoe UI Light\',\'Segoe UI\',\'Segoe\',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 15pt;"><\/span>';r+="<br /><br />";r+="<hr />";r+="<br />";r+="<div class=\"divSignInButton\" style=\"width:90%;text-align:center;line-height:0.8em;font-weight:bold;cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('revertACompletedTask2', '"+n+"', '"+t+"', '"+i+"', '"+c+"', '"+encodeURIComponent(JSON.stringify(f.results.changedRoleAssignments))+"', this);\">";r+="   Update Workflow and Notify Selected Participants";r+="<\/div>";r+="<br />";r+="<div class=\"divSignInButton\" style=\"width:90%;text-align:center;line-height:0.8em;font-weight:bold;cursor:pointer;\" onclick=\"$('.bwEmailEditor_RevertedRequest').bwEmailEditor_RevertedRequest('displayConfigureIntroductoryEmailDialog', 'Create');\">";r+='   Configure "A task has been rolled-back" email';r+="<\/div>";r+="<br /><br />";r+='<div class="divSignInButton" style="width:90%;text-align:center;line-height:0.8em;font-weight:bold;cursor:pointer;" onclick="$(\'#'+s+"').dialog('close');\">";r+="   Close";r+="<\/div>";r+="<br /><br />";r+='<div id="divBwEmailEditor_RevertedRequest">[divBwEmailEditor_RevertedRequest]<\/div>';h.innerHTML=r;$("#divBwEmailEditor_RevertedRequest").bwEmailEditor_RevertedRequest({})}catch(o){e="Exception in bwRequest.js.revertACompletedTask(): "+o.message+", "+o.stack;console.log(e);displayAlertDialog(e)}}})}}else displayAlertDialog("Error in revertACompletedTask(). Invalid value. This process cannot continue. bwstepname: "+w+", bwstepindex: "+c+", bwroleid: "+b+", bwtaskstatus: "+k)}else displayAlertDialog("Error in revertACompletedTask(). Could not locate the workflow details.")}catch(p){console.log("Exception in revertACompletedTask(): "+p.message+", "+p.stack);displayAlertDialog("Exception in revertACompletedTask(): "+p.message+", "+p.stack)}},pinRequestDialog:function(){try{console.log("In pinRequestDialog().");$(".ui-widget-overlay").unbind("click");$(".ui-widget-overlay").remove();console.log("In pinRequestDialog(). Scrolling window to top. This is experimental. Added a setTimeout to prevent race condition... 11-17-2022");$(window).scrollTop(0)}catch(n){console.log("Exception in pinRequestDialog(): "+n.message+", "+n.stack)}},shrinkRequestDialog:function(n){try{console.log("In shrinkRequestDialog(). requestDialogId: "+n);var i=document.getElementById(n);this.setZoom(.5,i);this.pinRequestDialog()}catch(t){console.log("Exception in shrinkRequestDialog(): "+t.message+", "+t.stack)}},growRequestDialog:function(n){try{console.log("In growRequestDialog(). requestDialogId: "+n);var i=document.getElementById(n);this.setZoom(1,i);this.pinRequestDialog()}catch(t){console.log("Exception in growRequestDialog(): "+t.message+", "+t.stack)}},zoomAndCenter:function(n){var f,t,u,e;try{console.log("In bwRequest.js.zoomAndCenter(). elementId: "+n);var o=n+"_Parent",s=document.getElementById(o),r=JSON.stringify(s.style.transform);if(r){f=r.split("scale(")[1];try{t=f.split(")")[0]}catch(i){console.log("xcx23124 bwRequest.js.zoomAndCenter() small issue here, it works but maybe improved?......")}}else t="2";t=="1"?(this.setZoom("200",n),u=window.innerWidth/7,console.log("xcx888747 THIS IS THE POSITIONG OF THE REQUEST DIALOG. 7 seems to be the magic number. width1: "+u),position={my:"center top",at:"center-"+u+" top","of":window,collision:"fit"},$("#"+n).dialog({position:position}),console.log("xcx453456 Calling bwJustificationDetailsField.js.ToggleExpandJustificationDetails(). scale=1")):t=="2"?(this.setZoom("100",n),$("#"+n).dialog({position:position}),console.log("xcx453456 Calling bwJustificationDetailsField.js.ToggleExpandJustificationDetails(). scale=2")):t=="3"?(this.setZoom("100",n),$("#"+n).dialog({position:position}),console.log("xcx453456 Calling bwJustificationDetailsField.js.ToggleExpandJustificationDetails(). scale=3")):(e="In bwRequest.js.zoomAndCenter(). Unexpected value for transform. Expected 1 or 2 or 3. transform: "+r+", scale: "+t,console.log(e),this.setZoom("100",n),$("#"+n).dialog({position:{my:"center top",at:"center top","of":window}}))}catch(i){console.log("Exception in bwRequest.js.zoomAndCenter(): "+i.message+", "+i.stack);displayAlertDialog("Exception in bwRequest.js.zoomAndCenter(): "+i.message+", "+i.stack)}},zoomAndCenterPoppedOutWindow:function(n){var t,r;try{console.log("In bwRequest.js.zoomAndCenterPoppedOutWindow(). elementId: "+n);t=this.options.lastPoppedOutZoom;t=="1"?(this.setZoom("200",n),this.options.lastPoppedOutZoom=2):t=="2"?(this.setZoom("100",n),this.options.lastPoppedOutZoom=1):(r="In bwRequest.js.zoomAndCenterPoppedOutWindow(). Unexpected value for transform. Expected 1 or 2. scale: "+t,console.log(r),displayAlertDialog(r))}catch(i){console.log("Exception in bwRequest.js.zoomAndCenterPoppedOutWindow(): "+i.message+", "+i.stack);displayAlertDialog("Exception in bwRequest.js.zoomAndCenterPoppedOutWindow(): "+i.message+", "+i.stack)}},setZoom:function(n,t){var p,u,s,h,i,r;try{if(console.log("In bwRequest.js.setZoom("+n+", "+t+")"),p=this,window.opener&&console.log("In bwRequest.js.setZoom(). This is a popped-out request wndow... we need to handle zoom differently here. originalZoom: "+n+", elementId: "+t),n>20)if(u=n/100,window.opener){console.log("In setZoom(). This is a popped-out request wndow... we need to handle zoom differently here. originalZoom: "+n+", elementId: "+t);i=document.body;transformOrigin=[0,0];var f=["webkit","moz","ms","o"],e="scale("+u+")",o=transformOrigin[0]*100+"% "+transformOrigin[1]*100+"%";for(r=0;r<f.length;r++)i.style[f[r]+"Transform"]=e,i.style[f[r]+"TransformOrigin"]=o;if(i.style.transform=e,i.style.transformOrigin=o,s="",s=t.indexOf("divRequestFormDialog_")>-1?t+"_Parent":"divRequestFormDialog_"+t+"_Parent",h=document.getElementById(s),console.log("xcx888 popped out window sizing happening here rectElement_Id: "+s),h){var c=h.getBoundingClientRect(),w=c.bottom-c.top,y=c.right-c.left+40,l=w*u,v=y*u;console.log("xcx21312342 rectElement: "+h+". weird fix for poppede out window, the window was getting too small and just disturbing ui/flash. 4-3-2023 xcx6665 width_not_baselined: "+y+", width: "+v+", zoom: "+u);l<200&&(l=1e3);window.resizeTo(v,l);console.log("xcx21335 In setZoom("+n+", "+t+"). window.resizeTo width: "+v+", height: "+l)}}else{console.log("In setZoom("+n+", "+t+")");t=t.replace("_Parent","");t+="_Parent";i=document.getElementById(t);transformOrigin=[0,0];var f=["webkit","moz","ms","o"],e="scale("+u+")",o=transformOrigin[0]*100+"% "+transformOrigin[1]*100+"%";for(r=0;r<f.length;r++)i.style[f[r]+"Transform"]=e,i.style[f[r]+"TransformOrigin"]=o;i.style.transform=e;i.style.transformOrigin=o;this.pinRequestDialog()}}catch(a){console.log("Exception in setZoom(): "+a.message+", "+a.stack);displayAlertDialog("Exception in setZoom(): "+a.message+", "+a.stack)}},reassignOrphanedRequestToAnActiveWorkflow:function(){try{console.log("In reassignOrphanedRequestToAnActiveWorkflow().");alert("This functionality is incomplete. Coming soon! In reassignOrphanedRequestToAnActiveWorkflow().")}catch(n){console.log("Exception in reassignOrphanedRequestToAnActiveWorkflow(): "+n.message+", "+n.stack)}},viewBwRequestJson:function(){var r,t,n;try{console.log("In viewBwRequestJson().");r=this;document.getElementById("spanDisplayJsonDialogTitle").innerHTML="";document.getElementById("spanDisplayJsonDialogContent").innerHTML="";document.getElementById("txtDisplayJsonDialogJSON").innerHTML="";$("#divDisplayJsonDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"760",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divDisplayJsonDialog").dialog("close")})},close:function(){$("#divDisplayJsonDialog").dialog("destroy")}});t=this.options.store;document.getElementById("spanDisplayJsonDialogTitle").innerHTML="Request JSON (bwRequestJson)";document.getElementById("spanDisplayJsonDialogContent").innerHTML="Use this to diagnose any issues.";n="";n+=JSON.stringify(t,null,2);document.getElementById("txtDisplayJsonDialogJSON").innerHTML=n;$("#btnRunDiagnostics").off("click").click(function(){alert("This functionality is incomplete. Coming soon!")})}catch(i){console.log("Exception in viewBwRequestJson(): "+i.message+", "+i.stack)}},viewWorkflowStepAndRoleJson:function(n){var u,i,t;try{console.log("In viewWorkflowStepAndRoleJson().");u=this;document.getElementById("spanDisplayJsonDialogTitle").innerHTML="";document.getElementById("spanDisplayJsonDialogContent").innerHTML="";document.getElementById("txtDisplayJsonDialogJSON").innerHTML="";$("#divDisplayJsonDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"760",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divDisplayJsonDialog").dialog("close")})},close:function(){$("#divDisplayJsonDialog").dialog("destroy")}});i=n;document.getElementById("spanDisplayJsonDialogTitle").innerHTML="Workflow Step/Role JSON";document.getElementById("spanDisplayJsonDialogContent").innerHTML="Use this to diagnose any issues.";t="";t+=JSON.stringify(i,null,2);document.getElementById("txtDisplayJsonDialogJSON").innerHTML=t;$("#btnRunDiagnostics").off("click").click(function(){alert("This functionality is incomplete. Coming soon!")})}catch(r){console.log("Exception in viewWorkflowStepAndRoleJson(): "+r.message+", "+r.stack)}},requestWindow_OnResize:function(){try{console.log("In requestWindow_OnResize(). No code here at the moment...")}catch(n){console.log("Exception in requestWindow_OnResize(): "+n.message+", "+n.stack)}},editTextbox_OnKeyUp:function(n){try{console.log("In editTextbox_OnKeyUp(). element.id: "+n.id);var i=n.getAttribute("bwFieldname"),r=n.value;this.options.store[i]=r}catch(t){console.log("Exception in editTextbox_OnKeyUp(): "+t.message+", "+t.stack)}},selectFiscalYear_OnChange:function(n){try{console.log("In selectFiscalYear_OnChange(). element.id: "+n.id);var i=n.getAttribute("bwFieldname"),r=n.value;this.options.store[i]=r;this.populateFunctionalAreas()}catch(t){console.log("Exception in selectFiscalYear_OnChange(): "+t.message+", "+t.stack)}},ddlFunctionalArea_OnChange:function(n){try{console.log("In ddlFunctionalArea_OnChange(). element.id: "+n.id);var i=n.getAttribute("bwFieldname"),r=n.value.split("|")[0];this.options.store[i]=r}catch(t){console.log("Exception in ddlFunctionalArea_OnChange(): "+t.message+", "+t.stack)}},dropDownList_OnChange:function(n){try{console.log("In ddlFunctionalArea_OnChange(). element.id: "+n.id);var i=n.getAttribute("bwFieldname"),r=n.value;this.options.store[i]=r}catch(t){console.log("Exception in ddlFunctionalArea_OnChange(): "+t.message+", "+t.stack)}},createRequestJson:function(){try{console.log("In bwRequest.js.createRequestJson(). This loads this.options.store with an empty bwRequest json object. Is this necessary?");this.options.store={BudgetRequestId:null,ARStatus:null,XmlDocument:null,Title:null,ProjectTitle:null,Project_Name:null,BriefDescriptionOfProject:null,Budget_Amount2:null,RequestedCapital:null,Requested_Expense:null,FunctionalAreaId:null,Functional_Area:null,EstimatedStartDate:null,EstimatedEndDate:null,Location:null,Cost_Center:null,Budget_Category:null,AttachmentsFolderName:null,FiscalYear:null,ProjectManager:{Person:{AccountId:null,FriendlyName:null,Email:null,AccountType:null}}}}catch(n){console.log("Exception in bwRequest.js.createRequestJson(): "+n.message+", "+n.stack);displayAlertDialog("Exception in bwRequest.js.createRequestJson(): "+n.message+", "+n.stack)}},displayChecklistInDialog:function(n,t,i,r,u,f,e){var c,o,s,h;try{console.log("In displayChecklistInDialog().");c=this;window.scrollTo(0,0);$(".bwActiveMenu").bwActiveMenu("adjustLeftSideMenu");o="divChecklistFormDialog_"+u+"_"+n;s="";s+='        <table style="width:100%;">';s+="            <tr>";s+='                <td style="width:90%;">';s+='                    <span id="divChecklistFormDialogContent"><\/span>';s+="                <\/td>";s+="            <\/tr>";s+="        <\/table>";s+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->';s+="        <br /><br />";h=document.getElementById(o);h||(h=document.createElement("div"),h.id=o,h.style.display="none",document.body.appendChild(h));h.innerHTML=s;$("#"+o).dialog({modal:!0,resizable:!0,closeText:"Cancel",closeOnEscape:!0,width:"800px",dialogClass:"no-close",hide:!1,position:{my:"middle top+12",at:"middle top","of":window},open:function(){var v,y,s,p,l,a;try{v=document.getElementById(o).parentNode;y=o+"_Parent";v.id=y;s="";s+='<table xcx="xcx3249-7" style="width:100%;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequestDialog\');">';s+="   <tr>";s+='       <td style="width:95%;">';s+='           <div id="slider_'+o+'" style="width:20%;cursor:pointer;"><\/div>';s+="       <\/td>";s+='       <td style="vertical-align:middle;width:5%;padding:0;border:0;margin:0;">';s+='           <span title="print" class="printButton" dev="xcx32424-3" style="font-size:18pt;cursor:pointer !important;" onclick="$(\'#divBwPrintButton\').bwPrintButton(\'PrintIndividualRequestReport\', \''+o+"');\">";s+='               <img src="/images/iosprinter_blue.png" style="width:50px;height:50px;cursor:pointer !important;" />';s+="           <\/span>";s+="       <\/td>";s+="       <td>";s+='           <span class="dialogXButton" style="font-size:25pt;cursor:pointer;width:100%;" onclick="$(\'#'+o.replace("_Parent","")+"').dialog('close');\">X<\/span>";s+="       <\/td>";s+="   <\/tr>";s+="<\/table>";document.getElementById(o).parentNode.querySelector(".ui-dialog-titlebar").innerHTML=s;console.log("In bwRequest.js.displayChecklistInDialog(). xcx3 budgetrequestform bwRequestType: "+r);s="";s+='<div id="budgetrequestchecklistform" bwWorkflowId="'+f+'" bwrequesttype="'+r+'" bwbudgetrequestid="'+u+'">';s+='<table style="width:100%;">';s+="        <tbody>";s+="            <tr>";s+='                <td colspan="4">';s+="                <\/td>";s+="            <\/tr>";s+="            <tr>";s+='                <td width="5"><\/td>';s+="                <td>";s+="                    <span>";s+='                       <img id="'+o+'_imgRequestOrgImage" src="'+c.options.operationUriPrefix+'images/corporeal.png" style="width:100px;height:100px;"/>';s+="                    <\/span>";s+="                <\/td>";s+='                <td style="text-align:right;" colspan="2">';s+='                    &nbsp;&nbsp;<span class="xdlabel" id="spanRequestForm_Title">';s+="                        <span xcx=\"xcx992234\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 22pt;font-weight:bold;\">";s+="                            Budget Request: ";s+='                            <span title="" id="spanRequestFormBudgetRequestTitle">'+i+"                       <\/span>";s+="                           <br />";s+='                           <span style="font-size:16pt;">Description: '+t+"<\/span>";s+="                        <\/span>";s+="                    <\/span>";s+="                <\/td>";s+="            <\/tr>";s+="        <\/tbody>";s+="    <\/table>";s+="";s+=c.renderChecklist(n);s+="<\/div";s+="<br />";s+='<div id="'+o+'_divChecklistFormDialogSaveButton" class="divSignInButton" style="width:90%;text-align:center;line-height:1.1em;font-weight:bold;">';s+="Save Completed Checklist";s+="<\/div>";s+="<br />";s+='<div class="divSignInButton" style="width:90%;text-align:center;line-height:1.1em;font-weight:bold;" onclick="$(\'#'+o.replace("_Parent","")+"').dialog('close');\">";s+="    Close";s+="<\/div>";s+="<br /><br />";document.getElementById(o).innerHTML=s;p="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)});a=JSON.parse($(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"));l=a.status!="SUCCESS"?"[No image. Unauthorized. xcx213124-34556-34-234-3245-xx]":c.options.operationUriPrefix+"_files/"+workflowAppId+"/orgimages/"+e+"/orgimage.png?v="+p+"&ActiveStateIdentifier="+a.ActiveStateIdentifier;$.get(l).done(function(){setTimeout(function(){$("#"+o+"_imgRequestOrgImage").attr("src",l)},500)}).fail(function(){});$("#slider_"+o).slider({min:0,max:100,value:100,slide:function(n,t){c.setZoom(t.value,o)}});$(".ui-widget-overlay").bind("click",function(){$("#"+o).dialog("close")});$("#"+o+"_divChecklistFormDialogSaveButton").bind("click",function(){$(".bwRequest").bwRequest("saveChecklist",n,o)})}catch(h){console.log("Exception in displayRequestWorkflowAuditTrailDialog().dialog.open(): "+h.message+", "+h.stack);displayAlertDialog("Exception in displayRequestWorkflowAuditTrailDialog().dialog.open(): "+h.message+", "+h.stack)}},close:function(){}})}catch(l){console.log("Exception in displayChecklistInDialog(): "+l.message+", "+l.stack);alert("Exception in displayChecklistInDialog(): "+l.message+", "+l.stack)}},displayChecklistInDialogReadOnly:function(n,t,i,r,u,f,e){var c,o,s,h;try{console.log("In displayChecklistInDialogReadOnly().");c=this;window.scrollTo(0,0);$(".bwActiveMenu").bwActiveMenu("adjustLeftSideMenu");o="divChecklistFormDialog_"+u+"_"+n;s="";s+='        <table style="width:100%;">';s+="            <tr>";s+='                <td style="width:90%;">';s+='                    <span id="divChecklistFormDialogContent"><\/span>';s+="                <\/td>";s+="            <\/tr>";s+="        <\/table>";s+='        <input type="text" autofocus="true" style="display:none;" /> <!-- This is here to prevent the first visible field from getting the cursor and zooming in on the iPhone. -->';s+="        <br /><br />";h=document.getElementById(o);h||(h=document.createElement("div"),h.id=o,h.style.display="none",document.body.appendChild(h));h.innerHTML=s;$("#"+o).dialog({modal:!0,resizable:!0,closeOnEscape:!0,width:"900px",dialogClass:"no-close",hide:!1,position:{my:"middle top+12",at:"middle top","of":window},open:function(){var l,a,s,v;try{l=document.getElementById(o).parentNode;a=o+"_Parent";l.id=a;s="";s+='<table xcx="xcx3249-8" style="width:100%;" onclick="$(\'.bwRequest\').bwRequest(\'pinRequestDialog\');">';s+="   <tr>";s+='       <td style="width:95%;">';s+='           <div id="slider_'+o+'" style="width:20%;cursor:pointer;"><\/div>';s+="       <\/td>";s+='       <td style="vertical-align:middle;width:5%;padding:0;border:0;margin:0;">';s+='           <span title="print" class="printButton" dev="xcx32424-4" style="font-size:18pt;cursor:pointer !important;" onclick="$(\'#divBwPrintButton\').bwPrintButton(\'PrintIndividualRequestReport\', \''+o+"');\">";s+='               <img src="/images/iosprinter_blue.png" style="width:50px;height:50px;cursor:pointer !important;" />';s+="           <\/span>";s+="       <\/td>";s+="       <td>";s+='           <span class="dialogXButton" style="font-size:25pt;cursor:pointer;width:100%;" onclick="$(\'#'+o.replace("_Parent","")+"').dialog('close');\">X<\/span>";s+="       <\/td>";s+="   <\/tr>";s+="<\/table>";document.getElementById(o).parentNode.querySelector(".ui-dialog-titlebar").innerHTML=s;s="";s+='<div id="budgetrequestchecklistform" bwWorkflowId="'+f+'" bwrequesttype="'+r+'" bwbudgetrequestid="'+u+'" bwchecklisttemplatesid="'+n+'">';s+='<table style="width:100%;">';s+="        <tbody>";s+="            <tr>";s+='                <td colspan="4">';s+="                <\/td>";s+="            <\/tr>";s+="            <tr>";s+='                <td width="5"><\/td>';s+="                <td>";s+="                    <span>";s+='                       <img id="'+o+'_imgRequestOrgImage" src="'+c.options.operationUriPrefix+'images/corporeal.png" style="width:100px;height:100px;"/>';s+="                    <\/span>";s+="                <\/td>";s+='                <td style="text-align:right;" colspan="2">';s+='                    &nbsp;&nbsp;<span class="xdlabel" id="spanRequestForm_Title">';s+="                        <span xcx=\"xcx99435\" style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 22pt;font-weight:bold;\">";s+="                            Budget Request:";s+='                            <span title="" id="spanRequestFormBudgetRequestTitle">'+i+"                       <\/span>";s+="                           <br />";s+='                           <span style="font-size:16pt;">Description: '+t+"<\/span>";s+="                        <\/span>";s+="                    <\/span>";s+="                <\/td>";s+="            <\/tr>";s+="        <\/tbody>";s+="    <\/table>";s+="<\/div>";v=c.renderChecklistReadOnly(n,u);v.then(function(n){try{n.status!="SUCCESS"?alert("xcx2312424 "+n.status+", "+n.message):s+=n.html;s+="<br />";s+='<div id="'+o+'_divChecklistFormDialogSaveButton" class="divSignInButton" style="width:90%;text-align:center;line-height:1.1em;font-weight:bold;">';s+="Request Revision";s+="<\/div>";s+="<br />";s+='<div class="divSignInButton" style="width:90%;text-align:center;line-height:1.1em;font-weight:bold;" onclick="$(\'#'+o.replace("_Parent","")+"').dialog('close');\">";s+="    Close";s+="<\/div>";s+="<br /><br />";document.getElementById(o).innerHTML=s;var u="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),i,r=JSON.parse($(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"));i=r.status!="SUCCESS"?"[No image. Unauthorized. xcx213124-34556-34-234-3245-xx]":c.options.operationUriPrefix+"_files/"+workflowAppId+"/orgimages/"+e+"/orgimage.png?v="+u+"&ActiveStateIdentifier="+r.ActiveStateIdentifier;$.get(i).done(function(){setTimeout(function(){$("#"+o+"_imgRequestOrgImage").attr("src",i)},500)}).fail(function(){});$("#slider_"+o).slider({min:0,max:100,value:100,slide:function(n,t){c.setZoom(t.value,o)}});$(".ui-widget-overlay").bind("click",function(){$("#"+o).dialog("close")});$("#"+o+"_divChecklistFormDialogSaveButton").bind("click",function(){alert("Revision functionality is incomplete. Coming soon! xcx123123123")})}catch(t){console.log("Exception in displayChecklistInDialogReadOnly(): "+t.message+", "+t.stack);alert("Exception in displayChecklistInDialogReadOnly(): "+t.message+", "+t.stack)}}).catch(function(n){console.log("Exception in displayChecklistInDialogReadOnly.renderChecklistReadOnly():44: "+JSON.stringify(n));alert("Exception in displayChecklistInDialogReadOnly.renderChecklistReadOnly():44: "+JSON.stringify(n))})}catch(h){console.log("Exception in displayRequestWorkflowAuditTrailDialog().dialog.open(): "+h.message+", "+h.stack);alert("Exception in displayRequestWorkflowAuditTrailDialog().dialog.open(): "+h.message+", "+h.stack)}},close:function(){}})}catch(l){console.log("Exception in displayChecklistInDialogReadOnly(): "+l.message+", "+l.stack);alert("Exception in displayChecklistInDialogReadOnly(): "+l.message+", "+l.stack)}},renderChecklist:function(n){var e,r,i,t,f,o;try{for(console.log("In renderChecklist. bwChecklistTemplatesId: "+n+", this.options.Checklists: "+JSON.stringify(this.options.Checklists)),alert("In renderChecklist. bwChecklistTemplatesId: "+n+", this.options.Checklists: "+JSON.stringify(this.options.Checklists)),t=0;t<this.options.Checklists.length;t++)if(n==this.options.Checklists[t].bwChecklistTemplatesId){e=t;break}for(r=JSON.parse(this.options.Checklists[e].ChecklistJson),i="",i+='<table class="xdFormLayout" style="BORDER-TOP: #d8d8d8 1pt solid; BORDER-RIGHT: #d8d8d8 1pt solid; VERTICAL-ALIGN: top; BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 15px; BORDER-LEFT: #d8d8d8 1pt solid; PADDING-RIGHT: 0px;">',i+="<tr>",i+="  <td>",i+="    <h2>"+r.Title+"<\/h2>",t=0;t<r.ChecklistTemplateRow.length;t++)r.ChecklistTemplateRow[t].TitleSection&&r.ChecklistTemplateRow[t].TitleSection!="<br />"&&(i+=r.ChecklistTemplateRow[t].TitleSection);for(t=0;t<r.ChecklistTemplateRow.length;t++)r.ChecklistTemplateRow[t].hasOwnProperty("TitleSection")||(r.ChecklistTemplateRow[t].hasOwnProperty("ChecklistItem")?(i+='<table style="width:50%;">',i+="<tr>",i+='   <td style="width:95%;text-align:left;color:black;" class="bwSliderTitleCell">',f=r.ChecklistTemplateRow[t].ChecklistItem.Question.trim(),o=f.charAt(f.length-1),i+=o=="?"?'       <span id="questiontext_'+t+'" class="bwQuestionText">'+r.ChecklistTemplateRow[t].ChecklistItem.Question+"<\/span>":'       <span id="questiontext_'+t+'" class="bwQuestionText">'+r.ChecklistTemplateRow[t].ChecklistItem.Question+"<\/span>:",i+="   <\/td>",i+='   <td style="width:5%;" class="bwChartCalculatorLightCurrencyTableCell">',i+='       <label for="configurationBehaviorRequireStartEndDatesSlider2"><\/label><input type="checkbox" class="bwQuestionCheckbox" id="questioncheckbox_'+t+'" />',i+="   <\/td>",i+="<\/tr>",i+="<\/table>"):alert("Unrecognized json attribute: "+r.ChecklistTemplateRow[t]));return i+="  <\/td>",i+="<\/tr>",i+"<\/table>"}catch(u){console.log("Exception in renderChecklist(): "+u.message+", "+u.stack);displayAlertDialog("Exception in renderChecklist(): "+u.message+", "+u.stack)}},renderChecklistReadOnly:function(n,t){console.log("In bwRequest.js.renderChecklistReadOnly().");var i=this;return new Promise(function(r,u){var f,s;try{console.log("In renderChecklistReadOnly. bwChecklistTemplatesId: "+n+", thiz.options.Checklists: "+JSON.stringify(i.options.Checklists));var e=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),h=$(".bwAuthentication").bwAuthentication("option","participantId"),c=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),l={bwParticipantId_LoggedIn:h,bwActiveStateIdentifier:c,bwWorkflowAppId_LoggedIn:e,bwWorkflowAppId:e,bwBudgetRequestId:t,isActive:!0,bwRequestType:"ALL"};$.ajax({url:webserviceurl+"/getsinglebudgetrequest",type:"POST",data:l,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){var r="Error in bwRequest.js.renderChecklistReadOnly.getsinglebudgetrequest(). xcx213124-1 Unauthorized. Please refresh your browser and log in again. jqXHR.status: "+n.status+", settings: "+t+", errorThrown: "+i,f={status:"ERROR",message:r};u(f)},success:function(t){var h,c,a,v,e,i,f,l,y,o,s;try{if(t.status!="SUCCESS")o="Error in bwRequest.js.renderChecklistReadOnly.getsinglebudgetrequest.success(): "+JSON.stringify(t),displayAlertDialog(o),s={status:"ERROR",message:o},u(s);else if(h=t.results,h.BudgetRequest&&h.BudgetRequest.bwRequestJson&&h.BudgetRequest.bwRequestJson!="")if(h.BudgetRequest.bwBudgetRequestId){for(c=JSON.parse(h.BudgetRequest.bwRequestJson).Checklists,f=0;f<c.length;f++)if(v=JSON.parse(c[f]),v.bwChecklistTemplatesId==n){a=f;break}for(e=JSON.parse(c[a]),i="",i+='<table class="xdFormLayout" style="BORDER-TOP: #d8d8d8 1pt solid; BORDER-RIGHT: #d8d8d8 1pt solid; VERTICAL-ALIGN: top; BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 15px; BORDER-LEFT: #d8d8d8 1pt solid; PADDING-RIGHT: 0px;">',i+="<tr>",i+="  <td>",i+="    <h2>"+e.Title+"<\/h2>",i+='    <span style="color:tomato;text-decoration:underline;font-style:italic;font-size:9pt;">This checklist was completed by '+e.CreatedByEmail+" on "+formatDateFromBW(e.Created)+"<\/span>",i+="    <br />",i+="    <br />",i+="<span onclick=\"$('.bwRequest').bwRequest('RequestARevisionToThisChecklist', 'false', '');\" style=\"font-size:9pt;\" title=\"The Checklist has been updated. Do you wish to request a revision before this step is completed? and still in this step!\">",i+='<img width="11" height="11" style="cursor:pointer;vertical-align:top;" alt="" src="/images/red-dot.png">',i+="&nbsp;The Checklist has been updated. Do you wish to request a revision before this step is completed? and still in this step!<\/span>",i+="    <br />",i+="    <br />",f=0;f<e.ChecklistTemplateRow.length;f++)e.ChecklistTemplateRow[f].TitleSection&&e.ChecklistTemplateRow[f].TitleSection!="<br />"&&(i+=e.ChecklistTemplateRow[f].TitleSection);for(f=0;f<e.ChecklistTemplateRow.length;f++)e.ChecklistTemplateRow[f].hasOwnProperty("TitleSection")||(e.ChecklistTemplateRow[f].hasOwnProperty("ChecklistItem")?(i+='<table style="width:50%;">',i+="<tr>",i+='   <td style="width:95%;text-align:left;color:black;" class="bwSliderTitleCell">',l=e.ChecklistTemplateRow[f].ChecklistItem.Question.trim(),y=l.charAt(l.length-1),i+=y=="?"?'       <span id="questiontext_'+f+'" class="bwQuestionText">'+e.ChecklistTemplateRow[f].ChecklistItem.Question+"<\/span>":'       <span id="questiontext_'+f+'" class="bwQuestionText">'+e.ChecklistTemplateRow[f].ChecklistItem.Question+"<\/span>:",i+="   <\/td>",i+='   <td style="width:5%;" class="bwChartCalculatorLightCurrencyTableCell">',i+='       <label for="configurationBehaviorRequireStartEndDatesSlider2"><\/label>',i+=e.ChecklistTemplateRow[f].ChecklistItem.Checked==!0?'<span style="white-space:nowrap;"><input disabled="disabled" type="checkbox" class="bwQuestionCheckbox" id="questioncheckbox_'+f+'" checked="checked" />&nbsp;Yes<\/span>':'<span style="white-space:nowrap;"><input disabled="disabled" type="checkbox" class="bwQuestionCheckbox" id="questioncheckbox_'+f+'" />&nbsp;No<\/span>',i+="   <\/td>",i+="<\/tr>",i+="<\/table>"):(i+="Unrecognized json attribute: "+e.ChecklistTemplateRow[f],alert("Unrecognized json attribute: "+e.ChecklistTemplateRow[f])));i+="  <\/td>";i+="<\/tr>";i+="<\/table>";s={status:"SUCCESS",html:i};r(s)}else o="Error in bwRequest.js.renderChecklistReadOnly(). Invalid value for brData.BudgetRequest.bwBudgetRequestId: "+h.BudgetRequest.bwBudgetRequestId,displayAlertDialog(o),s={status:"ERROR",message:o},u(s);else o="INVALID bwRequestJson RETURNED. THIS PROCESS CANNOT CONTINUE.xcx41202011 brData.BudgetRequest.bwRequestJson: "+h.BudgetRequest.bwRequestJson,displayAlertDialog(o),s={status:"ERROR",message:o},u(s)}catch(p){o="Exception in renderChecklistReadOnly():2: "+p.message+", "+p.stack;displayAlertDialog(o);s={status:"EXCEPTION",message:o};u(s)}}})}catch(o){f="Exception in renderChecklistReadOnly(): "+o.message+", "+o.stack;displayAlertDialog(f);s={status:"EXCEPTION",message:f};u(s)}})},saveChecklist:function(n,t){var i,a,v,w;try{console.log("In bwRequest.js.saveChecklist(). bwChecklistTemplatesId: "+n+", checklistDialogId: "+t);alert("In bwRequest.js.saveChecklist(). bwChecklistTemplatesId: "+n+", checklistDialogId: "+t);var s=this,h=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),f=$(".bwAuthentication").bwAuthentication("option","participantId"),c=$(".bwAuthentication").bwAuthentication("option","participantEmail"),l=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),e=null;for(i=0;i<this.options.Checklists.length;i++)if(n==this.options.Checklists[i].bwChecklistTemplatesId){e=i;break}if(e==null)console.log("Error in saveChecklist(): Could not find the checklist."),alert("ERROR: Could not find the checklist.");else{var p=JSON.parse(JSON.stringify(this.options.Checklists[e])),r=JSON.parse(p.ChecklistJson),o=document.getElementsByClassName("bwQuestionCheckbox");for(i=0;i<o.length;i++){a=o[i].id.split("_")[1];v=o[i].checked;try{r.ChecklistTemplateRow[a].ChecklistItem.Checked=v}catch(u){w=""}}r.Created=null;r.CreatedBy=l;r.CreatedById=f;r.CreatedByEmail=c;r.Modified=null;r.ModifiedByFriendlyName=null;r.ModifiedById=null;r.ModifiedByEmail=null;var y=$("#"+t).find("#budgetrequestchecklistform")[0].getAttribute("bwbudgetrequestid"),b=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),k={bwParticipantId_LoggedIn:f,bwActiveStateIdentifier:b,bwWorkflowAppId_LoggedIn:h,bwBudgetRequestId:y,bwWorkflowAppId:h,ModifiedById:f,ModifiedByFriendlyName:l,ModifiedByEmail:c,Checklist:JSON.stringify(r)},d=s.options.operationUriPrefix+"_bw/bwbudgetrequests/submitchecklistforrequest";$.ajax({url:d,type:"POST",data:k,headers:{Accept:"application/json; odata=verbose"},success:function(n){n.status=="SUCCESS"?($("#"+t).dialog("close"),s.displayArInDialog("",y,"","","","",""),displayAlertDialog("The checklist was saved successfully.")):displayAlertDialog(n.message)},error:function(n,t,i){console.log("Error assigning the budget amount: "+t+", "+i+JSON.stringify(n));displayAlertDialog("Error assigning the budget amount: "+t+", "+i+JSON.stringify(n))}})}}catch(u){console.log("Exception in saveChecklist(): "+u.message+", "+u.stack);displayAlertDialog("Exception in saveChecklist(): "+u.message+", "+u.stack)}},adminMoveWorkflowToNextStep:function(){try{console.log("In adminMoveWorkflowToNextStep().");alert("In adminMoveWorkflowToNextStep(). This functionality is incomplete. Coming soon!")}catch(n){console.log("Exception in adminMoveWorkflowToNextStep(): "+n.message+", "+n.stack)}},viewWorkflowHistoryDialog:function(){try{console.log("In viewWorkflowHistoryDialog().");alert("In viewWorkflowHistoryDialog(). This functionality is incomplete. Coming soon!")}catch(n){console.log("Exception in viewWorkflowHistoryDialog(): "+n.message+", "+n.stack)}},selectedRaciRole_OnChange:function(n){var f;try{console.log("In bwRequest.js.selectedRaciRole_OnChange().");var i=n.options[n.selectedIndex].value,r=$(n).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),u=n.options[n.selectedIndex].getAttribute("bwworkflowtaskitemid");console.log("In bwRequest.js.selectedRaciRole_OnChange(). selectedRaciRole: "+i+", bwWorkflowTaskItemId: "+u);f="divRequestFormDialog_"+r;this.displayRequestForm(r,f,u,i)}catch(t){console.log("Exception in bwRequest.js.selectedRaciRole_OnChange(): "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.selectedRaciRole_OnChange(): "+t.message+", "+t.stack)}},viewThisBudgetRequestSystemDetailsDialog:function(){try{console.log("In viewThisBudgetRequestSystemDetailsDialog().");alert("In viewThisBudgetRequestSystemDetailsDialog(). This functionality is incomplete. Coming soon!")}catch(n){console.log("Exception in viewThisBudgetRequestSystemDetailsDialog(): "+n.message+", "+n.stack)}},displayRequestTaskAuditTrailInDialog:function(n,t,i,r,u,f,e){var o,s;try{if(console.log("In displayRequestTaskAuditTrailInDialog()."),this.pinRequestDialog(),t||r)if(n||t||i||u)try{$("#spanArDialogTitle").empty();$("#spanArDialogTaskAuditTrail").empty();$("#spanArDialogViewBudgetRequestLink").empty();alert("Displaying ArDialog. xcx23425345-3-9");$("#ArDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:r+" ("+u+")",width:"720px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#ArDialog").dialog("close")})},close:function(){try{displayAlertDialog("In xcx23412(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-12")}catch(n){}}});o="";o+='<span xcx="342352-3" style="cursor:pointer;" title="Click here to view the audit trail..." onclick="$(\'.bwRequest\').bwRequest(\'displayRequestWorkflowAuditTrailDialog\', \''+r+"', '"+u.replace(/["]/g,"&quot;").replace(/[']/g,"&#92;&#39;")+"', '"+f+"', '"+t+"', '"+e+"');\"> <\/span>";o+="&nbsp;&nbsp;&nbsp;&nbsp;";o+=r+" ("+u+")xcx7.7";$("#spanArDialogTitle").html(o);s=webserviceurl+"/bwworkflowtasks/getbybudgetrequestid/"+t;$.ajax({url:s,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){var e,o,r,s,f;if(i.d.results.length==0)html="",html+="<table>",html+="   <tr>",html+="       <td>&nbsp;<\/td>",html+="   <\/tr>",html+="   <tr>",html+="       <td>",html+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+participantId+"', '"+u+"');\">Click here to view the Budget Request<\/a>",html+="       <\/td>",html+="   <\/tr>",html+="<\/table>",$("#spanArDialogViewBudgetRequestLink").html(html);else{for(e=[],e.push(i.d.results[0].bwAuthorId),o=0;o<i.d.results.length;o++)e.push(i.d.results[o].bwAssignedToId);for(r=[],s=0,f=0;f<e.length;f++)GetUserDetails[f]=$.Deferred(),GetUserDetails[f].done(function(n){var f,c,o,l,h;if(s+=1,r.push(n),s==e.length){for(f="",f+="<table>",f+="   <tr>",f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[0].Created)+'">',c="",h=0;h<r.length;h++)r[h][0]==i.d.results[0].bwAuthorId&&(c=r[h][1]);for(f+='           <strike><span style="cursor:help;">xcx25-2'+formatDateFromBW(i.d.results[0].Created)+" - Request submitted by "+c+"<\/span><\/strike>",f+="       <\/td>",f+="   <\/tr>",f+="<\/table>",o=0;o<i.d.results.length;o++){if(f+="<table>",f+="   <tr>",f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[o].Modified)+'">',i.d.results[o].bwPercentComplete==100&&i.d.results[o].bwStatus=="Completed")f+="       <strike>",f+='<span style="cursor:help;">xcx26'+i.d.results[o].Modified+" - "+i.d.results[o].bwTaskOutcome+" ["+i.d.results[o].bwAssignedToRaciRoleName+" ("+i.d.results[o].bwAssignedToRaciRoleAbbreviation+")]x<\/span>",f+="       <\/strike>";else{for(l="",h=0;h<r.length;h++)r[h][0]==i.d.results[o].bwAssignedToId&&(l=r[h][1]);f+="xcx27-2"+formatDateFromBW(i.d.results[o].Created)+" - "+i.d.results[o].bwTaskTitle+" assigned to "+l+" ["+i.d.results[o].bwAssignedToRaciRoleName+" ("+i.d.results[o].bwAssignedToRaciRoleAbbreviation+")]x"}f+="       <\/td>";f+="   <\/tr>";f+="<\/table>"}$("#spanArDialogTaskAuditTrail").html(f);f="";f+="<table>";f+="   <tr>";f+="       <td>&nbsp;<\/td>";f+="   <\/tr>";f+="   <tr>";f+="       <td>";f+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+participantId+"', '"+u+"');\">Click here to view the Budget Request<\/a>";f+="       <\/td>";f+="   <\/tr>";f+="<\/table>";$("#spanArDialogViewBudgetRequestLink").html(f);$("#ui-id-1").css("border-radius","20px 0 0 20px")}}).fail(function(){handleExceptionWithAlert("Error in bwRequest.displayRequestTaskAuditTrailInDialog().GetUserDetails.fail()","GetUserDetails.fail()")}),getUserDetails(e[f],n,f)}},error:function(){handleExceptionWithAlert("Error in bwRequest.displayRequestTaskAuditTrailInDialog()","1:"+errorCode+", "+errorMessage)}})}catch(h){handleExceptionWithAlert("Error in bwRequest.displayRequestTaskAuditTrailInDialog()","2:"+h.message)}else s=webserviceurl+"/getbudgetrequestidfromtitle/"+r,$.ajax({url:s,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){t=i[0].bwBudgetRequestId;n=globalUrlPrefix+globalUrlForWebServices;r=i[0].ProjectTitle;u=i[0].Title;try{$("#spanArDialogTitle").empty();$("#spanArDialogTaskAuditTrail").empty();$("#spanArDialogViewBudgetRequestLink").empty();alert("Displaying ArDialog. xcx23425345-3-8");$("#ArDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:r+" ("+u+")",width:"720px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#ArDialog").dialog("close")})},close:function(){try{displayAlertDialog("In xcx23412(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-11")}catch(n){}}});$("#ArDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();$("#spanArDialogTitle").html(r+" ("+u+")x5");var f=webserviceurl+"/bwworkflowtasks/getbybudgetrequestid/"+t;$.ajax({url:f,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){var e,o,r,s,f;if(i.d.results.length!=0){for(e=[],e.push(i.d.results[0].bwAuthorId),o=0;o<i.d.results.length;o++)e.push(i.d.results[o].bwAssignedToId);for(r=[],s=0,f=0;f<e.length;f++)GetUserDetails[f]=$.Deferred(),GetUserDetails[f].done(function(n){var f,c,o,l,h;if(s+=1,r.push(n),s==e.length){for(f="",f+="<table>",f+="   <tr>",f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[0].Created)+'">',c="",h=0;h<r.length;h++)r[h][0]==i.d.results[0].bwAuthorId&&(c=r[h][1]);for(f+='           <strike><span style="cursor:help;">xcx22'+formatDateFromBW(i.d.results[0].Created)+" - Request submitted by "+c+"[raci role 3]<\/span><\/strike>",f+="       <\/td>",f+="   <\/tr>",f+="<\/table>",o=0;o<i.d.results.length;o++){if(f+="<table>",f+="   <tr>",f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[o].Modified)+'">',i.d.results[o].bwPercentComplete==100&&i.d.results[o].bwStatus=="Completed")f+="       <strike>",f+='<span style="cursor:help;">xcx23'+formatDateFromBW(i.d.results[o].Modified)+" - "+i.d.results[o].bwTaskOutcome+"[raci role 4]<\/span>",f+="       <\/strike>";else{for(l="",h=0;h<r.length;h++)r[h][0]==i.d.results[o].bwAssignedToId&&(l=r[h][1]);f+="xcx24"+formatDateFromBW(i.d.results[o].Created)+" - "+i.d.results[o].bwTaskTitle+" assigned to "+l}f+="       <\/td>";f+="   <\/tr>";f+="<\/table>"}$("#spanArDialogTaskAuditTrail").html(f);f="";f+="<table>";f+="   <tr>";f+="       <td>&nbsp;<\/td>";f+="   <\/tr>";f+="   <tr>";f+="       <td>";f+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+participantId+"', '"+u+"');\">Click here to view the Budget Request<\/a>";f+="       <\/td>";f+="   <\/tr>";f+="<\/table>";$("#spanArDialogViewBudgetRequestLink").html(f);$("#ui-id-1").css("border-radius","20px 0 0 20px")}}).fail(function(){handleExceptionWithAlert("Error in bwRequest.displayRequestTaskAuditTrailInDialog().GetUserDetails.fail()","GetUserDetails.fail()")}),getUserDetails(e[f],n,f)}},error:function(){handleExceptionWithAlert("Error in bwRequest.displayRequestTaskAuditTrailInDialog()","1:"+errorCode+", "+errorMessage)}})}catch(e){handleExceptionWithAlert("Error in bwRequest.displayRequestTaskAuditTrailInDialog()","2:"+e.message)}},error:function(){handleExceptionWithAlert("Error in bwRequest.displayRequestTaskAuditTrailInDialog()","1:"+errorCode+", "+errorMessage)}});else{t=$('span[xd\\:binding = "my:BudgetRequestId"]')[0].innerHTML;n=this.options.operationUriPrefix;r=$('span[xd\\:binding = "my:Project_Name"]')[0].innerHTML;u=$('span[xd\\:binding = "my:Title"]')[0].innerHTML;try{$("#spanArDialogTitle").empty();$("#spanArDialogTaskAuditTrail").empty();$("#spanArDialogViewBudgetRequestLink").empty();alert("Displaying ArDialog. xcx23425345-3-7");$("#ArDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:r+" ("+u+")",width:"720px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#ArDialog").dialog("close")})},close:function(){try{displayAlertDialog("In xcx23412(). The request form is being closed. We need to check if the user may be losing any changes. This functionality is incomplete. Coming soon! xcx12312-10")}catch(n){}}});$("#ArDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();o="";o+=" ";o+="&nbsp;&nbsp;&nbsp;&nbsp;x3";o+=r+" ("+u+")";$("#spanArDialogTitle").html(o);s=webserviceurl+"/bwworkflowtasks/getbybudgetrequestid/"+t;$.ajax({url:s,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){var e,o,r,s,f;if(i.d.results.length!=0){for(e=[],e.push(i.d.results[0].bwAuthorId),o=0;o<i.d.results.length;o++)e.push(i.d.results[o].bwAssignedToId);for(r=[],s=0,f=0;f<e.length;f++)GetUserDetails[f]=$.Deferred(),GetUserDetails[f].done(function(n){var f,c,o,l,h;if(s+=1,r.push(n),s==e.length){for(f="",f+="<table>",f+="   <tr>",f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[0].Created)+'">',c="",h=0;h<r.length;h++)r[h][0]==i.d.results[0].bwAuthorId&&(c=r[h][1]);for(f+='           <strike><span style="cursor:help;">xcx19'+formatDateFromBW(i.d.results[0].Created)+" - Request submitted by "+c+"<\/span><\/strike>",f+="       <\/td>",f+="   <\/tr>",f+="<\/table>",o=0;o<i.d.results.length;o++){if(f+="<table>",f+="   <tr>",i.d.results[o].bwPercentComplete==100&&i.d.results[o].bwStatus=="Completed")f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[o].Modified)+'">',f+="       <strike>",f+='<span style="cursor:help;">xcx20'+formatDateFromBW(i.d.results[o].Modified)+" - "+i.d.results[o].bwTaskOutcome+"[raci role1]<\/span>",f+="       <\/strike>",f+="       <\/td>";else{for(l="",h=0;h<r.length;h++)r[h][0]==i.d.results[o].bwAssignedToId&&(l=r[h][1]);f+='       <td title="'+formatDateAndTimeFromBW(i.d.results[o].Created)+'">';f+='<span style="cursor:help;">xcx21'+formatDateFromBW(i.d.results[o].Created)+" - "+i.d.results[o].bwTaskTitle+" assigned to "+l+"[raci role2]<\/span>";f+="       <\/td>"}f+="   <\/tr>";f+="<\/table>"}$("#spanArDialogTaskAuditTrail").html(f);f="";f+="<table>";f+="   <tr>";f+="       <td>&nbsp;<\/td>";f+="   <\/tr>";f+="   <tr>";f+="       <td>";f+="           <a onclick=\"$('.bwRequest').bwRequest('displayRequestFormDialog', '"+t+"', '"+participantId+"', '"+u+"');\">Click here to view the Budget Request<\/a>";f+="       <\/td>";f+="   <\/tr>";f+="<\/table>";$("#spanArDialogViewBudgetRequestLink").html(f);$("#ui-id-1").css("border-radius","20px 0 0 20px")}}).fail(function(){handleExceptionWithAlert("Error in bwRequest.displayRequestTaskAuditTrailInDialog().GetUserDetails.fail()","GetUserDetails.fail()")}),getUserDetails(e[f],n,f)}},error:function(){handleExceptionWithAlert("Error in bwRequest.displayRequestTaskAuditTrailInDialog()","1:"+errorCode+", "+errorMessage)}})}catch(h){handleExceptionWithAlert("Error in bwRequest.displayRequestTaskAuditTrailInDialog()","2:"+h.message)}}}catch(h){console.log("Exception in displayRequestTaskAuditTrailInDialog(): "+h.message+", "+h.stack)}},expandOrCollapseWorkflowStep2:function(n,t,i,r){var f,u;try{console.log("In expandOrCollapseWorkflowStep2("+n+", "+t+", "+i+", "+r+").");var c=t.split("stepimage_")[1],o="steprow_"+c,e=$("#"+r).find("#"+t)[0],s=this.options.operationUriPrefix+"images/drawer-close.png",l=this.options.operationUriPrefix+"images/drawer-open.png",a=$("#"+r).find("#"+i)[0];if(e.src==s)for(e.src=l,f=$("#"+r).find("."+o),u=0;u<f.length;u++)f[u].style.display="none";else for(e.src=s,f=$("#"+r).find("."+o),u=0;u<f.length;u++)f[u].style.display="table-row"}catch(h){console.log("Exception in expandOrCollapseWorkflowStep2(): "+h.message+", "+h.stack)}},RequestARevisionToThisChecklist:function(){try{console.log("In RequestARevisionToThisChecklist().")}catch(n){console.log("Exception in RequestARevisionToThisChecklist(): "+n.message+", "+n.stack)}},renderCreateRequestFullFormOnline:function(n){var t,i;console.log("In renderCreateRequestFullFormOnline().");t=this;alert("In renderCreateRequestFullFormOnline(). cmdCreateBudgetRequestAndStartWorkflow method is called in here but not set with correct attributes.");i=this.renderRequestFormHtml_CapitalPlan_ExistingRequestScreen();i.then(function(i){var r,u,e;try{document.getElementById(n).innerHTML=i;document.getElementById("spanRequestForm_Instructions").innerHTML='zComplete the form then click the "Submit" button.';r="";r+="                        <button onclick=\"$('#divCreateRequestFormDialog').dialog('close');\" class=\"BwButton200ForRequestForm\">Save<\/button>";r+="                        &nbsp;";r+='                        <button name="startWorkflowButton" xcx="xcx22354235-5" id="startWorkflowButton" onclick="$(\'.bwRequest\').bwRequest(\'cmdCreateBudgetRequestAndStartWorkflow\', this, \'\');" class="BwButton200ForRequestForm" title="Click here to Submit the request.">Submitxcx4<\/button>';r+="                        &nbsp;";r+="                        <button onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\" class=\"BwButton200ForRequestForm\">Cancel<\/button>";t.renderRequestFormButtons(n,null,null,r,"xcx445566-12");u=[];e=[{Name:"",Id:0},{Name:"United States",Id:1},{Name:"Canada",Id:2},{Name:"United Kingdom",Id:3}];$("#jsGridCosts").jsGrid({width:"100%",height:"100%",inserting:!0,editing:!0,sorting:!0,paging:!0,data:u,noDataContent:'xClick the "Plus" (+) sign to add a Cost item...',fields:[{name:"Description",type:"text",width:150,validate:"required"},{name:"Lease",type:"number",width:50},{name:"Expense",type:"number",width:50},{name:"Capital",type:"number",width:50},{name:"Total",type:"number",width:50},{type:"control"}]});$("#jsGridPayback").jsGrid({width:"100%",height:"auto",inserting:!0,editing:!0,sorting:!0,paging:!0,data:u,noDataContent:'xClick the "Plus" (+) sign to add a Payback item...',fields:[{name:"Description",type:"text",width:150,validate:"required"},{name:"Lease",type:"number",width:50},{name:"Expense",type:"number",width:50},{name:"Capital",type:"number",width:50},{name:"Total",type:"number",width:50},{type:"control"}]});$("#jsGridOngoingCosts").jsGrid({width:"100%",height:"auto",inserting:!0,editing:!0,sorting:!0,paging:!0,data:u,noDataContent:'xClick the "Plus" (+) sign to add an Ongoing Costs item...',fields:[{name:"Description",type:"text",width:150,validate:"required"},{name:"Lease",type:"number",width:50},{name:"Expense",type:"number",width:50},{name:"Capital",type:"number",width:50},{name:"Total",type:"number",width:50},{type:"control"}]})}catch(f){console.log("Exception in renderCreateRequestFullFormOnline(): "+f.message+", "+f.stack)}})},renderCreateRequestFullFormOffline:function(n){var t,r,i;console.log("In renderCreateRequestFullFormOffline(). Getting ready to call getRequestFormHtml() for an offline form.");t=this;alert("In renderCreateRequestFullFormOffline(). Getting ready to call getRequestFormHtml() for an offline form.");n||(n="divRequestFormDialogContent");r="xcx435367";alert("xcx9895: !!!!!!!!!<<<<<<<<<<<<<<<<<<<<<<<<");i=this.getRequestFormHtml("offlinerequest",!0,null,"xcx23452-13");i.then(function(i){try{document.getElementById(n).innerHTML=i.html;document.getElementById("spanRequestForm_Instructions").innerHTML='zComplete the form then click the "Submit" button.';var r="";r+="                        <button onclick=\"$('#divCreateRequestFormDialog').dialog('close');\" class=\"BwButton200ForRequestForm\">Save<\/button>";r+="                        &nbsp;";r+='                        <button name="startWorkflowButton" xcx="xcx22354235-6" id="startWorkflowButton" onclick="$(\'.bwRequest\').bwRequest(\'cmdCreateBudgetRequestAndStartWorkflow\', this, \'\');" class="BwButton200ForRequestForm" title="Click here to Submit the request.">Submitxcx4<\/button>';r+="                        &nbsp;";r+="                        <button onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\" class=\"BwButton200ForRequestForm\">Cancel<\/button>";t.renderRequestFormButtons(n,null,null,r,"xcx445566-13")}catch(u){console.log("Exception in renderCreateRequestFullFormOffline(): "+u.message+", "+u.stack)}})},cmdDisplayClientRequestsNotYetSubmittedDialog:function(n){var t,i;console.log("In cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit().");try{t=this;i=t.options.indexDBVersion>0?t.options.indexedDBInstance.open(t.options.indexDBName,t.options.indexDBVersion):t.options.indexedDBInstance.open(t.options.indexDBName);i.onblocked=function(n){console.log("indexDB BLOCKED1. errorCode: "+n.target.errorCode)};i.onerror=function(n){console.log('In bwRequest.js.cmdDisplayClientRequestsNotYetSubmittedDialog(). Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};i.onsuccess=function(i){var r,f,u;console.log('In bwRequest.js.cmdDisplayClientRequestsNotYetSubmittedDialog(). Success accessing database "'+i.target.result.name+'".');r=i.target.result;r.onerror=function(n){console.log('Error In bwRequest.js.displayForm_DisplayCachedAr(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};try{f=r.transaction("objectStoreCachedRequests","readonly");u=f.objectStore("objectStoreCachedRequests").count()}catch(e){console.log("In bwRequest.js.cmdDisplayClientRequestsNotYetSubmittedDialog().XXXXXXXXXXXerror: "+e.message)}u.onsuccess=function(i){var u,e,f;i.target.result==1&&n!=!0?(f=r.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),f.openCursor().onsuccess=function(n){var i,r;try{i=n.target.result;i&&(r=i.value.bwBudgetRequestId,console.log("Getting ready to display bwBudgetRequestId: "+r),t.displayForm_DisplayCachedAr(r))}catch(u){console.log("In bwRequest.js.cmdDisplayClientRequestsNotYetSubmittedDialog(). xyyyyy..."+u.message+", "+u.stack)}}):(i.target.result>1||n==!0)&&(document.getElementById("spanClientRequestsNotYetSubmittedDialogTitle").innerHTML=i.target.result+" Requests on this device are waiting to be submitted.",document.getElementById("divClientRequestsNotYetSubmittedContent").innerHTML="",u="",u+='<span style="font-style:italic;font-size:30pt;">If this device runs low on storage, it may delete them without asking you.<\/span>',u+="<br />",u+="<br />",u+="<br />",u+='<table class="myStuffTable" style="width:100%;">',u+="  <tr>",u+='    <td class="bwHPNDrillDownLinkCell" style="text-align:left;" colspan="2"><span>There are '+i.target.result+" requests saved on this device.<\/span><\/td>",u+="  <\/tr>",e=i.target.result,f=r.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),f.openCursor().onsuccess=function(n){var i,r;try{i=n.target.result;i?(r=i.value.ProjectTitle,r==""&&(r="<em>[no description]<\/em>"),console.log("Retrieved request: "+r+": "+i.value.bwBudgetRequestId),u+="  <tr>",u+='    <td class="tdHomePageSubNotificationIos8" style="cursor:pointer;width:95%;" onclick="displayForm_DisplayCachedAr(\''+i.value.bwBudgetRequestId+"');\">",u+='      <div style="display:inline-block;">',u+='        <span title="Click to view the request." style="cursor:pointer;font-size:30pt;width:100%;">'+r+" (<em>"+t.formatCurrency(i.value.RequestedCapital)+"<\/em>)<\/span>",u+="      <\/div>",u+="    <\/td>",u+="    <td>",u+="      <img src=\"images/trash-can.png\" onclick=\"$('.bwRequest').bwRequest('cmdDisplayDeleteUnsubmittedBudgetRequestDialog', '"+i.value.bwBudgetRequestId+"', '"+r+"', '"+i.value.RequestedCapital+'\');" title="Delete" class="trashcan" style="cursor:pointer;">',u+="    <\/td>",u+="  <\/tr>",i.continue()):(console.log("DONE LOOPING, so rendering."),u+='<tr><td colspan="12"><\/td><\/tr>',u+="<\/table>",document.getElementById("divClientRequestsNotYetSubmittedContent").innerHTML=u,$("#divClientRequestsNotYetSubmittedDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"800",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divClientRequestsNotYetSubmittedDialog").dialog("close")})}}),$("#divClientRequestsNotYetSubmittedDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove())}catch(f){console.log("xxError: "+f.message+", "+f.stack)}})};u.onerror=function(){console.error("In bwRequest.js.cmdDisplayClientRequestsNotYetSubmittedDialog(). add error",this.error)}}}catch(r){console.log("In bwRequest.js.cmdDisplayClientRequestsNotYetSubmittedDialog(). FAILED TO OPEN A TRANSACTION to the database..."+r.message+", "+r.stack)}},formatRequestedExpense:function(){var n=this.formatCurrency($('span[xd\\:binding = "my:Requested_Expense"]')[0].innerHTML);$('span[xd\\:binding = "my:Requested_Expense"]')[0].innerHTML=n},formatRequestedCapital:function(){var n=this.formatCurrency($('span[xd\\:binding = "my:Requested_Capital"]')[0].innerHTML);$('span[xd\\:binding = "my:Requested_Capital"]')[0].innerHTML=n},formatCurrency2:function(n){var i,t,r,f,e;try{i=!1;t="";try{t=$('span[xd\\:binding = "'+n+'"]')[0].innerHTML.trim()}catch(u){t=$('input[xd\\:binding = "'+n+'"]')[0].value;i=!0}try{t===""||t==="0"||t==="$0.00"||t==="NaN"?i==!0?$('input[xd\\:binding = "'+n+'"]')[0].value="":$('span[xd\\:binding = "'+n+'"]')[0].innerHTML="":i==!0?(r=this.formatCurrencyWithoutDollarSign(t),$('input[xd\\:binding = "'+n+'"]')[0].value=r):(r=this.formatCurrency(t),$('span[xd\\:binding = "'+n+'"]')[0].innerHTML=r)}catch(o){this.WriteToErrorLog("bwm.core.js.formatCurrency2("+n+")","Could not assign a value to this element. Message: "+o.message)}this.recalculateCosts()}catch(u){f="bwm.core.js.formatCurrency2("+n+")";e=u.message+" "+u.stack;this.WriteToErrorLog(f,e)}},loadXslFiles:function(){var n=this,t;t=n.options.indexDBVersion>0?n.options.indexedDBInstance.open(n.options.indexDBName,n.options.indexDBVersion):n.options.indexedDBInstance.open(n.options.indexDBName);t.onblocked=function(n){console.log("In bw.offline.core.js.loadXslFiles().request.onblocked: indexDB BLOCKED1. errorCode: "+n.target.errorCode)};t.onerror=function(n){console.log("In bw.offline.core.js.loadXslFiles().request.onerror: Error opening IndexedDB database1. errorCode: "+n.target.errorCode)};t.onsuccess=function(t){var u=t.target.result,i,r;for(u.onerror=function(n){console.log("In bw.offline.core.js.loadXslFiles().request.onsuccess.db.onerror: ERRRRRRRRRRRRRRRRRRRR: This may not happen in other browsers and unique to edge, but not confirmed (todd): "+n.message+", "+n.target.errorMessage+", "+n.target.name)},i=[],i.push(["/views/UnsubmittedBudgetRequest.xsl","UnsubmittedBudgetRequest"]),i.push(["/views/UnsubmittedQuoteRequest.xsl","UnsubmittedQuoteRequest"]),i.push(["/views/UnsubmittedReimbursementRequest.xsl","UnsubmittedReimbursementRequest"]),i.push(["/views/UnsubmittedRecurringExpense.xsl","UnsubmittedRecurringExpense"]),i.push(["/viewsIos8/UnsubmittedBudgetRequest.xsl","UnsubmittedBudgetRequestIos8"]),i.push(["/viewsIos8/UnsubmittedQuoteRequest.xsl","UnsubmittedQuoteRequestIos8"]),i.push(["/viewsIos8/UnsubmittedReimbursementRequest.xsl","UnsubmittedReimbursementRequestIos8"]),i.push(["/viewsIos8/UnsubmittedRecurringExpense.xsl","UnsubmittedRecurringExpenseIos8"]),i.push(["/viewsPrintableHtml/UnsubmittedBudgetRequestPrintableHtml.xsl","UnsubmittedBudgetRequestPrintableHtml"]),i.push(["/viewsPrintableHtml/UnsubmittedQuoteRequestPrintableHtml.xsl","UnsubmittedQuoteRequestPrintableHtml"]),i.push(["/viewsPrintableHtml/UnsubmittedReimbursementRequestPrintableHtml.xsl","UnsubmittedReimbursementRequestPrintableHtml"]),i.push(["/viewsPrintableHtml/UnsubmittedRecurringExpensePrintableHtml.xsl","UnsubmittedRecurringExpensePrintableHtml"]),r=0;r<i.length;r++)n.getXsltAndStoreInDatabase(u,i[r][0],i[r][1])}},getXsltAndStoreInDatabase:function(n,t,i){var e=this,r=new XMLHttpRequest,u,f;r.onreadystatechange=function(){try{if(r.status==200&&r.readyState==4){u=r.response;console.log('Attempting to put Xsl file "'+t+'" as "'+i+'" into IndexedDB. blob length: '+u.length);var e=""+i,o=n.transaction("objectStoreCachedXsltFiles","readwrite").objectStore("objectStoreCachedXsltFiles").add(u,e).onsuccess=function(){console.log("SUCCESSSSSSSSSSSSSS: Stored "+t+" as "+i)}}}catch(f){console.log("Error in getXsltAndStoreInDatabase.xhr.onreadystatechange(): "+f.message+", "+f.stack)}};f=e.options.operationUriPrefix+t;r.open("GET",f,!0);r.responseType="text";r.send()},TransformToHtmlTextOffline:function(n,t){var l=this,o,s,v,i,f,h,c,e;try{var a=new DOMParser,u=a.parseFromString(n,"application/xml"),y=a.parseFromString(t,"application/xml");if(typeof XSLTProcessor!="undefined")return console.log('In bwRequest.js.TransformToHtmlTextOffline(): typeof (XSLTProcessor) != "undefined"'),o=new XSLTProcessor,o.importStylesheet(y),s=o.transformToFragment(u,document),typeof GetXmlStringFromXmlDoc!="undefined"?(console.log('In bwRequest.js.TransformToHtmlTextOffline(): typeof (GetXmlStringFromXmlDoc) != "undefined")'),GetXmlStringFromXmlDoc(s)):(console.log("In bwRequest.js.TransformToHtmlTextOffline(): chrome friendly"),v=new XMLSerializer,i=v.serializeToString(s),i.indexOf("XML Parsing Error: syntax error")>-1&&(console.log("In bwRequest.js.TransformToHtmlTextOffline(): sResult: "+i),console.log("In bwRequest.js.TransformToHtmlTextOffline(): xml: "+n)),i.indexOf("<transformiix:result")>-1&&(i=i.substring(i.indexOf(">")+1,i.lastIndexOf("<"))),i);if(typeof u.transformNode!="undefined")return console.log('In bwRequest.js.TransformToHtmlTextOffline(): typeof (xmlDoc.transformNode) != "undefined"'),u.transformNode(t);f=null;try{f=new ActiveXObject("Msxml2.XSLTemplate")}catch(r){console.log('In bwRequest.js.TransformToHtmlTextOffline(): Failed to create new ActiveXObject("Msxml2.XSLTemplate"): '+r.message+", "+r.stack)}try{if(f)return console.log("In bwRequest.js.TransformToHtmlTextOffline(): activeXOb"),h=f,c=new ActiveXObject("Msxml2.FreeThreadedDOMDocument"),console.log("In bwRequest.js.TransformToHtmlTextOffline(): Preparing to load xml into Msxml2.FreeThreadedDOMDocument"),c.loadXML(t),console.log("In bwRequest.js.TransformToHtmlTextOffline(): Successful: xslDoc.loadXML(xsltDoc.xml). xsltDoc: "+t+". xsltDoc.xml: "+t.xml),h.stylesheet=c,console.log("In bwRequest.js.TransformToHtmlTextOffline(): Successful: xslt.stylesheet = xslDoc;"),e=h.createProcessor(),console.log("In bwRequest.js.TransformToHtmlTextOffline(): Successful: var xslProc = xslt.createProcessor();"),e.input=u,console.log("In bwRequest.js.TransformToHtmlTextOffline(): Successful: xslProc.input = xmlDoc;"),e.transform(),console.log("In bwRequest.js.TransformToHtmlTextOffline(): Successful: xslProc.transform();"),e.output}catch(r){return displayAlertDialog("There was an error parsing XSLT."),console.log("Error In bwRequest.js.TransformToHtmlTextOffline(): There was an error parsing XSLT: "+r.name+", "+r.message),l.WriteToErrorLog("Error In bwRequest.js.TransformToHtmlTextOffline()","There was an error parsing XSLT: "+r.name+", "+r.message),l.WriteToErrorLog("Error In bwRequest.js.TransformToHtmlTextOffline()",n),null}}catch(r){console.log("Error in TransformToHtmlTextOffline: "+r.message+", "+r.stack)}},displayForm_DisplayCachedAr:function(n){var t,i;try{$("#divClientRequestsNotYetSubmittedDialog").dialog("close")}catch(r){}t=this;i=t.options.indexDBVersion>0?t.options.indexedDBInstance.open(t.options.indexDBName,t.options.indexDBVersion):t.options.indexedDBInstance.open(t.options.indexDBName);i.onblocked=function(n){console.log("In bwRequest.js.displayForm_DisplayCachedAr(): indexDB BLOCKED1. errorCode: "+n.target.errorCode);displayAlertDialog("In bwRequest.js.displayForm_DisplayCachedAr(): indexDB BLOCKED1. errorCode: "+n.target.errorCode)};i.onerror=function(n){console.log('In bwRequest.js.displayForm_DisplayCachedAr(): Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);displayAlertDialog('In bwRequest.js.displayForm_DisplayCachedAr(): Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};i.onsuccess=function(i){console.log('In bwRequest.js.displayForm_DisplayCachedAr(): Success accessing database "'+i.target.result.name+'".');var r=i.target.result;r.onerror=function(n){console.log('Error In bwRequest.js.displayForm_DisplayCachedAr(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);displayAlertDialog('Error In bwRequest.js.displayForm_DisplayCachedAr(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};r.transaction("objectStoreCachedXsltFiles").objectStore("objectStoreCachedXsltFiles").get("UnsubmittedBudgetRequestIos8").onsuccess=function(i){var u=i.target.result,f;u?(console.log("In bwRequest.js.displayForm_DisplayCachedAr("+n+"). Loaded the Xsl file from the indexDB!"),f=r.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),f.openCursor().onsuccess=function(i){var r,e,o;try{r=i.target.result;r?(r.value.bwBudgetRequestId==n&&(status='<img class="imgRedDot" alt="" src="/images/red-dot.png"> You will be prompted to submit this request the next time you <a href="javascript:displayCustomLogonDialog();">sign in.<\/a>',e=r.value.bwDocumentXml,o=t.TransformToHtmlTextOffline(e,u),console.log("In bwRequest.js.displayForm_DisplayCachedAr("+n+"). Preparing to display in divOfflineRequestFormPageMainPageContent."),document.getElementById("divOfflineRequestFormDialogContent").innerHTML=o,$("#divOfflineRequestFormDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!0,width:"1100",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divOfflineRequestFormDialog").dialog("close")});console.log("Completed display in displayForm_DisplayCachedAr divOfflineRequestFormPageMainPageContent.");try{console.log("In bwRequest.js.displayForm_DisplayCachedAr(): Populating offline attachments 1!!!!");t.populateOfflineAttachments("attachmentsInXslForm")}catch(n){displayAlertDialog("Exception In bwRequest.js.displayForm_DisplayCachedAr(): "+n.message+n.stack)}}}),$("#divOfflineRequestFormDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()),r.continue()):console.log("In bwRequest.js.displayForm_DisplayCachedAr. DONE LOOPING.")}catch(f){console.log("Exception In bwRequest.js.displayForm_DisplayCachedAr. xxError: "+f.message+", "+f.stack);displayAlertDialog("Exception In bwRequest.js.displayForm_DisplayCachedAr. xxError: "+f.message+", "+f.stack)}}):(console.log("ERRROR LOADING XSL FILE!!! "+u),displayAlertDialog("ERRROR LOADING XSL FILE!!!"))}}},PrintRequest:function(){var r,n,i,u;$("#PrintDialog").dialog("close");r=this;try{try{n=document.getElementById("OfflineRequestBudgetRequestIdInXslForm").innerHTML}catch(t){try{n=document.getElementById("UnsubmittedBudgetRequestId").innerHTML}catch(t){n=document.getElementById("XslFormBudgetRequestId").innerHTML}}i=document.getElementById("divDocumentBody").innerHTML;$("#divOfflineRequestFormDialog").dialog("close");u=r.displayForm_DisplayCachedArWithPrintableHtml(n);u.then(function(){var n,t,r;console.log("Declaring attachment to the window.onafterprint event. This doesn't seem to work on MacBook Safari, or iOS (Safari and Chrome).");window.onafterprint=function(n){try{console.log("Print Dialog Closed.");document.getElementById("divDocumentBody").innerHTML=i;$("#divOfflineRequestFormDialog").dialog("open")}catch(n){console.log("Exception in window.onafterprint: "+n.message)}};console.log("navigator.userAgent: "+navigator.userAgent);console.log("window.matchMedia: "+window.matchMedia);navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)?(n=function(){console.log("Functionality to run before printing.")},t=function(){console.log("Functionality to run after printing");document.getElementById("divDocumentBody").innerHTML=i;$("#divOfflineRequestFormDialog").dialog("open")},window.matchMedia&&(r=window.matchMedia("print"),r.addListener(function(i){i.matches?n():t()})),window.onbeforeprint=n,window.onafterprint=t):navigator.userAgent.match(/Macintosh/i)&&navigator.userAgent.match(/Safari/i)&&(console.log("Print Dialog Closed4. Safari on Macintosh?"),document.getElementById("divDocumentBody").innerHTML=i,$("#divOfflineRequestFormDialog").dialog("open"));window.print();console.log("window.print() has just been executed. In Safari on MacBook, and Safari & Chrome on iOS, this is a synchronous call.")})}catch(t){console.log("Error in bw.offline.core.js.PrintRequest(): "+t.message+", "+t.stack);displayAlertDialog("Error in bw.offline.core.js.PrintRequest()x: "+t.message+", "+t.stack)}},cmdPrintForm:function(){$("#PrintDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"760",dialogClass:"no-close",hide:!1});$("#PrintDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();var n="";n+="Print";document.getElementById("spanPrintDialogTitle").innerHTML=n;n="Currently there is no custom report for this screen. Coming Soon!";document.getElementById("spanPrintDialogContents").innerHTML=n},decodeUriInAllFields:function(){$('span[xd\\:binding = "my:Project_Name"]')[0].innerHTML=decodeURIComponent($('span[xd\\:binding = "my:Project_Name"]')[0].innerHTML);$('span[xd\\:binding = "my:Brief_Description_of_Project"]')[0].innerHTML=decodeURIComponent($('span[xd\\:binding = "my:Brief_Description_of_Project"]')[0].innerHTML);try{$('span[xd\\:binding = "my:NecessityOfProposedExpenditure"]')[0].innerHTML=decodeURIComponent($('span[xd\\:binding = "my:NecessityOfProposedExpenditure"]')[0].innerHTML);$('span[xd\\:binding = "my:Location"]')[0].innerHTML=decodeURIComponent($('span[xd\\:binding = "my:Location"]')[0].innerHTML);$('span[xd\\:binding = "my:group15/my:EstimatedCostsExplanation"]')[0].innerHTML=decodeURIComponent($('span[xd\\:binding = "my:group15/my:EstimatedCostsExplanation"]')[0].innerHTML);$('span[xd\\:binding = "my:SavingsNotes"]')[0].innerHTML=decodeURIComponent($('span[xd\\:binding = "my:SavingsNotes"]')[0].innerHTML)}catch(n){}},displayForm_DisplayCachedArWithPrintableHtml:function(n){var t=this;return new Promise(function(i,r){var u;try{u=t.options.indexDBVersion>0?t.options.indexedDBInstance.open(t.options.indexDBName,t.options.indexDBVersion):t.options.indexedDBInstance.open(t.options.indexDBName);u.onblocked=function(n){console.log("In bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml(): indexDB BLOCKED1. errorCode: "+n.target.errorCode);displayAlertDialog("In bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml(): indexDB BLOCKED1. errorCode: "+n.target.errorCode);r()};u.onerror=function(n){console.log('In bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml(): Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);displayAlertDialog('In bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml(): Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);r()};u.onsuccess=function(u){console.log('In bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml(): Success accessing database "'+u.target.result.name+'".');var f=u.target.result;f.onerror=function(n){console.log('Error in bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);displayAlertDialog('Error in bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);r()};f.transaction("objectStoreCachedXsltFiles").objectStore("objectStoreCachedXsltFiles").get("UnsubmittedBudgetRequestPrintableHtml").onsuccess=function(u){var e=u.target.result,o;e?(console.log("In bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml("+n+"). Loaded the Xsl file from the indexDB!"),o=f.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),o.openCursor().onsuccess=function(u){var o,s,h;try{if(o=u.target.result,o){if(o.value.bwBudgetRequestId==n){status='<img class="imgRedDot" alt="" src="/images/red-dot.png"> You will be prompted to submit this request the next time you <a href="javascript:displayCustomLogonDialog();">sign in.<\/a>';s=o.value.bwDocumentXml;console.log("Starting: TransformToHtmlTextOffline(xml, xslt)");h=t.TransformToHtmlTextOffline(s,e);console.log("Ending: TransformToHtmlTextOffline(xml, xslt)");console.log("In bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml("+n+"). Preparing to display in divOfflineRequestFormPageMainPageContent.");document.getElementById("divDocumentBody").innerHTML=h;console.log("Completed display in displayForm_DisplayCachedArWithPrintableHtml divOfflineRequestFormPageMainPageContent.");try{$('span[xd\\:binding = "my:Status"]')[0].innerHTML=status;t.decodeUriInAllFields();t.formatRequestedExpense();t.formatRequestedCapital();t.formatCurrency2("my:Budget_Amount2");t.formatCurrency2("my:ExpenseEquipmentAndParts");t.formatCurrency2("my:CostOfEquipmentAndParts");t.formatCurrency2("my:ExpenseInternalLabor");t.formatCurrency2("my:CostOfInternalLabor");t.formatCurrency2("my:ExpenseCostOfOutsideServices");t.formatCurrency2("my:CostOfOutsideServices");t.formatCurrency2("my:OtherExpense");t.formatCurrency2("my:OtherCapital");t.formatCurrency2("my:SalesTax");console.log("In bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml(): Populating offline attachments 1!!!!")}catch(f){console.log("Exception in bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml(): Error rendering . "+f.message+f.stack);displayAlertDialog("Exception in bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml(): Error rendering . "+f.message+f.stack);r()}}o.continue()}else console.log("In bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml. DONE LOOPING."),i()}catch(f){console.log("Exception in bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml. xxError: "+f.message+", "+f.stack);displayAlertDialog("Exception in bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml. xxError: "+f.message+", "+f.stack);r()}}):(console.log("In bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml: ERRROR LOADING XSL FILE!!! "+e),displayAlertDialog("In bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml: ERRROR LOADING XSL FILE!!!"),r())}}}catch(f){console.log("Exception in bw.offline.core.js.displayForm_DisplayCachedArWithPrintableHtml("+n+")");r()}})},cmdDisplayDeleteUnsubmittedBudgetRequestDialog:function(n,t){var i,u;try{i=this;console.log("In bwRequest.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog("+n+", "+t+").");n||(console.log("In bwRequest.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog("+n+", "+t+"). <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< requestId is undefined!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! Todd fix this."),u=!0,n=document.getElementById("OfflineRequestBudgetRequestIdInXslForm").innerHTML,t="this request...",console.log("requestId: "+n));$("#divDeleteABudgetRequestOfflineDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"Delete "+n,width:"570px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divDeleteABudgetRequestOfflineDialog").dialog("close")})}});$("#divDeleteABudgetRequestOfflineDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("spanDeleteABudgetRequestOfflineDialogTitle").innerHTML="Delete "+t;$("#divDeleteABudgetRequestOfflineDialogDeleteRequestButton").off("click").click(function(){var t;t=i.options.indexDBVersion>0?i.options.indexedDBInstance.open(i.options.indexDBName,i.options.indexDBVersion):i.options.indexedDBInstance.open(i.options.indexDBName);t.onblocked=function(n){console.log("indexDB BLOCKED1. errorCode: "+n.target.errorCode)};t.onerror=function(n){console.log("In cmdDisplayDeleteUnsubmittedBudgetRequestDialog(). Error creating/accessing IndexedDB database1. errorCode: "+n.target.errorCode)};t.onsuccess=function(t){var r=t.target.result,f;console.log('In cmdDisplayDeleteUnsubmittedBudgetRequestDialog(). Successfully opened the database "'+t.target.result.name+'".');r.onerror=function(n){console.log('Error In bwRequest.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};f=r.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests");f.openCursor().onsuccess=function(t){var f,o,e;try{f=t.target.result;f?(f.value.bwBudgetRequestId==n&&(o=r.transaction("objectStoreCachedRequests","readwrite"),e=o.objectStore("objectStoreCachedRequests").delete(f.primaryKey),e.onsuccess=function(){console.log("In cmdDisplayDeleteUnsubmittedBudgetRequestDialog(). Successfully deleted request from the database.");u==!0?($("#divDeleteABudgetRequestOfflineDialog").dialog("close"),$("#divOfflineRequestFormDialog").dialog("close")):($("#divDeleteABudgetRequestOfflineDialog").dialog("close"),i.cmdDisplayClientRequestsNotYetSubmittedDialog(!0));participantId},e.onerror=function(){console.error("In cmdDisplayDeleteUnsubmittedBudgetRequestDialog(). Error deleting request from the database.",this.error)}),f.continue()):console.log("In bwRequest.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog. DONE LOOPING.")}catch(s){console.log("In bwRequest.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog. xxError: "+s.message+", "+s.stack)}}}})}catch(r){console.log("Exception in cmdDisplayDeleteUnsubmittedBudgetRequestDialog(): "+r.message+", "+r.stack);displayAlertDialog("Exception in cmdDisplayDeleteUnsubmittedBudgetRequestDialog(): "+r.message)}},displayListOfRequestsStoredInIndexDb:function(){var n,t;try{n=this;$("#divOfflineRequestsList").empty();t=n.options.indexDBVersion>0?n.options.indexedDBInstance.open(n.options.indexDBName,n.options.indexDBVersion):n.options.indexedDBInstance.open(n.options.indexDBName);t.onerror=function(n){console.log('In my.js.displayListOfRequestsStoredInIndexDb(). Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};t.onsuccess=function(n){var t,r,i;console.log('In my.js.displayListOfRequestsStoredInIndexDb(). Success accessing database "'+n.target.result.name+'".');t=n.target.result;try{r=t.transaction("objectStoreCachedRequests","readonly");i=r.objectStore("objectStoreCachedRequests").count()}catch(u){console.log("In displayListOfRequestsStoredInIndexDb(): XXXXXXXXXXXerror: "+u.message)}i.onsuccess=function(n){var r=n.target.result,i,u;i=r==1?"<span style=\"font-family:'Courier New';font-size:30pt;\"><a onclick=\"$('.bwRequest').bwRequest('cmdDisplayClientRequestsNotYetSubmittedDialog');\">You have "+r+" un-submitted request saved on this device.<\/a><\/span>":r>1?"<span style=\"font-family:'Courier New';font-size:30pt;\"><a onclick=\"$('.bwRequest').bwRequest('cmdDisplayClientRequestsNotYetSubmittedDialog');\">You have "+r+" un-submitted requests saved on this device.<\/a><\/span>":"<span style=\"font-family:'Courier New';font-size:30pt;\">You have no un-submitted requests saved on this device.<\/span>";r>0?(console.log("If this device runs low on storage, your web browser may delete them without asking you."),i+="<br />",i+="If this device runs low on storage, your web browser may delete them without asking you.",i+="<br />",i+="<table>",u=t.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),u.openCursor().onsuccess=function(n){var t,u;try{t=n.target.result;t?(u="",console.log("Retrieved request: "+t.value.ProjectTitle+": "+t.value.bwBudgetRequestId),i+="  <tr>",i+="    <td style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:14pt;\"><a onclick=\"$('.bwRequest').bwRequest('displayForm_DisplayCachedAr', '"+t.value.bwBudgetRequestId+"');\">"+t.value.ProjectTitle+"<\/a><\/td>",i+="    <td style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:14pt;\">xxts<\/td>",i+="    <td>",i+="      <img src=\"images/trash-can.png\" onclick=\"$('.bwRequest').bwRequest('cmdDisplayDeleteUnsubmittedBudgetRequestDialog', '"+t.value.bwBudgetRequestId+"', '"+t.value.ProjectTitle+'\');" title="Delete" style="cursor:pointer;" />',i+="    <\/td>",i+="  <\/tr>",t.continue()):(console.log("DONE LOOPING, so rendering."),i+='<tr><td colspan="12"><\/td><\/tr>',i+="<\/table>",$("#divOfflineRequestsList").append(i))}catch(r){console.log("xxyyyfgError: "+r.message+", "+r.stack)}}):$("#divOfflineRequestsList").append(i)};i.onerror=function(){console.error("In my.js.displayListOfRequestsStoredInIndexDb(). add error",this.error)}}}catch(i){console.log("In my.js.displayListOfRequestsStoredInIndexDb(). FAILED TO OPEN A TRANSACTION to the database..."+i.message+", "+i.stack)}},cmdDisplayConfirmFileUploadOfflineDialog:function(n,t,i){try{console.log("In bwRequest.js.cmdDisplayConfirmFileUploadOfflineDialog("+n+", "+t+", "+i+").");document.getElementById("txtConfirmFileUploadOfflineDialogFilename").value="";$("#txtConfirmFileUploadOfflineDialogFileDescription").empty();$("#divConfirmFileUploadOfflineDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"",width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divConfirmFileUploadOfflineDialog").dialog("close")})}});$("#divConfirmFileUploadOfflineDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("spanConfirmFileUploadOfflineDialogUploadTheFileNowButton").innerHTML="<button title=\"Click here to upload the attachment.\" class=\"BwButton\" onclick=\"$('.bwRequest').bwRequest('ProcessOfflineUpload', '"+n+"', '"+t+"', '"+i+"');\">Upload<\/button>";document.getElementById("spanConfirmFileUploadOfflineDialogCancelButton").innerHTML='<button title="" class="BwButton" onclick="$(\'#divConfirmFileUploadOfflineDialog\').dialog(\'close\');">Cancel<\/button>'}catch(r){console.log("Error in bwRequest.js.cmdDisplayConfirmFileUploadOfflineDialog("+n+", "+t+", "+i+"): "+r.message+", "+r.stack);this.displayAlertDialog("Error in bwRequest.js.cmdDisplayConfirmFileUploadOfflineDialog("+n+", "+t+", "+i+"): "+r.message+", "+r.stack)}},uploadAttachmentOffline:function(n,t){var i,u,f;console.log("In uploadAttachmentOffline("+n+", "+t+").1");try{try{i=document.getElementById("OfflineRequestBudgetRequestIdInXslForm").innerHTML}catch(r){i=document.getElementById("OfflineRequestBudgetRequestId").innerHTML}console.log("In bwRequest.js.uploadAttachmentOffline("+n+", "+t+"). Preparing to upload file for _budgetRequestId: "+i);u=document.getElementById(t);f=u.files[0];f.size>1e8?(displayAlertDialog("Currently the system does not allow files over 100MB. Calling clone."),$("#"+t).replaceWith($("#"+t).clone())):this.cmdDisplayConfirmFileUploadOfflineDialog(n,t,i)}catch(r){console.log("Exception in uploadAttachmentOffline("+n+", "+t+"): "+r.message+", "+r.stack);this.displayAlertDialog("Exception in uploadAttachmentOffline("+n+", "+t+"): "+r.message)}},populateOfflineAttachments:function(n){var t,i;try{console.log("In bwRequest.js.populateOfflineAttachments("+n+"). Rendering the list of files.");t=this;$("#"+n).empty();i=t.options.indexDBVersion>0?t.options.indexedDBInstance.open(t.options.indexDBName,t.options.indexDBVersion):t.options.indexedDBInstance.open(t.options.indexDBName);i.onblocked=function(t){console.log("In bwRequest.js.populateOfflineAttachments("+n+"): indexDB BLOCKED1. errorCode: "+t.target.errorCode);displayAlertDialog("In bwRequest.js.populateOfflineAttachments("+n+"): indexDB BLOCKED1. errorCode: "+t.target.errorCode)};i.onerror=function(t){console.log("In bwRequest.js.populateOfflineAttachments("+n+'): Error accessing database "'+t.target.result.name+'". errorCode: '+t.target.errorCode);displayAlertDialog("In bwRequest.js.populateOfflineAttachments("+n+'): Error accessing database "'+t.target.result.name+'". errorCode: '+t.target.errorCode)};i.onsuccess=function(t){var i,u,r;console.log("In bwRequest.js.populateOfflineAttachments("+n+'): Success accessing database "'+t.target.result.name+'".');i=t.target.result;i.onerror=function(t){console.log("In bwRequest.js.populateOfflineAttachments("+n+'). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+t.target.result.name+'". errorCode: '+t.target.errorCode);displayAlertDialog("In bwRequest.js.populateOfflineAttachments("+n+'). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+t.target.result.name+'". errorCode: '+t.target.errorCode)};u=i.transaction("OfflineAttachedFiles","readonly");r=u.objectStore("OfflineAttachedFiles").count();r.onsuccess=function(t){var u,e,f;try{t.target.result==0?$("#"+n)[0].innerHTML="<i>no attachments found<\/i>":(console.log("In populateOfflineAttachments("+n+"). Found "+t.target.result+" files on my device."),u="",u+="<br /><br />",e=t.target.result,f=i.transaction("OfflineAttachedFiles").objectStore("OfflineAttachedFiles"),f.openCursor().onsuccess=function(t){var u,e,l,a,v,b,f,k,h,w,nt,o;try{if(u=t.target.result,u){try{e=document.getElementById("OfflineRequestBudgetRequestIdInXslForm").innerHTML}catch(c){e=document.getElementById("OfflineRequestBudgetRequestId").innerHTML}if(console.log("In populateOfflineAttachments("+n+"): _budgetRequestId: "+e+", cursor.value.bwBudgetRequestId: "+u.value.bwBudgetRequestId),e==u.value.bwBudgetRequestId){console.log("In populateOfflineAttachments("+n+"). Rendering list of attachments for _budgetRequestId: "+e);var i=u.value.fileName,s=u.value.fileDescription,e=u.value.bwBudgetRequestId;if(console.log("In populateOfflineAttachments("+n+"): _budgetRequestId == cursor.value.bwBudgetRequestId"),navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i))if(u.value.encodingType=="uInt8Array")i.toUpperCase().indexOf(".JPG")!=-1||i.toUpperCase().indexOf(".JPEG")?f="image/jpeg":i.toUpperCase().indexOf(".PNG")!=-1?f="image/png":i.toUpperCase().indexOf(".BMP")!=-1?f="image/bmp":i.toUpperCase().indexOf(".GIF")!=-1?f="image/gif":i.toUpperCase().indexOf(".TIFF")!=-1&&(f="image/tiff"),l=new Blob([u.value.fileContents],{type:f});else{for(a=atob(u.value.fileContents),v=new Uint8Array(a.length),o=0,b=a.length;o<b;++o)v[o]=a.charCodeAt(o);i.toUpperCase().indexOf(".JPG")!=-1||i.toUpperCase().indexOf(".JPEG")?f="image/jpeg":i.toUpperCase().indexOf(".PNG")!=-1?f="image/png":i.toUpperCase().indexOf(".BMP")!=-1?f="image/bmp":i.toUpperCase().indexOf(".GIF")!=-1?f="image/gif":i.toUpperCase().indexOf(".TIFF")!=-1&&(f="image/tiff");l=new Blob([v.buffer],{type:f})}else l=u.value.fileContents;k=window.URL||window.webkitURL;h=k.createObjectURL(l);console.log("In populateOfflineAttachments("+n+"): Got fileUrl: "+h);var y=800,p=600,d=(screen.width-y)/2,g=(screen.height-p)/2,r="";r+='<table style="width:100%;">';r+="  <tr>";r+='    <td style="width:10%;">';(i.toLowerCase().indexOf(".png")>-1||i.toLowerCase().indexOf(".jpg")>-1||i.toLowerCase().indexOf(".jpeg")>-1||i.toLowerCase().indexOf(".jfif")>-1||i.toLowerCase().indexOf(".webp")>-1)&&(r+='<img src="'+h+'" style="height:120px;display:block;margin-left:auto;margin-right:auto;cursor:pointer;" alt="" ',r+=w=="IOS8"?"onclick=\"displayAttachmentInDialogOffline2('"+i+"', '"+s+"', '"+e+"', '"+n+"');\"":"onclick=\"window.open('"+h+"', 'window1', 'width="+y+", height="+p+", top="+g+", left="+d+", resizable=yes');return false;\"",r+=" />");r+="    <\/td>";r+='    <td style="width:90%;">';w="IOS8";r+=w=="IOS8"?'<div xcx="xcx21342346-6" class="attachmentsSectionFileLink" onclick="displayAttachmentInDialogOffline2(\''+i+"', '"+s+"', '"+e+"', '"+n+"');\">":'<div xcx="xcx21342346-7" class="attachmentsSectionFileLink" onclick="window.open(\''+h+"', 'window1', 'width="+y+", height="+p+", top="+g+", left="+d+", resizable=yes');return false;\">";r+=i;r+=s.length>0?'&nbsp;&nbsp;<span class="attachmentsSectionDescription"> - "'+s+'"<\/span>':'&nbsp;&nbsp;<span class="attachmentsSectionDescription"> - [no description]'+s+"<\/span>";nt="xx";o=0;r+="<\/div>";r+="    <\/td>";r+="  <\/tr>";r+="<\/table>";r+="<\/br>";console.log("In bwRequest.js.populateOfflineAttachments("+n+"). Preparing to render in attachmentsTagId "+n);$("#"+n).append(r);console.log("In bwRequest.js.populateOfflineAttachments("+n+"). After rendering in attachmentsTagId "+n);try{$("#divFileUploadSpinnerDialog").dialog("close")}catch(c){}}u.continue()}}catch(c){console.log("Exception in bwRequest.js.populateOfflineAttachments("+n+"):8: "+c.message+", "+c.stack);displayAlertDialog("Exception in bwRequest.js.populateOfflineAttachments("+n+"):8: "+c.message+", "+c.stack)}})}catch(r){console.log("Exception in bwRequest.js.populateOfflineAttachments("+n+"):9: "+r.message+", "+r.stack);displayAlertDialog("Exception in bwRequest.js.populateOfflineAttachments("+n+"):9: "+r.message+", "+r.stack)}};r.onerror=function(){console.error("In bwRequest.js.populateOfflineAttachments("+n+").req.onerror: add error",this.error);console.log("In bwRequest.js.populateOfflineAttachments("+n+").req.onerror:10: "+this.error);displayAlertDialog("In bwRequest.js.populateOfflineAttachments("+n+").req.onerror:10: "+this.error)}}}catch(r){console.log("Exception in bwRequest.js.populateOfflineAttachments("+n+"): "+r.message+", "+r.stack);displayAlertDialog("Exception in bwRequest.js.populateOfflineAttachments("+n+"): "+r.message+", "+r.stack)}},ProcessOfflineUpload:function(n,t,i){var r=this,e,u,f;try{console.log("In bw.offline.core.js.ProcessOfflineUpload("+n+", "+i+").");e=document.getElementById(t);u=e.files[0];$("#divConfirmFileUploadOfflineDialog").dialog("close");$("#divFileUploadSpinnerDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!0,width:"970px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divFileUploadSpinnerDialog").dialog("close")})}});$("#divFileUploadSpinnerDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("spanFileUploadSpinnerDialogTitle").innerHTML="Uploading "+u.name+"...";console.log("In bw.offline.core.js.ProcessOfflineUpload("+n+", "+i+"). file.name: "+u.name);f=r.options.indexDBVersion>0?r.options.indexedDBInstance.open(r.options.indexDBName,r.options.indexDBVersion):r.options.indexedDBInstance.open(r.options.indexDBName);f.onblocked=function(n){console.error(n.target);console.log("In bw.offline.core.js.ProcessOfflineUpload().request.onblocked: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In bw.offline.core.js.ProcessOfflineUpload().request.onblocked: "+n.target.error.name||n.target.error||n.target.errorCode)};f.onerror=function(n){console.error(n.target);console.log("In bw.offline.core.js.ProcessOfflineUpload().request.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In bw.offline.core.js.ProcessOfflineUpload().request.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)};f.onsuccess=function(f){var h,p,c,l,a,v,o,y,w,s;try{if(console.log("In ProcessOfflineUpload().request.onsuccess. Success accessing IndexedDB database."),h=f.target.result,h.onerror=function(n){console.error(n.target);console.log("In bw.offline.core.js.ProcessOfflineUpload().db.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In bw.offline.core.js.ProcessOfflineUpload().db.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)},p=u.name,c=document.getElementById("txtConfirmFileUploadOfflineDialogFilename").value.trim()==""?u.name:document.getElementById("txtConfirmFileUploadOfflineDialogFilename").value.trim().split(".")[0]+"."+p.split(".")[1],l=document.getElementById("txtConfirmFileUploadOfflineDialogFileDescription").value.trim(),a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i))console.log("THIS IS THE WORKAROUND FOR THE IOS STORING BLOB IN INDEXDB ISSUE"),v=new FileReader,v.onload=function(f){var y=new Uint8Array(f.target.result),s={encodingType:"uInt8Array",fileContents:y,fileName:c,fileDescription:l,bwBudgetRequestId:i,id:a},v,e;console.log("File size: "+u.size+", dbRecord: "+JSON.stringify(s));try{v=h.transaction("OfflineAttachedFiles","readwrite")}catch(o){console.log("ERROR ACCESSING OfflineAttachedFiles DATABASE11!!!!!!!!!!!!"+o.message+", "+o.stack)}try{e=v.objectStore("OfflineAttachedFiles").add(s)}catch(o){console.log("ERROR ACCESSING OfflineAttachedFiles DATABASE22!!!!!!!!!!!!"+o.message+", "+o.stack)}console.log("In bw.offline.core.js.ProcessOfflineUpload(). Successfully executed var put = transaction.objectStore(OfflineAttachedFiles).add(dbRecord);");e.onsuccess=function(){try{console.log("In bw.offline.core.js.ProcessOfflineUpload(). Successfully stored file in the database. Calling clone.");alert("In bw.offline.core.js.ProcessOfflineUpload(). Successfully stored file in the database. Calling clone.");$("#"+t).replaceWith($("#"+t).clone());r.populateOfflineAttachments(n)}catch(i){displayAlertDialog("Exception in bw.offline.core.js.ProcessOfflineUpload().put.onsuccess: "+i.message+", "+i.stack)}};e.onerror=function(n){console.error(n.target);console.log("In bw.offline.core.js.ProcessOfflineUpload().put.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In bw.offline.core.js.ProcessOfflineUpload().put.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)};e.transaction.oncomplete=function(){console.log("In bw.offline.core.js.ProcessOfflineUpload().put.transaction.oncomplete.")};e.transaction.onerror=function(n){console.log("In bw.offline.core.js.ProcessOfflineUpload().put.transaction.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In bw.offline.core.js.ProcessOfflineUpload().put.transaction.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)}},v.readAsArrayBuffer(u);else{console.log("THIS WORKS FOR BLOB APPROACH. NOT ON IOS.");o="";o+="Todd - I currently think this only works for:<br /><br />";o+="- PNG on Mac (Chrome). Safari needs to be fixed!<br />";o+="- PNG on Windows 10 is Ok (IE and Edge).<br />";o+="- iOS - not working.<br />";o+="- Android - not sure.<br />";o+="- Ubuntu (Firefox) - not sure.<br /><br />";console.log(o);y={encodingType:"blob",fileContents:u,fileName:c,fileDescription:l,bwBudgetRequestId:i,id:a};console.log("File size: "+u.size+", dbRecord: "+JSON.stringify(y));try{w=h.transaction("OfflineAttachedFiles","readwrite")}catch(e){e.message=="NotFoundError"?(console.log("In bw.offline.core.js.ProcessOfflineUpload(). The database has been destroyed by the browser, or did not get created properly in the beginning."),displayAlertDialog("In bw.offline.core.js.ProcessOfflineUpload(). The database has been destroyed by the browser, or did not get created properly in the beginning.")):(console.log("In bw.offline.core.js.ProcessOfflineUpload(). ERROR ACCESSING OfflineAttachedFiles DATABASE33!!!!!!!!!!!!"+e.message+", "+e.stack),displayAlertDialog("In bw.offline.core.js.ProcessOfflineUpload(). ERROR ACCESSING OfflineAttachedFiles DATABASE33!!!!!!!!!!!!"+e.message+", "+e.stack))}try{s=w.objectStore("OfflineAttachedFiles").add(y)}catch(e){console.log("In bw.offline.core.js.ProcessOfflineUpload(). Exception performing add on indexDB: "+e.message+", "+e.stack);displayAlertDialog("In bw.offline.core.js.ProcessOfflineUpload(). Exception performing add on indexDB: "+e.message+", "+e.stack)}console.log("In bw.offline.core.js.ProcessOfflineUpload(). Successfully executed var put = transaction.objectStore(OfflineAttachedFiles).add(dbRecord);");s.onsuccess=function(){console.log("In bw.offline.core.js.ProcessOfflineUpload(). Successfully stored file in the database.");r.populateOfflineAttachments(n)};s.onerror=function(n){console.error(n.target);console.log("In bw.offline.core.js.ProcessOfflineUpload().put.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In bw.offline.core.js.ProcessOfflineUpload().put.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)};s.transaction.oncomplete=function(){console.log("In bw.offline.core.js.ProcessOfflineUpload().put.transaction.oncomplete.")};s.transaction.onerror=function(n){console.log("In bw.offline.core.js.ProcessOfflineUpload().put.transaction.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In bw.offline.core.js.ProcessOfflineUpload().put.transaction.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)}}}catch(e){console.log("Exception in bw.offline.core.js.ProcessOfflineUpload(xxx). indexDBName: "+r.options.indexDBName+", indexDBVersion: "+r.options.indexDBVersion+", error: "+e.message+", "+e.stack);displayAlertDialog("Exception in bw.offline.core.js.ProcessOfflineUpload(xxx). indexDBName: "+r.options.indexDBName+", indexDBVersion: "+r.options.indexDBVersion+", error: "+e.message+", "+e.stack)}}}catch(o){displayAlertDialog("Exception In bw.offline.core.js.ProcessOfflineUpload:7:("+n+", "+i+"): "+o.message+", "+o.stack)}},clearNewBudgetRequestFormFields:function(){try{}catch(n){this.displayAlertDialog("Error in bwRequest.js.clearNewBudgetRequestFormFields().")}},cmdCreateBudgetRequestAndSaveToMyDevice:function(){var n,t;try{this.displayAlertDialog("This functionality is being worked on. It may not work as expected. Click the Cancel button to return to the home page. This functionality is coming soon!");n=this;n.options.indexDBVersion>0?t=n.options.indexedDBInstance.open(n.options.indexDBName,n.options.indexDBVersion):n.options.indexedDBInstance&&(t=n.options.indexedDBInstance.open(n.options.indexDBName));t.onblocked=function(n){console.log("In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onblocked() errorCode: "+n.target.errorCode);displayAlertDialog("In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onblocked() errorCode: "+n.target.errorCode)};t.onerror=function(n){console.log("In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onerror() errorCode: "+n.target.errorCode);displayAlertDialog("In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onerror() errorCode: "+n.target.errorCode)};t.onsuccess=function(t){var c,o,s,u,f,k,h;console.log('In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess() Attempting to access IndexedDB database: "'+t.target.result.name+'".');c=t.target.result;console.log('In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess(). Successfully opened the database "'+t.target.result.name+'".');var r=[],l="",a="",v="",e="";try{o=document.getElementById("OfflineRequestBudgetRequestId").innerHTML;s=!1;try{$("#selectOfflineRequestNewRequestFormRequestTypeDropDown option:selected").val()=="recurringexpense"&&(s=!0)}catch(i){console.log("Exception In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess() while looking up #selectOfflineRequestNewRequestFormRequestTypeDropDown option:selected).val(): "+i.message);displayAlertDialog("Exception In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess() while looking up #selectOfflineRequestNewRequestFormRequestTypeDropDown option:selected).val(): "+i.message)}if(s==!0){var y=document.getElementById("OfflineRequestRecurringExpenseId").innerHTML,d=document.getElementById("dtOfflineRequestRecurringExpenseReminderDate").value,g=document.getElementById("cbOfflineNewRequestRecurringExpenseSubmitImmediately").checked,u=createXmlDocument_InitRecurringExpense(y),f=document.getElementById("strOfflineRequestProjectTitle").value,p=document.getElementById("dblOfflineRequestRequestedCapital").value.replace(/[^0-9-.]/g,""),w=0;r={submitTheFirstRecurringExpenseImmediately:g,bwRecurringExpenseId:y,bwTenantId:l,bwWorkflowAppId:a,bwWorkflowId:null,CreatedBy:"",CreatedById:v,CreatedByEmail:e,ReminderDate:d,bwDocumentXml:u.toString(),ProjectTitle:f.toString(),BudgetAmount:null,RequestedCapital:p,RequestedExpense:w,FunctionalAreaId:null,Quote:"false",ManagerId:null}}else if(u=n.createXmlDocument_InitOfflineAr(o),u=="FAILED")displayAlertDialog("Failed to create XML.");else{try{f=document.getElementById("strProjectTitle").value}catch(i){f=document.getElementById("strProjectTitle").innerHTML}var p=0,w=0,nt=n.getCreatedTimestamp(),tt=n.getDueDateTimestamp(),b=!1;$("#selectOfflineNewRequestFormRequestTypeDropDown option:selected").val()=="quoterequest"&&(b=!0);r={bwBudgetRequestId:o.toString(),bwTenantId:l,bwWorkflowAppId:a,bwWorkflowId:null,IsSupplementalRequest:"false",RelatedBudgetRequestId:null,IsRecurringExpense:"false",RelatedRecurringExpenseId:null,CreatedBy:e,CreatedById:v,CreatedByEmail:e,bwDocumentXml:u.toString(),ProjectTitle:f.toString(),BudgetAmount:null,RequestedCapital:p,RequestedExpense:w,FunctionalAreaId:null,ARStatus:"Submitted",BudgetWorkflowStatus:"Assign Budget",Quote:b,ManagerId:null,bwWorkflowToken:"0"};console.log("In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess(): New request successfully stored in _newRequest variable.");try{k=c.transaction("objectStoreCachedRequests","readwrite")}catch(i){console.log("Exception In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess()2:. FAILED TO OPEN A TRANSACTION to the database..."+i.message+", "+i.stack);displayAlertDialog("Exception In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess()2:. FAILED TO OPEN A TRANSACTION to the database..."+i.message+", "+i.stack)}h=k.objectStore("objectStoreCachedRequests").put(r);h.onsuccess=function(){console.log("In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.put.onsuccess(): Successfully stored _newRequest in the database. "+JSON.stringify(r));$("#divCreateRequestFormDialog").dialog("close");displayAlertDialog("Successfully stored the new request on your device. It will be available to submit when you log in.");n.displayListOfRequestsStoredInIndexDb()};h.onerror=function(){console.log("In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.put.onerror(): Error storing _newRequest in the database. "+this.error);displayAlertDialog("In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.put.onerror(): Error storing _newRequest in the database. "+this.error)};console.log("In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess():. Stored new request in IndexedDB:22.")}}catch(i){console.log("Exception In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess()1: "+i.message+", "+i.stack);displayAlertDialog("Exception In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess()1: "+i.message+", "+i.stack)}}}catch(i){console.log("Exception In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess():3: "+i.message+", "+i.stack);displayAlertDialog("Exception In bwRequest.js.cmdCreateBudgetRequestAndSaveToMyDevice.request.onsuccess():3: "+i.message+", "+i.stack)}},cmdCreateBudgetRequestAndStartWorkflow:function(n){var i,r;try{console.log("In bwRequest.js.cmdCreateBudgetRequestAndStartWorkflow(). bwBudgetRequestId: "+n);i=this;ShowActivitySpinner("Submitting the request...");console.log("Calling bwRequest.js.scrapeBwRequestJson(). xcx1231242-6");r=this.scrapeBwRequestJson(n);r.then(function(t){var r,f,h,k,c,o,l,d,g,nt,a,p,w,tt,v,it,y,u,b,s,ut,e;try{if(console.log("Returning from scrapeBwRequestJson(). xcx2131241-6"),t.status!="SUCCESS")e="Error in cmdCreateBudgetRequestAndStartWorkflow(). "+t.status+", "+t.mesage,displayAlertDialog(e);else if(r=t.bwRequestJson,console.log("In cmdCreateBudgetRequestAndStartWorkflow().scrapeBwRequestJson().bwRequestJson.xcx2: "+JSON.stringify(r,2,null)),r.bwOrgId&&r.bwOrgName){for(h=$("#budgetrequestform"),u=0;u<h.length;u++)if(k=$(h[u])[0].getAttribute("bwbudgetrequestid"),n==k){f=$(h[u])[0];break}if(f){for(c=[],o=$(f).find(".bwwidgetname"),u=0;u<o.length;u++)l=o[u].getAttribute("bwwidgetname"),d=$(o[u])[l]("isARequiredField"),d==!0&&(g=$(o[u])[l]("getData"),g||(nt=$(o[u])[l]("getfieldTitle"),c.push(nt)));if(c.length>0){for(HideActivitySpinner(),a="",a+="Please complete these fields before submitting this request: <br />",u=0;u<c.length;u++)a+='<span style="font-style:italic;">- '+c[u]+"<\/span><br />";displayAlertDialog(a)}else{for(p=!1,r.bwRequestType=="quoterequest"&&(p=!0),w=!1,r.bwRequestType=="expenserequest"&&(w=!0),r.RequestedCapital||(r.RequestedCapital=0),r.ProjectManager&&r.ProjectManager.ParticipantId?tt=r.ProjectManager.ParticipantId:console.log("No bwRequestJson.ProjectManager element found on the form."),v=$(h[u])[0].getAttribute("bwrequesttypeid"),console.log(">>>>>>>>>>>>>> bwRequestTypeId xcx678854: "+v),y=$(".bwAuthentication").bwAuthentication("option","bwEnabledRequestTypes").EnabledItems,u=0;u<y.length;u++)v==y.bwRequestTypeId&&(it=y.Abbreviation);b="";r.ProjectTitle&&r.ProjectTitle.value&&(b=r.ProjectTitle.value);s="";r.RequestedCapital&&r.RequestedCapital.value&&(s=r.RequestedCapital.value,s&&(s=s.replace("$","")));var et=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),rt=$(".bwAuthentication").bwAuthentication("option","participantId"),ot=$(".bwAuthentication").bwAuthentication("option","participantEmail"),st=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),ht=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");_budgetRequest={bwParticipantId_LoggedIn:rt,bwActiveStateIdentifier:ht,bwWorkflowAppId_LoggedIn:et,bwBudgetRequestId:r.bwBudgetRequestId,bwTenantId:r.bwTenantId,bwWorkflowAppId:r.bwWorkflowAppId,bwRequestTypeId:v,bwRequestTypeAbbreviation:it,IsSupplementalRequest:"false",RelatedBudgetRequestId:null,IsRecurringExpense:"false",RelatedRecurringExpenseId:null,CreatedById:rt,CreatedBy:st,CreatedByEmail:ot,bwRequestJson:JSON.stringify(r),ProjectTitle:b,RequestedCapital:s,BudgetAmount:null,OrgId:r.bwOrgId,OrgName:r.bwOrgName,ARStatus:"Submitted",BudgetWorkflowStatus:"Admin",Quote:p,bwBudgetRequestPlaceholder1:w,ManagerId:tt,bwWorkflowToken:"0"};ut=i.options.operationUriPrefix+"_bw/initializebudgetrequest";$.ajax({url:ut,type:"POST",data:_budgetRequest,headers:{Accept:"application/json; odata=verbose"},error:function(n){alert("Error creating the budget request in budgetrequests library. "+JSON.stringify(n));HideActivitySpinner();displayAlertDialog("Error creating the budget request in budgetrequests library. "+JSON.stringify(n))},success:function(n){var o,s,i,t,h,u,c,l,e;try{if(HideActivitySpinner(),n.status=="SUCCESS"||n.status=="COMPLETED"){for(displayAlertDialog_QuickNotice("The request has been submitted"),$(f).find("#startWorkflowButton")[0].setAttribute("disabled","disabled"),$(f).find("#spanRequestForm_Instructions").html("This request has been submitted."),console.log("DEV: fix: 11-7-2023. NOW WE CLEAR THE CACHED NEW REQUEST AND RETURN TO THE HOME SCREEN. xcx2321312-1."),$(".bwAuthentication").bwAuthentication("option","NEW_REQUEST_LastSavedJson",null),i=$(document).find(".budgetrequestform"),t=0;t<i.length;t++)if(h=$(i[t]).attr("bwrequesttitle"),h=="New"){i[t].remove();break}$(".bwActiveMenu").bwActiveMenu("RenderContentForButton",this,"HOME");u=$(".bwCoreComponent").bwCoreComponent("getIndexDbInstance");u.transaction?(l=u.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),l.openCursor().onsuccess=function(n){var t,o,e;try{t=n.target.result;t?(t.value.bwBudgetRequestId==r.bwBudgetRequestId&&(o=u.transaction("objectStoreCachedRequests","readwrite"),e=o.objectStore("objectStoreCachedRequests").delete(t.primaryKey),e.onsuccess=function(){try{console.log("In cmdDisplayDeleteUnsubmittedBudgetRequestDialog.objectStore.openCursor.onsuccess.del.onsuccess(). Successfully deleted request from the database.");var t=$(f).closest(".ui-dialog");$(t).dialog("close");$(".bwActiveMenu").bwActiveMenu("RenderContentForButton","NEW_REQUEST_FORM_CANCEL_BUTTON","HOME")}catch(n){console.log("Exception in my.js.cmdCreateBudgetRequestAndStartWorkflow.objectStore.openCursor.onsuccess.del.onsuccess("+requestId+", "+title+", "+requestedAmount+"): "+n.message+", "+n.stack);displayAlertDialog("Exception in my.js.cmdCreateBudgetRequestAndStartWorkflow.objectStore.openCursor.onsuccess.del.onsuccess("+requestId+", "+title+", "+requestedAmount+"): "+n.message+", "+n.stack)}},e.onerror=function(){console.error("In cmdCreateBudgetRequestAndStartWorkflow.objectStore.openCursor.onsuccess.del.onerror(). Error deleting request from the database.",this.error);displayAlertDialog("In cmdCreateBudgetRequestAndStartWorkflow.objectStore.openCursor.onsuccess.del.onerror(). Error deleting request from the database.",this.error)}),t.continue()):console.log("In my.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog3. DONE LOOPING.")}catch(i){console.log("Exception in my.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog4. xxError: "+i.message+", "+i.stack);displayAlertDialog("Exception in my.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog4. xxError: "+i.message+", "+i.stack)}}):(console.log("In cmdDisplayDeleteUnsubmittedBudgetRequestDialog():xcx1234234: Could not find indexdb..?"),c=$(f).closest(".ui-dialog"),$(c).dialog("close"),$(".bwActiveMenu").bwActiveMenu("RenderContentForButton","NEW_REQUEST_FORM_CANCEL_BUTTON","HOME"))}else console.log("The budget request may not be submitted. This may be a duplicate BudgetRequestIdxcx2. Unexpected response: "+n.status+", "+n.message),n.message?(o=n.message.indexOf("This most likely means this organization does not have a workflow for this request type:"),o>-1?(console.log(""),console.log("**************"),console.log('This means there is no workflow for this request type. We will give the user the option to "Save to their device" right here so it is just 1 button click.'),console.log("**************"),console.log(""),s=n.message.substring(o).split(":")[1].trim(),displayAlertDialog("There is no workflow available for this request type ("+s+').<br /><br />Click the "Save" button to save it now.')):displayAlertDialog("The budget request may not be submitted. Unexpected response: "+n.status+", "+n.message)):displayAlertDialog("The budget request may not be submitted. xcx123142155678990. Unexpected response: results: "+JSON.stringify(n)+", status: "+n.status+", message: "+n.message)}catch(a){HideActivitySpinner();e="Exception in cmdCreateBudgetRequestAndStartWorkflow().scrapeBwRequestJson.initbudgetrequest(): "+a.message+", "+a.stack;console.log(e);displayAlertDialog(e);$(f).find("#spanRequestForm_Error")[0].innerHTML=e}}})}}else HideActivitySpinner(),displayAlertDialog("Error in bwRequest.js.cmdCreateBudgetRequestAndStartWorkflow(). Could not find the request form. xcx1232563 budgetrequestform: "+JSON.stringify(f))}else HideActivitySpinner(),console.log("FATAL ERROR in cmdCreateBudgetRequestAndStartWorkflow(). The organization has not been specified. bwOrgId: "+r.bwOrgId+", bwOrgName: "+r.bwOrgName),displayAlertDialog("FATAL ERROR in cmdCreateBudgetRequestAndStartWorkflow(). The organization has not been specified. bwOrgId: "+r.bwOrgId+", bwOrgName: "+r.bwOrgName+", bwRequestJson: "+JSON.stringify(r))}catch(ft){HideActivitySpinner();e="Exception in cmdCreateBudgetRequestAndStartWorkflow().scrapeBwRequestJson():2-2: "+ft.message+", "+ft.stack;console.log(e);displayAlertDialog(e);$(f).find("#spanRequestForm_Error")[0].innerHTML=e}})}catch(t){HideActivitySpinner();console.log("Exception in bwRequest.js.cmdCreateBudgetRequestAndStartWorkflow(): "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.cmdCreateBudgetRequestAndStartWorkflow(): "+t.message+", "+t.stack)}},scrapeBwRequestJson:function(n){var t=this;return new Promise(function(t,i){var e,y,o,p,tt,l,a,it,d,g,u,ft,r,h,v,c,nt,k,at,f,s;try{if(console.log("In scrapeBwRequestJson("+n+")."),n){for(e={},y=window,window.opener&&(y=window.opener),console.log("In bwRequest.js.scrapeBwRequestJson(). Finding the budgetrequestform."),p=y.document.getElementsByClassName("budgetrequestform"),r=0;r<p.length;r++)if(tt=p[r].getAttribute("bwbudgetrequestid"),n==tt){console.log(">>>>>>> In bwRequest.js.scrapeBwRequestJson(). WE FOUND THE FORM in the main window. bwBudgetRequestId: "+n);o=p[r];break}if(!o&&(l=y.$(".bwAuthentication:first").bwAuthentication("option","poppedOutRequestWindows"),a=!1,l&&l.length))for(r=0;r<l.length;r++)if(n==l[r].bwBudgetRequestId){it=l[r].windowObjectReference.document;o=it.getElementsByClassName("budgetrequestform")[0];a=!0;console.log("In bwRequest.js.scrapeBwRequestJson(). WE FOUND THE FORM in a popped-out window. bwBudgetRequestId: "+n);break}if(o){var et=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),ot=$(".bwAuthentication").bwAuthentication("option","participantId"),st=$(".bwAuthentication").bwAuthentication("option","participantEmail"),ht=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),w=o.getAttribute("bwrequesttypeid"),rt=o.getAttribute("bworgid"),ct=o.getAttribute("bworgname"),lt=o.getAttribute("bwfiscalyear"),ut=o.getAttribute("bwrequesttitle");for(a&&a==!0&&console.log("In bwRequest.js.scrapeBwRequestJson(). WE FOUND THE FORM in a popped-out window. bwRequestTypeId: "+w+", bwOrgId: "+rt),e.bwWorkflowAppId=et,e.Created=new Date,e.CreatedById=ot,e.CreatedByFriendlyName=ht,e.CreatedByEmail=st,e.bwRequestTypeId=w,e.bwFiscalYear=lt,e.bwOrgId=rt,e.bwOrgName=ct,e.bwBudgetRequestId=n,e.Title=ut,g=$(o).find("[bwwidgetname]"),u=[],r=0;r<g.length;r++)ft=g[r].getAttribute("bwwidgetname"),u.push(ft);for(console.log("In bwRequest.js.scrapeBwRequestJson(). Found these form widgets: "+JSON.stringify(u)),a&&a==!0&&console.log("In bwRequest.js.scrapeBwRequestJson(). WE FOUND THE FORM in a popped-out window. Found these form widgets: "+JSON.stringify(u)),r=0;r<u.length;r++)if(h=$(o).find("."+u[r]+":first"),$(h)[u[r]]){try{console.log("xcx23123123-1. In scrapeBwRequestJson(). Calling getData() for "+u[r]+".");v=$(h)[u[r]]("getData")}catch(b){}if(typeof v=="undefined")f="",f+=">>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<",f+=">>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<",f+="Error in bwRequest.js.scrapeBwRequestJson(): This widget has failed / is not instantiated: "+u[r]+", bwRequestTypeId: "+w,f+=">>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<",f+=">>>>>>>>>>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<<<<<<",console.log(f),displayAlertDialog_Persistent("Error in bwRequest.js.scrapeBwRequestJson(): This widget has failed/is not instantiated: "+u[r]+", bwRequestTypeId: "+w);else{c=$(h)[u[r]]("getDataType");nt=!0;switch(c){case"invoice":break;case"currency":break;case"string":break;case"organization_location":break;case"attachments":break;case"spreadsheet":break;case"inventory":break;case"user":break;default:nt=!1}nt==!1?(f='xcx32576656. Unexpected datatype specified for widget "'+u[r]+'". widgetDataType: '+JSON.stringify(c)+", widgetValue: "+JSON.stringify(v)+", bwBudgetRequestId: "+n+", title: "+ut,console.log(f),displayAlertDialog(f),k={value:f,bwDataRequired:$(h)[u[r]]("isARequiredField"),bwDataType:c,tagName:u[r]}):k=c=="invoice"?{value:v,isPaid:$(h)[u[r]]("getIsPaid"),bwDataRequired:$(h)[u[r]]("isARequiredField"),bwDataType:c,tagName:u[r]}:{value:v,bwDataRequired:$(h)[u[r]]("isARequiredField"),bwDataType:c,tagName:u[r]};try{at=JSON.stringify(k);e[u[r]]=k}catch(b){displayAlertDialog("Caught Exception in xcx12123 BAD JSON. This exception has been handlded. formwidget: "+u[r]+", widgetDataType: "+c+". Dev: Add correct widgetDataType code here.? "+b.message+", "+b.stack);e[u[r]]={value:null,tagName:u[r]}}}}else f="12-26-2023. NO LONGER DISPLAYING THIS message to the user. Currently it stubmled on ProjectTitle.js, which I believe has been depracated/removed/renamed. A remnant on the form defiinition. xcx2131245368894",console.log(f),alert(f);s={status:"SUCCESS",message:"SUCCESS",bwRequestJson:e};t(s)}else f="In bwRequest.js.scrapeBwRequestJson(). Could not find the form for bwBudgetRequestId: "+n+". If there is a dialog displayed, going to close it now.... xcx774433.",console.log(f),console.log("In bwRequest.js.scrapeBwRequestJson(). Try to close the dialog..... Just in case... NO!!! xcx8903245 not sure what this is lol!"),d="divRequestFormDialog_"+n,$("#"+d).dialog("option","bwForceClose",!0),$("#"+d).dialog("close"),s={status:"ERROR",message:f},i(s)}else f="Error in scrapeBwRequestJson(). Unexpected value for bwBudgetRequestId: "+n,displayAlertDialog(f),s={status:"ERROR",message:f},i(s)}catch(b){f="Exception in bwRequest.scrapeBwRequestJson(): "+b.message+", "+b.stack;displayAlertDialog(f);s={status:"EXCEPTION",message:f};i(s)}})},viewScrapedBwRequestJson:function(n){var i,r;try{console.log("In viewScrapedBwRequestJson(). bwBudgetRequestId: "+n);i=this;$("#divDisplayJsonDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"760",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divDisplayJsonDialog").dialog("close")})},close:function(){$("#divDisplayJsonDialog").dialog("destroy")}});document.getElementById("spanDisplayJsonDialogTitle").innerHTML="";document.getElementById("spanDisplayJsonDialogContent").innerHTML="";document.getElementById("txtDisplayJsonDialogJSON").innerHTML="";console.log("Calling bwRequest.js.scrapeBwRequestJson(). xcx1231242-7");r=this.scrapeBwRequestJson(n);r.then(function(n){try{alert("Returning from scrapeBwRequestJson(). xcx2131241-7");document.getElementById("spanDisplayJsonDialogTitle").innerHTML="Request JSON";document.getElementById("spanDisplayJsonDialogContent").innerHTML="This is the BwRequestJson (scraped).";var r="";r+=JSON.stringify(n,null,2);document.getElementById("txtDisplayJsonDialogJSON").innerHTML=r;$("#btnRunDiagnostics").off("click").click(function(){i.runJsonDiagnostics()})}catch(t){console.log("Exception in viewScrapedBwRequestJson.scrapeBwRequestJson(): "+t.message+", "+t.stack);document.getElementById("txtDisplayJsonDialogJSON").innerHTML="Exception in viewScrapedBwRequestJson.scrapeBwRequestJson(): "+t.message+", "+t.stack}})}catch(t){console.log("Exception in viewScrapedBwRequestJson(): "+t.message+", "+t.stack);displayAlertDialog("Exception in viewScrapedBwRequestJson(): "+t.message+", "+t.stack)}},viewDatabaseBwRequestJson:function(n){try{console.log("In bwRequest.js.viewDatabaseBwRequestJson(). bwBudgetRequestId: "+n);var r=this,i=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),u=$(".bwAuthentication").bwAuthentication("option","participantId"),f=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),e={bwParticipantId_LoggedIn:u,bwActiveStateIdentifier:f,bwWorkflowAppId_LoggedIn:i,bwWorkflowAppId:i,bwBudgetRequestId:n};$.ajax({url:webserviceurl+"/getsinglebudgetrequest",type:"POST",data:e,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){$(".bwPageScrollingHandler").bwPageScrollingHandler("CloseDialogAndPreventNextWindowScrollEvent",requestDialogId);n.status==401?(console.log('HTTP 401 "Unauthorized".'),console.log('HTTP 401 "Unauthorized".'),console.log("Error in bwRequest.js.viewDatabaseBwRequestJson(). xcx213124-1-1 Unauthorized. Please refresh your browser and log in again. jqXHR.status: "+n.status+", settings: "+t+", errorThrown: "+i),console.log('HTTP 401 "Unauthorized".'),console.log('HTTP 401 "Unauthorized".')):(console.log("Error in bwRequest.js.viewDatabaseBwRequestJson():1: "+t+", "+i+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n)),alert("Error in bwRequest.js.viewDatabaseBwRequestJson():1: "+t+", "+i+" I suspect this may be a service unavailable error but not sure by any means! More investigation needed!"+JSON.stringify(n)))},success:function(n){var i,u;try{n.status!="SUCCESS"?(console.log("Error in bwRequest.js.viewDatabaseBwRequestJson(). "+n.status+", "+n.message),displayAlertDialog("Error in bwRequest.js.viewDatabaseBwRequestJson(). "+n.status+", "+n.message)):($("#divDisplayJsonDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"760",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divDisplayJsonDialog").dialog("close")})},close:function(){$("#divDisplayJsonDialog").dialog("destroy")}}),i=n.results.bwBudgetRequest,i.bwRequestJson=JSON.parse(n.results.bwBudgetRequest.bwRequestJson),document.getElementById("spanDisplayJsonDialogTitle").innerHTML="Request JSON",document.getElementById("spanDisplayJsonDialogContent").innerHTML="This is the BwRequestJson (database).",u="",u+=JSON.stringify(i,null,2),document.getElementById("txtDisplayJsonDialogJSON").innerHTML=u,$("#btnRunDiagnostics").off("click").click(function(){r.runJsonDiagnostics()}))}catch(t){console.log("Exception in bwRequest.js.viewDatabaseBwRequestJson():2: "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.viewDatabaseBwRequestJson():2: "+t.message+", "+t.stack)}}})}catch(t){console.log("Exception in bwRequest.js.viewDatabaseBwRequestJson(): "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.viewDatabaseBwRequestJson(): "+t.message+", "+t.stack)}},viewDatabaseBwRequestJson2:function(n){var i,r;try{console.log("In bwRequest.js.viewDatabaseBwRequestJson2(). bwBudgetRequestId: "+n);i=this;r=webserviceurl+"/bwbudgetrequests/"+n;$.ajax({url:r,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var r,u;try{n.d?($("#divDisplayJsonDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"760",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divDisplayJsonDialog").dialog("close")})},close:function(){$("#divDisplayJsonDialog").dialog("destroy")}}),r=n.d.results[0][0],r?(document.getElementById("spanDisplayJsonDialogTitle").innerHTML="Request JSON",document.getElementById("spanDisplayJsonDialogContent").innerHTML="This is the BwRequest (database).",u="",u+=JSON.stringify(r,null,2),document.getElementById("txtDisplayJsonDialogJSON").innerHTML=u,$("#btnRunDiagnostics").off("click").click(function(){i.runJsonDiagnostics()})):displayAlertDialog("INVALID bwRequest RETURNED. THIS PROCESS CANNOT CONTINUE. xcx4120203-2")):displayAlertDialog("Error in bwRequest.js.viewDatabaseBwRequestJson2(): "+n)}catch(t){console.log("Exception in bwRequest.js.viewDatabaseBwRequestJson2(). "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.viewDatabaseBwRequestJson2(). "+t.message+", "+t.stack)}},error:function(n){var t="Error in bwRequest.js.viewDatabaseBwRequestJson2: "+n.message.value;console.log(t);displayAlertDialog(t)}})}catch(t){console.log("Exception in bwRequest.js.viewDatabaseBwRequestJson2(): "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.viewDatabaseBwRequestJson2(): "+t.message+", "+t.stack)}},viewTaskJsonInDialog:function(n){var u,i,r;try{console.log("In viewTaskJsonInDialog(). bwWorkflowTaskItemId: "+n);u=this;i=$(".bwAuthentication").bwAuthentication("option","workflowAppId");data={bwWorkflowAppId:i,bwWorkflowTaskItemId:n};r=webserviceurl+"/bwworkflow/gettask";$.ajax({url:r,type:"POST",data:data,headers:{Accept:"application/json; odata=verbose"},success:function(n){n.message!="SUCCESS"?displayAlertDialog(JSON.stringify(n.message)):displayAlertDialog(JSON.stringify(n.data))},error:function(n,t,i){displayAlertDialog("Error in bwRequest.js.displayUpdateDailyOverdueTaskNotificationDateDialog().itemizebudgetrequestdependencies  xcx332-3: "+i)}})}catch(t){console.log("Exception in viewTaskJsonInDialog(): "+t.message+", "+t.stack);this.displayAlertDialog("Exception in viewTaskJsonInDialog(): "+t.message+", "+t.stack)}},isNumberGreaterThanZero:function(n){var t=!1,i;return!isNaN(parseFloat(n))&&isFinite(n)?(i=parseFloat(n),t=i<=0?!1:!0):t=!1,t},formatRequestedCapital_InitBudgetRequest:function(){try{var t=this.formatCurrency(document.getElementById("dblRequestedCapital").value);document.getElementById("dblRequestedCapital").value=t}catch(n){console.log("Exception in formatRequestedCapital_InitBudgetRequest(): "+n.message+", "+n.stack)}},validateCapexForm3:function(){var n,r,t,f,e,o,i,s,h;try{if(console.log("In validateCapexForm3()."),n=!0,document.getElementById("strProjectTitle").value==""&&(n=!1,this.displayAlertDialog('Please enter a "Description" before submitting your request.')),r=!0,n&&document.getElementById("strBriefDescriptionOfProject").value==""&&r==!0&&(n=!1,this.displayAlertDialog('Please enter some "Details" before submitting your request.')),n)try{try{t=document.getElementById("dblRequestedCapital").value}catch(u){t=document.getElementById("dblRequestedCapital").innerHTML}console.log("dblRequestedCapital: "+t);t==""?(n=!1,this.displayAlertDialog('Please enter a value for "Requested Amount" before submitting your request.')):(f=t,e=parseFloat(f.replace(/[^0-9-.]/g,"")),this.isNumberGreaterThanZero(e)||(n=!1,this.displayAlertDialog('xPlease enter a value greater than zero for "Requested Amount" before submitting your request.'),document.getElementById("dblRequestedCapital").innerHTML=""))}catch(u){n=!1;this.displayAlertDialog('Please enter a value for "Requested Amount" before submitting your request.')}if(o="Project Manager",n){try{i=document.getElementById("txtProjectManagerName").value}catch(u){i=document.getElementById("txtProjectManagerName").innerHTML}console.log("projectManagerName: "+i);i==""&&(n=!1,this.displayAlertDialog('Please select a "'+o+'" before submitting your request.'))}if(n)try{document.getElementById("selectFiscalYear").innerHTML==""&&(n=!1,this.displayAlertDialog('Please select a "Year" before submitting your request.'))}catch(u){n=!1;console.log('Exception trying to retrieve Year value from "selectFiscalYear".')}if(n)try{document.getElementById("ddlFunctionalArea").selectedIndex==0&&(n=!1,this.displayAlertDialog('Please select a "Financial Area" before submitting your request.'))}catch(u){n=!1;console.log('Exception trying to retrieve Functional Area value from "ddlFunctionalArea".')}return s=document.getElementById("txtLocationPickerFilter").getAttribute("bwOrgId"),h=document.getElementById("txtLocationPickerFilter").value,n}catch(u){return console.log("Exception in validateCapexForm2(): "+u.message+", "+u.stack),!1}},formatCurrency:function(n){var t="",u,r,i;switch("Dollar"){case"Dollar":t="$";break;case"Pound":t="";break;case"Euro":t="";break;case"Rand":t="R";break;case"Franc":t="";break;case"Yen":t="";break;case"Rouble":t="";break;case"Peso":t="";break;case"Rupee":t="";break;case"Guilder":t="";break;default:t="$"}if(n){for(n=n.toString().replace(/\$|\,/g,""),n=n.toString().replace(/\|\,/g,""),n=n.toString().replace(/\|\,/g,""),n=n.toString().replace(/\R|\,/g,""),n=n.toString().replace(/\|\,/g,""),n=n.toString().replace(/\|\,/g,""),n=n.toString().replace(/\|\,/g,""),n=n.toString().replace(/\|\,/g,""),n=n.toString().replace(/\|\,/g,""),n=n.toString().replace(/\|\,/g,""),isNaN(n)&&(n="0"),u=n==(n=Math.abs(n)),n=Math.floor(n*100+.50000000001),r=n%100,n=Math.floor(n/100).toString(),r<10&&(r="0"+r),i=0;i<Math.floor((n.length-(1+i))/3);i++)n=n.substring(0,n.length-(4*i+3))+","+n.substring(n.length-(4*i+3));return(u?"":"-")+t+n+"."+r}return t+"0.00"},displayCreateRequestFormDialog:function(){try{console.log("In displayCreateRequestFormDialog().");alert("In displayCreateRequestFormDialog().");participantId?($("#divCreateRequestFormDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divCreateRequestFormDialog").dialog("close")})}}),$("#divCreateRequestFormDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),this.renderCreateRequestFullFormOnline(),this.renderNewRequestForm()):($("#divCreateRequestFormDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divCreateRequestFormDialog").dialog("close")})}}),$("#divCreateRequestFormDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),this.renderCreateRequestFullFormOffline(),this.renderNewRequestForm())}catch(n){console.log("Exception in displayCreateRequestFormDialog: "+n.message+", "+n.stack)}},undoLocationChange:function(n,t,i){var e,u,r;try{for(console.log("In bwRequest.js.undoLocationChange. bwBudgetRequestId: "+n+", originalOrgId: "+t+", originalOrgName: "+i),u=$(".budgetrequestform"),r=0;r<u.length;r++)u[r].getAttribute("bwbudgetrequestid")==n&&(console.log("In bwRequest.js.undoLocationChange(). FOUND THE FORM"),e=u[r]);e?($(e).find(".bwLocationPicker").bwLocationPicker("selectLocation",t,i),$("#bwRequest_REFUSED_SAVE_CHANGED_ORGID_dialog").dialog("close")):(console.log("Error in bwRequest.js.undoLocationChange(). NO FORM FOUND for bwBudgetRequestId: "+n),displayAlertDialog("Error in bwRequest.js.undoLocationChange(). NO FORM FOUND for bwBudgetRequestId: "+n))}catch(f){console.log("Exception in bwRequest.js.undoLocationChange: "+f.message+", "+f.stack);displayAlertDialog("Exception in bwRequest.js.undoLocationChange: "+f.message+", "+f.stack)}},displayOneTimeReminder:function(n){try{console.log("In bwRequest.js.displayOneTimeReminder().");displayAlertDialog("This Request has an UPCOMING REMINDER. [Show details here... xMon May 6, 2:45pmx Hover for executive summary... In bwRequest.js.displayOneTimeReminder().")}catch(n){console.log("Exception in bwRequest.js.displayOneTimeReminder: "+n.message+", "+n.stack);displayAlertDialog("Exception in bwRequest.js.displayOneTimeReminder: "+n.message+", "+n.stack)}},saveAndPublishTheRequest:function(n,t,i,r){var u,f,o;try{return ShowActivitySpinner("Saving the request..."),console.log("In bwRequest.js.saveAndPublishTheRequest(). Publish so that everyone sees the latest updates to the request."),u=this,new Promise(function(f,e){var l,o,v;try{var y=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),s=$(".bwAuthentication").bwAuthentication("option","participantId"),h=$(".bwAuthentication").bwAuthentication("option","participantEmail"),c=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName");i||(i=$("#"+n).find(".budgetrequestform")[0].getAttribute("bwbudgetrequestid"));console.log("Calling bwRequest.js.scrapeBwRequestJson(). xcx1231242-8");l=u.scrapeBwRequestJson(i);l.then(function(o){var l,p,w,a,v;try{o.status!="SUCCESS"?(a="Error in saveAndPublishTheRequest.scrapeBwRequestJson(). "+o.status+", "+o.message,v={status:"ERROR",message:a},e(v)):(l=o.bwRequestJson,bwBudgetRequest={bwWorkflowAppId:y,bwBudgetRequestId:i,ModifiedById:s,ModifiedByEmail:h,ModifiedByFriendlyName:c,bwRequestJson:JSON.stringify(l),BudgetAmount:null,bwRequestTypeId:r},l.bwLocationPicker&&l.bwLocationPicker.value&&l.bwLocationPicker.value.bwOrgId&&(bwBudgetRequest.OrgId=l.bwLocationPicker.value.bwOrgId),l.bwLocationPicker&&l.bwLocationPicker.value&&l.bwLocationPicker.value.bwOrgName&&(bwBudgetRequest.OrgName=l.bwLocationPicker.value.bwOrgName),l.ProjectTitle&&l.ProjectTitle.value&&(bwBudgetRequest.ProjectTitle=l.ProjectTitle.value),l.bwRequestedCapitalField&&l.bwRequestedCapitalField.value&&(bwBudgetRequest.RequestedCapital=l.bwRequestedCapitalField.value),l.RequestedExpense&&(bwBudgetRequest.RequestedExpense=l.RequestedExpense.value),l.ProjectManager&&(bwBudgetRequest.ManagerId=l.ProjectManager.ParticipantId,bwBudgetRequest.ManagerEmail=l.ProjectManager.ParticipantEmail,bwBudgetRequest.ManagerFriendlyName=l.ProjectManager.ParticipantFriendlyName),l.ModifiedById=s,l.ModifiedByFriendlyName=c,l.ModifiedByEmail=h,l.Modified=new Date,p=JSON.parse(JSON.stringify(o.bwRequestJson)),console.log("In saveAndPublishTheRequest(). bwRequestJson was returned."),console.log("In bwRequest.js.saveAndPublishTheRequest(). Saving bwRequestJson, getting ready to call /bwbudgetrequests/saveAndPublishTheRequest(): "+JSON.stringify(l)),w=u.options.operationUriPrefix+"_bw/bwbudgetrequests/saveAndPublishTheRequest",$.ajax({url:w,type:"POST",data:bwBudgetRequest,headers:{Accept:"application/json; odata=verbose"},success:function(n){var a,l,h,c,o,s;try{if(console.log("xcx211232 xcx231333 results: "+JSON.stringify(n)),HideActivitySpinner(),n.status=="SUCCESS"){for(o="<br />The request has been saved/published<br /><br />",t=="true"&&displayAlertDialog_QuickNotice(o,200),console.log("DEV: fix: 11-7-2023. NOW WE CLEAR THE CACHED NEW REQUEST AND RETURN TO THE HOME SCREEN. xcx2321312-2."),console.log("In bwRequest.js.saveAndPublishTheRequest(). Calling bwAuthentication.js.redrawSingleExecutiveSummary()."),$(".bwAuthentication").bwAuthentication("redrawSingleExecutiveSummary",i,bwBudgetRequest),a=-1,l=0;l<u.options.lastSavedJson.length;l++)if(u.options.lastSavedJson[l].bwBudgetRequestId==i){a=l;break}a>-1?u.options.lastSavedJson[a]=p:u.options.lastSavedJson.push(p);console.log('In bwRequest.js.saveAndPublishTheRequest(). Successfully added bwRequestJson to thiz.options.lastSavedJson for our "You have changes that need to be saved" check.');s={status:"SUCCESS",message:o};f(s)}else n.status=="REFUSED_SAVE_CHANGED_ORGID"?(alert('results.status == "REFUSED_SAVE_CHANGED_ORGID" xcx213123'),n.results&&n.results.changedRoleAssignments?(h="bwRequest_REFUSED_SAVE_CHANGED_ORGID_dialog",c=document.getElementById(h),c||(c=document.createElement("div"),c.id=h,document.body.appendChild(c)),$("#"+h).dialog({modal:!0,resizable:!0,closeOnEscape:!0,width:"900px",hide:!1,position:{my:"middle top+12",at:"middle top","of":window},close:function(){console.log("In xcx1234647(). Dialog "+h+"is being closed.")},open:function(){var t,u,e,f;try{for(console.log("xcx2134234124 bwRequest_REFUSED_SAVE_CHANGED_ORGID_dialog bwRequestTypeId: "+r),t="",t+="<table style=\"width:100%;\" onclick=\"$('.bwRequest').bwRequest('pinRequestDialog');\">",t+="   <tr>",t+='       <td style="width:95%;">',t+="       <\/td>",t+="       <td>",t+="           <span class=\"dialogXButton\" style=\"font-size:25pt;cursor:pointer;width:100%;font-weight:bold;\" onclick=\"$('.bwPageScrollingHandler').bwPageScrollingHandler('CloseDialogAndPreventNextWindowScrollEvent', '"+h.replace("_Parent","")+"');\">X<\/span>",t+="       <\/td>",t+="   <\/tr>",t+="<\/table>",c.parentNode.querySelector(".ui-dialog-titlebar").innerHTML=t,t="",t+="<span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;font-weight:bold;\">",t+='The location has been changed from "'+n.results.originalOrgName+'" to "'+n.results.newOrgName+'".',t+="<\/span>",t+="<br /><br />",t+="These people will no longer participate in the workflow:",t+="<ul>",u=0;u<n.results.changedRoleAssignments.removedRoleAssignments.length;u++)t+='<li style="color:red;">',t+='<span style="color:black;">',t+="<span style=\"color:purple;font-weight:bold;cursor:pointer;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+n.results.changedRoleAssignments.removedRoleAssignments[u].ParticipantId+"', '"+n.results.changedRoleAssignments.removedRoleAssignments[u].ParticipantFriendlyName+"', '"+n.results.changedRoleAssignments.removedRoleAssignments[u].ParticipantEmail+"', 'undefined');\">",t+=n.results.changedRoleAssignments.removedRoleAssignments[u].ParticipantFriendlyName,t+="<\/span>",t+=" - "+n.results.changedRoleAssignments.removedRoleAssignments[u].RoleName+" ("+n.results.changedRoleAssignments.removedRoleAssignments[u].RoleId+")<\/span>",t+='<span style="color:black;padding-left:50px;"><input id="xcx234256" type="checkbox" checked="checked" />&nbsp;Notify<\/span>',t+="<\/li>";for(t+="<\/ul>",t+="<br />",t+="These people will be added:",t+="<ul>",u=0;u<n.results.changedRoleAssignments.addedRoleAssignments.length;u++)t+='<li style="color:red;">',t+='<span style="color:black;">',t+="<span style=\"color:purple;font-weight:bold;cursor:pointer;\" onclick=\"$('.bwCircleDialog2').bwCircleDialog2('displayParticipantRoleMultiPickerInACircle', true, '', '"+n.results.changedRoleAssignments.addedRoleAssignments[u].ParticipantId+"', '"+n.results.changedRoleAssignments.addedRoleAssignments[u].ParticipantFriendlyName+"', '"+n.results.changedRoleAssignments.addedRoleAssignments[u].ParticipantEmail+"', 'undefined');\">",t+=n.results.changedRoleAssignments.addedRoleAssignments[u].ParticipantFriendlyName,t+="<\/span>",t+=" - "+n.results.changedRoleAssignments.addedRoleAssignments[u].RoleName+" ("+n.results.changedRoleAssignments.addedRoleAssignments[u].RoleId+")<\/span>",t+='<span style="color:black;padding-left:50px;"><input id="xcx234256" type="checkbox" checked="checked" />&nbsp;Notify<\/span>',t+="<\/li>";t+="<\/ul>";t+="<br />";t+='<hr /><div id="divBwOrganizationViewer"><\/div><hr />';t+="<br />";t+="<br />";t+="<br />";t+='<div class="divSignInButton" style="width:90%;text-align:center;line-height:0.8em;font-weight:bold;cursor:pointer;" onclick="alert(\'This functionality is incomplete. xcx21342425.\');">';t+="   Update Request and Notify Selected Participants";t+="<\/div>";t+="<br />";t+="<hr />";t+="<br /><br />";t+="<div class=\"divSignInButton\" style=\"width:90%;text-align:center;line-height:0.8em;font-weight:bold;cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('undoLocationChange', '"+i+"', '"+n.results.originalOrgId+"', '"+n.results.originalOrgName+"');\">";t+="   Undo Location Change";t+="<\/div>";t+="<br /><br />";t+='<div class="divSignInButton" style="width:90%;text-align:center;line-height:0.8em;font-weight:bold;cursor:pointer;" onclick="$(\'#'+h+"').dialog('close');\">";t+="   Close";t+="<\/div>";t+="<br /><br />";c.innerHTML=t;e={RoleAssignments:n.results,displayWorkflowPicker:!0};$("#divBwOrganizationViewer").bwOrganizationViewer(e)}catch(o){f="Exception in bwRequest.js.saveAndPublishTheRequest(): "+o.message+", "+o.stack;console.log(f);displayAlertDialog(f)}}}),o="The budget request may not be saved/published. "+n.message,s={status:"REFUSED_SAVE_CHANGED_ORGID",message:o},f(s)):(o="Error in bwRequest.js.saveAndPublishTheRequest(). results.status: REFUSED_SAVE_CHANGED_ORGID. Unexpected null value for changedRoleAssignments. xcx123235.",console.log(o),displayAlertDialog(o),s={status:"ERROR",message:o},f(s))):(o="Error in bwRequest.js.saveAndPublishTheRequest(). The budget request may not be saved/published. Unexpected response: "+n.status+": "+n.message,console.log(o),displayAlertDialog(o),s={status:"ERROR",message:o},f(s))}catch(v){HideActivitySpinner();o="Exception in saveAndPublishTheRequest().saveAndPublishTheRequest(): "+v.message+", "+v.stack;console.log(o);displayAlertDialog(o);s={status:"EXCEPTION",message:o};e(s)}},error:function(){var n,t;HideActivitySpinner();n="Error saving/publishing the budget request in budgetrequests library. "+JSON.stringify(o.message);displayAlertDialog(n);t={status:"ERROR",message:n};e(t)}}))}catch(b){HideActivitySpinner();a="Exception in saveAndPublishTheRequest():3: "+b.message+", "+b.stack;console.log(a);displayAlertDialog(a);$("#"+n).find("#spanRequestForm_Error")[0].innerHTML=a;v={status:"EXCEPTION",message:a};e(v)}}).catch(function(t){var i,r;HideActivitySpinner();i="Exception in saveAndPublishTheRequest():2: "+JSON.stringify(t);displayAlertDialog(i);$("#"+n).find("#spanRequestForm_Error")[0].innerHTML=i;r={status:"EXCEPTION",message:i};e(r)})}catch(a){HideActivitySpinner();o="Exception in saveAndPublishTheRequest():1: requestDialogId: "+n+", "+a.message+", "+a.stack;console.log(o);displayAlertDialog(o);v={status:"EXCEPTION",message:o};e(v)}})}catch(e){HideActivitySpinner();f="Exception in saveAndPublishTheRequest(): "+e.message+", "+e.stack;console.log(f);displayAlertDialog(f);$("#"+n).find("#spanRequestForm_Error")[0].innerHTML=f;o={status:"EXCEPTION",message:f};reject(o)}},successfulTaskCompletion_AlertDialog_Close:function(n,t){var r,i,u,e,o;try{if(console.log("In successfulTaskCompletion_AlertDialog_Close()."),n&&t){if($("#divSuccessfulTaskCompletion_AlertDialog").dialog("close"),r=window,window.opener&&(r=window.opener),i=r.$(".budgetrequestform"),i&&i.length&&i.length>0)for(u=0;u<i.length;u++)e=r.$(i[u]).attr("bwbudgetrequestid"),o=r.$(i[u]).attr("bwworkflowtaskitemid"),n==e&&t==o&&$("#divRequestFormDialog_"+n).dialog("close")}else $("#divSuccessfulTaskCompletion_AlertDialog").dialog("close")}catch(f){console.log("Exception in successfulTaskCompletion_AlertDialog_Close(): "+f.message+", "+f.stack);displayAlertDialog("Exception in successfulTaskCompletion_AlertDialog_Close(): "+f.message+", "+f.stack)}},displaySuccessfulTaskCompletion_AlertDialog:function(n,t,i){var f,u,r;try{console.log("In displaySuccessfulTaskCompletion_AlertDialog().");f="divSuccessfulTaskCompletion_AlertDialog";u=document.getElementById(f);u||(u=document.createElement("div"),u.id=f,u.style.display="none",document.body.appendChild(u));r="";r+='<div id="divSuccessfulTaskCompletion_AlertDialog_MessageContent" style="font-size:40pt;"><\/div>';r+="<br /><br />";r+="<br />";r+="<div class=\"divDialogButton\" onclick=\"$('.bwRequest').bwRequest('successfulTaskCompletion_AlertDialog_Close', '"+t+"', '"+i+"');\">";r+="    Close the request";r+="<\/div>";r+="<br />";r+="<div class=\"divDialogButton\" onclick=\"$('.bwRequest').bwRequest('successfulTaskCompletion_AlertDialog_Close');\">";r+="    Keep the request open";r+="<\/div>";r+="<br /><br />";u.innerHTML=r;$("#"+f).dialog({modal:!0,resizable:!1,closeOnEscape:!0,width:"720",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#"+f).dialog("close")})}});$("#"+f).dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("divSuccessfulTaskCompletion_AlertDialog_MessageContent").innerHTML=n}catch(e){console.log("Exception in displaySuccessfulTaskCompletion_AlertDialog(): "+e.message+", "+e.stack);displayAlertDialog("Exception in displaySuccessfulTaskCompletion_AlertDialog(): "+e.message+", "+e.stack)}},cmdApproveRequest:function(n,t,i,r,u){var f,o,s,e;try{ShowActivitySpinner("Approving the request...");console.log("In bwRequest.js.cmdApproveRequest(). Approve the request and submit comments.");f=this;n?(o=$(n).closest(".ui-dialog")[0].id,s=this.saveAndPublishTheRequest(o),s.then(function(){var v,w,a;try{t&&(v='SYSTEM MESSSAGE: ADMIN "'+l+'" ('+c+') has approved this request on behalf of the "'+t+'" ('+i+') in workflow step "'+u+'" ('+r+").");var y=$(".bwAuthentication").bwAuthentication("option","tenantId"),s=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),h=$(".bwAuthentication").bwAuthentication("option","participantId"),c=$(".bwAuthentication").bwAuthentication("option","participantEmail"),l=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),p=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),e=$(n).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),o=$(n).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid");o&&o!="undefined"||(alert("In bwRequest.js.cmdApproveRequest(). Invaid value for bwWorkflowTaskItemId: "+o),displayAlertDialog("In bwRequest.js.cmdApproveRequest(). Invaid value for bwWorkflowTaskItemId: "+o));console.log("In cmdApproveRequest(). bwBudgetRequestId: "+e+", tenantId: "+y+", workflowAppId: "+s);w={bwParticipantId_LoggedIn:h,bwActiveStateIdentifier:p,bwWorkflowAppId_LoggedIn:s,bwWorkflowAppId:s,bwBudgetRequestId:e};alert("In ??(). xcx12325-3. Calling /workflowconfiguration5().");$.ajax({url:f.options.operationUriPrefix+"_bw/workflowconfiguration5",type:"POST",data:w,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){console.log("xcx23123-3 Error in bwRequest.js.displayRequestForm(): "+t+" "+i);displayAlertDialog("xcx23123-3 Error in bwRequest.js.displayRequestForm(): "+t+" "+i)},success:function(n){var it,g,b,t,ot,rt,i,st,d,u;try{if(n.Workflow.length==0)HideActivitySpinner(),u="ERROR: Cannot locate workflowxcx9 for bwBudgetRequestId: "+e,console.log(u),displayAlertDialog(u);else{var a=JSON.parse(n.Workflow[0].bwWorkflowJson),nt="divRequestFormDialog_"+e,ut=$("#"+nt).find("#budgetrequestform")[0].getAttribute("bwworkflowstatus_bwworkflowstepname",ut),w=null;for(t=0;t<a.Steps.Step.length;t++)if(r=a.Steps.Step[t]["@Name"],r==ut){w=t;break}var ft=$("#"+nt).find("#selectedRaciRole")[0].value,et=$("#"+nt).find("#ReviewerComments")[0].innerHTML.replace("<br>","").trim(),tt=!1,k=!1;for(i=0;i<a.Steps.Step[w].Assign.length;i++)if(a.Steps.Step[w].Assign[i]["@Role"]==ft)for(it=a.Steps.Step[w].Assign[i],g=it["@Cond"],g&&g.indexOf("$ChecklistsRequired~")>-1&&(k=!0),t=0;t<a.Steps.Step[w].Assign[i].Action.length;t++)a.Steps.Step[w].Assign[i].Action[t]["@Name"]=="Approve"&&a.Steps.Step[w].Assign[i].Action[t]["@RequireComments"]&&(tt=Boolean(a.Steps.Step[w].Assign[i].Action[t]["@RequireComments"].toLowerCase()));if(k==!0)if(g=it["@Cond"],b=g.split("$ChecklistsRequired~")[1].split("&")[0].split(","),f.options.store.Checklists){for(t=0;t<f.options.store.Checklists.length;t++)if(ot=JSON.parse(f.options.store.Checklists[t]),rt=ot.bwChecklistTemplatesId,b.indexOf(rt)>-1)for(i=0;i<b.length;i++)st=b.indexOf(rt),b.splice(st,1);b.length==0&&(k=!1)}else k=!1;if(d=!0,tt==!0&&et.length==0?(d=!1,alert("COMMENTS ARE REQUIRED BEFORE YOU CAN APPROVE.XCX395")):k==!0?(d=!1,alert(b.length+" checklists are required before you approve and complete this step. They may not all be yours...xcx396.")):tt==!0&&k==!0&&(d=!1,alert("COMMENTS AND CHECKLIST(S) ARE REQUIRED BEFORE YOU CAN APPROVE.XCX397")),d!=!0)HideActivitySpinner(),u="Error in bwRequest.js.cmdApproveRequest(). Invalid value for isValid: "+d,console.log(u),displayAlertDialog(u);else{var at=getCreatedTimestamp(),vt=getDueDateTimestamp(),ct={bwParticipantId_LoggedIn:h,bwActiveStateIdentifier:p,bwWorkflowAppId_LoggedIn:s,bwBudgetRequestId:e,bwTenantId:y,bwWorkflowAppId:s,bwWorkflowTaskItemId:o,ModifiedByFriendlyName:l,ModifiedById:h,ModifiedByEmail:c,CurrentOwner:h,bwAssignedTo:c,bwAssignedToId:h,participantFriendlyName:l,selectedRoleId:ft,reviewerComments:et,systemMessage:v},lt=f.options.operationUriPrefix+"_bw/bwbudgetrequests/approverequest";$.ajax({url:lt,type:"POST",data:ct,headers:{Accept:"application/json; odata=verbose"},success:function(n){var r,i,l,a,c,s,t,u;try{if(HideActivitySpinner(),n.status!="SUCCESS")console.log("Error in bwRequest.js.cmdApproveRequest(). xcx99304: "+JSON.stringify(n)),displayAlertDialog("Error in bwRequest.js.cmdApproveRequest(): "+JSON.stringify(n));else if(f.displaySuccessfulTaskCompletion_AlertDialog(n.message,e,o),$("#divRequestFormDialog_"+e).dialog("option","bwForceClose",!0),f.displayArInDialog("https://budgetworkflow.com",e,"","","","",""),r=window,window.opener&&(r=window.opener),i=r.$(".executiveSummaryInCarousel"),i&&i.length&&i.length>0)for(t=0;t<i.length;t++)if(l=r.$(i[t]).attr("bwbudgetrequestid"),u=r.$(i[t]).attr("bwworkflowtaskitemid"),e==l&&o==u&&(console.log("In bwAuthentication.js.checkIfWeNeedToUpdateTheHomepage(). We just completed this task... remove it from the display. bwBudgetRequestId: "+e+", bwWorkflowTaskItemId: "+o),i[t].remove(),a="divRequestFormDialog_"+e,c=$("#"+a).find("#selectedRaciRole")[0],c))for(s=$(c).find("option"),t=0;t<s.length;t++)u=$(s[t]).attr("bwworkflowtaskitemid"),o==u&&s[t].remove()}catch(h){HideActivitySpinner();console.log("Exception in bwRequest.js.cmdApproveRequest().post.approverequest.success(): "+h.message+", "+h.stack);alert("Exception in bwRequest.js.cmdApproveRequest().post.approverequest.success(): "+h.message+", "+h.stack)}},error:function(n,t,i){console.log("Error in bwRequest.js.cmdApproveRequest().post.approverequest: Error approving the request: "+t+", "+i+", "+JSON.stringify(n));t=="timeout"?(displayAlertDialog('The approval had an error. <span style="display:normal;">'+ +t+", "+i+", "+JSON.stringify(n)+"<\/span>"),HideActivitySpinner()):(alert("Error in bwRequest.js.cmdApproveRequest().post.approverequest: Error approving the request: "+t+", "+i+", "+JSON.stringify(n)),HideActivitySpinner())}})}}}catch(ht){HideActivitySpinner();u="Exception in bwRequest.js.cmdApproveRequest().xcx234: "+ht.message+", "+ht.stack;console.log(u);displayAlertDialog(u);document.getElementById("spanRequestForm_Error").innerHTML+=u}}})}catch(b){HideActivitySpinner();a="Exception in bwRequest.js.cmdApproveRequest():2: "+b.message+", "+b.stack;console.log(a);displayAlertDialog(a)}})):(HideActivitySpinner(),e="In cmdApproveRequest(). Reference to this form was not passed. This process cannot continue. This is likely because the Approve button javascript needs to be changed in the workflow.",displayAlertDialog(e))}catch(h){HideActivitySpinner();e="Exception in bwRequest.js.cmdApproveRequest(): "+h.message+", "+h.stack;console.log(e);displayAlertDialog(e)}},cmdReviewRequest:function(n,t,i,r,u){var f,o,s,e;try{console.log("In bwRequest.js.cmdReviewRequest(). ??xcx1234puttitleattribute desc here");alert("In bwRequest.js.cmdReviewRequest(). ??xcx1234puttitleattribute desc here");f=this;n?(o=$(n).closest(".ui-dialog")[0].id,s=this.saveAndPublishTheRequest(o),s.then(function(){var v,y,p,a;try{t&&(v='SYSTEM MESSSAGE: ADMIN "'+l+'" ('+c+') has approved this request on behalf of the "'+t+'" ('+i+') in workflow step "'+u+'" ('+r+").");var s=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),h=$(".bwAuthentication").bwAuthentication("option","participantId"),c=$(".bwAuthentication").bwAuthentication("option","participantEmail"),l=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),e=$(n).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),o=$(n).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid");o&&o!="undefined"||(alert("In bwRequest.js.cmdReviewRequest(). Invaid value for bwWorkflowTaskItemId: "+o),displayAlertDialog("In bwRequest.js.cmdReviewRequest(). Invaid value for bwWorkflowTaskItemId: "+o));console.log("In cmdReviewRequest(). bwBudgetRequestId: "+e+", tenantId: "+tenantId+", workflowAppId: "+s);y=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");p={bwParticipantId_LoggedIn:h,bwActiveStateIdentifier:y,bwWorkflowAppId_LoggedIn:s,bwWorkflowAppId:s,bwBudgetRequestId:e};alert("In ??(). xcx12325-5. Calling /workflowconfiguration5().");$.ajax({url:f.options.operationUriPrefix+"_bw/workflowconfiguration5",type:"POST",data:p,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){console.log("Error in bwRequest.js.cmdReviewRequest():3: "+t+" "+i);displayAlertDialog("Error in bwRequest.js.cmdReviewRequest():3: "+t+" "+i)},success:function(n){var g,w,y,t,ft,nt,i,et,b,tt;try{if(n.Workflow.length==0)alert("ERROR: Cannot locate workflowxcx9 for bwBudgetRequestId: "+e);else{var u=JSON.parse(n.Workflow[0].bwWorkflowJson),k="divRequestFormDialog_"+e,it=$("#"+k).find("#budgetrequestform")[0].getAttribute("bwworkflowstatus_bwworkflowstepname",it),a=null;for(t=0;t<u.Steps.Step.length;t++)if(r=u.Steps.Step[t]["@Name"],r==it){a=t;break}var rt=$("#"+k).find("#selectedRaciRole")[0].value,ut=$("#"+k).find("#ReviewerComments")[0].innerHTML.replace("<br>","").trim(),d=!1,p=!1;for(i=0;i<u.Steps.Step[a].Assign.length;i++)if(u.Steps.Step[a].Assign[i]["@Role"]==rt)for(g=u.Steps.Step[a].Assign[i],w=g["@Cond"],w&&w.indexOf("$ChecklistsRequired~")>-1&&(p=!0),t=0;t<u.Steps.Step[a].Assign[i].Action.length;t++)u.Steps.Step[a].Assign[i].Action[t]["@Name"]=="Approve"&&u.Steps.Step[a].Assign[i].Action[t]["@RequireComments"]&&(d=Boolean(u.Steps.Step[a].Assign[i].Action[t]["@RequireComments"].toLowerCase()));if(p==!0)if(w=g["@Cond"],y=w.split("$ChecklistsRequired~")[1].split("&")[0].split(","),f.options.store.Checklists){for(t=0;t<f.options.store.Checklists.length;t++)if(ft=JSON.parse(f.options.store.Checklists[t]),nt=ft.bwChecklistTemplatesId,y.indexOf(nt)>-1)for(i=0;i<y.length;i++)et=y.indexOf(nt),y.splice(et,1);y.length==0&&(p=!1)}else p=!1;if(b=!0,d==!0&&ut.length==0?(b=!1,alert("COMMENTS ARE REQUIRED BEFORE YOU CAN APPROVE.XCX395")):p==!0?(b=!1,alert(y.length+" checklists are required before you approve and complete this step. They may not all be yours...xcx396.")):d==!0&&p==!0&&(b=!1,alert("COMMENTS AND CHECKLIST(S) ARE REQUIRED BEFORE YOU CAN APPROVE.XCX397")),b==!0){var ct=getCreatedTimestamp(),lt=getDueDateTimestamp(),st={bwBudgetRequestId:e,bwTenantId:tenantId,bwWorkflowAppId:s,bwWorkflowTaskItemId:o,ModifiedByFriendlyName:l,ModifiedById:h,ModifiedByEmail:c,CurrentOwner:h,bwAssignedTo:c,bwAssignedToId:h,participantFriendlyName:l,selectedRoleId:rt,reviewerComments:ut,systemMessage:v},ht=webserviceurl+"/bwbudgetrequests/reviewrequest";$.ajax({url:ht,type:"POST",timeout:f.options.ajaxTimeout,data:st,headers:{Accept:"application/json; odata=verbose"},success:function(n){try{displayAlertDialog(n);f.displayArInDialog("https://budgetworkflow.com",e,"","","","","")}catch(t){console.log("Exception in bwRequest.cmdReviewRequest().post.reviewrequest.success(): "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.cmdReviewRequest().post.reviewrequest.success(): "+t.message+", "+t.stack)}},error:function(n,t,i){console.log("Error in bwRequest.cmdReviewRequest().post.reviewrequest: Error reviewing the request: "+t+", "+i+JSON.stringify(n));displayAlertDialog("Error in bwRequest.cmdReviewRequest().post.reviewrequest: Error reviewing the request: "+t+", "+i+JSON.stringify(n))}})}}}catch(ot){tt="Exception in cmdReviewRequest():3: "+ot.message+", "+ot.stack;console.log(tt);displayAlertDialog(tt)}}})}catch(w){a="Exception in cmdReviewRequest():2: "+w.message+", "+w.stack;console.log(a);displayAlertDialog(a)}})):(e="In cmdReviewRequest(). Reference to this form was not passed. This process cannot continue. This is likely because the Approve button javascript needs to be changed in the workflow.",console.log(e),displayAlertDialog(e))}catch(h){e="Exception in cmdReviewRequest(): "+h.message+", "+h.stack;console.log(e);displayAlertDialog(e)}},cmdReviseHoldRequest:function(n,t,i,r,u){var f,o,s,e;try{console.log("In bwRequest.js.cmdReviseHoldRequest(). This sends the request back to the original creator.");f=this;n?(o=$(n).closest(".ui-dialog")[0].id,s=this.saveAndPublishTheRequest(o),s.then(function(){var v,p,a;try{t&&(v='SYSTEM MESSSAGE: ADMIN "'+l+'" ('+c+') has approved this request on behalf of the "'+t+'" ('+i+') in workflow step "'+u+'" ('+r+").");var o=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),s=$(".bwAuthentication").bwAuthentication("option","participantId"),c=$(".bwAuthentication").bwAuthentication("option","participantEmail"),l=$(".bwAuthentication").bwAuthentication("option","participantFriendlyName"),y=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier"),e=$(n).closest("#budgetrequestform")[0].getAttribute("bwbudgetrequestid"),h=$(n).closest("#budgetrequestform")[0].getAttribute("bwworkflowtaskitemid");h&&h!="undefined"||(alert("In bwRequest.js.cmdReviseHoldRequest(). Invaid value for bwWorkflowTaskItemId: "+h),displayAlertDialog("In bwRequest.js.cmdReviseHoldRequest(). Invaid value for bwWorkflowTaskItemId: "+h));console.log("In bwRequest.js.cmdReviseHoldRequest(). bwBudgetRequestId: "+e+", workflowAppId: "+o);p={bwParticipantId_LoggedIn:s,bwActiveStateIdentifier:y,bwWorkflowAppId_LoggedIn:o,bwWorkflowAppId:o,bwBudgetRequestId:e};alert("In ??(). xcx12325-6. Calling /workflowconfiguration5().");$.ajax({url:f.options.operationUriPrefix+"_bw/workflowconfiguration5",type:"POST",data:p,headers:{Accept:"application/json; odata=verbose"},error:function(n,t,i){console.log("xcx23123-4 Error in bwRequest.js.displayRequestForm(): "+t+" "+i);displayAlertDialog("xcx23123-4 Error in bwRequest.js.displayRequestForm(): "+t+" "+i)},success:function(n){var tt,b,p,t,et,it,i,ot,k,d;try{if(n.Workflow.length==0)alert("ERROR: Cannot locate workflowxcx9 for bwBudgetRequestId: "+e);else{var u=JSON.parse(n.Workflow[0].bwWorkflowJson),g="divRequestFormDialog_"+e,rt=$("#"+g).find("#budgetrequestform")[0].getAttribute("bwworkflowstatus_bwworkflowstepname",rt),a=null;for(t=0;t<u.Steps.Step.length;t++)if(r=u.Steps.Step[t]["@Name"],r==rt){a=t;break}var ut=$("#"+g).find("#selectedRaciRole")[0].value,ft=$("#"+g).find("#ReviewerComments")[0].innerHTML.replace("<br>","").trim(),nt=!1,w=!1;for(i=0;i<u.Steps.Step[a].Assign.length;i++)if(u.Steps.Step[a].Assign[i]["@Role"]==ut)for(tt=u.Steps.Step[a].Assign[i],b=tt["@Cond"],b&&b.indexOf("$ChecklistsRequired~")>-1&&(w=!0),t=0;t<u.Steps.Step[a].Assign[i].Action.length;t++)u.Steps.Step[a].Assign[i].Action[t]["@Name"]=="Approve"&&u.Steps.Step[a].Assign[i].Action[t]["@RequireComments"]&&(nt=Boolean(u.Steps.Step[a].Assign[i].Action[t]["@RequireComments"].toLowerCase()));if(w==!0)if(b=tt["@Cond"],p=b.split("$ChecklistsRequired~")[1].split("&")[0].split(","),f.options.store.Checklists){for(t=0;t<f.options.store.Checklists.length;t++)if(et=JSON.parse(f.options.store.Checklists[t]),it=et.bwChecklistTemplatesId,p.indexOf(it)>-1)for(i=0;i<p.length;i++)ot=p.indexOf(it),p.splice(ot,1);p.length==0&&(w=!1)}else w=!1;if(k=!0,nt==!0&&ft.length==0?(k=!1,alert("COMMENTS ARE REQUIRED BEFORE YOU CAN APPROVE.XCX395")):w==!0?(k=!1,alert(p.length+" checklists are required before you approve and complete this step. They may not all be yours...xcx396.")):nt==!0&&w==!0&&(k=!1,alert("COMMENTS AND CHECKLIST(S) ARE REQUIRED BEFORE YOU CAN APPROVE.XCX397")),k==!0){var lt=getCreatedTimestamp(),at=getDueDateTimestamp(),ht={bwParticipantId_LoggedIn:s,bwActiveStateIdentifier:y,bwWorkflowAppId_LoggedIn:o,bwBudgetRequestId:e,bwWorkflowAppId:o,bwWorkflowTaskItemId:h,ModifiedByFriendlyName:l,ModifiedById:s,ModifiedByEmail:c,CurrentOwner:s,bwAssignedTo:c,bwAssignedToId:s,participantFriendlyName:l,selectedRoleId:ut,reviewerComments:ft,systemMessage:v},ct=webserviceurl+"/bwbudgetrequests/reviseholdrequest";$.ajax({url:ct,type:"POST",data:ht,headers:{Accept:"application/json; odata=verbose"},success:function(n){try{n.status!="SUCCESS"?(console.log("Error in reviseholdrequest xcx99304: "+JSON.stringify(n)),displayAlertDialog("Error in reviseholdrequest: "+JSON.stringify(n))):(displayAlertDialog(n.message),f.displayArInDialog("https://budgetworkflow.com",e,"","","","",""))}catch(t){console.log("Exception in bwRequest.js.cmdReviseHoldRequest().post.approverequest.success(): "+t.message+", "+t.stack);displayAlertDialog("Exception in bwRequest.js.cmdReviseHoldRequest().post.approverequest.success(): "+t.message+", "+t.stack)}},error:function(n,t,i){console.log("Error in bwRequest.js.cmdReviseHoldRequest().post.approverequest: Error approving the request: "+t+", "+i+JSON.stringify(n));displayAlertDialog("Error in bwRequest.js.cmdReviseHoldRequest().post.approverequest: Error approving the request: "+t+", "+i+JSON.stringify(n))}})}}}catch(st){d="Exception in bwRequest.js.cmdReviseHoldRequest().Get: "+st.message+", "+st.stack;console.log(d);displayAlertDialog(d);document.getElementById("spanRequestForm_Error").innerHTML+=d}}})}catch(w){a="Exception in bwRequest.js.cmdReviseHoldRequest():2: "+w.message+", "+w.stack;console.log(a);displayAlertDialog(a)}})):(e="In bwRequest.js.cmdReviseHoldRequest(). Reference to this form was not passed. This process cannot continue. This is likely because the Approve button javascript needs to be changed in the workflow.",console.log(e),displayAlertDialog(e))}catch(h){e="Exception in bwRequest.js.cmdReviseHoldRequest(): "+h.message+", "+h.stack;console.log(e);displayAlertDialog(e)}},cmdDeclineRequest:function(){try{console.log("In bwRequest.js.cmdDeclineRequest(). This declines the request and marks it as Completed/Done, but not active/approved.");alert("In bwRequest.js.cmdDeclineRequest(). This declines the request and marks it as Completed/Done/Abandoned?, but not active/approved. This functionality is incomplete. Coming soon!")}catch(n){}},removeDuplicateUsingSet:function(n){return Array.from(new Set(n))},removeDuplicates:function(n){for(var i=[],t=0;t<n.length;t++)i.indexOf(n[t])==-1&&i.push(n[t]);return i},createXmlDocument_InitArFromOfflineRequest:function(n){var o,t,u,f,i,e;console.log("In createXmlDocument_InitArFromOfflineRequest("+n+")");o=this;t='<?xml version="1.0" encoding="UTF-8"?>';try{t+='<my:myFields  xmlns:pc="http://schemas.microsoft.com/office/infopath/2007/PartnerControls" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2012-09-11T20:22:29"  xmlns:xd="http://schemas.microsoft.com/office/infopath/2003">';t+="<my:BudgetRequestId>"+n+"<\/my:BudgetRequestId>";t+='<my:Requested_Expense xsi:nil="true">0<\/my:Requested_Expense>';u=document.getElementById("dtEstimatedStartDate").value;i=u.split("-");u=i[1]+"/"+i[2]+"/"+i[0];u.indexOf("undefined")>-1&&(u="");t+="<my:Estimated_Start_Date>"+u+"<\/my:Estimated_Start_Date>";f=document.getElementById("dtEstimatedEndDate").value;i=f.split("-");f=i[1]+"/"+i[2]+"/"+i[0];f.indexOf("undefined")>-1&&(f="");t+="<my:Estimated_End_Date>"+f+"<\/my:Estimated_End_Date>";t+='<my:Budget_Amount2 xsi:nil="true"><\/my:Budget_Amount2>';t+="<my:Location><\/my:Location>";t+="<my:AttachmentsFolderName>";t+="<\/my:AttachmentsFolderName>";t+="<my:CapexAttachmentsGroup>";t+="    <my:CapexAttachments>";t+="    <\/my:CapexAttachments>";t+="<\/my:CapexAttachmentsGroup>";t+="<my:field4><\/my:field4>";t+="<\/my:myFields>"}catch(r){e=t;t="FAILED";o.WriteToErrorLog("Error in bwRequest.js.createXmlDocument_InitArFromOfflineRequest()","Error creating the AR XML: "+r.name+", "+r.message);o.WriteToErrorLog("bwRequest.js.createXmlDocument_InitArFromOfflineRequest()",e);console.log("Exception in bwRequest.js.createXmlDocument_InitArFromOfflineRequest(): name: "+r.name+", message: "+r.message+", stack: "+r.stack+", xml: "+e);displayAlertDialog("Exception in bwRequest.js.createXmlDocument_InitArFromOfflineRequest(): name: "+r.name+", message: "+r.message+", stack: "+r.stack+", xml: "+e)}return t},getCreatedTimestamp:function(){var n=new Date,t=n.getFullYear(),i=n.getMonth()+1,r=n.getDate(),u=n.getHours(),f=n.getMinutes(),e=n.getSeconds();return t+"-"+i+"-"+r+"T"+u+":"+f+":"+e},getDueDateTimestamp:function(){var n=new Date,t=n.getFullYear(),i=n.getMonth()+1,o=n.getDate(),r=n.getHours(),u=n.getMinutes(),f=n.getSeconds(),e=n.getDate()+1;return t+"-"+i+"-"+e+"T:"+r+":"+u+":"+f},populateFunctionalAreas:function(n){try{var t=this,i=webserviceurl+"/getfunctionalareasbyappid/"+this.options.bwWorkflowAppId+"/RETURNALL";$.ajax({url:i,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){var o,i,u,f,r;try{for(t.options.store.FiscalYear==null&&(t.options.store.FiscalYear="2020"),t.options.bwWorkflowAppId==null&&(o=[{bwFunctionalAreaYear:"2020",IsHidden:"false",bwFunctionalAreaId:"1",bwFunctionalAreaQuote:"false",bwFunctionalAreaTitle:"Buildings"},{bwFunctionalAreaYear:"2020",IsHidden:"false",bwFunctionalAreaId:"1",bwFunctionalAreaQuote:"false",bwFunctionalAreaTitle:"Computer equipment"},{bwFunctionalAreaYear:"2020",IsHidden:"false",bwFunctionalAreaId:"1",bwFunctionalAreaQuote:"false",bwFunctionalAreaTitle:"Office equipment"},{bwFunctionalAreaYear:"2020",IsHidden:"false",bwFunctionalAreaId:"1",bwFunctionalAreaQuote:"false",bwFunctionalAreaTitle:"Furniture and fixtures"},{bwFunctionalAreaYear:"2020",IsHidden:"false",bwFunctionalAreaId:"1",bwFunctionalAreaQuote:"false",bwFunctionalAreaTitle:"Intangible assets"},{bwFunctionalAreaYear:"2020",IsHidden:"false",bwFunctionalAreaId:"1",bwFunctionalAreaQuote:"false",bwFunctionalAreaTitle:"Land"},{bwFunctionalAreaYear:"2020",IsHidden:"false",bwFunctionalAreaId:"1",bwFunctionalAreaQuote:"false",bwFunctionalAreaTitle:"Machinery"},{bwFunctionalAreaYear:"2020",IsHidden:"false",bwFunctionalAreaId:"1",bwFunctionalAreaQuote:"false",bwFunctionalAreaTitle:"Software"},{bwFunctionalAreaYear:"2020",IsHidden:"false",bwFunctionalAreaId:"1",bwFunctionalAreaQuote:"false",bwFunctionalAreaTitle:"Vehicles"},],i={d:{results:o}}),u=[],u=[],r=0;r<i.d.results.length;r++)i.d.results[r].bwFunctionalAreaYear==t.options.store.FiscalYear&&i.d.results[r].IsHidden!="true"&&(f=[],f=new Array(3),f[0]=i.d.results[r].bwFunctionalAreaId,f[1]=i.d.results[r].bwFunctionalAreaQuote,f[2]=i.d.results[r].bwFunctionalAreaTitle,u.push(f));if(u.length==0)console.log("xThere are no Financial Areas to choose from for this Budget Request, therefore you cannot submit one at this time.");else for($("<option value=''>Select a functional area...<\/option>").appendTo($("#"+n).find("#ddlFunctionalArea")[0]),r=0;r<u.length;r++)$("<option value='"+u[r][0]+"|"+u[r][1]+"'>"+u[r][2]+"<\/option>").appendTo($("#"+n).find("#ddlFunctionalArea")[0])}catch(e){console.log("Exception in populateFunctionalAreas(): "+e.message+", "+e.stack);alert("Exception in populateFunctionalAreas(). This process cannot continue: "+e.message)}},error:function(){displayAlertDialog("Error populating functional areas.")}})}catch(r){displayAlertDialog("Error in populateFunctionalAreas(): "+r.message)}},populateLocations:function(n){try{var t=this,i=webserviceurl+"/getlocationsbyappid/"+this.options.bwWorkflowAppId+"/RETURNALL";$.ajax({url:i,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){var e,i,u,f,r;for(t.options.bwWorkflowAppId==null&&(e=[{IsHidden:"false",Name:"Headquarters"}],i={d:{results:e}}),u=[],r=0;r<i.d.results.length;r++)i.d.results[r].IsHidden!="true"&&(f=[],f=new Array(1),f[0]=i.d.results[r].Name,u.push(f));if(u.length==0)console.log("There are no Financial Areas to choose from for this Budget Request, therefore you cannot submit one at this time.x2");else for($("<option value=''>Select a location...<\/option>").appendTo($("#"+n).find("#ddlLocation")[0]),r=0;r<u.length;r++)$("<option value='"+u[r][0]+"|"+u[r][0]+"'>"+u[r][0]+"<\/option>").appendTo($("#"+n).find("#ddlLocation")[0])},error:function(){displayAlertDialog("Error populating locations.")}})}catch(r){displayAlertDialog("Error in populateLocations(): "+r.message)}},displayArOnTheHomePage:function(n,t,i){var u,f;try{$("#ArDialog").dialog("close")}catch(r){}try{console.log("In Request.js.displayArOnTheHomePage(). budgetRequestId: "+n+", participantId: "+t+", title: "+i);alert("In Request.js.displayArOnTheHomePage(). budgetRequestId: "+n+", participantId: "+t+", title: "+i);u='<div id="myxml" align="left" style="FONT-SIZE: 10pt; FONT-FAMILY: Calibri;"><\/div>';$("#divWelcomeMessage").html(u);f="";this.displayForm_DisplayArBasedOnWorkflowStatus2(n,f,t)}catch(r){console.log("Exception in my.js.displayArOnTheHomePage(): "+r.message+", "+r.stack);displayAlertDialog("Exception in my.js.displayArOnTheHomePage(): "+r.message+", "+r.stack)}},populateStartPageItem:function(n){var e,o,t,u,i,r,h,c,f;try{if(console.log("In bwRequest.js.populateStartPageItem(). DO WE USE THIS ANYMORE??? 3-14-2023"),alert("In bwRequest.js.populateStartPageItem(). DO WE USE THIS ANYMORE??? 3-14-2023"),n=="divWelcome")alert("xcx12221321-4 CALLING renderWelcomeScreen()."),renderWelcomeScreen(),renderAlerts(),$("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").show(),$("#liNewRequest").hide(),$("#liArchive").hide(),$("#liSummaryReport").hide(),$("#liConfiguration").hide(),$("#liHelp").hide(),$("#divWelcomeMasterDiv").show(),f=document.getElementById("divWelcomeMasterDiv"),f.style.borderRadius="20px 0 0 20px",renderLeftButtons("divWelcomePageLeftButtons");else if(n=="divNewRequestOffline"){console.log('In bwRequest.js.populateStartPageItem("divNewRequestOffline").');try{for(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),document.getElementById("OfflineRequestBudgetRequestId").innerHTML=e,o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),document.getElementById("OfflineRequestRecurringExpenseId").innerHTML=o,document.getElementById("strOfflineRequestProjectTitle").value="",document.getElementById("strOfflineRequestBriefDescriptionOfProject").value="",document.getElementById("dblOfflineRequestRequestedCapital").value="",document.getElementById("dtOfflineRequestEstimatedStartDate").value="",document.getElementById("dtOfflineRequestEstimatedEndDate").value="",document.getElementById("OfflineRequestnewrequestattachments").value="",document.getElementById("strOfflineRequestProjectTitle").innerHTML="",document.getElementById("strOfflineRequestBriefDescriptionOfProject").innerHTML="",document.getElementById("dblOfflineRequestRequestedCapital").innerHTML="",document.getElementById("OfflineRequestnewrequestattachments").innerHTML="",$("#liWelcome").hide(),$("#liOfflineWelcome").hide(),$("#liArchive").hide(),$("#liNewRequest").hide(),$("#liAbout").hide(),$("#liOfflineRequestForm").show(),t=[],t=[],u=["budgetrequest","Budget Request","selected"],t.push(u),u=["quoterequest","Quote Request",""],t.push(u),u=["expenserequest","Reimbursement Request",""],t.push(u),u=["recurringexpense","Recurring Expense",""],t.push(u),this.renderCreateRequestFormOffline(),i="",i+='<span style="font-size: 350%;">New <strong>',i+='<select id="selectOfflineNewRequestFormRequestTypeDropDown" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1.0em; font-weight: bold; cursor: pointer;\'>',r=0;r<t.length;r++)i+='<option value="'+t[r][0]+'" '+t[r][2]+">"+t[r][1]+"<\/option>";i+="<\/select>";i+="<\/span>";document.getElementById("spanNewRequestDetailsLabel").innerHTML='<span class="xdlabel">Justification details:<\/span>';$("#trNewRequestAttachmentsSection").show();$("#trNewRequestBarcodeAttachmentsSection").show();console.log('in bwRequest.js.populateStartPageItem("divNewRequestOffline"): XXXXXXXXXXXXXXXXXXXXXXXXXXX')}catch(s){console.log('Exception in bwRequest.js.populateStartPageItem("divNewRequestOffline"): '+s.message+", "+s.stack)}}else if(n=="divNewRequest"){if(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),this.renderCreateRequestForm("divCreateRequestFormDialogContent"),i="",t.length==1)i+='<span style="font-size: 200%;">New <strong>'+t[0][1]+"<\/strong><\/span>",document.getElementById("spanRequestForm_Title").innerHTML=i;else{for(i+='<span style="font-size: 200%;">New <strong>',i+='<select id="selectNewRequestFormRequestTypeDropDown-DOESTHISEVERGETUSED" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1.25em; font-weight: bold; cursor: pointer;\'>',r=0;r<t.length;r++)i+=t[r][0]==bwLastSelectedNewRequestType?'<option value="'+t[r][0]+'" '+t[r][2]+" selected >"+t[r][1]+"<\/option>":'<option value="'+t[r][0]+'" '+t[r][2]+">"+t[r][1]+"<\/option>";i+="<\/select>";i+="<\/span>";document.getElementById("spanRequestForm_Title").innerHTML=i;$("#selectNewRequestFormRequestTypeDropDown").change(function(){var n,t,i;alert("In  selectNewRequestFormRequestTypeDropDown.change(). Is this old code??? xcx12346-3");$("#divTopBar_Long").html("");n=$("#selectNewRequestFormRequestTypeDropDown option:selected").val();bwLastSelectedNewRequestType=n;t=[];t={bwParticipantId:participantId,bwWorkflowAppId:workflowAppId,bwLastSelectedNewRequestType:bwLastSelectedNewRequestType};i=webserviceurl+"/bwparticipant/updateuserconfigurationselectednewrequestscreenrequesttype";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){t!="SUCCESS"?displayAlertDialog(t):n=="recurringexpense"?($("#trNewRequestRecurringExpenseSection").show(),$("#dtRecurringExpenseReminderDate").datepicker()):$("#trNewRequestRecurringExpenseSection").hide()},error:function(n,t,i){displayAlertDialog("Error in my.js.cmdChooseSelectedWorkflow(): "+t+" "+i)}})})}populateFunctionalAreas();$("#spanRequestForm_ManagerTitle").html(newBudgetRequestManagerTitle);document.getElementById("spanNewRequestDetailsLabel").innerHTML=requireRequestDetails==!0?'<span class="xdlabel">Justification details:<\/span>&nbsp;<span style="color:red;font-size:medium;">*<\/span>':'<span class="xdlabel">Justification details:<\/span>';requireStartEndDates==!0?(document.getElementById("spanNewRequestStartDateLabel").innerHTML='<span class="xdlabel" style="white-space:nowrap;">Start date (estimated):&nbsp;<\/span><span style="color:red;font-size:medium;">*<\/span>',document.getElementById("spanNewRequestEndDateLabel").innerHTML='<span class="xdlabel" style="white-space:nowrap;">End date (estimated):&nbsp;<\/span><span style="color:red;font-size:medium;">*<\/span>'):(document.getElementById("spanNewRequestStartDateLabel").innerHTML='<span class="xdlabel">Start date (estimated):<\/span>',document.getElementById("spanNewRequestEndDateLabel").innerHTML='<span class="xdlabel">End date (estimated):<\/span>');enableNewRequestAttachments==!0?$("#trNewRequestAttachmentsSection").show():$("#trNewRequestAttachmentsSection").hide();enableNewRequestBarcodeAttachments==!0?$("#trNewRequestBarcodeAttachmentsSection").show():$("#trNewRequestBarcodeAttachmentsSection").hide();renderLeftButtons("divNewRequestPageLeftButtons");$("#txtProjectManagerName").autocomplete({source:function(n,t){$.ajax({url:webserviceurl+"/workflow/"+workflowAppId+"/participants/"+n.term,dataType:"json",success:function(n){for(var r=[],i=0;i<n.participants.length;i++)r[i]=n.participants[i].participant;t(r)}})},minLength:1,select:function(){},open:function(){},close:function(){var n=this.value.split("|")[0],t=this.value.split("|")[1],i=this.value.split("|")[2];n.indexOf("undefined")>-1?(document.getElementById("txtProjectManagerName").value="",document.getElementById("txtProjectManagerId").value="",document.getElementById("txtProjectManagerEmail").value=""):(document.getElementById("txtProjectManagerName").value=n,document.getElementById("txtProjectManagerId").value=t,document.getElementById("txtProjectManagerEmail").value=i)}});monkeyPatchAutocomplete()}else if(n=="divArchive"){if($("#bwQuickLaunchMenuTd").css({width:"0"}),f=document.getElementById("divArchiveMasterDiv"),f.style.borderRadius="20px 0 0 20px",t=[],t=[],u=["budgetrequests","Budget Requests","selected"],t.push(u),quotingEnabled==!0&&(u=["quoterequests","Quote Requests",""],t.push(u)),reimbursementRequestsEnabled==!0&&(u=["expenserequests","Reimbursement Requests",""],t.push(u)),recurringExpensesEnabled==!0&&(u=["recurringexpenses","Recurring Expenses",""],t.push(u)),i="",t.length==1)i+='<span style="font-size: 200%;">View <strong>'+t[0][1]+"<\/strong><\/span>",document.getElementById("spanArchiveScreenRequestTypeDropDownSection").innerHTML=i;else{for(i+="<span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 1.77em;\">",i+="View ",i+='<select id="selectArchiveScreenRequestTypeDropDown" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1.25em; font-weight: bold; cursor: pointer;\'>',r=0;r<t.length;r++)i+=t[r][0]==bwLastSelectedArchiveScreenRequestType?'<option value="'+t[r][0]+'" '+t[r][2]+" selected >"+t[r][1]+"<\/option>":'<option value="'+t[r][0]+'" '+t[r][2]+">"+t[r][1]+"<\/option>";i+="<\/select>";i+='&nbsp;for&nbsp;<span style="font-weight:bold;white-space:nowrap;">'+workflowAppTitle+"<\/span>";i+="<\/span>";document.getElementById("spanArchiveScreenRequestTypeDropDownSection").innerHTML=i;$("#selectArchiveScreenRequestTypeDropDown").change(function(){var n=$("#selectArchiveScreenRequestTypeDropDown option:selected").val(),t,i;bwLastSelectedArchiveScreenRequestType=n;t=[];t={bwParticipantId:participantId,bwWorkflowAppId:workflowAppId,LastSelected_ArchiveScreen_bwRequestTypeId:LastSelected_ArchiveScreen_bwRequestTypeId};i=webserviceurl+"/bwparticipant/updateuserconfigurationselectedarchivescreenrequesttype";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){t!="SUCCESS"?displayAlertDialog(t):n=="budgetrequests"?cmdListAllBudgetRequestsUsingClientDatasetApproach():n=="quoterequests"?cmdListAllQuoteRequestsUsingClientDatasetApproach():n=="expenserequests"?cmdListAllReimbursementRequestsUsingClientDatasetApproach():n=="recurringexpenses"?cmdDisplayArchivePageRecurringExpenses():n=="participants"&&cmdListAllParticipantsUsingClientDatasetApproach()},error:function(n,t,i){displayAlertDialog("Error in my.js.cmdChooseSelectedWorkflow(): "+t+" "+i)}})})}h=$("#selectArchiveScreenRequestTypeDropDown option:selected").val();bwLastSelectedArchiveScreenRequestType=h;GetWorkflowAppConfigurationData9=$.Deferred();GetWorkflowAppConfigurationData9.done(function(){bwLastSelectedArchiveScreenRequestType||(bwLastSelectedArchiveScreenRequestType="budgetrequests");bwLastSelectedArchiveScreenRequestType=="budgetrequests"?cmdListAllBudgetRequestsUsingClientDatasetApproach():bwLastSelectedArchiveScreenRequestType=="quoterequests"?cmdListAllQuoteRequestsUsingClientDatasetApproach():bwLastSelectedArchiveScreenRequestType=="expenserequests"?cmdListAllReimbursementRequestsUsingClientDatasetApproach():bwLastSelectedArchiveScreenRequestType=="recurringexpenses"?cmdDisplayArchivePageRecurringExpenses():bwLastSelectedArchiveScreenRequestType=="participants"&&cmdListAllParticipantsUsingClientDatasetApproach();renderLeftButtons("divArchivePageLeftButtons")}).fail(function(){handleExceptionWithAlert("Error in bwRequest.js.populateStartPageItem(divFunctionalAreas)","GetWorkflowAppConfigurationData9.fail()")});loadWorkflowAppConfigurationDetails9()}else n=="divSummaryReport"?($("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").hide(),$("#liNewRequest").hide(),$("#liHelp").hide(),$("#liArchive").hide(),$("#liConfiguration").hide(),$("#liSummaryReport").show(),f=document.getElementById("divSummaryReportMasterDiv"),f.style.borderRadius="20px 0 0 20px",quotingEnabled==!0?($("#divBudgetRequestsOrQuotes").html('<label for="budgetRequestsOrQuotes"><\/label><input type="checkbox" name="budgetRequestsOrQuotes" id="budgetRequestsOrQuotes" />'),c={show_labels:!0,labels_placement:"both",on_label:"Quotes",off_label:"Budget<br />Requests",width:50,height:22,button_width:24,clear_after:null},$("input#budgetRequestsOrQuotes").switchButton(c),$("#budgetRequestsOrQuotes").change(function(){$("#budgetRequestsOrQuotes").is(":checked")?$("#financialOrParticipantSummary").is(":checked")?$("#financialOrParticipantSummary").is(":checked")?renderParticipantSummary(!0):displayAlertDialog("financialOrParticipantSummary is in an invalid state."):renderFinancialSummary9(!0):$("#budgetRequestsOrQuotes").is(":checked")?displayAlertDialog("budgetRequestsOrQuotes is in an invalid state."):$("#financialOrParticipantSummary").is(":checked")?$("#financialOrParticipantSummary").is(":checked")?renderParticipantSummary(!1):displayAlertDialog("financialOrParticipantSummary is in an invalid state."):renderFinancialSummary9(!1)})):$("#divBudgetRequestsOrQuotes").empty(),GetWorkflowAppConfigurationData9=$.Deferred(),GetWorkflowAppConfigurationData9.done(function(){renderLeftButtons("divSummaryPageLeftButtons");var t=(new Date).getFullYear().toString(),n="";n+=t;document.getElementById("spanSummaryReportYear").innerHTML=n;$("#financialOrParticipantSummary").is(":checked")?$("#financialOrParticipantSummary").is(":checked")&&($("#budgetRequestsOrQuotes").is(":checked")?$("#budgetRequestsOrQuotes").is(":checked")&&renderParticipantSummary(!0):renderParticipantSummary(!1)):$("#budgetRequestsOrQuotes").is(":checked")?$("#budgetRequestsOrQuotes").is(":checked")&&(displayAlertDialog("renderFinancialSummary9(true);"),renderFinancialSummary9(!0)):renderFinancialSummary9(!1)}).fail(function(){handleExceptionWithAlert("Error in bwRequest.js.populateStartPageItem(divSummaryReport)","GetWorkflowAppConfigurationData9.fail()")}),loadWorkflowAppConfigurationDetails9()):n=="divHelp"?($("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").hide(),$("#liNewRequest").hide(),$("#liArchive").hide(),$("#liSummaryReport").hide(),$("#liConfiguration").hide(),$("#liHelp").show(),f=document.getElementById("divHelpMasterDiv"),f.style.borderRadius="20px 0 0 20px",renderLeftButtons("divHelpPageLeftButtons")):n=="divConfiguration"?($("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").hide(),$("#liNewRequest").hide(),$("#liArchive").hide(),$("#liSummaryReport").hide(),$("#liHelp").hide(),$("#liConfiguration").show(),f=document.getElementById("divConfigurationMasterDiv"),f.style.borderRadius="20px 0 0 20px",f=document.getElementById("divFunctionalAreas"),f.style.borderRadius="20px 0 0 20px",generateConfigurationLeftSideMenu(),renderLeftButtons("divConfigurationPageLeftButtons")):n=="divAddAFunctionalArea"?($("#bwQuickLaunchMenuTd").css({width:"0"}),$("#divFunctionalAreasMasterSubMenuDiv").text("Add a functional area:"),$("#btnFunctionalAreaDelete").hide(),$("#divFunctionalAreaSection").html($("#divFunctionalAreaTemplate").html()),$("#txtFunctionalAreaId").empty,document.getElementById("divMenuMasterDivAddAFunctionalArea").className="divLeftButtonSelected",$("#divFunctionalAreasMasterSubMenuDiv").show(),hookUpThePeoplePickers(),f=document.getElementById("divFunctionalAreas"),f.style.borderRadius="20px 0 0 20px"):n=="divFunctionalAreas"?($("#bwQuickLaunchMenuTd").css({width:"0"}),GetWorkflowAppConfigurationData9=$.Deferred(),GetWorkflowAppConfigurationData9.done(function(){generateFunctionalAreasListButtons()}).fail(function(){handleExceptionWithAlert("Error in bwRequest.js.populateStartPageItem(divFunctionalAreas)","GetWorkflowAppConfigurationData9.fail()")}),loadWorkflowAppConfigurationDetails9()):n=="divBehavior"?$("#bwQuickLaunchMenuTd").css({width:"0"}):n=="divWorkflowSettings"&&($("#bwQuickLaunchMenuTd").css({width:"0"}),renderConfigurationSettings());navigator.userAgent.match(/iPhone/i)&&$("#bwMyPage").animate({zoom:3},400)}catch(s){displayAlertDialog("Error in bwRequest.js.populateStartPageItem("+n+"): "+s.message)}},displayPeoplePickerDialog:function(n,t,i,r,u,f){try{console.log("In displayPeoplePickerDialog(). elementIdSuffix: "+f);var o=this;u&&u=="emailrecipient"?($("#txtPeoplePickerDialogSearchBox").empty(),$("#PeoplePickerDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"570px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#PeoplePickerDialog").dialog("close")})}}),$("#PeoplePickerDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),$("#spanPeoplePickerDialogTitle").html("Select an email recipient..."),$("#txtPeoplePickerDialogSearchBox").autocomplete({source:function(u){u.term==""?o.renderAllEmailRecipientsInThePeoplePicker():$.ajax({url:webserviceurl+"/workflow/"+workflowAppId+"/participants/"+u.term,dataType:"json",success:function(u){var o,e;if($("#spanPeoplePickerParticipantsList").empty(),o="",u.participants.length>0)for(e=0;e<u.participants.length;e++)o+="<a style=\"cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('cmdReturnParticipantIdToField_ForEmailRecipients', '"+n+"', '"+t+"', '"+i+"', '"+u.participants[e].participant.split("|")[0]+"', '"+u.participants[e].participant.split("|")[1]+"', '"+u.participants[e].participant.split("|")[2]+"', '"+r+"', '"+f+"');\">"+u.participants[e].participant.split("|")[0]+"&nbsp;&nbsp;<i>("+u.participants[e].participant.split("|")[2]+")<\/i><\/a>",o+="<br />";else o+="<span><i>There were no results<\/i><\/span>";$("#spanPeoplePickerParticipantsList").append(o)}})},minLength:0,select:function(){},open:function(){},close:function(){var n=this.value.split("|")[0],t=this.value.split("|")[1],i=this.value.split("|")[2];n.indexOf("undefined")>-1?(document.getElementById("txtPeoplePickerDialogSearchBox").value="",document.getElementById("txtPeoplePickerDialogParticipantId").value="",document.getElementById("txtPeoplePickerDialogParticipantEmail").value=""):(document.getElementById("txtPeoplePickerDialogSearchBox").value=n,document.getElementById("txtPeoplePickerDialogParticipantId").value=t,document.getElementById("txtPeoplePickerDialogParticipantEmail").value=i)}}),this.renderAllEmailRecipientsInThePeoplePicker(n,t,i,r,f)):u&&u=="customer"?($("#txtPeoplePickerDialogSearchBox").empty(),$("#PeoplePickerDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"570px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#PeoplePickerDialog").dialog("close")})}}),$("#PeoplePickerDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),$("#spanPeoplePickerDialogTitle").html("Select a customer..."),$("#txtPeoplePickerDialogSearchBox").autocomplete({source:function(u){u.term==""?o.renderAllCustomersInThePeoplePicker():$.ajax({url:webserviceurl+"/workflow/"+workflowAppId+"/participants/"+u.term,dataType:"json",success:function(u){var e,f;if($("#spanPeoplePickerParticipantsList").empty(),e="",u.participants.length>0)for(f=0;f<u.participants.length;f++)e+="<a onclick=\"$('.bwRequest').bwRequest('cmdReturnParticipantIdToField_ForCustomer', '"+n+"', '"+t+"', '"+i+"', '"+u.participants[f].participant.split("|")[0]+"', '"+u.participants[f].participant.split("|")[1]+"', '"+u.participants[f].participant.split("|")[2]+"', '"+r+"');\">"+u.participants[f].participant.split("|")[0]+"&nbsp;&nbsp;<i>("+u.participants[f].participant.split("|")[2]+")<\/i><\/a>",e+="<br />";else e+="<span><i>There were no results<\/i><\/span>";$("#spanPeoplePickerParticipantsList").append(e)}})},minLength:0,select:function(){},open:function(){},close:function(){var n=this.value.split("|")[0],t=this.value.split("|")[1],i=this.value.split("|")[2];n.indexOf("undefined")>-1?(document.getElementById("txtPeoplePickerDialogSearchBox").value="",document.getElementById("txtPeoplePickerDialogParticipantId").value="",document.getElementById("txtPeoplePickerDialogParticipantEmail").value=""):(document.getElementById("txtPeoplePickerDialogSearchBox").value=n,document.getElementById("txtPeoplePickerDialogParticipantId").value=t,document.getElementById("txtPeoplePickerDialogParticipantEmail").value=i)}}),this.renderAllCustomersInThePeoplePicker(n,t,i,r)):($("#txtPeoplePickerDialogSearchBox").empty(),$("#PeoplePickerDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"570px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#PeoplePickerDialog").dialog("close")})}}),$("#PeoplePickerDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),$("#spanPeoplePickerDialogTitle").html("Select a person..."),$("#txtPeoplePickerDialogSearchBox").autocomplete({source:function(u){u.term==""?o.renderAllParticipantsInThePeoplePicker():$.ajax({url:webserviceurl+"/workflow/"+workflowAppId+"/participants/"+u.term,dataType:"json",success:function(u){var e,f;if($("#spanPeoplePickerParticipantsList").empty(),e="",u.participants.length>0)for(f=0;f<u.participants.length;f++)e+="<a onclick=\"$('.bwRequest').bwRequest('cmdReturnParticipantIdToField', '"+n+"', '"+t+"', '"+i+"', '"+u.participants[f].participant.split("|")[0]+"', '"+u.participants[f].participant.split("|")[1]+"', '"+u.participants[f].participant.split("|")[2]+"', '"+r+"');\">"+u.participants[f].participant.split("|")[0]+"&nbsp;&nbsp;<i>("+u.participants[f].participant.split("|")[2]+")<\/i><\/a>",e+="<br />";else e+="<span><i>There were no results<\/i><\/span>";$("#spanPeoplePickerParticipantsList").append(e)}})},minLength:0,select:function(){},open:function(){},close:function(){var n=this.value.split("|")[0],t=this.value.split("|")[1],i=this.value.split("|")[2];n.indexOf("undefined")>-1?(document.getElementById("txtPeoplePickerDialogSearchBox").value="",document.getElementById("txtPeoplePickerDialogParticipantId").value="",document.getElementById("txtPeoplePickerDialogParticipantEmail").value=""):(document.getElementById("txtPeoplePickerDialogSearchBox").value=n,document.getElementById("txtPeoplePickerDialogParticipantId").value=t,document.getElementById("txtPeoplePickerDialogParticipantEmail").value=i)}}),this.renderAllParticipantsInThePeoplePicker(n,t,i,r))}catch(e){console.log("Exception in displayPeoplePickerDialog: "+e.message+", "+e.stack);displayAlertDialog("Exception in displayPeoplePickerDialog: "+e.message+", "+e.stack)}},renderAllParticipantsInThePeoplePicker:function(n,t,i,r){var e;try{console.log("In bwRequest.js.renderAllParticipantsInThePeoplePicker().");var f=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),o=$(".bwAuthentication").bwAuthentication("option","participantId"),s=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");$("#spanPeoplePickerParticipantsList").empty();e={bwParticipantId_LoggedIn:o,bwActiveStateIdentifier:s,bwWorkflowAppId_LoggedIn:f,bwWorkflowAppId:f};$.ajax({url:webserviceurl+"/workflow/participants",type:"POST",contentType:"application/json",data:JSON.stringify(e),success:function(u){var e,o,f;try{for(e=u.BwWorkflowUsers,o="",f=0;f<e.length;f++)o+="<a onclick=\"$('.bwRequest').bwRequest('cmdReturnParticipantIdToField', '"+n+"', '"+t+"', '"+i+"', '"+e[f].bwParticipantFriendlyName+"', '"+e[f].bwParticipantId+"', '"+e[f].bwParticipantEmail+"', '"+r+"');\">"+e[f].bwParticipantFriendlyName+"&nbsp;&nbsp;<i>("+e[f].bwParticipantEmail+")<\/i><\/a>",o+="<br />";$("#spanPeoplePickerParticipantsList").append(o)}catch(s){console.log("Exception in renderAllParticipantsInThePeoplePicker():2: "+s.message+", "+s.stack);displayAlertMessage("Exception in renderAllParticipantsInThePeoplePicker():2: "+s.message+", "+s.stack)}},error:function(n,t,i){console.log("Error in my.js.renderAllParticipantsInThePeoplePicker():"+t+", "+i);displayAlertDialog("Error in my.js.renderAllParticipantsInThePeoplePicker():"+t+", "+i)}})}catch(u){console.log("Exception in renderAllParticipantsInThePeoplePicker(): "+u.message+", "+u.stack);displayAlertMessage("Exception in renderAllParticipantsInThePeoplePicker(): "+u.message+", "+u.stack)}},renderAllCustomersInThePeoplePicker:function(n,t,i,r){var s;try{console.log("In bwRequest.js.renderAllCustomersInThePeoplePicker().");var f=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),e=$(".bwAuthentication").bwAuthentication("option","participantId"),o=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");$("#spanPeoplePickerParticipantsList").empty();s={bwParticipantId_LoggedIn:e,bwActiveStateIdentifier:o,bwWorkflowAppId_LoggedIn:f,bwWorkflowAppId:f,bwParticipantId:e,bwActiveStateIdentifier:o};$.ajax({url:webserviceurl+"/workflow/participants",type:"POST",contentType:"application/json",data:JSON.stringify(s),success:function(u){var f;try{var e=u.BwWorkflowUsers,o="",h=!1;for(f=0;f<e.length;f++)e[f].bwParticipantRole=="customer"&&(h=!0,o+="<a onclick=\"$('.bwRequest').bwRequest('cmdReturnParticipantIdToField_ForCustomer', '"+n+"', '"+t+"', '"+i+"', '"+e[f].bwParticipantFriendlyName+"', '"+e[f].bwParticipantId+"', '"+e[f].bwParticipantEmail+"', '"+r+"');\">"+e[f].bwParticipantFriendlyName+"&nbsp;&nbsp;<i>("+e[f].bwParticipantEmail+")<\/i><\/a>",o+="<br />");h==!1&&(o+="There are no customers in this organization.");$("#spanPeoplePickerParticipantsList").append(o)}catch(s){console.log("Exception in renderAllCustomersInThePeoplePicker():2: "+s.message+", "+s.stack);displayAlertMessage("Exception in renderAllCustomersInThePeoplePicker():2: "+s.message+", "+s.stack)}},error:function(n,t,i){console.log("Error in my.js.renderAllCustomersInThePeoplePicker():"+t+", "+i);displayAlertDialog("Error in my.js.renderAllCustomersInThePeoplePicker():xcx677756: "+t+", "+i)}})}catch(u){console.log("Exception in renderAllCustomersInThePeoplePicker(): "+u.message+", "+u.stack);displayAlertMessage("Exception in renderAllCustomersInThePeoplePicker(): "+u.message+", "+u.stack)}},renderAllEmailRecipientsInThePeoplePicker:function(n,t,i,r,u){var o;try{console.log("In bwRequest.js.renderAllEmailRecipientsInThePeoplePicker(). elementIdSuffix: "+u);var e=$(".bwAuthentication").bwAuthentication("option","workflowAppId"),s=$(".bwAuthentication").bwAuthentication("option","participantId"),h=$(".bwAuthentication:first").bwAuthentication("getActiveStateIdentifier");$("#spanPeoplePickerParticipantsList").empty();o={bwParticipantId_LoggedIn:s,bwActiveStateIdentifier:h,bwWorkflowAppId_LoggedIn:e,bwWorkflowAppId:e};$.ajax({url:webserviceurl+"/workflow/participants",type:"POST",contentType:"application/json",data:JSON.stringify(o),success:function(f){var e;try{var o=f.BwWorkflowUsers,s="",c=!1;for(e=0;e<o.length;e++)(o[e].bwParticipantRole=="customer"||o[e].bwParticipantRole=="emailrecipient")&&(c=!0,s+="<a style=\"cursor:pointer;\" onclick=\"$('.bwRequest').bwRequest('cmdReturnParticipantIdToField_ForEmailRecipient', '"+n+"', '"+t+"', '"+i+"', '"+o[e].bwParticipantFriendlyName+"', '"+o[e].bwParticipantId+"', '"+o[e].bwParticipantEmail+"', '"+r+"', '"+u+"');\">"+o[e].bwParticipantFriendlyName+"&nbsp;&nbsp;<i>("+o[e].bwParticipantEmail+")<\/i><\/a>",s+="<br />");c==!1&&(s+="There are no email recipients in this organization.");$("#spanPeoplePickerParticipantsList").append(s)}catch(h){console.log("Exception in renderAllEmailRecipientsInThePeoplePicker():2: "+h.message+", "+h.stack);displayAlertMessage("Exception in renderAllEmailRecipientsInThePeoplePicker():2: "+h.message+", "+h.stack)}},error:function(n,t,i){console.log("Error in bwRequest.js.renderAllEmailRecipientsInThePeoplePicker():"+t+", "+i);displayAlertDialog("Error in bwRequest.js.renderAllEmailRecipientsInThePeoplePicker():"+t+", "+i)}})}catch(f){console.log("Exception in bwRequest.js.renderAllEmailRecipientsInThePeoplePicker(): "+f.message+", "+f.stack);displayAlertDialog("Exception in bwRequest.js.renderAllEmailRecipientsInThePeoplePicker(): "+f.message+", "+f.stack)}},cmdReturnParticipantIdToField:function(n,t,i,r,u,f,e){try{console.log("In cmdReturnParticipantIdToField().");document.getElementById(n).value=r;document.getElementById(n).setAttribute("title",f);document.getElementById(t).value=u;document.getElementById(i).value=f;this.options.store.ProjectManager={Person:{AccountId:u,FriendlyName:r,Email:f,AccountType:null}};e&&e!="undefined"&&(document.getElementById(e).disabled=!1);$("#PeoplePickerDialog").dialog("close")}catch(o){console.log("Exception in cmdReturnParticipantIdToField(): "+o.message+", "+o.stack)}},cmdReturnParticipantIdToField_ForCustomer:function(n,t,i,r,u,f){var o,c,s,e,a,l;try{for(console.log("In cmdReturnParticipantIdToField_ForCustomer()."),o=n.split("_")[1],s=document.getElementsByClassName("budgetrequestform"),e=0;e<s.length;e++)if(a=$(s[e])[0].getAttribute("bwbudgetrequestid"),o==a){c=$(s[e])[0];break}c?(l=$(c).find(".bwPeoplePicker_Customer")[0],l?$(l).bwPeoplePicker_Customer("addCustomer",n,t,i,r,u,f,o):alert("In cmdReturnParticipantIdToField_ForCustomer(). Could not find formwidget.")):alert("In cmdReturnParticipantIdToField_ForCustomer(). Could not find budgetrequestform. bwBudgetRequestId: "+o+", friendlyNameSourceField: "+n)}catch(h){console.log("Exception in cmdReturnParticipantIdToField_ForCustomer(): "+h.message+", "+h.stack);displayAlertDialog("Exception in cmdReturnParticipantIdToField_ForCustomer(): "+h.message+", "+h.stack)}},cmdReturnParticipantIdToField_ForEmailRecipient:function(n,t,i,r,u,f,e,o){try{console.log("In cmdReturnParticipantIdToField_ForEmailRecipient(). elementIdSuffix: "+o);$("#divEmailAttachmentsDialog_bwAttachments_bwPeoplePicker_EmailRecipients_"+o).bwPeoplePicker_EmailRecipients("addEmailRecipient",n,t,i,r,u,f,o)}catch(s){console.log("Exception in cmdReturnParticipantIdToField_ForEmailRecipient(): "+s.message+", "+s.stack);displayAlertDialog("Exception in cmdReturnParticipantIdToField_ForEmailRecipient(): "+s.message+", "+s.stack)}},renderParticipantInformation:function(n){try{console.log("renderParticipantInformation(). userId: "+n);alert("In renderParticipantInformation(). userId: "+n)}catch(t){console.log("Exception in renderParticipantInformation(): "+t.message+", "+t.stack)}}});