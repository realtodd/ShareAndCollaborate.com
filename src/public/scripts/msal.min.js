/*! msal v1.3.3 2020-07-10 */
(function(n,t){typeof exports=="object"&&typeof module=="object"?module.exports=t():typeof define=="function"&&define.amd?define("Msal",[],t):typeof exports=="object"?exports.Msal=t():n.Msal=t()})(window,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})},t.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){var r,u;if((i&1&&(n=t(n)),i&8)||i&4&&typeof n=="object"&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),i&2&&typeof n!="string")for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r},t.n=function(n){var i=n&&n.__esModule?function(){return n["default"]}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=29)}([function(n,t){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0
THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.
See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function e(n,t){function i(){this.constructor=n}r(n,t);n.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}function o(n,t){var u={},r;for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(u[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(u[i[r]]=n[i[r]]);return u}function s(n,t,i,r){var f=arguments.length,u=f<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,e,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(e=n[o])&&(u=(f<3?e(u):f>3?e(t,i,u):e(t,i))||u);return f>3&&u&&Object.defineProperty(t,i,u),u}function h(n,t){return function(i,r){t(i,r,n)}}function c(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)}function l(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})}function a(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e}function v(n,t){for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])}function u(n){var t=typeof Symbol=="function"&&n[Symbol.iterator],i=0;return t?t.call(n):{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}}}function f(n,t){var i=typeof Symbol=="function"&&n[Symbol.iterator],r,u,f,e;if(!i)return n;r=i.call(n);f=[];try{while((t===void 0||t-->0)&&!(u=r.next()).done)f.push(u.value)}catch(o){e={error:o}}finally{try{u&&!u.done&&(i=r["return"])&&i.call(r)}finally{if(e)throw e.error;}}return f}function y(){for(var n=[],t=0;t<arguments.length;t++)n=n.concat(f(arguments[t]));return n}function p(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u}function i(n){return this instanceof i?(this.v=n,this):new i(n)}function w(n,t,r){function o(n){s[n]&&(f[n]=function(t){return new Promise(function(i,r){u.push([n,t,i,r])>1||e(n,t)})})}function e(n,t){try{c(s[n](t))}catch(i){h(u[0][3],i)}}function c(n){n.value instanceof i?Promise.resolve(n.value.v).then(l,a):h(u[0][2],n)}function l(n){e("next",n)}function a(n){e("throw",n)}function h(n,t){(n(t),u.shift(),u.length)&&e(u[0][0],u[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(n,t||[]),f,u=[];return f={},o("next"),o("throw"),o("return"),f[Symbol.asyncIterator]=function(){return this},f}function b(n){function r(r,f){t[r]=n[r]?function(t){return(u=!u)?{value:i(n[r](t)),done:r==="return"}:f?f(t):t}:f}var t,u;return t={},r("next"),r("throw",function(n){throw n;}),r("return"),t[Symbol.iterator]=function(){return this},t}function k(n){function i(i){t[i]=n[i]&&function(t){return new Promise(function(r,u){t=n[i](t);f(r,u,t.done,t.value)})}}function f(n,t,i,r){Promise.resolve(r).then(function(t){n({value:t,done:i})},t)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n[Symbol.asyncIterator],t;return r?r.call(n):(n=typeof u=="function"?u(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t)}function d(n,t){return Object.defineProperty?Object.defineProperty(n,"raw",{value:t}):n.raw=t,n}function g(n){var t,i;if(n&&n.__esModule)return n;if(t={},n!=null)for(i in n)Object.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t.default=n,t}function nt(n){return n&&n.__esModule?n:{"default":n}}Object.defineProperty(t,"__esModule",{value:!0});var r=function(n,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},r(n,t)};t.__extends=e;t.__assign=function(){return t.__assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},t.__assign.apply(this,arguments)};t.__rest=o;t.__decorate=s;t.__param=h;t.__metadata=c;t.__awaiter=l;t.__generator=a;t.__exportStar=v;t.__values=u;t.__read=f;t.__spread=y;t.__spreadArrays=p;t.__await=i;t.__asyncGenerator=w;t.__asyncDelegator=b;t.__asyncValues=k;t.__makeTemplateObject=d;t.__importStar=g;t.__importDefault=nt},function(n,t){"use strict";function s(){return"1.3.3"}var r,u,f,e,o,i;Object.defineProperty(t,"__esModule",{value:!0});r=function(){function n(){}return Object.defineProperty(n,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(n,"popUpWidth",{get:function(){return this._popUpWidth},set:function(n){this._popUpWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(n,"popUpHeight",{get:function(){return this._popUpHeight},set:function(n){this._popUpHeight=n},enumerable:!0,configurable:!0}),Object.defineProperty(n,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ADFS",{get:function(){return"adfs"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),n._popUpWidth=483,n._popUpHeight=600,n}();t.Constants=r,function(n){n.SCOPE="scope";n.STATE="state";n.ERROR="error";n.ERROR_DESCRIPTION="error_description";n.ACCESS_TOKEN="access_token";n.ID_TOKEN="id_token";n.EXPIRES_IN="expires_in";n.SESSION_STATE="session_state";n.CLIENT_INFO="client_info"}(u=t.ServerHashParamKeys||(t.ServerHashParamKeys={})),function(n){n.AUTHORITY="authority";n.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount";n.SESSION_STATE="session.state";n.STATE_LOGIN="state.login";n.STATE_ACQ_TOKEN="state.acquireToken";n.STATE_RENEW="state.renew";n.NONCE_IDTOKEN="nonce.idtoken";n.LOGIN_REQUEST="login.request";n.RENEW_STATUS="token.renew.status";n.URL_HASH="urlHash";n.INTERACTION_STATUS="interaction_status";n.REDIRECT_REQUEST="redirect_request"}(f=t.TemporaryCacheKeys||(t.TemporaryCacheKeys={})),function(n){n.IDTOKEN="idtoken";n.CLIENT_INFO="client.info"}(e=t.PersistentCacheKeys||(t.PersistentCacheKeys={})),function(n){n.LOGIN_ERROR="login.error";n.ERROR="error";n.ERROR_DESC="error.description"}(o=t.ErrorCacheKeys||(t.ErrorCacheKeys={}));t.DEFAULT_AUTHORITY="https://login.microsoftonline.com/common/";t.AAD_INSTANCE_DISCOVERY_ENDPOINT=t.DEFAULT_AUTHORITY+"/discovery/instance?api-version=1.1&authorization_endpoint=",function(n){n.ACCOUNT="account";n.SID="sid";n.LOGIN_HINT="login_hint";n.ID_TOKEN="id_token";n.ACCOUNT_ID="accountIdentifier";n.HOMEACCOUNT_ID="homeAccountIdentifier"}(i=t.SSOTypes||(t.SSOTypes={}));t.BlacklistedEQParams=[i.SID,i.LOGIN_HINT];t.NetworkRequestType={GET:"GET",POST:"POST"};t.PromptState={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};t.FramePrefix={ID_TOKEN_FRAME:"msalIdTokenFrame",TOKEN_FRAME:"msalRenewFrame"};t.libraryVersion=s},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.createNewGuid=function(){var e=window.crypto,t,i;if(e&&e.getRandomValues)return t=new Uint8Array(16),e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,n.decimalToHex(t[0])+n.decimalToHex(t[1])+n.decimalToHex(t[2])+n.decimalToHex(t[3])+"-"+n.decimalToHex(t[4])+n.decimalToHex(t[5])+"-"+n.decimalToHex(t[6])+n.decimalToHex(t[7])+"-"+n.decimalToHex(t[8])+n.decimalToHex(t[9])+"-"+n.decimalToHex(t[10])+n.decimalToHex(t[11])+n.decimalToHex(t[12])+n.decimalToHex(t[13])+n.decimalToHex(t[14])+n.decimalToHex(t[15]);var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",u=0,f="";for(i=0;i<36;i++)r[i]!=="-"&&r[i]!=="4"&&(u=Math.random()*16|0),r[i]==="x"?f+=o[u]:r[i]==="y"?(u&=3,u|=8,f+=o[u]):f+=r[i];return f},n.isGuid=function(n){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)},n.decimalToHex=function(n){for(var t=n.toString(16);t.length<2;)t="0"+t;return t},n.base64Encode=function(n){return btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,function(n,t){return String.fromCharCode(Number("0x"+t))}))},n.base64Decode=function(n){var t=n.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string");}return decodeURIComponent(atob(t).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""))},n.deserialize=function(n){for(var f=/\+/g,i=/([^&=]+)=([^&]*)/g,r=function(n){return decodeURIComponent(decodeURIComponent(n.replace(f," ")))},u={},t=i.exec(n);t;)u[r(t[1])]=r(t[2]),t=i.exec(n);return u},n}();t.CryptoUtils=i},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.isEmpty=function(n){return typeof n=="undefined"||!n||0===n.length},n}();t.StringUtils=i},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),u=i(9),f=i(3),e=i(2),o=function(){function n(){}return n.createNavigateUrl=function(n){var i=this.createNavigationUrlString(n),t=n.authorityInstance.AuthorizationEndpoint;return t+=t.indexOf("?")<0?"?":"&",""+t+i.join("&")},n.createNavigationUrlString=function(n){var i=n.scopes,t;return i.indexOf(n.clientId)===-1&&i.push(n.clientId),t=[],t.push("response_type="+n.responseType),this.translateclientIdUsedInScope(i,n.clientId),t.push("scope="+encodeURIComponent(u.ScopeSet.parseScope(i))),t.push("client_id="+encodeURIComponent(n.clientId)),t.push("redirect_uri="+encodeURIComponent(n.redirectUri)),t.push("state="+encodeURIComponent(n.state)),t.push("nonce="+encodeURIComponent(n.nonce)),t.push("client_info=1"),t.push("x-client-SKU="+n.xClientSku),t.push("x-client-Ver="+n.xClientVer),n.promptValue&&t.push("prompt="+encodeURIComponent(n.promptValue)),n.claimsValue&&t.push("claims="+encodeURIComponent(n.claimsValue)),n.queryParameters&&t.push(n.queryParameters),n.extraQueryParameters&&t.push(n.extraQueryParameters),t.push("client-request-id="+encodeURIComponent(n.correlationId)),t},n.translateclientIdUsedInScope=function(n,t){var i=n.indexOf(t);i>=0&&(n.splice(i,1),n.indexOf("openid")===-1&&n.push("openid"),n.indexOf("profile")===-1&&n.push("profile"))},n.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},n.removeHashFromUrl=function(n){return n.split("#")[0]},n.replaceTenantPath=function(n,t){n=n.toLowerCase();var u=this.GetUrlComponents(n),i=u.PathSegments;return t&&i.length!==0&&i[0]===r.Constants.common&&(i[0]=t),this.constructAuthorityUriFromObject(u,i)},n.constructAuthorityUriFromObject=function(n,t){return this.CanonicalizeUri(n.Protocol+"//"+n.HostNameAndPort+"/"+t.join("/"))},n.GetUrlComponents=function(n){var u,t,i,r;if(!n)throw"Url required";if(u=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=n.match(u),!t||t.length<6)throw"Valid url required";return i={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5]},r=i.AbsolutePath.split("/"),r=r.filter(function(n){return n&&n.length>0}),i.PathSegments=r,t[6]&&(i.Search=t[6]),t[8]&&(i.Hash=t[8]),i},n.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!n.endsWith(t,"/")&&(t+="/"),t},n.endsWith=function(n,t){return!n||!t?!1:n.indexOf(t,n.length-t.length)!==-1},n.urlRemoveQueryStringParameter=function(n,t){if(f.StringUtils.isEmpty(n))return n;var i=new RegExp("(\\&"+t+"=)[^&]+");return n=n.replace(i,""),i=new RegExp("("+t+"=)[^&]+&"),n=n.replace(i,""),i=new RegExp("("+t+"=)[^&]+"),n.replace(i,"")},n.getHashFromUrl=function(n){var t=n.indexOf("#"),i=n.indexOf("#/");return i>-1?n.substring(i+2):t>-1?n.substring(t+1):n},n.urlContainsHash=function(t){var i=n.deserializeHash(t);return i.hasOwnProperty(r.ServerHashParamKeys.ERROR_DESCRIPTION)||i.hasOwnProperty(r.ServerHashParamKeys.ERROR)||i.hasOwnProperty(r.ServerHashParamKeys.ACCESS_TOKEN)||i.hasOwnProperty(r.ServerHashParamKeys.ID_TOKEN)},n.deserializeHash=function(t){var i=n.getHashFromUrl(t);return e.CryptoUtils.deserialize(i)},n.getHostFromUri=function(n){var t=String(n).replace(/^(https?:)\/\//,"");return t.split("/")[0]},n}();t.UrlUtils=o},function(n,t,i){"use strict";var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});r=i(0);u=i(6);t.ClientConfigurationErrorMessage={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},storageNotSupported:{code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientScope:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},b2cKnownAuthoritiesNotSet:{code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},invalidCorrelationIdError:{code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},ssoSilentError:{code:"sso_silent_error",desc:"request must contain either sid or login_hint"},invalidAuthorityMetadataError:{code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."}};f=function(n){function i(t,r){var u=n.call(this,t,r)||this;return u.name="ClientConfigurationError",Object.setPrototypeOf(u,i.prototype),u}return r.__extends(i,n),i.createNoSetConfigurationError=function(){return new i(t.ClientConfigurationErrorMessage.configurationNotSet.code,""+t.ClientConfigurationErrorMessage.configurationNotSet.desc)},i.createStorageNotSupportedError=function(n){return new i(t.ClientConfigurationErrorMessage.storageNotSupported.code,t.ClientConfigurationErrorMessage.storageNotSupported.desc+" Given location: "+n)},i.createRedirectCallbacksNotSetError=function(){return new i(t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.code,t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.desc)},i.createInvalidCallbackObjectError=function(n){return new i(t.ClientConfigurationErrorMessage.invalidCallbackObject.code,t.ClientConfigurationErrorMessage.invalidCallbackObject.desc+" Given value for callback function: "+n)},i.createEmptyScopesArrayError=function(n){return new i(t.ClientConfigurationErrorMessage.emptyScopes.code,t.ClientConfigurationErrorMessage.emptyScopes.desc+" Given value: "+n+".")},i.createScopesNonArrayError=function(n){return new i(t.ClientConfigurationErrorMessage.nonArrayScopes.code,t.ClientConfigurationErrorMessage.nonArrayScopes.desc+" Given value: "+n+".")},i.createClientIdSingleScopeError=function(n){return new i(t.ClientConfigurationErrorMessage.clientScope.code,t.ClientConfigurationErrorMessage.clientScope.desc+" Given value: "+n+".")},i.createScopesRequiredError=function(n){return new i(t.ClientConfigurationErrorMessage.scopesRequired.code,t.ClientConfigurationErrorMessage.scopesRequired.desc+" Given value: "+n)},i.createInvalidPromptError=function(n){return new i(t.ClientConfigurationErrorMessage.invalidPrompt.code,t.ClientConfigurationErrorMessage.invalidPrompt.desc+" Given value: "+n)},i.createClaimsRequestParsingError=function(n){return new i(t.ClientConfigurationErrorMessage.claimsRequestParsingError.code,t.ClientConfigurationErrorMessage.claimsRequestParsingError.desc+" Given value: "+n)},i.createEmptyRequestError=function(){var n=t.ClientConfigurationErrorMessage.emptyRequestError,r=n.code,u=n.desc;return new i(r,u)},i.createInvalidCorrelationIdError=function(){return new i(t.ClientConfigurationErrorMessage.invalidCorrelationIdError.code,t.ClientConfigurationErrorMessage.invalidCorrelationIdError.desc)},i.createKnownAuthoritiesNotSetError=function(){return new i(t.ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.code,t.ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.desc)},i.createInvalidAuthorityTypeError=function(){return new i(t.ClientConfigurationErrorMessage.invalidAuthorityType.code,t.ClientConfigurationErrorMessage.invalidAuthorityType.desc)},i.createUntrustedAuthorityError=function(n){return new i(t.ClientConfigurationErrorMessage.untrustedAuthority.code,t.ClientConfigurationErrorMessage.untrustedAuthority.desc+" Provided Authority: "+n)},i.createTelemetryConfigError=function(n){var r=t.ClientConfigurationErrorMessage.telemetryConfigError,f=r.code,e=r.desc,u={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"},o=Object.keys(u).reduce(function(t,i){return n[i]?t:t.concat([i+" ("+u[i]+")"])},[]);return new i(f,e+" mising values: "+o.join(","))},i.createSsoSilentError=function(){return new i(t.ClientConfigurationErrorMessage.ssoSilentError.code,t.ClientConfigurationErrorMessage.ssoSilentError.desc)},i.createInvalidAuthorityMetadataError=function(){return new i(t.ClientConfigurationErrorMessage.invalidAuthorityMetadataError.code,t.ClientConfigurationErrorMessage.invalidAuthorityMetadataError.desc)},i}(u.ClientAuthError);t.ClientConfigurationError=f},function(n,t,i){"use strict";var u;Object.defineProperty(t,"__esModule",{value:!0});var f=i(0),e=i(7),r=i(3);t.ClientAuthErrorMessage={multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},multipleCacheAuthorities:{code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},tokenRenewalError:{code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},invalidStateError:{code:"invalid_state_error",desc:"Invalid state."},nonceMismatchError:{code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},loginProgressError:{code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},acquireTokenProgressError:{code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},callbackError:{code:"callback_error",desc:"Error occurred in token received callback function."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},userDoesNotExistError:{code:"user_non_existent",desc:"User object does not exist. Please call a login API."},clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoNotPopulatedError:{code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},idTokenNotParsed:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},tokenEncodingError:{code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},invalidInteractionType:{code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},cacheParseError:{code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},blockTokenRequestsInHiddenIframe:{code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"}};u=function(n){function i(t,r){var u=n.call(this,t,r)||this;return u.name="ClientAuthError",Object.setPrototypeOf(u,i.prototype),u}return f.__extends(i,n),i.createEndpointResolutionError=function(n){var u=t.ClientAuthErrorMessage.endpointResolutionError.desc;return n&&!r.StringUtils.isEmpty(n)&&(u+=" Details: "+n),new i(t.ClientAuthErrorMessage.endpointResolutionError.code,u)},i.createMultipleMatchingTokensInCacheError=function(n){return new i(t.ClientAuthErrorMessage.multipleMatchingTokens.code,"Cache error for scope "+n+": "+t.ClientAuthErrorMessage.multipleMatchingTokens.desc+".")},i.createMultipleAuthoritiesInCacheError=function(n){return new i(t.ClientAuthErrorMessage.multipleCacheAuthorities.code,"Cache error for scope "+n+": "+t.ClientAuthErrorMessage.multipleCacheAuthorities.desc+".")},i.createPopupWindowError=function(n){var u=t.ClientAuthErrorMessage.popUpWindowError.desc;return n&&!r.StringUtils.isEmpty(n)&&(u+=" Details: "+n),new i(t.ClientAuthErrorMessage.popUpWindowError.code,u)},i.createTokenRenewalTimeoutError=function(){return new i(t.ClientAuthErrorMessage.tokenRenewalError.code,t.ClientAuthErrorMessage.tokenRenewalError.desc)},i.createInvalidIdTokenError=function(n){return new i(t.ClientAuthErrorMessage.invalidIdToken.code,t.ClientAuthErrorMessage.invalidIdToken.desc+" Given token: "+n)},i.createInvalidStateError=function(n,r){return new i(t.ClientAuthErrorMessage.invalidStateError.code,t.ClientAuthErrorMessage.invalidStateError.desc+" "+n+", state expected : "+r+".")},i.createNonceMismatchError=function(n,r){return new i(t.ClientAuthErrorMessage.nonceMismatchError.code,t.ClientAuthErrorMessage.nonceMismatchError.desc+" "+n+", nonce expected : "+r+".")},i.createLoginInProgressError=function(){return new i(t.ClientAuthErrorMessage.loginProgressError.code,t.ClientAuthErrorMessage.loginProgressError.desc)},i.createAcquireTokenInProgressError=function(){return new i(t.ClientAuthErrorMessage.acquireTokenProgressError.code,t.ClientAuthErrorMessage.acquireTokenProgressError.desc)},i.createUserCancelledError=function(){return new i(t.ClientAuthErrorMessage.userCancelledError.code,t.ClientAuthErrorMessage.userCancelledError.desc)},i.createErrorInCallbackFunction=function(n){return new i(t.ClientAuthErrorMessage.callbackError.code,t.ClientAuthErrorMessage.callbackError.desc+" "+n+".")},i.createUserLoginRequiredError=function(){return new i(t.ClientAuthErrorMessage.userLoginRequiredError.code,t.ClientAuthErrorMessage.userLoginRequiredError.desc)},i.createUserDoesNotExistError=function(){return new i(t.ClientAuthErrorMessage.userDoesNotExistError.code,t.ClientAuthErrorMessage.userDoesNotExistError.desc)},i.createClientInfoDecodingError=function(n){return new i(t.ClientAuthErrorMessage.clientInfoDecodingError.code,t.ClientAuthErrorMessage.clientInfoDecodingError.desc+" Failed with error: "+n)},i.createClientInfoNotPopulatedError=function(n){return new i(t.ClientAuthErrorMessage.clientInfoNotPopulatedError.code,t.ClientAuthErrorMessage.clientInfoNotPopulatedError.desc+" Failed with error: "+n)},i.createIdTokenNullOrEmptyError=function(n){return new i(t.ClientAuthErrorMessage.nullOrEmptyIdToken.code,t.ClientAuthErrorMessage.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+n)},i.createIdTokenParsingError=function(n){return new i(t.ClientAuthErrorMessage.idTokenNotParsed.code,t.ClientAuthErrorMessage.idTokenNotParsed.desc+" Failed with error: "+n)},i.createTokenEncodingError=function(n){return new i(t.ClientAuthErrorMessage.tokenEncodingError.code,t.ClientAuthErrorMessage.tokenEncodingError.desc+" Attempted to decode: "+n)},i.createInvalidInteractionTypeError=function(){return new i(t.ClientAuthErrorMessage.invalidInteractionType.code,t.ClientAuthErrorMessage.invalidInteractionType.desc)},i.createCacheParseError=function(n){var r="invalid key: "+n+", "+t.ClientAuthErrorMessage.cacheParseError.desc;return new i(t.ClientAuthErrorMessage.cacheParseError.code,r)},i.createBlockTokenRequestsInHiddenIframeError=function(){return new i(t.ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.code,t.ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.desc)},i}(e.AuthError);t.ClientAuthError=u},function(n,t,i){"use strict";var r,u;Object.defineProperty(t,"__esModule",{value:!0});r=i(0);t.AuthErrorMessage={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},noWindowObjectError:{code:"no_window_object",desc:"No window object available. Details:"}};u=function(n){function i(t,r){var u=n.call(this,r)||this;return Object.setPrototypeOf(u,i.prototype),u.errorCode=t,u.errorMessage=r,u.name="AuthError",u}return r.__extends(i,n),i.createUnexpectedError=function(n){return new i(t.AuthErrorMessage.unexpectedError.code,t.AuthErrorMessage.unexpectedError.desc+": "+n)},i.createNoWindowObjectError=function(n){return new i(t.AuthErrorMessage.noWindowObjectError.code,t.AuthErrorMessage.noWindowObjectError.desc+" "+n)},i}(Error);t.AuthError=u},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EVENT_NAME_PREFIX="msal.";t.EVENT_NAME_KEY="event_name";t.START_TIME_KEY="start_time";t.ELAPSED_TIME_KEY="elapsed_time";t.TELEMETRY_BLOB_EVENT_NAMES={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"};t.TENANT_PLACEHOLDER="<tenant>"},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),u=i(1),f=function(){function n(){}return n.isIntersectingScopes=function(n,t){for(var u=this.trimAndConvertArrayToLowerCase(n.slice()),r=this.trimAndConvertArrayToLowerCase(t.slice()),i=0;i<r.length;i++)if(u.indexOf(r[i].toLowerCase())>-1)return!0;return!1},n.containsScope=function(n,t){var i=this.trimAndConvertArrayToLowerCase(n.slice()),r=this.trimAndConvertArrayToLowerCase(t.slice());return r.every(function(n){return i.indexOf(n.toString().toLowerCase())>=0})},n.trimAndConvertToLowerCase=function(n){return n.trim().toLowerCase()},n.trimAndConvertArrayToLowerCase=function(n){var t=this;return n.map(function(n){return t.trimAndConvertToLowerCase(n)})},n.removeElement=function(n,t){var i=this.trimAndConvertToLowerCase(t);return n.filter(function(n){return n!==i})},n.parseScope=function(n){var i="",t;if(n)for(t=0;t<n.length;++t)i+=t!==n.length-1?n[t]+" ":n[t];return i},n.validateInputScope=function(n,t,i){if(!n)if(t)throw r.ClientConfigurationError.createScopesRequiredError(n);else return;if(!Array.isArray(n))throw r.ClientConfigurationError.createScopesNonArrayError(n);if(n.length<1)throw r.ClientConfigurationError.createEmptyScopesArrayError(n.toString());if(n.indexOf(i)>-1&&n.length>1)throw r.ClientConfigurationError.createClientIdSingleScopeError(n.toString());},n.getScopeFromState=function(n){if(n){var t=n.indexOf(u.Constants.resourceDelimiter);if(t>-1&&t+1<n.length)return n.substring(t+1)}return""},n.appendScopes=function(n,t){if(n){var i=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,r=this.trimAndConvertArrayToLowerCase(n.slice());return i?r.concat(i):r}return null},n}();t.ScopeSet=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(8),u=i(2),f=i(4),e=i(21);t.scrubTenantFromUri=function(n){var i=f.UrlUtils.GetUrlComponents(n),t,u;return e.AuthorityFactory.isAdfs(n)?n:(t=i.PathSegments,t&&t.length>=2&&(u=t[1]==="tfp"?2:1,u<t.length&&(t[u]=r.TENANT_PLACEHOLDER)),i.Protocol+"//"+i.HostNameAndPort+"/"+t.join("/"))};t.hashPersonalIdentifier=function(n){return u.CryptoUtils.base64Encode(n)};t.prependEventNamePrefix=function(n){return""+r.EVENT_NAME_PREFIX+(n||"")};t.supportsBrowserPerformance=function(){return!!(typeof window!="undefined"&&"performance"in window&&window.performance.mark&&window.performance.measure)};t.endBrowserPerformanceMeasurement=function(n,i,r){t.supportsBrowserPerformance()&&(window.performance.mark(r),window.performance.measure(n,i,r),window.performance.clearMeasures(n),window.performance.clearMarks(i),window.performance.clearMarks(r))};t.startBrowserPerformanceMeasurement=function(n){t.supportsBrowserPerformance()&&window.performance.mark(n)}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.parseExpiresIn=function(n){return n||(n="3599"),parseInt(n,10)},n.now=function(){return Math.round((new Date).getTime()/1e3)},n.relativeNowMs=function(){return window.performance.now()},n}();t.TimeUtils=i},function(n,t,i){"use strict";var f,u,r,e;Object.defineProperty(t,"__esModule",{value:!0});f=i(3);u=i(1),function(n){n[n.Error=0]="Error";n[n.Warning=1]="Warning";n[n.Info=2]="Info";n[n.Verbose=3]="Verbose"}(r=t.LogLevel||(t.LogLevel={}));e=function(){function n(n,t){t===void 0&&(t={});this.level=r.Info;var i=t.correlationId,e=i===void 0?"":i,u=t.level,o=u===void 0?r.Info:u,f=t.piiLoggingEnabled,s=f===void 0?!1:f;this.localCallback=n;this.correlationId=e;this.level=o;this.piiLoggingEnabled=s}return n.prototype.logMessage=function(n,t,i){if(!(n>this.level)&&(this.piiLoggingEnabled||!i)){var e=(new Date).toUTCString(),o;o=f.StringUtils.isEmpty(this.correlationId)?e+":"+u.libraryVersion()+"-"+r[n]+(i?"-pii":"")+" "+t:e+":"+this.correlationId+"-"+u.libraryVersion()+"-"+r[n]+(i?"-pii":"")+" "+t;this.executeCallback(n,o,i)}},n.prototype.executeCallback=function(n,t,i){this.localCallback&&this.localCallback(n,t,i)},n.prototype.error=function(n){this.logMessage(r.Error,n,!1)},n.prototype.errorPii=function(n){this.logMessage(r.Error,n,!0)},n.prototype.warning=function(n){this.logMessage(r.Warning,n,!1)},n.prototype.warningPii=function(n){this.logMessage(r.Warning,n,!0)},n.prototype.info=function(n){this.logMessage(r.Info,n,!1)},n.prototype.infoPii=function(n){this.logMessage(r.Info,n,!0)},n.prototype.verbose=function(n){this.logMessage(r.Verbose,n,!1)},n.prototype.verbosePii=function(n){this.logMessage(r.Verbose,n,!0)},n.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},n}();t.Logger=e},function(n,t,i){"use strict";var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});r=i(0);u=i(7);t.ServerErrorMessage={serverUnavailable:{code:"server_unavailable",desc:"Server is temporarily unavailable."},unknownServerError:{code:"unknown_server_error"}};f=function(n){function i(t,r){var u=n.call(this,t,r)||this;return u.name="ServerError",Object.setPrototypeOf(u,i.prototype),u}return r.__extends(i,n),i.createServerUnavailableError=function(){return new i(t.ServerErrorMessage.serverUnavailable.code,t.ServerErrorMessage.serverUnavailable.desc)},i.createUnknownServerError=function(n){return new i(t.ServerErrorMessage.unknownServerError.code,n)},i}(u.AuthError);t.ServerError=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=i(0),f=i(8),u=i(8),r=i(10),o=i(2),s=function(){function n(n,t,i){var e;this.eventId=o.CryptoUtils.createNewGuid();this.label=i;this.event=(e={},e[r.prependEventNamePrefix(u.EVENT_NAME_KEY)]=n,e[r.prependEventNamePrefix(u.ELAPSED_TIME_KEY)]=-1,e[""+f.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=t,e)}return n.prototype.setElapsedTime=function(n){this.event[r.prependEventNamePrefix(u.ELAPSED_TIME_KEY)]=n},n.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp);r.endBrowserPerformanceMeasurement(this.displayName,this.perfStartMark,this.perfEndMark)},n.prototype.start=function(){this.startTimestamp=Date.now();this.event[r.prependEventNamePrefix(u.START_TIME_KEY)]=this.startTimestamp;r.startBrowserPerformanceMeasurement(this.perfStartMark)},Object.defineProperty(n.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+f.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]},set:function(n){this.event[""+f.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"eventName",{get:function(){return this.event[r.prependEventNamePrefix(u.EVENT_NAME_KEY)]},enumerable:!0,configurable:!0}),n.prototype.get=function(){return e.__assign({},this.event,{eventId:this.eventId})},Object.defineProperty(n.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),n}();t.default=s},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=i(0),rt=i(31),ut=i(32),w=i(16),b=i(33),y=i(34),f=i(35),v=i(19),nt=i(9),s=i(3),o=i(20),ft=i(17),et=i(11),e=i(4),l=i(18),tt=i(38),c=i(21),st=i(25),k=i(5),p=i(7),u=i(6),ht=i(13),it=i(26),d=i(27),ot=h.__importDefault(i(39)),g=i(28),r=i(1),ct=i(2),lt=i(24),at="https://login.microsoftonline.com/common",a={id_token:"id_token",token:"token",id_token_token:"id_token token"},vt=function(){function n(n){var t,i,u;this.authResponseCallback=null;this.tokenReceivedCallback=null;this.errorReceivedCallback=null;this.config=st.buildConfiguration(n);this.logger=this.config.system.logger;this.clientId=this.config.auth.clientId;this.inCookie=this.config.cache.storeAuthStateInCookie;this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId);lt.TrustedAuthority.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities);c.AuthorityFactory.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata);this.authority=this.config.auth.authority||at;this.cacheStorage=new f.AuthCache(this.clientId,this.config.cache.cacheLocation,this.inCookie);window.activeRenewals={};window.renewStates=[];window.callbackMappedToRenewStates={};window.promiseMappedToRenewStates={};window.msal=this;t=window.location.hash;i=e.UrlUtils.urlContainsHash(t);o.WindowUtils.checkIfBackButtonIsPressed(this.cacheStorage);i&&(u=this.getResponseState(t),u.method===r.Constants.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(t))}return Object.defineProperty(n.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(n){this.authorityInstance=c.AuthorityFactory.CreateInstance(n,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),n.prototype.getAuthorityInstance=function(){return this.authorityInstance},n.prototype.handleRedirectCallback=function(n,t){if(!n)throw k.ClientConfigurationError.createInvalidCallbackObjectError(n);t?(this.tokenReceivedCallback=n,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=n;this.redirectError?this.authErrorHandler(r.Constants.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(r.Constants.interactionTypeRedirect,this.redirectResponse)},n.prototype.urlContainsHash=function(n){return this.logger.verbose("UrlContainsHash has been called"),e.UrlUtils.urlContainsHash(n)},n.prototype.authResponseHandler=function(n,t,i){if(this.logger.verbose("AuthResponseHandler has been called"),n===r.Constants.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else if(n===r.Constants.interactionTypePopup)this.logger.verbose("Interaction type is popup, resolving"),i(t);else throw u.ClientAuthError.createInvalidInteractionTypeError();},n.prototype.authErrorHandler=function(n,t,i,f){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.removeItem(r.TemporaryCacheKeys.INTERACTION_STATUS),n===r.Constants.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,i.accountState)):(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,i));else if(n===r.Constants.interactionTypePopup)this.logger.verbose("Interaction type is popup, rejecting"),f(t);else throw u.ClientAuthError.createInvalidInteractionTypeError();},n.prototype.loginRedirect=function(n){this.logger.verbose("LoginRedirect has been called");var t=l.RequestUtils.validateRequest(n,!0,this.clientId,r.Constants.interactionTypeRedirect);this.acquireTokenInteractive(r.Constants.interactionTypeRedirect,!0,t,null,null)},n.prototype.acquireTokenRedirect=function(n){this.logger.verbose("AcquireTokenRedirect has been called");var t=l.RequestUtils.validateRequest(n,!1,this.clientId,r.Constants.interactionTypeRedirect);this.acquireTokenInteractive(r.Constants.interactionTypeRedirect,!1,t,null,null)},n.prototype.loginPopup=function(n){var i=this,t,u;return this.logger.verbose("LoginPopup has been called"),t=l.RequestUtils.validateRequest(n,!0,this.clientId,r.Constants.interactionTypePopup),u=this.telemetryManager.createAndStartApiEvent(t.correlationId,g.API_EVENT_IDENTIFIER.LoginPopup),new Promise(function(n,u){i.acquireTokenInteractive(r.Constants.interactionTypePopup,!0,t,n,u)}).then(function(n){return i.logger.verbose("Successfully logged in"),i.telemetryManager.stopAndFlushApiEvent(t.correlationId,u,!0),n}).catch(function(n){i.cacheStorage.resetTempCacheItems(t.state);i.telemetryManager.stopAndFlushApiEvent(t.correlationId,u,!1,n.errorCode);throw n;})},n.prototype.acquireTokenPopup=function(n){var i=this,t,u;return this.logger.verbose("AcquireTokenPopup has been called"),t=l.RequestUtils.validateRequest(n,!1,this.clientId,r.Constants.interactionTypePopup),u=this.telemetryManager.createAndStartApiEvent(t.correlationId,g.API_EVENT_IDENTIFIER.AcquireTokenPopup),new Promise(function(n,u){i.acquireTokenInteractive(r.Constants.interactionTypePopup,!1,t,n,u)}).then(function(n){return i.logger.verbose("Successfully acquired token"),i.telemetryManager.stopAndFlushApiEvent(t.correlationId,u,!0),n}).catch(function(n){i.cacheStorage.resetTempCacheItems(t.state);i.telemetryManager.stopAndFlushApiEvent(t.correlationId,u,!1,n.errorCode);throw n;})},n.prototype.acquireTokenInteractive=function(n,t,i,f,e){var s=this,l,a,c,v,y,h;if(this.logger.verbose("AcquireTokenInteractive has been called"),o.WindowUtils.blockReloadInHiddenIframes(),l=this.cacheStorage.getItem(r.TemporaryCacheKeys.INTERACTION_STATUS),n===r.Constants.interactionTypeRedirect&&this.cacheStorage.setItem(r.TemporaryCacheKeys.REDIRECT_REQUEST,""+r.Constants.inProgress+r.Constants.resourceDelimiter+i.state),l===r.Constants.inProgress){a=t?u.ClientAuthError.createLoginInProgressError():u.ClientAuthError.createAcquireTokenInProgressError();h=d.buildResponseStateOnly(this.getAccountState(i.state));this.cacheStorage.resetTempCacheItems(i.state);this.authErrorHandler(n,a,h,e);return}if(i&&i.account&&!t?(c=i.account,this.logger.verbose("Account set from request")):(c=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),c||w.ServerRequestParameters.isSSOParam(i))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(c,n,t,i,f,e);else if(t)v=this.extractADALIdToken(),v&&!i.scopes?(this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken"),y=this.buildIDTokenRequest(i),this.silentLogin=!0,this.acquireTokenSilent(y).then(function(t){s.silentLogin=!1;s.logger.info("Unified cache call is successful");s.authResponseHandler(n,t,f);return},function(r){s.silentLogin=!1;s.logger.error("Error occurred during unified cache ATS: "+r);s.acquireTokenHelper(null,n,t,i,f,e)})):(this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,n,t,i,f,e));else{this.logger.verbose("AcquireToken call, no context or account given");this.logger.info("User login is required");h=d.buildResponseStateOnly(this.getAccountState(i.state));this.cacheStorage.resetTempCacheItems(i.state);this.authErrorHandler(n,u.ClientAuthError.createUserLoginRequiredError(),h,e);return}},n.prototype.acquireTokenHelper=function(n,t,i,s,l,v){return h.__awaiter(this,void 0,Promise,function(){var nt,y,k,p,rt,ut,b,tt,g,ft,it;return h.__generator(this,function(h){switch(h.label){case 0:this.logger.verbose("AcquireTokenHelper has been called");this.logger.verbose("Interaction type: "+t+". isLoginCall: "+i);this.cacheStorage.setItem(r.TemporaryCacheKeys.INTERACTION_STATUS,r.Constants.inProgress);nt=s.scopes?s.scopes.join(" ").toLowerCase():this.clientId.toLowerCase();this.logger.verbosePii("Serialized scopes: "+nt);k=s&&s.authority?c.AuthorityFactory.CreateInstance(s.authority,this.config.auth.validateAuthority,s.authorityMetadata):this.authorityInstance;h.label=1;case 1:return(h.trys.push([1,11,,12]),!!k.hasCachedMetadata())?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,c.AuthorityFactory.saveMetadataFromNetwork(k,this.telemetryManager,s.correlationId)]);case 2:return h.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority");h.label=4;case 4:if(rt=i?a.id_token:this.getTokenType(n,s.scopes,!1),ut=s.redirectStartPage||window.location.href,y=new w.ServerRequestParameters(k,this.clientId,rt,this.getRedirectUri(s&&s.redirectUri),s.scopes,s.state,s.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(y,n,i,ut),this.logger.verbose("Updating cache entries"),y.populateQueryParams(n,s),this.logger.verbose("Query parameters populated from account"),b=e.UrlUtils.createNavigateUrl(y)+r.Constants.response_mode_fragment,t===r.Constants.interactionTypeRedirect)i?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.STATE_ACQ_TOKEN,s.state),y.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+y.state));else if(t===r.Constants.interactionTypePopup)window.renewStates.push(y.state),window.requestType=i?r.Constants.login:r.Constants.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+y.state),this.registerCallback(y.state,nt,l,v);else{this.logger.verbose("Invalid interaction error. State not cached");throw u.ClientAuthError.createInvalidInteractionTypeError();}if(!(t===r.Constants.interactionTypePopup))return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{p=this.openPopup(b,"msal",r.Constants.popUpWidth,r.Constants.popUpHeight);o.WindowUtils.trackPopup(p)}catch(et){if(this.logger.info(u.ClientAuthErrorMessage.popUpWindowError.code+":"+u.ClientAuthErrorMessage.popUpWindowError.desc),this.cacheStorage.setItem(r.ErrorCacheKeys.ERROR,u.ClientAuthErrorMessage.popUpWindowError.code),this.cacheStorage.setItem(r.ErrorCacheKeys.ERROR_DESC,u.ClientAuthErrorMessage.popUpWindowError.desc),v)return v(u.ClientAuthError.createPopupWindowError()),[2]}if(!p)return[3,8];h.label=5;case 5:return h.trys.push([5,7,,8]),[4,o.WindowUtils.monitorPopupForHash(p,this.config.system.loadFrameTimeout,b,this.logger)];case 6:return tt=h.sent(),this.handleAuthenticationResponse(tt),this.cacheStorage.removeItem(r.TemporaryCacheKeys.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&(this.broadcast("msal:popUpHashChanged",tt),o.WindowUtils.closePopups()),[3,8];case 7:return g=h.sent(),v&&v(g),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",g.errorCode+r.Constants.resourceDelimiter+g.errorMessage):(this.cacheStorage.removeItem(r.TemporaryCacheKeys.INTERACTION_STATUS),p.close()),[3,8];case 8:return[3,10];case 9:s.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),ft=s.onRedirectNavigate(b),ft!==!1?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(b)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(b));h.label=10;case 10:return[3,12];case 11:return it=h.sent(),this.logger.error(it),this.cacheStorage.resetTempCacheItems(s.state),this.authErrorHandler(t,u.ClientAuthError.createEndpointResolutionError(it.toString),d.buildResponseStateOnly(s.state),v),p&&p.close(),[3,12];case 12:return[2]}})})},n.prototype.ssoSilent=function(n){if(this.logger.verbose("ssoSilent has been called"),!n)throw k.ClientConfigurationError.createEmptyRequestError();if(!n.sid&&!n.loginHint)throw k.ClientConfigurationError.createSsoSilentError();return this.acquireTokenSilent(h.__assign({},n,{scopes:[this.clientId]}))},n.prototype.acquireTokenSilent=function(n){var i=this;this.logger.verbose("AcquireTokenSilent has been called");var t=l.RequestUtils.validateRequest(n,!1,this.clientId,r.Constants.interactionTypeSilent),e=this.telemetryManager.createAndStartApiEvent(t.correlationId,g.API_EVENT_IDENTIFIER.AcquireTokenSilent),f=l.RequestUtils.createRequestSignature(t);return new Promise(function(n,e){return h.__awaiter(i,void 0,void 0,function(){var g,l,y,b,i,nt,k,a,p,v,d;return h.__generator(this,function(h){switch(h.label){case 0:if(o.WindowUtils.blockReloadInHiddenIframes(),g=t.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+g),t.account?(l=t.account,this.logger.verbose("Account set from request")):(l=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),y=this.cacheStorage.getItem(r.Constants.adalIdToken),!l&&!(t.sid||t.loginHint)&&s.StringUtils.isEmpty(y))return this.logger.info("User login is required"),[2,e(u.ClientAuthError.createUserLoginRequiredError())];if(b=this.getTokenType(l,t.scopes,!0),this.logger.verbose("Response type: "+b),i=new w.ServerRequestParameters(c.AuthorityFactory.CreateInstance(t.authority,this.config.auth.validateAuthority,t.authorityMetadata),this.clientId,b,this.getRedirectUri(t.redirectUri),t.scopes,t.state,t.correlationId),this.logger.verbose("Finished building server authentication request"),w.ServerRequestParameters.isSSOParam(t)||l?(i.populateQueryParams(l,t,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):l||s.StringUtils.isEmpty(y)?this.logger.verbose("No additional query parameters added"):(nt=ft.TokenUtils.extractIdToken(y),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),i.populateQueryParams(l,null,nt,!0)),k=t.claimsRequest||i.claimsValue,!k&&!t.forceRefresh)try{p=this.getCachedToken(i,l)}catch(tt){a=tt}return p?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(p.scopes)),n(p),[2,null]):[3,1];case 1:return a?(this.logger.infoPii(a.errorCode+":"+a.errorMessage),e(a),[2,null]):[3,2];case 2:v=void 0;v=k?"Skipped cache lookup since claims were given":t.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No token found in cache lookup";this.logger.verbose(v);i.authorityInstance||(i.authorityInstance=t.authority?c.AuthorityFactory.CreateInstance(t.authority,this.config.auth.validateAuthority,t.authorityMetadata):this.authorityInstance);this.logger.verbosePii("Authority instance: "+i.authority);h.label=3;case 3:return(h.trys.push([3,7,,8]),!!i.authorityInstance.hasCachedMetadata())?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,c.AuthorityFactory.saveMetadataFromNetwork(i.authorityInstance,this.telemetryManager,t.correlationId)]);case 4:return h.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority");h.label=6;case 6:return window.activeRenewals[f]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[f],f,n,e)):t.scopes&&t.scopes.indexOf(this.clientId)>-1&&t.scopes.length===1?(this.logger.verbose("ClientId is the only scope, renewing idToken"),this.silentLogin=!0,this.renewIdToken(f,n,e,l,i)):(this.logger.verbose("Renewing access token"),this.renewToken(f,n,e,l,i)),[3,8];case 7:return d=h.sent(),this.logger.error(d),e(u.ClientAuthError.createEndpointResolutionError(d.toString())),[2,null];case 8:return[2]}})})}).then(function(n){return i.logger.verbose("Successfully acquired token"),i.telemetryManager.stopAndFlushApiEvent(t.correlationId,e,!0),n}).catch(function(n){i.cacheStorage.resetTempCacheItems(t.state);i.telemetryManager.stopAndFlushApiEvent(t.correlationId,e,!1,n.errorCode);throw n;})},n.prototype.openPopup=function(n,t,i,f){this.logger.verbose("OpenPopup has been called");try{var o=window.screenLeft?window.screenLeft:window.screenX,s=window.screenTop?window.screenTop:window.screenY,h=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=h/2-i/2+o,a=c/2-f/2+s,e=window.open(n,t,"width="+i+", height="+f+", top="+a+", left="+l+", scrollbars=yes");if(!e)throw u.ClientAuthError.createPopupWindowError();return e.focus&&e.focus(),e}catch(v){this.cacheStorage.removeItem(r.TemporaryCacheKeys.INTERACTION_STATUS);throw u.ClientAuthError.createPopupWindowError(v.toString());}},n.prototype.loadIframeTimeout=function(n,t,i){return h.__awaiter(this,void 0,Promise,function(){var u,e,s,c,l;return h.__generator(this,function(h){switch(h.label){case 0:return(u=window.activeRenewals[i],this.logger.verbosePii("Set loading state to pending for: "+i+":"+u),this.cacheStorage.setItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.RENEW_STATUS,u),r.Constants.inProgress),!this.config.system.navigateFrameWait)?[3,2]:[4,o.WindowUtils.loadFrame(n,t,this.config.system.navigateFrameWait,this.logger)];case 1:return s=h.sent(),[3,3];case 2:s=o.WindowUtils.loadFrameSync(n,t,this.logger);h.label=3;case 3:e=s;h.label=4;case 4:return h.trys.push([4,6,,7]),[4,o.WindowUtils.monitorIframeForHash(e.contentWindow,this.config.system.loadFrameTimeout,n,this.logger)];case 5:return c=h.sent(),c&&this.handleAuthenticationResponse(c),[3,7];case 6:l=h.sent();this.cacheStorage.getItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.RENEW_STATUS,u))===r.Constants.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+i+":"+u),u&&window.callbackMappedToRenewStates[u]&&window.callbackMappedToRenewStates[u](null,l),this.cacheStorage.removeItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.RENEW_STATUS,u)));o.WindowUtils.removeHiddenIframe(e);throw l;case 7:return o.WindowUtils.removeHiddenIframe(e),[2]}})})},n.prototype.navigateWindow=function(n,t){if(n&&!s.StringUtils.isEmpty(n)){var i=t?t:window,r=t?"Navigated Popup window to:"+n:"Navigate to:"+n;this.logger.infoPii(r);i.location.assign(n)}else{this.logger.info("Navigate url is empty");throw p.AuthError.createUnexpectedError("Navigate url is empty");}},n.prototype.registerCallback=function(n,t,i,r){var u=this;window.activeRenewals[t]=n;window.promiseMappedToRenewStates[n]||(window.promiseMappedToRenewStates[n]=[]);window.promiseMappedToRenewStates[n].push({resolve:i,reject:r});window.callbackMappedToRenewStates[n]||(window.callbackMappedToRenewStates[n]=function(i,r){window.activeRenewals[t]=null;for(var f=0;f<window.promiseMappedToRenewStates[n].length;++f)try{if(r)window.promiseMappedToRenewStates[n][f].reject(r);else if(i)window.promiseMappedToRenewStates[n][f].resolve(i);else{u.cacheStorage.resetTempCacheItems(n);throw p.AuthError.createUnexpectedError("Error and response are both null");}}catch(e){u.logger.warning(e)}window.promiseMappedToRenewStates[n]=null;window.callbackMappedToRenewStates[n]=null})},n.prototype.logout=function(n){this.logger.verbose("Logout has been called");this.logoutAsync(n)},n.prototype.logoutAsync=function(n){return h.__awaiter(this,void 0,Promise,function(){var t,u,f,i,r,e;return h.__generator(this,function(o){switch(o.label){case 0:t=n||ct.CryptoUtils.createNewGuid();u=this.telemetryManager.createAndStartApiEvent(t,g.API_EVENT_IDENTIFIER.Logout);this.clearCache();this.account=null;o.label=1;case 1:return(o.trys.push([1,5,,6]),!!this.authorityInstance.hasCachedMetadata())?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,c.AuthorityFactory.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,n)]);case 2:return o.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority");o.label=4;case 4:return f="client-request-id="+t,i=void 0,this.getPostLogoutRedirectUri()?(i="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(i="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),r=void 0,this.authorityInstance.EndSessionEndpoint?(r=this.authorityInstance.EndSessionEndpoint+"?"+f+i,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(r=this.authority+"oauth2/v2.0/logout?"+f+i,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,u,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(r),[3,6];case 5:return e=o.sent(),this.telemetryManager.stopAndFlushApiEvent(t,u,!1,e.errorCode),[3,6];case 6:return[2]}})})},n.prototype.clearCache=function(){var t,n;for(this.logger.verbose("Clearing cache"),window.renewStates=[],t=this.cacheStorage.getAllAccessTokens(r.Constants.clientId,r.Constants.homeAccountIdentifier),n=0;n<t.length;n++)this.cacheStorage.removeItem(JSON.stringify(t[n].key));this.cacheStorage.resetCacheItems();this.cacheStorage.clearMsalCookie();this.logger.verbose("Cache cleared")},n.prototype.clearCacheForScope=function(n){var u,t,i;for(this.logger.verbose("Clearing access token from cache"),u=this.cacheStorage.getAllAccessTokens(r.Constants.clientId,r.Constants.homeAccountIdentifier),t=0;t<u.length;t++)i=u[t],i.value.accessToken===n&&(this.cacheStorage.removeItem(JSON.stringify(i.key)),this.logger.verbosePii("Access token removed: "+i.key))},n.prototype.isCallback=function(n){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),e.UrlUtils.urlContainsHash(n)},n.prototype.processCallBack=function(n,t,i){var f,e,s;this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");t||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),t=this.getResponseState(n));try{f=this.saveTokenFromHash(n,t)}catch(o){e=o}try{if(this.cacheStorage.clearMsalCookie(t.state),s=this.getAccountState(t.state),f){if(t.requestType===r.Constants.renewToken||f.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+r.ServerHashParamKeys.ACCESS_TOKEN),f.tokenType=r.ServerHashParamKeys.ACCESS_TOKEN):t.requestType===r.Constants.login&&(this.logger.verbose("Response tokenType set to "+r.ServerHashParamKeys.ID_TOKEN),f.tokenType=r.ServerHashParamKeys.ID_TOKEN),!i){this.logger.verbose("Setting redirectResponse");this.redirectResponse=f;return}}else if(!i){this.logger.verbose("Response is null, setting redirectResponse with state");this.redirectResponse=d.buildResponseStateOnly(s);this.redirectError=e;this.cacheStorage.resetTempCacheItems(t.state);return}this.logger.verbose("Calling callback provided to processCallback");i(f,e)}catch(o){this.logger.error("Error occurred in token received callback function: "+o);throw u.ClientAuthError.createErrorInCallbackFunction(o.toString());}},n.prototype.handleAuthenticationResponse=function(n){var t,i,r;this.logger.verbose("HandleAuthenticationResponse has been called");t=n||window.location.hash;i=this.getResponseState(t);this.logger.verbose("Obtained state from response");r=window.callbackMappedToRenewStates[i.state];this.processCallBack(t,i,r);o.WindowUtils.closePopups()},n.prototype.handleRedirectAuthenticationResponse=function(n){var u,t,o,i,s;if(this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),window.location.hash="",this.logger.verbose("Window.location.hash cleared"),u=this.getResponseState(n),this.config.auth.navigateToLoginRequestUrl&&window.parent===window)if(this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on"),t=this.cacheStorage.getItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.LOGIN_REQUEST,u.state),this.inCookie),t&&t!=="null"){if(this.logger.verbose("Valid login request url obtained from cache"),o=e.UrlUtils.removeHashFromUrl(window.location.href),i=e.UrlUtils.removeHashFromUrl(t),o!==i){this.logger.verbose("Current url is not login request url, navigating");this.logger.verbosePii("CurrentUrl: "+o+", finalRedirectUrl: "+i);window.location.assign(""+i+n);return}this.logger.verbose("Current url matches login request url");s=e.UrlUtils.GetUrlComponents(t);s.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=s.Hash)}else{this.logger.error("Unable to get valid login request url from cache, redirecting to home page");window.location.assign("/");return}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(n,u,null)},n.prototype.getResponseState=function(n){var i,t,o,s,u;if(this.logger.verbose("GetResponseState has been called"),i=e.UrlUtils.deserializeHash(n),!i)throw p.AuthError.createUnexpectedError("Hash was not parsed correctly.");if(i.hasOwnProperty(r.ServerHashParamKeys.STATE))this.logger.verbose("Hash contains state. Creating stateInfo object"),o=l.RequestUtils.parseLibraryState(i.state),t={requestType:r.Constants.unknown,state:i.state,timestamp:o.ts,method:o.method,stateMatch:!1};else throw p.AuthError.createUnexpectedError("Hash does not contain state.");if(t.state===this.cacheStorage.getItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=r.Constants.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=r.Constants.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){for(this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType,s=window.renewStates,u=0;u<s.length;u++)if(s[u]===t.state){this.logger.verbose("Matching state found for request");t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},n.prototype.getCachedToken=function(n,t){var f,b,o,s,a,v,d,w,g,k;this.logger.verbose("GetCachedToken has been called");var i=null,l=n.scopes,h=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(this.logger.verbose("Getting all cached access tokens"),h.length===0)return this.logger.verbose("No matching tokens found when filtered by clientId and account"),null;if(f=[],n.authority){for(this.logger.verbose("Authority passed, filtering by authority and scope"),o=0;o<h.length;o++)s=h[o],a=s.key.scopes.split(" "),nt.ScopeSet.containsScope(a,l)&&e.UrlUtils.CanonicalizeUri(s.key.authority)===n.authority&&f.push(s);if(f.length===0)return this.logger.verbose("No matching tokens found"),null;if(f.length===1)this.logger.verbose("Single token found"),i=f[0];else throw u.ClientAuthError.createMultipleMatchingTokensInCacheError(l.toString());}else{for(this.logger.verbose("No authority passed, filtering tokens by scope"),o=0;o<h.length;o++)s=h[o],a=s.key.scopes.split(" "),nt.ScopeSet.containsScope(a,l)&&f.push(s);if(f.length===1)this.logger.verbose("One matching token found, setting authorityInstance"),i=f[0],n.authorityInstance=c.AuthorityFactory.CreateInstance(i.key.authority,this.config.auth.validateAuthority);else if(f.length>1)throw u.ClientAuthError.createMultipleMatchingTokensInCacheError(l.toString());else{if(this.logger.verbose("No matching token found when filtering by scope"),b=this.getUniqueAuthority(h,"authority"),b.length>1)throw u.ClientAuthError.createMultipleAuthoritiesInCacheError(l.toString());this.logger.verbose("Single authority used, setting authorityInstance");n.authorityInstance=c.AuthorityFactory.CreateInstance(b[0],this.config.auth.validateAuthority)}}if(i!=null){if(this.logger.verbose("Evaluating access token found"),v=Number(i.value.expiresIn),d=this.config.system.tokenRenewalOffsetSeconds||300,v&&v>et.TimeUtils.now()+d){if(this.logger.verbose("Token expiration is within offset, renewing token"),w=new y.IdToken(i.value.idToken),!t&&(t=this.getAccount(),!t))throw p.AuthError.createUnexpectedError("Account should not be null here.");return g=this.getAccountState(n.state),k={uniqueId:"",tenantId:"",tokenType:i.value.idToken===i.value.accessToken?r.ServerHashParamKeys.ID_TOKEN:r.ServerHashParamKeys.ACCESS_TOKEN,idToken:w,idTokenClaims:w.claims,accessToken:i.value.accessToken,scopes:i.key.scopes.split(" "),expiresOn:new Date(v*1e3),account:t,accountState:g,fromCache:!0},tt.ResponseUtils.setResponseIdToken(k,w),this.logger.verbose("Response generated and token set"),k}return this.logger.verbose("Token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(f[0].key)),null}return this.logger.verbose("No tokens found"),null},n.prototype.getUniqueAuthority=function(n,t){this.logger.verbose("GetUniqueAuthority has been called");var i=[],r=[];return n.forEach(function(n){n.key.hasOwnProperty(t)&&r.indexOf(n.key[t])===-1&&(r.push(n.key[t]),i.push(n.key[t]))}),i},n.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var n=this.cacheStorage.getItem(r.Constants.adalIdToken);return s.StringUtils.isEmpty(n)?null:ft.TokenUtils.extractIdToken(n)},n.prototype.renewToken=function(n,t,i,u,f){var s,h;this.logger.verbose("RenewToken has been called");this.logger.verbosePii("RenewToken scope and authority: "+n);s=o.WindowUtils.generateFrameName(r.FramePrefix.TOKEN_FRAME,n);o.WindowUtils.addHiddenIFrame(s,this.logger);this.updateCacheEntries(f,u,!1);this.logger.verbosePii("RenewToken expected state: "+f.state);h=e.UrlUtils.urlRemoveQueryStringParameter(e.UrlUtils.createNavigateUrl(f),r.Constants.prompt)+r.Constants.prompt_none+r.Constants.response_mode_fragment;window.renewStates.push(f.state);window.requestType=r.Constants.renewToken;this.logger.verbose("Set window.renewState and requestType");this.registerCallback(f.state,n,t,i);this.logger.infoPii("Navigate to: "+h);this.loadIframeTimeout(h,s,n).catch(function(n){return i(n)})},n.prototype.renewIdToken=function(n,t,i,u,f){var s,h;this.logger.info("RenewIdToken has been called");s=o.WindowUtils.generateFrameName(r.FramePrefix.ID_TOKEN_FRAME,n);o.WindowUtils.addHiddenIFrame(s,this.logger);this.updateCacheEntries(f,u,!1);this.logger.verbose("RenewIdToken expected state: "+f.state);h=e.UrlUtils.urlRemoveQueryStringParameter(e.UrlUtils.createNavigateUrl(f),r.Constants.prompt)+r.Constants.prompt_none+r.Constants.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=r.Constants.login,this.silentAuthenticationState=f.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=r.Constants.renewToken,window.renewStates.push(f.state));this.registerCallback(f.state,n,t,i);this.logger.infoPii('Navigate to:" '+h);this.loadIframeTimeout(h,s,n).catch(function(n){return i(n)})},n.prototype.saveAccessToken=function(n,t,i,u,f){var o,e,c,s,w,k,a,v,d,g,tt,y,p;if(this.logger.verbose("SaveAccessToken has been called"),e=h.__assign({},n),c=new b.ClientInfo(u),i.hasOwnProperty(r.ServerHashParamKeys.SCOPE)){for(this.logger.verbose("Response parameters contains scope"),o=i[r.ServerHashParamKeys.SCOPE],w=o.split(" "),k=this.cacheStorage.getAllAccessTokens(this.clientId,t),this.logger.verbose("Retrieving all access tokens from cache and removing duplicates"),a=0;a<k.length;a++)v=k[a],v.key.homeAccountIdentifier===n.account.homeAccountIdentifier&&(d=v.key.scopes.split(" "),nt.ScopeSet.isIntersectingScopes(d,w)&&this.cacheStorage.removeItem(JSON.stringify(v.key)));g=et.TimeUtils.parseExpiresIn(i[r.ServerHashParamKeys.EXPIRES_IN]);tt=l.RequestUtils.parseLibraryState(i[r.ServerHashParamKeys.STATE]);s=tt.ts+g;y=new rt.AccessTokenKey(t,this.clientId,o,c.uid,c.utid);p=new ut.AccessTokenValue(i[r.ServerHashParamKeys.ACCESS_TOKEN],f.rawIdToken,s.toString(),u);this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(p));this.logger.verbose("Saving token to cache");e.accessToken=i[r.ServerHashParamKeys.ACCESS_TOKEN];e.scopes=w}else this.logger.verbose("Response parameters does not contain scope, clientId set as scope"),o=this.clientId,y=new rt.AccessTokenKey(t,this.clientId,o,c.uid,c.utid),s=Number(f.expiration),p=new ut.AccessTokenValue(i[r.ServerHashParamKeys.ID_TOKEN],i[r.ServerHashParamKeys.ID_TOKEN],s.toString(),u),this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(p)),this.logger.verbose("Saving token to cache"),e.scopes=[o],e.accessToken=i[r.ServerHashParamKeys.ID_TOKEN];return s?(this.logger.verbose("New expiration set"),e.expiresOn=new Date(s*1e3)):this.logger.error("Could not parse expiresIn parameter"),e},n.prototype.saveTokenFromHash=function(n,t){var g,nt,l,rt,ot,ft,ut,k,d,et;this.logger.verbose("SaveTokenFromHash has been called");this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var o={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},c,i=e.UrlUtils.deserializeHash(n),a="",w="",h=null;if(i.hasOwnProperty(r.ServerHashParamKeys.ERROR_DESCRIPTION)||i.hasOwnProperty(r.ServerHashParamKeys.ERROR)){this.logger.verbose("Server returned an error");this.logger.infoPii("Error : "+i[r.ServerHashParamKeys.ERROR]+"; Error description: "+i[r.ServerHashParamKeys.ERROR_DESCRIPTION]);this.cacheStorage.setItem(r.ErrorCacheKeys.ERROR,i[r.ServerHashParamKeys.ERROR]);this.cacheStorage.setItem(r.ErrorCacheKeys.ERROR_DESC,i[r.ServerHashParamKeys.ERROR_DESCRIPTION]);t.requestType===r.Constants.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(r.ErrorCacheKeys.LOGIN_ERROR,i[r.ServerHashParamKeys.ERROR_DESCRIPTION]+":"+i[r.ServerHashParamKeys.ERROR]),a=f.AuthCache.generateAuthorityKey(t.state));t.requestType===r.Constants.renewToken&&(this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),a=f.AuthCache.generateAuthorityKey(t.state),g=this.getAccount(),nt=void 0,g&&!s.StringUtils.isEmpty(g.homeAccountIdentifier)?(nt=g.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(nt=r.Constants.no_account,this.logger.verbose("AccountId is set as no_account")),w=f.AuthCache.generateAcquireTokenAccountKey(nt,t.state));var st=r.ServerHashParamKeys.ERROR,ct=i[st],lt=r.ServerHashParamKeys.ERROR_DESCRIPTION,at=i[lt];c=it.InteractionRequiredAuthError.isInteractionRequiredError(ct)||it.InteractionRequiredAuthError.isInteractionRequiredError(at)?new it.InteractionRequiredAuthError(i[r.ServerHashParamKeys.ERROR],i[r.ServerHashParamKeys.ERROR_DESCRIPTION]):new ht.ServerError(i[r.ServerHashParamKeys.ERROR],i[r.ServerHashParamKeys.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){if(this.logger.info("State is right"),i.hasOwnProperty(r.ServerHashParamKeys.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.SESSION_STATE,t.state),i[r.ServerHashParamKeys.SESSION_STATE])),o.accountState=this.getAccountState(t.state),l="",i.hasOwnProperty(r.ServerHashParamKeys.ACCESS_TOKEN)){if(this.logger.info("Fragment has access token"),o.accessToken=i[r.ServerHashParamKeys.ACCESS_TOKEN],i.hasOwnProperty(r.ServerHashParamKeys.SCOPE)&&(o.scopes=i[r.ServerHashParamKeys.SCOPE].split(" ")),i.hasOwnProperty(r.ServerHashParamKeys.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),h=new y.IdToken(i[r.ServerHashParamKeys.ID_TOKEN]),o.idToken=h,o.idTokenClaims=h.claims):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),h=new y.IdToken(this.cacheStorage.getItem(r.PersistentCacheKeys.IDTOKEN)),o=tt.ResponseUtils.setResponseIdToken(o,h)),k=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,h),this.logger.verbose("Got authority from cache"),i.hasOwnProperty(r.ServerHashParamKeys.CLIENT_INFO))this.logger.verbose("Fragment has clientInfo"),l=i[r.ServerHashParamKeys.CLIENT_INFO];else{this.logger.warning("ClientInfo not received in the response from AAD");throw u.ClientAuthError.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");}o.account=v.Account.createAccount(h,new b.ClientInfo(l));this.logger.verbose("Account object created from response");rt=void 0;o.account&&!s.StringUtils.isEmpty(o.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),rt=o.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),rt=r.Constants.no_account);w=f.AuthCache.generateAcquireTokenAccountKey(rt,t.state);ot=f.AuthCache.generateAcquireTokenAccountKey(r.Constants.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");ft=this.cacheStorage.getItem(w);ut=void 0;s.StringUtils.isEmpty(ft)?s.StringUtils.isEmpty(this.cacheStorage.getItem(ot))||(this.logger.verbose("No acquireToken account retrieved from cache"),o=this.saveAccessToken(o,k,i,l,h)):(ut=JSON.parse(ft),this.logger.verbose("AcquireToken request account retrieved from cache"),o.account&&ut&&v.Account.compareAccounts(o.account,ut)?(o=this.saveAccessToken(o,k,i,l,h),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}i.hasOwnProperty(r.ServerHashParamKeys.ID_TOKEN)&&(this.logger.info("Fragment has idToken"),h=new y.IdToken(i[r.ServerHashParamKeys.ID_TOKEN]),o=tt.ResponseUtils.setResponseIdToken(o,h),i.hasOwnProperty(r.ServerHashParamKeys.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),l=i[r.ServerHashParamKeys.CLIENT_INFO]):this.logger.warning("ClientInfo not received in the response from AAD"),k=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,h),this.account=v.Account.createAccount(h,new b.ClientInfo(l)),o.account=this.account,this.logger.verbose("Account object created from response"),h&&h.nonce?(this.logger.verbose("IdToken has nonce"),d=this.cacheStorage.getItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.NONCE_IDTOKEN,t.state),this.inCookie),h.nonce!==d?(this.account=null,this.cacheStorage.setItem(r.ErrorCacheKeys.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+d+",Actual Nonce: "+h.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+d+", Actual Nonce: "+h.nonce),c=u.ClientAuthError.createNonceMismatchError(d,h.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(r.PersistentCacheKeys.IDTOKEN,i[r.ServerHashParamKeys.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(r.PersistentCacheKeys.CLIENT_INFO,l,this.inCookie),this.saveAccessToken(o,k,i,l,h))):(this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),a=t.state,w=t.state,this.logger.error("Invalid id_token received in the response"),c=u.ClientAuthError.createInvalidIdTokenError(h),this.cacheStorage.setItem(r.ErrorCacheKeys.ERROR,c.errorCode),this.cacheStorage.setItem(r.ErrorCacheKeys.ERROR_DESC,c.errorMessage)))}else this.logger.verbose("State mismatch"),a=t.state,w=t.state,et=this.cacheStorage.getItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.STATE_LOGIN,t.state),this.inCookie),this.logger.error("State Mismatch. Expected State: "+et+", Actual State: "+t.state),c=u.ClientAuthError.createInvalidStateError(t.state,et),this.cacheStorage.setItem(r.ErrorCacheKeys.ERROR,c.errorCode),this.cacheStorage.setItem(r.ErrorCacheKeys.ERROR_DESC,c.errorMessage);if(this.cacheStorage.removeItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(a,"",-1),this.cacheStorage.clearMsalCookie(t.state)),c)throw c;if(!o)throw p.AuthError.createUnexpectedError("Response is null");return o},n.prototype.populateAuthority=function(n,t,i,r){this.logger.verbose("PopulateAuthority has been called");var o=f.AuthCache.generateAuthorityKey(n),u=i.getItem(o,t);return s.StringUtils.isEmpty(u)?u:e.UrlUtils.replaceTenantPath(u,r.tenantId)},n.prototype.getAccount=function(){var n,t,i,u;return this.account?this.account:(n=this.cacheStorage.getItem(r.PersistentCacheKeys.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(r.PersistentCacheKeys.CLIENT_INFO,this.inCookie),!s.StringUtils.isEmpty(n)&&!s.StringUtils.isEmpty(t))?(i=new y.IdToken(n),u=new b.ClientInfo(t),this.account=v.Account.createAccount(i,u),this.account):null},n.prototype.getAccountState=function(n){if(n){var t=n.indexOf(r.Constants.resourceDelimiter);if(t>-1&&t+1<n.length)return n.substring(t+1)}return n},n.prototype.getAllAccounts=function(){for(var i=[],t=this.cacheStorage.getAllAccessTokens(r.Constants.clientId,r.Constants.homeAccountIdentifier),n=0;n<t.length;n++){var u=new y.IdToken(t[n].value.idToken),f=new b.ClientInfo(t[n].value.homeAccountIdentifier),e=v.Account.createAccount(u,f);i.push(e)}return this.getUniqueAccounts(i)},n.prototype.getUniqueAccounts=function(n){var i,r,t;if(!n||n.length<=1)return n;for(i=[],r=[],t=0;t<n.length;++t)n[t].homeAccountIdentifier&&i.indexOf(n[t].homeAccountIdentifier)===-1&&(i.push(n[t].homeAccountIdentifier),r.push(n[t]));return r},n.prototype.broadcast=function(n,t){var i=new CustomEvent(n,{detail:t});window.dispatchEvent(i)},n.prototype.getCachedTokenInternal=function(n,t,i,r){var u=t||this.getAccount();if(!u)return null;var f=this.authorityInstance?this.authorityInstance:c.AuthorityFactory.CreateInstance(this.authority,this.config.auth.validateAuthority),e=this.getTokenType(u,n,!0),o=new w.ServerRequestParameters(f,this.clientId,e,this.getRedirectUri(),n,i,r);return this.getCachedToken(o,t)},n.prototype.getScopesForEndpoint=function(n){var t,i,r,u;if(this.config.framework.unprotectedResources.length>0)for(t=0;t<this.config.framework.unprotectedResources.length;t++)if(n.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(i=0,r=Array.from(this.config.framework.protectedResourceMap.keys());i<r.length;i++)if(u=r[i],n.indexOf(u)>-1)return this.config.framework.protectedResourceMap.get(u);if(n.indexOf("http://")>-1||n.indexOf("https://")>-1){if(e.UrlUtils.getHostFromUri(n)===e.UrlUtils.getHostFromUri(this.getRedirectUri()))return new Array(this.clientId)}else return new Array(this.clientId);return null},n.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(r.TemporaryCacheKeys.INTERACTION_STATUS)===r.Constants.inProgress},n.prototype.setInteractionInProgress=function(n){n?this.cacheStorage.setItem(r.TemporaryCacheKeys.INTERACTION_STATUS,r.Constants.inProgress):this.cacheStorage.removeItem(r.TemporaryCacheKeys.INTERACTION_STATUS)},n.prototype.setloginInProgress=function(n){this.setInteractionInProgress(n)},n.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(r.TemporaryCacheKeys.INTERACTION_STATUS)===r.Constants.inProgress},n.prototype.setAcquireTokenInProgress=function(n){this.setInteractionInProgress(n)},n.prototype.getLogger=function(){return this.logger},n.prototype.setLogger=function(n){this.logger=n},n.prototype.getRedirectUri=function(n){return n?n:typeof this.config.auth.redirectUri=="function"?this.config.auth.redirectUri():this.config.auth.redirectUri},n.prototype.getPostLogoutRedirectUri=function(){return typeof this.config.auth.postLogoutRedirectUri=="function"?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},n.prototype.getCurrentConfiguration=function(){if(!this.config)throw k.ClientConfigurationError.createNoSetConfigurationError();return this.config},n.prototype.getTokenType=function(n,t,i){return i?v.Account.compareAccounts(n,this.getAccount())?t.indexOf(this.config.auth.clientId)>-1?a.id_token:a.token:t.indexOf(this.config.auth.clientId)>-1?a.id_token:a.id_token_token:v.Account.compareAccounts(n,this.getAccount())?t.indexOf(this.clientId)>-1?a.id_token:a.token:a.id_token_token},n.prototype.setAccountCache=function(n,t){var i=n?this.getAccountId(n):r.Constants.no_account,u=f.AuthCache.generateAcquireTokenAccountKey(i,t);this.cacheStorage.setItem(u,JSON.stringify(n))},n.prototype.setAuthorityCache=function(n,t){var i=f.AuthCache.generateAuthorityKey(n);this.cacheStorage.setItem(i,e.UrlUtils.CanonicalizeUri(t),this.inCookie)},n.prototype.updateCacheEntries=function(n,t,i,u){u&&this.cacheStorage.setItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.LOGIN_REQUEST,n.state),u,this.inCookie);i?this.cacheStorage.setItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.STATE_LOGIN,n.state),n.state,this.inCookie):this.setAccountCache(t,n.state);this.setAuthorityCache(n.state,n.authority);this.cacheStorage.setItem(f.AuthCache.generateTemporaryCacheKey(r.TemporaryCacheKeys.NONCE_IDTOKEN,n.state),n.nonce,this.inCookie)},n.prototype.getAccountId=function(n){return s.StringUtils.isEmpty(n.homeAccountIdentifier)?r.Constants.no_account:n.homeAccountIdentifier},n.prototype.buildIDTokenRequest=function(n){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:n.extraQueryParameters,correlationId:n.correlationId}},n.prototype.getTelemetryManagerFromConfig=function(n,t){var f,e;if(!n)return ot.default.getTelemetrymanagerStub(t,this.logger);var i=n.applicationName,r=n.applicationVersion,u=n.telemetryEmitter;if(!i||!r||!u)throw k.ClientConfigurationError.createTelemetryConfigError(n);return f={applicationName:i,applicationVersion:r},e={platform:f,clientId:t},new ot.default(e,u,this.logger)},n}();t.UserAgentApplication=vt},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(2),r=i(1),f=i(3),e=i(9),o=function(){function n(n,t,i,f,o,s,h){this.authorityInstance=n;this.clientId=t;this.nonce=u.CryptoUtils.createNewGuid();this.scopes=o?o.slice():[t];this.scopes=e.ScopeSet.trimAndConvertArrayToLowerCase(this.scopes);this.state=s;this.correlationId=h;this.xClientSku="MSAL.JS";this.xClientVer=r.libraryVersion();this.responseType=i;this.redirectUri=f}return Object.defineProperty(n.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),n.prototype.populateQueryParams=function(t,i,r,u){var f={},e;i&&(i.prompt&&(this.promptValue=i.prompt),i.claimsRequest&&(this.claimsValue=i.claimsRequest),n.isSSOParam(i)&&(f=this.constructUnifiedCacheQueryParameter(i,null)));r&&(f=this.constructUnifiedCacheQueryParameter(null,r));f=this.addHintParameters(t,f);e=i?i.extraQueryParameters:null;this.queryParameters=n.generateQueryParametersString(f);this.extraQueryParameters=n.generateQueryParametersString(e,u)},n.prototype.constructUnifiedCacheQueryParameter=function(n,t){var i,u,f;return n?n.account?(f=n.account,f.sid?(i=r.SSOTypes.SID,u=f.sid):f.userName&&(i=r.SSOTypes.LOGIN_HINT,u=f.userName)):n.sid?(i=r.SSOTypes.SID,u=n.sid):n.loginHint&&(i=r.SSOTypes.LOGIN_HINT,u=n.loginHint):t&&t.hasOwnProperty(r.Constants.upn)&&(i=r.SSOTypes.ID_TOKEN,u=t.upn),this.addSSOParameter(i,u)},n.prototype.addHintParameters=function(n,t){var i,u;return n&&!t[r.SSOTypes.SID]&&(i=!t[r.SSOTypes.LOGIN_HINT]&&n.sid&&this.promptValue===r.PromptState.NONE,i?t=this.addSSOParameter(r.SSOTypes.SID,n.sid,t):(u=!t[r.SSOTypes.LOGIN_HINT]&&n.userName&&!f.StringUtils.isEmpty(n.userName),u&&(t=this.addSSOParameter(r.SSOTypes.LOGIN_HINT,n.userName,t)))),t},n.prototype.addSSOParameter=function(n,t,i){if(i||(i={}),!t)return i;switch(n){case r.SSOTypes.SID:i[r.SSOTypes.SID]=t;break;case r.SSOTypes.ID_TOKEN:i[r.SSOTypes.LOGIN_HINT]=t;break;case r.SSOTypes.LOGIN_HINT:i[r.SSOTypes.LOGIN_HINT]=t}return i},n.generateQueryParametersString=function(n,t){var i=null;return n&&Object.keys(n).forEach(function(u){u===r.Constants.domain_hint&&(t||n[r.SSOTypes.SID])||(i==null?i=u+"="+encodeURIComponent(n[u]):i+="&"+u+"="+encodeURIComponent(n[u]))}),i},n.isSSOParam=function(n){return n&&(n.account||n.sid||n.loginHint)},n}();t.ServerRequestParameters=o},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),u=i(3),f=function(){function n(){}return n.decodeJwt=function(n){var i,t;return u.StringUtils.isEmpty(n)?null:(i=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/,t=i.exec(n),!t||t.length<4)?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},n.extractIdToken=function(n){var i=this.decodeJwt(n),u,t;if(!i)return null;try{return(u=i.JWSPayload,t=r.CryptoUtils.base64Decode(u),!t)?null:JSON.parse(t)}catch(f){}return null},n}();t.TokenUtils=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=i(0),r=i(1),f=i(5),o=i(9),h=i(3),u=i(2),s=i(11),c=i(6),l=function(){function n(){}return n.validateRequest=function(n,t,i,r){var u,s;if(!t&&!n)throw f.ClientConfigurationError.createEmptyRequestError();n&&(u=t?o.ScopeSet.appendScopes(n.scopes,n.extraScopesToConsent):n.scopes,o.ScopeSet.validateInputScope(u,!t,i),this.validatePromptParameter(n.prompt),s=this.validateEQParameters(n.extraQueryParameters,n.claimsRequest),this.validateClaimsRequest(n.claimsRequest));var h=this.validateAndGenerateState(n&&n.state,r),c=this.validateAndGenerateCorrelationId(n&&n.correlationId);return e.__assign({},n,{extraQueryParameters:s,scopes:u,state:h,correlationId:c})},n.validatePromptParameter=function(n){if(n&&[r.PromptState.LOGIN,r.PromptState.SELECT_ACCOUNT,r.PromptState.CONSENT,r.PromptState.NONE].indexOf(n)<0)throw f.ClientConfigurationError.createInvalidPromptError(n);},n.validateEQParameters=function(n,t){var i=e.__assign({},n);return i?(t&&delete i[r.Constants.claims],r.BlacklistedEQParams.forEach(function(n){i[n]&&delete i[n]}),i):null},n.validateClaimsRequest=function(n){if(n){var t;try{t=JSON.parse(n)}catch(i){throw f.ClientConfigurationError.createClaimsRequestParsingError(i);}}},n.validateAndGenerateState=function(t,i){return h.StringUtils.isEmpty(t)?n.generateLibraryState(i):""+n.generateLibraryState(i)+r.Constants.resourceDelimiter+t},n.generateLibraryState=function(n){var t={id:u.CryptoUtils.createNewGuid(),ts:s.TimeUtils.now(),method:n},i=JSON.stringify(t);return u.CryptoUtils.base64Encode(i)},n.parseLibraryState=function(n){var t=decodeURIComponent(n).split(r.Constants.resourceDelimiter)[0],i,f;if(u.CryptoUtils.isGuid(t))return{id:t,ts:s.TimeUtils.now(),method:r.Constants.interactionTypeRedirect};try{return i=u.CryptoUtils.base64Decode(t),f=JSON.parse(i),f}catch(e){throw c.ClientAuthError.createInvalidStateError(n,null);}},n.validateAndGenerateCorrelationId=function(n){if(n&&!u.CryptoUtils.isGuid(n))throw f.ClientConfigurationError.createInvalidCorrelationIdError();return u.CryptoUtils.isGuid(n)?n:u.CryptoUtils.createNewGuid()},n.createRequestSignature=function(n){return""+n.scopes.join(" ").toLowerCase()+r.Constants.resourceDelimiter+n.authority},n}();t.RequestUtils=l},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),u=i(3),f=function(){function n(n,t,i,r,u,f,e){this.accountIdentifier=n;this.homeAccountIdentifier=t;this.userName=i;this.name=r;this.idToken=u;this.idTokenClaims=u;this.sid=f;this.environment=e}return n.createAccount=function(t,i){var s=t.objectId||t.subject,f=i?i.uid:"",e=i?i.utid:"",o;return u.StringUtils.isEmpty(f)||u.StringUtils.isEmpty(e)||(o=r.CryptoUtils.base64Encode(f)+"."+r.CryptoUtils.base64Encode(e)),new n(s,o,t.preferredName,t.name,t.claims,t.sid,t.issuer)},n.compareAccounts=function(n,t){return!n||!t?!1:n.homeAccountIdentifier&&t.homeAccountIdentifier&&n.homeAccountIdentifier===t.homeAccountIdentifier?!0:!1},n}();t.Account=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(6),u=i(4),f=i(1),e=i(11),o=function(){function n(){}return n.isInIframe=function(){return window.parent!==window},n.isInPopup=function(){return!!(window.opener&&window.opener!==window)},n.generateFrameName=function(n,t){return""+n+f.Constants.resourceDelimiter+t},n.monitorIframeForHash=function(t,i,f,o){return new Promise(function(s,h){var l=e.TimeUtils.relativeNowMs(),a=l+i,c;o.verbose("monitorWindowForIframe polling started");c=setInterval(function(){if(e.TimeUtils.relativeNowMs()>a){o.error("monitorIframeForHash unable to find hash in url, timing out");o.errorPii("monitorIframeForHash polling timed out for url: "+f);clearInterval(c);h(r.ClientAuthError.createTokenRenewalTimeoutError());return}var n;try{n=t.location.href}catch(i){}n&&u.UrlUtils.urlContainsHash(n)&&(o.verbose("monitorIframeForHash found url in hash"),clearInterval(c),s(t.location.hash))},n.POLLING_INTERVAL_MS)})},n.monitorPopupForHash=function(t,i,f,e){return new Promise(function(o,s){var l=i/n.POLLING_INTERVAL_MS,c=0,h;e.verbose("monitorWindowForHash polling started");h=setInterval(function(){if(t.closed){e.error("monitorWindowForHash window closed");clearInterval(h);s(r.ClientAuthError.createUserCancelledError());return}var n;try{n=t.location.href}catch(i){}n&&n!=="about:blank"&&(c++,n&&u.UrlUtils.urlContainsHash(n)?(e.verbose("monitorPopupForHash found url in hash"),clearInterval(h),o(t.location.hash)):c>l&&(e.error("monitorPopupForHash unable to find hash in url, timing out"),e.errorPii("monitorPopupForHash polling timed out for url: "+f),clearInterval(h),s(r.ClientAuthError.createTokenRenewalTimeoutError())))},n.POLLING_INTERVAL_MS)})},n.loadFrame=function(n,t,i,r){var u=this;return r.infoPii("LoadFrame: "+t),new Promise(function(f,e){setTimeout(function(){var i=u.loadFrameSync(n,t,r);if(!i){e("Unable to load iframe with name: "+t);return}f(i)},i)})},n.loadFrameSync=function(t,i,r){var u=n.addHiddenIFrame(i,r);if(u)(u.src===""||u.src==="about:blank")&&(u.src=t,r.infoPii("Frame Name : "+i+" Navigated to: "+t));else return null;return u},n.addHiddenIFrame=function(n,t){var r,i;return typeof n=="undefined"?null:(t.infoPii("Add msal frame to document:"+n),r=document.getElementById(n),r||(document.createElement&&document.documentElement&&window.navigator.userAgent.indexOf("MSIE 5.0")===-1?(i=document.createElement("iframe"),i.setAttribute("id",n),i.setAttribute("aria-hidden","true"),i.style.visibility="hidden",i.style.position="absolute",i.style.width=i.style.height="0",i.style.border="0",i.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(i)):document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+n+"' id='"+n+"' style='display:none'><\/iframe>"),window.frames&&window.frames[n]&&(r=window.frames[n])),r)},n.removeHiddenIframe=function(n){document.body===n.parentNode&&document.body.removeChild(n)},n.getIframeWithHash=function(n){var t=document.getElementsByTagName("iframe"),i=Array.apply(null,Array(t.length)).map(function(n,i){return t.item(i)});return i.filter(function(t){try{return t.contentWindow.location.hash===n}catch(i){return!1}})[0]},n.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},n.getPopUpWithHash=function(t){return n.getPopups().filter(function(n){try{return n.location.hash===t}catch(i){return!1}})[0]},n.trackPopup=function(t){n.getPopups().push(t)},n.closePopups=function(){n.getPopups().forEach(function(n){return n.close()})},n.blockReloadInHiddenIframes=function(){if(u.UrlUtils.urlContainsHash(window.location.hash)&&n.isInIframe())throw r.ClientAuthError.createBlockTokenRequestsInHiddenIframeError();},n.checkIfBackButtonIsPressed=function(n){var i=n.getItem(f.TemporaryCacheKeys.REDIRECT_REQUEST),t,r;i&&!u.UrlUtils.urlContainsHash(window.location.hash)&&(t=i.split(f.Constants.resourceDelimiter),r=t.length>1?t[t.length-1]:null,n.resetTempCacheItems(r))},n.POLLING_INTERVAL_MS=50,n}();t.WindowUtils=o},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),f=i(22),e=i(3),u=i(5),o=i(1),s=i(4),h=function(){function n(){}return n.saveMetadataFromNetwork=function(n,t,i){return r.__awaiter(this,void 0,Promise,function(){var u;return r.__generator(this,function(r){switch(r.label){case 0:return[4,n.resolveEndpointsAsync(t,i)];case 1:return u=r.sent(),this.metadataMap.set(n.CanonicalAuthority,u),[2,u]}})})},n.getMetadata=function(n){return this.metadataMap.get(n)},n.saveMetadataFromConfig=function(n,t){try{if(t){var i=JSON.parse(t);if(!i.authorization_endpoint||!i.end_session_endpoint||!i.issuer)throw u.ClientConfigurationError.createInvalidAuthorityMetadataError();this.metadataMap.set(n,{AuthorizationEndpoint:i.authorization_endpoint,EndSessionEndpoint:i.end_session_endpoint,Issuer:i.issuer})}}catch(r){throw u.ClientConfigurationError.createInvalidAuthorityMetadataError();}},n.CreateInstance=function(n,t,i){return e.StringUtils.isEmpty(n)?null:(i&&this.saveMetadataFromConfig(n,i),new f.Authority(n,t,this.metadataMap.get(n)))},n.isAdfs=function(n){var i=s.UrlUtils.GetUrlComponents(n),t=i.PathSegments;return t.length&&t[0].toLowerCase()===o.Constants.ADFS?!0:!1},n.metadataMap=new Map,n}();t.AuthorityFactory=h},function(n,t,i){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});var f=i(0),r=i(5),s=i(23),e=i(4),u=i(24),h=i(1),c;(function(n){n[n.Default=0]="Default";n[n.Adfs=1]="Adfs"})(c=t.AuthorityType||(t.AuthorityType={}));o=function(){function n(n,t,i){this.IsValidationEnabled=t;this.CanonicalAuthority=n;this.validateAsUri();this.tenantDiscoveryResponse=i}return Object.defineProperty(n.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),n.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first";},Object.defineProperty(n.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(n){this.canonicalAuthority=e.UrlUtils.CanonicalizeUri(n);this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=e.UrlUtils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),n.prototype.validateAsUri=function(){var n;try{n=this.CanonicalAuthorityUrlComponents}catch(t){throw r.ClientConfigurationErrorMessage.invalidAuthorityType;}if(!n.Protocol||n.Protocol.toLowerCase()!=="https:")throw r.ClientConfigurationErrorMessage.authorityUriInsecure;if(!n.PathSegments||n.PathSegments.length<1)throw r.ClientConfigurationErrorMessage.authorityUriInvalidPath;},n.prototype.DiscoverEndpoints=function(n,t,i){var f=new s.XhrClient,u=h.NetworkRequestType.GET,r=t.createAndStartHttpEvent(i,u,n,"openIdConfigurationEndpoint");return f.sendRequestAsync(n,u,!0).then(function(n){return r.httpResponseStatus=n.statusCode,t.stopEvent(r),{AuthorizationEndpoint:n.body.authorization_endpoint,EndSessionEndpoint:n.body.end_session_endpoint,Issuer:n.body.issuer}}).catch(function(n){r.serverErrorCode=n;t.stopEvent(r);throw n;})},n.prototype.resolveEndpointsAsync=function(n,t){return f.__awaiter(this,void 0,Promise,function(){var i,e,o;return f.__generator(this,function(f){switch(f.label){case 0:return this.IsValidationEnabled?(i=this.canonicalAuthorityUrlComponents.HostNameAndPort,!(u.TrustedAuthority.getTrustedHostList().length===0))?[3,2]:[4,u.TrustedAuthority.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,n,t)]:[3,3];case 1:f.sent();f.label=2;case 2:if(!u.TrustedAuthority.IsInTrustedHostList(i))throw r.ClientConfigurationError.createUntrustedAuthorityError(i);f.label=3;case 3:return e=this.GetOpenIdConfigurationEndpoint(),o=this,[4,this.DiscoverEndpoints(e,n,t)];case 4:return o.tenantDiscoveryResponse=f.sent(),[2,this.tenantDiscoveryResponse]}})})},n.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},n.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},n}();t.Authority=o},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),u=function(){function n(){}return n.prototype.sendRequestAsync=function(n,t,i){var u=this;return new Promise(function(f,e){var o=new XMLHttpRequest;if(o.open(t,n,!0),i,o.onload=function(){var n,t;(o.status<200||o.status>=300)&&e(u.handleError(o.responseText));try{n=JSON.parse(o.responseText)}catch(i){e(u.handleError(o.responseText))}t={statusCode:o.status,body:n};f(t)},o.onerror=function(){e(o.status)},t===r.NetworkRequestType.GET)o.send();else throw"not implemented";})},n.prototype.handleError=function(n){var t;try{if(t=JSON.parse(n),t.error)return t.error;throw n;}catch(i){return n}},n}();t.XhrClient=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),f=i(23),u=i(1),e=i(4),o=function(){function n(){}return n.setTrustedAuthoritiesFromConfig=function(t,i){t&&!this.getTrustedHostList().length&&i.forEach(function(t){n.TrustedHostList.push(t.toLowerCase())})},n.getAliases=function(n,t,i){return r.__awaiter(this,void 0,Promise,function(){var h,o,s,e;return r.__generator(this,function(){return h=new f.XhrClient,o=u.NetworkRequestType.GET,s=""+u.AAD_INSTANCE_DISCOVERY_ENDPOINT+n+"oauth2/v2.0/authorize",e=t.createAndStartHttpEvent(i,o,s,"getAliases"),[2,h.sendRequestAsync(s,o,!0).then(function(n){return e.httpResponseStatus=n.statusCode,t.stopEvent(e),n.body.metadata}).catch(function(n){e.serverErrorCode=n;t.stopEvent(e);throw n;})]})})},n.setTrustedAuthoritiesFromNetwork=function(t,i,u){return r.__awaiter(this,void 0,Promise,function(){var o,f;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this.getAliases(t,i,u)];case 1:return o=r.sent(),o.forEach(function(t){var i=t.aliases;i.forEach(function(t){n.TrustedHostList.push(t.toLowerCase())})}),f=e.UrlUtils.GetUrlComponents(t).HostNameAndPort,n.getTrustedHostList().length&&!n.IsInTrustedHostList(f)&&n.TrustedHostList.push(f.toLowerCase()),[2]}})})},n.getTrustedHostList=function(){return this.TrustedHostList},n.IsInTrustedHostList=function(n){return this.TrustedHostList.indexOf(n.toLowerCase())>-1},n.TrustedHostList=[],n}();t.TrustedAuthority=o},function(n,t,i){"use strict";function c(n){var f=n.auth,t=n.cache,c=t===void 0?{}:t,i=n.system,l=i===void 0?{}:i,u=n.framework,a=u===void 0?{}:u;return{auth:r.__assign({},e,f),cache:r.__assign({},o,c),system:r.__assign({},s,l),framework:r.__assign({},h,a)}}Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),f=i(12),u=i(4),e={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return u.UrlUtils.getCurrentUrl()},postLogoutRedirectUri:function(){return u.UrlUtils.getCurrentUrl()},navigateToLoginRequestUrl:!0},o={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},s={logger:new f.Logger(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},h={isAngular:!1,unprotectedResources:[],protectedResourceMap:new Map};t.buildConfiguration=c},function(n,t,i){"use strict";var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});r=i(0);u=i(13);t.InteractionRequiredAuthErrorMessage={interactionRequired:{code:"interaction_required"},consentRequired:{code:"consent_required"},loginRequired:{code:"login_required"}};f=function(n){function i(t,r){var u=n.call(this,t,r)||this;return u.name="InteractionRequiredAuthError",Object.setPrototypeOf(u,i.prototype),u}return r.__extends(i,n),i.isInteractionRequiredError=function(n){var i=[t.InteractionRequiredAuthErrorMessage.interactionRequired.code,t.InteractionRequiredAuthErrorMessage.consentRequired.code,t.InteractionRequiredAuthErrorMessage.loginRequired.code];return n&&i.indexOf(n)>-1},i.createLoginRequiredAuthError=function(n){return new i(t.InteractionRequiredAuthErrorMessage.loginRequired.code,n)},i.createInteractionRequiredAuthError=function(n){return new i(t.InteractionRequiredAuthErrorMessage.interactionRequired.code,n)},i.createConsentRequiredAuthError=function(n){return new i(t.InteractionRequiredAuthErrorMessage.consentRequired.code,n)},i}(u.ServerError);t.InteractionRequiredAuthError=f},function(n,t){"use strict";function i(n){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:n,fromCache:!1}}Object.defineProperty(t,"__esModule",{value:!0});t.buildResponseStateOnly=i},function(n,t,i){"use strict";var u,f,e,h,c;Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),l=o.__importDefault(i(14)),s=i(8),r=i(10);t.EVENT_KEYS={AUTHORITY:r.prependEventNamePrefix("authority"),AUTHORITY_TYPE:r.prependEventNamePrefix("authority_type"),PROMPT:r.prependEventNamePrefix("ui_behavior"),TENANT_ID:r.prependEventNamePrefix("tenant_id"),USER_ID:r.prependEventNamePrefix("user_id"),WAS_SUCESSFUL:r.prependEventNamePrefix("was_successful"),API_ERROR_CODE:r.prependEventNamePrefix("api_error_code"),LOGIN_HINT:r.prependEventNamePrefix("login_hint")},function(n){n[n.AcquireTokenRedirect=2001]="AcquireTokenRedirect";n[n.AcquireTokenSilent=2002]="AcquireTokenSilent";n[n.AcquireTokenPopup=2003]="AcquireTokenPopup";n[n.LoginRedirect=2004]="LoginRedirect";n[n.LoginPopup=2005]="LoginPopup";n[n.Logout=2006]="Logout"}(f=t.API_CODE||(t.API_CODE={})),function(n){n.AcquireTokenRedirect="AcquireTokenRedirect";n.AcquireTokenSilent="AcquireTokenSilent";n.AcquireTokenPopup="AcquireTokenPopup";n.LoginRedirect="LoginRedirect";n.LoginPopup="LoginPopup";n.Logout="Logout"}(e=t.API_EVENT_IDENTIFIER||(t.API_EVENT_IDENTIFIER={}));h=(u={},u[e.AcquireTokenSilent]=f.AcquireTokenSilent,u[e.AcquireTokenPopup]=f.AcquireTokenPopup,u[e.AcquireTokenRedirect]=f.AcquireTokenRedirect,u[e.LoginPopup]=f.LoginPopup,u[e.LoginRedirect]=f.LoginRedirect,u[e.Logout]=f.Logout,u);c=function(n){function i(t,i,u){var f=n.call(this,r.prependEventNamePrefix("api_event"),t,u)||this;return u&&(f.apiCode=h[u],f.apiEventIdentifier=u),f.piiEnabled=i,f}return o.__extends(i,n),Object.defineProperty(i.prototype,"apiEventIdentifier",{set:function(n){this.event[s.TELEMETRY_BLOB_EVENT_NAMES.ApiTelemIdConstStrKey]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"apiCode",{set:function(n){this.event[s.TELEMETRY_BLOB_EVENT_NAMES.ApiIdConstStrKey]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"authority",{set:function(n){this.event[t.EVENT_KEYS.AUTHORITY]=r.scrubTenantFromUri(n).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"apiErrorCode",{set:function(n){this.event[t.EVENT_KEYS.API_ERROR_CODE]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tenantId",{set:function(n){this.event[t.EVENT_KEYS.TENANT_ID]=this.piiEnabled&&n?r.hashPersonalIdentifier(n):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"accountId",{set:function(n){this.event[t.EVENT_KEYS.USER_ID]=this.piiEnabled&&n?r.hashPersonalIdentifier(n):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"wasSuccessful",{get:function(){return this.event[t.EVENT_KEYS.WAS_SUCESSFUL]===!0},set:function(n){this.event[t.EVENT_KEYS.WAS_SUCESSFUL]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"loginHint",{set:function(n){this.event[t.EVENT_KEYS.LOGIN_HINT]=this.piiEnabled&&n?r.hashPersonalIdentifier(n):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"authorityType",{set:function(n){this.event[t.EVENT_KEYS.AUTHORITY_TYPE]=n.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"promptType",{set:function(n){this.event[t.EVENT_KEYS.PROMPT]=n.toLowerCase()},enumerable:!0,configurable:!0}),i}(l.default);t.default=c},function(n,t,i){n.exports=i(30)},function(n,t,i){"use strict";var r,e,o,s,u,h,c,f,l,a,v,y,p,w,b,k,d,g;Object.defineProperty(t,"__esModule",{value:!0});r=i(15);t.UserAgentApplication=r.UserAgentApplication;t.authResponseCallback=r.authResponseCallback;t.errorReceivedCallback=r.errorReceivedCallback;t.tokenReceivedCallback=r.tokenReceivedCallback;e=i(12);t.Logger=e.Logger;o=i(12);t.LogLevel=o.LogLevel;s=i(19);t.Account=s.Account;u=i(1);t.Constants=u.Constants;t.ServerHashParamKeys=u.ServerHashParamKeys;h=i(22);t.Authority=h.Authority;c=i(15);t.CacheResult=c.CacheResult;f=i(25);t.CacheLocation=f.CacheLocation;t.Configuration=f.Configuration;l=i(42);t.AuthenticationParameters=l.AuthenticationParameters;a=i(27);t.AuthResponse=a.AuthResponse;v=i(2);t.CryptoUtils=v.CryptoUtils;y=i(4);t.UrlUtils=y.UrlUtils;p=i(20);t.WindowUtils=p.WindowUtils;w=i(7);t.AuthError=w.AuthError;b=i(6);t.ClientAuthError=b.ClientAuthError;k=i(13);t.ServerError=k.ServerError;d=i(5);t.ClientConfigurationError=d.ClientConfigurationError;g=i(26);t.InteractionRequiredAuthError=g.InteractionRequiredAuthError},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),u=i(4),f=function(){function n(n,t,i,f,e){this.authority=u.UrlUtils.CanonicalizeUri(n);this.clientId=t;this.scopes=i;this.homeAccountIdentifier=r.CryptoUtils.base64Encode(f)+"."+r.CryptoUtils.base64Encode(e)}return n}();t.AccessTokenKey=f},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t,i,r){this.accessToken=n;this.idToken=t;this.expiresIn=i;this.homeAccountIdentifier=r}return n}();t.AccessTokenValue=i},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),u=i(6),f=i(3),e=function(){function n(n){if(!n||f.StringUtils.isEmpty(n)){this.uid="";this.utid="";return}try{var i=r.CryptoUtils.base64Decode(n),t=JSON.parse(i);t&&(t.hasOwnProperty("uid")&&(this.uid=t.uid),t.hasOwnProperty("utid")&&(this.utid=t.utid))}catch(e){throw u.ClientAuthError.createClientInfoDecodingError(e);}}return Object.defineProperty(n.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(n){this._uid=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(n){this._utid=n},enumerable:!0,configurable:!0}),n}();t.ClientInfo=e},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(6),u=i(17),f=i(3),e=function(){function n(n){if(f.StringUtils.isEmpty(n))throw r.ClientAuthError.createIdTokenNullOrEmptyError(n);try{this.rawIdToken=n;this.claims=u.TokenUtils.extractIdToken(n);this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(t){throw r.ClientAuthError.createIdTokenParsingError(t);}}return n}();t.IdToken=e},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i(0),r=i(1),e=i(36),o=i(37),s=i(6),u=i(18),h=function(n){function t(t,i,r){var u=n.call(this,i)||this;return u.clientId=t,u.rollbackEnabled=!0,u.migrateCacheEntries(r),u}return f.__extends(t,n),t.prototype.migrateCacheEntries=function(t){var i=this,u=r.Constants.cachePrefix+"."+r.PersistentCacheKeys.IDTOKEN,f=r.Constants.cachePrefix+"."+r.PersistentCacheKeys.CLIENT_INFO,e=r.Constants.cachePrefix+"."+r.ErrorCacheKeys.ERROR,o=r.Constants.cachePrefix+"."+r.ErrorCacheKeys.ERROR_DESC,s=n.prototype.getItem.call(this,u),h=n.prototype.getItem.call(this,f),c=n.prototype.getItem.call(this,e),l=n.prototype.getItem.call(this,o),a=[s,h,c,l],v=[r.PersistentCacheKeys.IDTOKEN,r.PersistentCacheKeys.CLIENT_INFO,r.ErrorCacheKeys.ERROR,r.ErrorCacheKeys.ERROR_DESC];v.forEach(function(n,r){return i.duplicateCacheEntry(n,a[r],t)})},t.prototype.duplicateCacheEntry=function(n,t,i){t&&this.setItem(n,t,i)},t.prototype.generateCacheKey=function(n,t){try{return JSON.parse(n),n}catch(i){return n.indexOf(""+r.Constants.cachePrefix)===0||n.indexOf(r.Constants.adalIdToken)===0?n:t?r.Constants.cachePrefix+"."+this.clientId+"."+n:r.Constants.cachePrefix+"."+n}},t.prototype.setItem=function(t,i,r){n.prototype.setItem.call(this,this.generateCacheKey(t,!0),i,r);this.rollbackEnabled&&!r&&n.prototype.setItem.call(this,this.generateCacheKey(t,!1),i,r)},t.prototype.getItem=function(t,i){return n.prototype.getItem.call(this,this.generateCacheKey(t,!0),i)},t.prototype.removeItem=function(t){n.prototype.removeItem.call(this,this.generateCacheKey(t,!0));this.rollbackEnabled&&n.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var i=window[this.cacheLocation];for(var t in i)i.hasOwnProperty(t)&&t.indexOf(r.Constants.cachePrefix)!==-1&&n.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var i=this,f=t&&u.RequestUtils.parseLibraryState(t).id,e=this.tokenRenewalInProgress(t),o=window[this.cacheLocation];f&&!e&&Object.keys(o).forEach(function(t){t.indexOf(f)!==-1&&(i.removeItem(t),n.prototype.clearItemCookie.call(i,t))});this.removeItem(r.TemporaryCacheKeys.INTERACTION_STATUS);this.removeItem(r.TemporaryCacheKeys.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,i,r){n.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),i,r);this.rollbackEnabled&&n.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),i,r)},t.prototype.clearItemCookie=function(t){n.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0));this.rollbackEnabled&&n.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return n.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllAccessTokens=function(n,t){var i=this;return Object.keys(window[this.cacheLocation]).reduce(function(u,f){var l=f.match(n)&&f.match(t)&&f.match(r.Constants.scopes),o,h,c;if(l&&(o=i.getItem(f),o))try{return h=JSON.parse(f),c=new e.AccessTokenCacheItem(h,JSON.parse(o)),u.concat([c])}catch(a){throw s.ClientAuthError.createCacheParseError(f);}return u},[])},t.prototype.tokenRenewalInProgress=function(n){var i=this.getItem(t.generateTemporaryCacheKey(r.TemporaryCacheKeys.RENEW_STATUS,n));return!!(i&&i===r.Constants.inProgress)},t.prototype.clearMsalCookie=function(i){var f=this,u;i?(this.clearItemCookie(t.generateTemporaryCacheKey(r.TemporaryCacheKeys.NONCE_IDTOKEN,i)),this.clearItemCookie(t.generateTemporaryCacheKey(r.TemporaryCacheKeys.STATE_LOGIN,i)),this.clearItemCookie(t.generateTemporaryCacheKey(r.TemporaryCacheKeys.LOGIN_REQUEST,i)),this.clearItemCookie(t.generateTemporaryCacheKey(r.TemporaryCacheKeys.STATE_ACQ_TOKEN,i))):(u=document.cookie.split(";"),u.forEach(function(t){var i=t.trim().split("=")[0];i.indexOf(r.Constants.cachePrefix)>-1&&n.prototype.clearItemCookie.call(f,i)}))},t.generateAcquireTokenAccountKey=function(n,t){var i=u.RequestUtils.parseLibraryState(t).id;return""+r.TemporaryCacheKeys.ACQUIRE_TOKEN_ACCOUNT+r.Constants.resourceDelimiter+n+r.Constants.resourceDelimiter+i},t.generateAuthorityKey=function(n){return t.generateTemporaryCacheKey(r.TemporaryCacheKeys.AUTHORITY,n)},t.generateTemporaryCacheKey=function(n,t){var i=u.RequestUtils.parseLibraryState(t).id;return""+n+r.Constants.resourceDelimiter+i},t}(o.BrowserStorage);t.AuthCache=h},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){this.key=n;this.value=t}return n}();t.AccessTokenCacheItem=i},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),u=i(7),f=function(){function n(n){if(!window)throw u.AuthError.createNoWindowObjectError("Browser storage class could not find window object");var t=typeof window[n]!="undefined"&&window[n]!=null;if(!t)throw r.ClientConfigurationError.createStorageNotSupportedError(n);this.cacheLocation=n}return n.prototype.setItem=function(n,t,i){window[this.cacheLocation].setItem(n,t);i&&this.setItemCookie(n,t)},n.prototype.getItem=function(n,t){return t&&this.getItemCookie(n)?this.getItemCookie(n):window[this.cacheLocation].getItem(n)},n.prototype.removeItem=function(n){return window[this.cacheLocation].removeItem(n)},n.prototype.clear=function(){return window[this.cacheLocation].clear()},n.prototype.setItemCookie=function(n,t,i){var r=n+"="+t+";path=/;",u;i&&(u=this.getCookieExpirationTime(i),r+="expires="+u+";");document.cookie=r},n.prototype.getItemCookie=function(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)===" ";)t=t.substring(1);if(t.indexOf(r)===0)return t.substring(r.length,t.length)}return""},n.prototype.clearItemCookie=function(n){this.setItemCookie(n,"",-1)},n.prototype.getCookieExpirationTime=function(n){var t=new Date,i=new Date(t.getTime()+n*864e5);return i.toUTCString()},n}();t.BrowserStorage=f},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),u=function(){function n(){}return n.setResponseIdToken=function(n,t){if(n){if(!t)return n}else return null;var i=Number(t.expiration);return i&&!n.expiresOn&&(n.expiresOn=new Date(i*1e3)),r.__assign({},n,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},n}();t.ResponseUtils=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),f=r.__importDefault(i(40)),u=i(1),e=r.__importDefault(i(28)),o=r.__importDefault(i(41)),s=function(){function n(n,t,i){this.completedEvents={};this.inProgressEvents={};this.eventCountByCorrelationId={};this.onlySendFailureTelemetry=!1;this.telemetryPlatform=r.__assign({sdk:u.Constants.libraryName,sdkVersion:u.libraryVersion(),networkInformation:{connectionSpeed:typeof navigator!="undefined"&&navigator.connection&&navigator.connection.effectiveType}},n.platform);this.clientId=n.clientId;this.onlySendFailureTelemetry=n.onlySendFailureTelemetry;this.telemetryEmitter=t;this.logger=i}return n.getTelemetrymanagerStub=function(n,t){var i=function(){},r={platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:n};return new this(r,i,t)},n.prototype.startEvent=function(n){(this.logger.verbose("Telemetry Event started: "+n.key),this.telemetryEmitter)&&(n.start(),this.inProgressEvents[n.key]=n)},n.prototype.stopEvent=function(n){if(this.logger.verbose("Telemetry Event stopped: "+n.key),this.telemetryEmitter&&this.inProgressEvents[n.key]){n.stop();this.incrementEventCount(n);var t=this.completedEvents[n.telemetryCorrelationId];this.completedEvents[n.telemetryCorrelationId]=(t||[]).concat([n]);delete this.inProgressEvents[n.key]}},n.prototype.flush=function(n){var o=this,i,t,r,u,e;(this.logger.verbose("Flushing telemetry events: "+n),this.telemetryEmitter&&this.completedEvents[n])&&(i=this.getOrphanedEvents(n),i.forEach(function(n){return o.incrementEventCount(n)}),t=this.completedEvents[n].concat(i),delete this.completedEvents[n],r=this.eventCountByCorrelationId[n],delete this.eventCountByCorrelationId[n],t&&t.length)&&(u=new f.default(this.telemetryPlatform,n,this.clientId,r),e=t.concat([u]),this.telemetryEmitter(e.map(function(n){return n.get()})))},n.prototype.createAndStartApiEvent=function(n,t){var i=new e.default(n,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(i),i},n.prototype.stopAndFlushApiEvent=function(n,t,i,r){t.wasSuccessful=i;r&&(t.apiErrorCode=r);this.stopEvent(t);this.flush(n)},n.prototype.createAndStartHttpEvent=function(n,t,i,r){var u=new o.default(n,r);return u.url=i,u.httpMethod=t,this.startEvent(u),u},n.prototype.incrementEventCount=function(n){var r,t=n.eventName,i=this.eventCountByCorrelationId[n.telemetryCorrelationId];i?i[t]=i[t]?i[t]+1:1:this.eventCountByCorrelationId[n.telemetryCorrelationId]=(r={},r[t]=1,r)},n.prototype.getOrphanedEvents=function(n){var t=this;return Object.keys(this.inProgressEvents).reduce(function(i,r){if(r.indexOf(n)!==-1){var u=t.inProgressEvents[r];return delete t.inProgressEvents[r],i.concat([u])}return i},[])},n}();t.default=s},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i(0),u=i(8),e=f.__importDefault(i(14)),r=i(10),o=function(n){function t(t,i,f,e){var o=n.call(this,r.prependEventNamePrefix("default_event"),i,"DefaultEvent")||this;return o.event[r.prependEventNamePrefix("client_id")]=f,o.event[r.prependEventNamePrefix("sdk_plaform")]=t.sdk,o.event[r.prependEventNamePrefix("sdk_version")]=t.sdkVersion,o.event[r.prependEventNamePrefix("application_name")]=t.applicationName,o.event[r.prependEventNamePrefix("application_version")]=t.applicationVersion,o.event[r.prependEventNamePrefix("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,o.event[""+u.TELEMETRY_BLOB_EVENT_NAMES.UiEventCountTelemetryBatchKey]=o.getEventCount(r.prependEventNamePrefix("ui_event"),e),o.event[""+u.TELEMETRY_BLOB_EVENT_NAMES.HttpEventCountTelemetryBatchKey]=o.getEventCount(r.prependEventNamePrefix("http_event"),e),o.event[""+u.TELEMETRY_BLOB_EVENT_NAMES.CacheEventCountConstStrKey]=o.getEventCount(r.prependEventNamePrefix("cache_event"),e),o}return f.__extends(t,n),t.prototype.getEventCount=function(n,t){return t[n]?t[n]:0},t}(e.default);t.default=o},function(n,t,i){"use strict";var f;Object.defineProperty(t,"__esModule",{value:!0});var u=i(0),e=u.__importDefault(i(14)),r=i(10),o=i(16);t.EVENT_KEYS={HTTP_PATH:r.prependEventNamePrefix("http_path"),USER_AGENT:r.prependEventNamePrefix("user_agent"),QUERY_PARAMETERS:r.prependEventNamePrefix("query_parameters"),API_VERSION:r.prependEventNamePrefix("api_version"),RESPONSE_CODE:r.prependEventNamePrefix("response_code"),O_AUTH_ERROR_CODE:r.prependEventNamePrefix("oauth_error_code"),HTTP_METHOD:r.prependEventNamePrefix("http_method"),REQUEST_ID_HEADER:r.prependEventNamePrefix("request_id_header"),SPE_INFO:r.prependEventNamePrefix("spe_info"),SERVER_ERROR_CODE:r.prependEventNamePrefix("server_error_code"),SERVER_SUB_ERROR_CODE:r.prependEventNamePrefix("server_sub_error_code"),URL:r.prependEventNamePrefix("url")};f=function(n){function i(t,i){return n.call(this,r.prependEventNamePrefix("http_event"),t,i)||this}return u.__extends(i,n),Object.defineProperty(i.prototype,"url",{set:function(n){var i=r.scrubTenantFromUri(n);this.event[t.EVENT_KEYS.URL]=i&&i.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"httpPath",{set:function(n){this.event[t.EVENT_KEYS.HTTP_PATH]=r.scrubTenantFromUri(n).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"userAgent",{set:function(n){this.event[t.EVENT_KEYS.USER_AGENT]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"queryParams",{set:function(n){this.event[t.EVENT_KEYS.QUERY_PARAMETERS]=o.ServerRequestParameters.generateQueryParametersString(n)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"apiVersion",{set:function(n){this.event[t.EVENT_KEYS.API_VERSION]=n.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"httpResponseStatus",{set:function(n){this.event[t.EVENT_KEYS.RESPONSE_CODE]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"oAuthErrorCode",{set:function(n){this.event[t.EVENT_KEYS.O_AUTH_ERROR_CODE]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"httpMethod",{set:function(n){this.event[t.EVENT_KEYS.HTTP_METHOD]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"requestIdHeader",{set:function(n){this.event[t.EVENT_KEYS.REQUEST_ID_HEADER]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"speInfo",{set:function(n){this.event[t.EVENT_KEYS.SPE_INFO]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"serverErrorCode",{set:function(n){this.event[t.EVENT_KEYS.SERVER_ERROR_CODE]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"serverSubErrorCode",{set:function(n){this.event[t.EVENT_KEYS.SERVER_SUB_ERROR_CODE]=n},enumerable:!0,configurable:!0}),i}(e.default);t.default=f},function(n,t,i){"use strict";function u(n){if(n.claimsRequest){var t;try{t=JSON.parse(n.claimsRequest)}catch(i){throw r.ClientConfigurationError.createClaimsRequestParsingError(i);}}}Object.defineProperty(t,"__esModule",{value:!0});var r=i(5);t.validateClaimsRequest=u}])});
//# sourceMappingURL=msal.min.js.map
