"use strict";function renderWelcomePageOffline(){try{console.log("In renderWelcomePageOffline()");$("#bwStartPageAccordion").show();$("#liWelcome").hide();$("#liOfflineWelcome").show();$("#liNewRequest").hide();$("#liArchive").hide();$("#liSummaryReport").hide();$("#liConfiguration").hide();$("#liHelp").hide();$("#liOfflineRequestForm").hide();var n=indexedDB.open(indexDBName,dbVersion);n.onblocked=function(n){console.log("In ios8.js.renderWelcomePageOffline.request.onblocked(): errorCode: "+n.target.errorCode);displayAlertDialog("In ios8.js.renderWelcomePageOffline.request.onblocked(): errorCode: "+n.target.errorCode)};n.onerror=function(n){console.log('In ios8.js.renderWelcomePageOffline.request.onerror(). Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);displayAlertDialog('In ios8.js.renderWelcomePageOffline.request.onerror(). Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};n.onsuccess=function(n){var r,i,f,e,o,c,s,l,h,a,t;console.log('In ios8.js.renderWelcomePageOffline(). Success accessing database "'+n.target.result.name+'".');try{r=n.target.result;i=[];i=[];f=[];f=[];e=[];e=[];o=[];o=[];try{c=r.transaction("OfflineAttachedFiles","readonly");s=c.objectStore("OfflineAttachedFiles").count();s.onsuccess=function(t){try{t.target.result==0&&console.log("In ios8.js.renderWelcomePageOffline().request.onsuccess: No OfflineAttachedFiles found for any offline requests: "+t.target.result);var h=t.target.result,s=r.transaction("OfflineAttachedFiles").objectStore("OfflineAttachedFiles");s.openCursor().onsuccess=function(t){var h,s,a,l,v,u;try{h=t.target.result;h&&(s=h.value.fileName,console.log("FOUND FILE: "+s+" for bwBudgetRequestId: "+h.value.bwBudgetRequestId),s.toUpperCase().indexOf(".PNG")!=-1||s.toUpperCase().indexOf(".JPG")!=-1||s.toUpperCase().indexOf(".JPEG")!=-1||s.toUpperCase().indexOf(".BMP")!=-1||s.toUpperCase().indexOf(".GIF")!=-1||s.toUpperCase().indexOf(".TIFF")!=-1||s.toUpperCase().indexOf(".SVG")!=-1?o.indexOf(h.value.bwBudgetRequestId)==-1&&o.push(h.value.bwBudgetRequestId):s.toUpperCase().indexOf(".PDF")!=-1||s.toUpperCase().indexOf(".RTF")!=-1||s.toUpperCase().indexOf(".DOC")!=-1||s.toUpperCase().indexOf(".DOCX")!=-1||s.toUpperCase().indexOf(".XSL")!=-1||s.toUpperCase().indexOf(".XSLX")!=-1||s.toUpperCase().indexOf(".TXT")!=-1||s.toUpperCase().indexOf(".ODT")!=-1||s.toUpperCase().indexOf(".ODS")!=-1||s.toUpperCase().indexOf(".ODP")!=-1?i.indexOf(h.value.bwBudgetRequestId)==-1&&i.push(h.value.bwBudgetRequestId):s.toUpperCase().indexOf(".MP3")!=-1||s.toUpperCase().indexOf(".M4A")!=-1||s.toUpperCase().indexOf(".M4R")!=-1?f.indexOf(h.value.bwBudgetRequestId)==-1&&f.push(h.value.bwBudgetRequestId):s.toUpperCase().indexOf(".M4V")!=-1||s.toUpperCase().indexOf(".AVI")!=-1||s.toUpperCase().indexOf(".MOV")!=-1||s.toUpperCase().indexOf(".MP4")!=-1?e.indexOf(h.value.bwBudgetRequestId)==-1&&e.push(h.value.bwBudgetRequestId):i.indexOf(h.value.bwBudgetRequestId)==-1&&i.push(h.value.bwBudgetRequestId),h.continue());try{a=r.transaction("objectStoreCachedRequests","readonly");l=a.objectStore("objectStoreCachedRequests").count();l.onsuccess=function(n){var t,u,s;console.log("In ios8.js.renderWelcomePageOffline().request.onsuccess.req.onsuccess.");t="";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+="            <br /><br /><br /><br /><br /><br />";t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+='            <span style="font-size:35pt;margin:auto;text-align:center;display:table;font-style:italic;">';t+="                <span>Sign in, or create a free account.<\/span>";t+="                <br />";t+='                <span style="font-size:25pt;margin:auto;text-align=center;display:table;">(no credit card required!)<\/span>';t+="            <\/span>";t+="            <br />";t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+='            <div class="divSignInButton" onclick="displayTheLogon();" style="width:850px;height:150px;text-align:center;line-height:1.5em;font-size:60pt;">Sign In<\/div>';t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+="            <br /><br /><br /><br /><br /><br />";t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+='        <td style="vertical-align:bottom;">';t+='            <span style="font-size:35pt;margin:auto;text-align=center;display:table;font-style:italic;">';t+="                <span>Create an offline request now<\/span>";t+="                <br />";t+='                <span style="font-size:25pt;margin:auto;text-align=center;display:table;">(and log in later to involve your team)<\/span>';t+="            <\/span>";t+="            <br />";t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;">';t+='            <div class="divSignInButton" onclick="displayLearnMore(\'New Offline Request\');" style="width:75px;height:150px;text-align:right;font-size:70pt;border-radius:120px 10px 10px 120px;vertical-align:middle;">';t+="                ?&nbsp;";t+="            <\/div>";t+="        <\/td>";t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+='            <div class="divSignInButton" onclick="populateStartPageItem(\'divNewRequestOffline\', \'Reports\', \'\');" style="width:850px;height:150px;text-align:center;line-height:1.5em;font-size:60pt;border-radius: 10px 10px 10px 10px;"><span style="font-weight:normal;color:white;">Create Request<\/span><\/div>';t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+="        <\/td>";t+="    <\/tr>";u=n.target.result;u>0&&(t+="<tr>",t+='    <td style="width:75px;"><\/td>',t+='    <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>',t+='    <td style="width:5px;"><\/td>',t+="    <td>",t+="        <br /><br /><br /><br /><br /><br />",t+="    <\/td>",t+="<\/tr>",t+="    <tr>",t+='        <td style="width:75px;"><\/td>',t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>',t+='        <td style="width:5px;"><\/td>',t+="        <td>",t+='            <span style="font-size:30pt;margin:auto;text-align=center;display:table;font-style:italic;">',t+="               <span>Your requests saved on this device<\/span>",t+="            <\/span>",t+="            <br />",t+="        <\/td>",t+="    <\/tr>");s=r.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests");s.openCursor().onsuccess=function(r){var s,c,a,v,y,p,w;console.log("In ios8.js.renderWelcomePageOffline().request.onsuccess.objectStore.openCursor().onsuccess");try{if(s=r.target.result,s){c=s.value.ProjectTitle;c==""&&(c="<em>[no description]<\/em>");console.log("Retrieved request: "+c+": "+s.value.bwBudgetRequestId);t+="<tr>";t+='  <td style="width:75px;">';t+='    <table style="width:100%;">';t+="      <tr>";t+="        <td>";t+='            <div class="tdHomePageSubNotificationIos8" onclick="deleteOfflineRequest(\''+s.value.bwBudgetRequestId+"', '"+c+"', '"+s.value.RequestedCapital+'\')" style="line-height:2;cursor:pointer;width:75px;height:130px;text-align:right;font-size:45pt;border-radius:120px 10px 10px 120px;vertical-align:middle;">';t+="&#128465;&nbsp;";t+="            <\/div>";t+="        <\/td>";t+="      <\/tr>";t+="    <\/table>";t+="  <\/td>";t+='  <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='  <td style="width:5px;"><\/td>';t+="  <td>";t+='    <table style="width:100%;">';t+="      <tr>";t+='        <td class="tdHomePageSubNotificationIos8" style="cursor:pointer;width:95%;" onclick="displayForm_DisplayCachedAr(\''+s.value.bwBudgetRequestId+"');\">";t+='          <span style="font-size:8pt;font-color:lightgray;"><\/span>';t+='          <div style="display:inline-block;height:130px;">';t+='          <span title="Click to view the request." style="cursor:pointer;font-size:30pt;width:100%;">'+c+" (<em>"+formatCurrency(s.value.RequestedCapital)+"<\/em>)<\/span>";t+="          <br />";var l=s.value.bwDocumentXml,k=33,d=l.indexOf("<my:Brief_Description_of_Project>")+k,g=l.indexOf("<\/my:Brief_Description_of_Project>"),h=decodeURIComponent(l.substring(d,g));h=h.replace("<br>","");console.log("tmpDescription2:"+h);h.length>0?(console.log("tmpDescription2.length > 0: tmpDescription2.length="+h.length),a="",a=h.length>39?h.substring(0,38)+"...":h,t+="      <span>",t+="      <em>"+a+"&nbsp;&nbsp;&#128247;&nbsp;&nbsp;&#127908;<\/em>",t+="      <\/span>"):(console.log("!(tmpDescription2.length > 0): tmpDescription2.length="+h.length),v=i.indexOf(s.value.bwBudgetRequestId)>-1?"&#128193;":'<span style="opacity: 0.20;">&#128193;<\/span>',y=f.indexOf(s.value.bwBudgetRequestId)>-1?"&#127908;":'<span style="opacity: 0.20;">&#127908;<\/span>',p=e.indexOf(s.value.bwBudgetRequestId)>-1?"&#128249;":'<span style="opacity: 0.20;">&#128249;<\/span>',w=o.indexOf(s.value.bwBudgetRequestId)>-1?"&#128247;":'<span style="opacity: 0.20;">&#128247;<\/span>',console.log("[no details] [no details] [no details] [no details] [no details] [no details] [no details] [no details] [no details] "),t+="      <span>",t+="      <em>[no details]&nbsp;&nbsp;"+v+"&nbsp;"+y+"&nbsp;"+p+"&nbsp;"+w+"<\/em>",t+="      <\/span>");t+="          <\/div>";t+="        <\/td>";t+="      <\/tr>";t+="    <\/table>";s.continue()}else console.log("DONE LOOPING, so rendering."),u>0&&(t+="<tr>",t+='    <td style="width:75px;"><\/td>',t+='    <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>',t+='    <td style="width:5px;"><\/td>',t+="    <td>",t+="        <br /><br /><br /><br /><br /><br />",t+="    <\/td>",t+="<\/tr>",t+="<tr>",t+='  <td style="width:75px;"><\/td>',t+='  <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>',t+='  <td style="width:5px;"><\/td>',t+="  <td>",t+="    <table>",t+="      <tr>",t+="        <td>",t+="          <table>",t+="            <tr>",t+='              <td class="tdHomePageSubNotificationIos8" style="font-size:70pt;cursor:pointer;padding-top:0;" onclick="cmdOfflineDeviceSynchronization();" title="Offline request device synchronization...">',t+="                &#128187;&#8652;&#128187;",t+="              <\/td>",t+="            <\/tr>",t+="          <\/table>",t+="        <\/td>",t+="      <\/tr>",t+="    <\/table>",t+="  <\/td>",t+="<\/tr>"),t+="<tr>",t+='    <td style="width:75px;"><\/td>',t+='    <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>',t+='    <td style="width:5px;"><\/td>',t+="    <td>",t+="        <br /><br /><br /><br /><br /><br />",t+="    <\/td>",t+="<\/tr>",t+="<\/table>",$("#divOfflineWelcomeContent").html(t),document.title="Budgeting ("+n.target.result+")"}catch(b){console.log("xxError: "+b.message+", "+b.stack)}}};l.onerror=function(){console.log("In ios8.js.renderWelcomePageOffline.req.error(). "+this.error);displayAlertDialog("In ios8.js.renderWelcomePageOffline.req.error(). "+this.error)}}catch(c){c.message=="NotFoundError"?(console.log('Found the database "'+n.target.result.name+'", but didn\'t find the objectStore "objectStoreCachedRequests". Attempting to create it now.'),u="",u+="<br />",u+="<br />",u+="<br />",u+="<br />",u+='<span style="font-size:35pt;margin:auto;text-align=center;display:table;font-style:italic;"><span>Sign in, or create a free account.<\/span><br /><span style="font-size:25pt;margin:auto;text-align=center;display:table;">(no credit card required!)<\/span><\/span>',u+="<br />",u+='<div class="divSignInButton" id="xx" onclick="displayTheLogon();" style="width:850px;height:150px;text-align:center;line-height:1.5em;font-size:60pt;">Sign In<\/div>',u+="<br />",u+="<br />",u+="<br />",u+="<br />",u+='<span style="font-size:30pt;margin:auto;text-align=center;display:table;font-style:italic;">Create a new request on this device, including any attached files <em>(pictures, voice memos, any kind of file)<\/em>, and have sent to the next person specified for the selected financial area approvals. ',u+="<br /><br />",u+="- Invite participants, it's your own Budgeting Social Network!",u+="<br /><br />",u+="- The system sends emails to let everyone know if they have things to do, and reminds them on a regular basis for recurring expenses.",u+="<br /><br />",u+="- You can view the status and activity of all requests from the top menu bar.",u+="<br /><br />",u+="- Owners see everything, participants see less. It is a secure role based system!",u+="<br />",u+="<br />",u+='<span style="font-size:25pt;margin:auto;text-align=center;display:table;">You can create an offline request right now, then log in to involve your team.<\/span>',u+="<br />",u+="<\/span>",u+="<br />",u+='<div class="divSignInButton" onclick="displayLearnMore(\'New Offline Request\');" style="width:150px;height:150px;text-align:left;line-height:1.275em;font-size:30pt;display: inline-block;margin-bottom:40px;">',u+="Learn<br />more...",u+="<\/div>",u+="&nbsp;",u+='<div class="divSignInButton" id="xx" onclick="populateStartPageItem(\'divNewRequestOffline\', \'Reports\', \'\');" style="width:850px;height:150px;text-align:center;line-height:1.5em;font-size:60pt;display: inline-block;margin-bottom:40px;">New Offline Request<\/div>',u+="<br />",u+="<br />",u+="<br />",u+="<br />",u+='<span style="font-size:35pt;margin:auto;text-align=center;display:table;font-style:italic;"><span>Manage offline requests on this device.<\/span><br /><span style="font-size:25pt;margin:auto;text-align=center;display:table;">(View your requests saved on this device.)<\/span><\/span>',u+="<br />",u+='<div class="divSignInButton" id="xx" onclick="displayAlertDialog(\'DEV: Exception in ios8.js.renderWelcomePageOffline.NotFoundError: Error locating objectStoreCachedRequests...\');" style="width:850px;height:325px;text-align:center;line-height:1.5em;font-size:50pt;">Offline Archive<br />(error locating<br />objectStoreCachedRequests)<\/div>',u+="<br />",u+="<br />",u+="<br />",$("#divOfflineWelcomeMessage").html(u),v=getCookie("bypassHomePageCookie"),v=="checked"&&(u="",u+='&nbsp;&nbsp;<input type="checkbox" checked id="cbAlwaysBypassHomePageAndLaunchApp" onclick="cbAlwaysBypassHomePageAndLaunchAppClicked();"><span style="font-size:30pt;font-style:italic;">&nbsp;&nbsp;&nbsp;&nbsp;Always bypass home page and launch app.<\/span>',$("#divAlwaysBypassHomePageAndLaunchApp").html(u))):(console.log("XXXXXXXXXXXyerror: "+c.message),displayAlertDialog("XXXXXXXXXXXyerror: "+c.message))}}catch(c){console.log("Exception in ios8.js.renderWelcomePageOffline:81: "+c.message+", "+c.stack);displayAlertDialog("Exception in ios8.js.renderWelcomePageOffline:81: "+c.message+", "+c.stack)}}}catch(u){console.log("Exception in ios8.js.renderWelcomePageOffline:91: "+u.message+", "+u.stack);displayAlertDialog("Exception in ios8.js.renderWelcomePageOffline:91: "+u.message+", "+u.stack)}};s.onerror=function(){console.error("In ios8.js.renderWelcomePageOffline.req2.onerror: add error",this.error);console.log("In ios8.js.renderWelcomePageOffline.req2.onerror:10: "+this.error);displayAlertDialog("In ios8.js.renderWelcomePageOffline.req2.onerror:10: "+this.error)}}catch(u){try{l=r.transaction("objectStoreCachedRequests","readonly");h=l.objectStore("objectStoreCachedRequests").count();h.onsuccess=function(n){var t,s,u;console.log("In ios8.js.renderWelcomePageOffline().request.onsuccess.req.onsuccess.");t="";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+="            <br /><br /><br /><br /><br /><br />";t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+='            <span style="font-size:35pt;margin:auto;text-align:center;display:table;font-style:italic;">';t+="                <span>Sign in, or create a free account.<\/span>";t+="                <br />";t+='                <span style="font-size:25pt;margin:auto;text-align=center;display:table;">(no credit card required!)<\/span>';t+="            <\/span>";t+="            <br />";t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+='            <div class="divSignInButton" onclick="displayTheLogon();" style="width:850px;height:150px;text-align:center;line-height:1.5em;font-size:60pt;">Sign In<\/div>';t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+="            <br /><br /><br /><br /><br /><br />";t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+='        <td style="vertical-align:bottom;">';t+='            <span style="font-size:35pt;margin:auto;text-align=center;display:table;font-style:italic;">';t+="                <span>Create an offline request now<\/span>";t+="                <br />";t+='                <span style="font-size:25pt;margin:auto;text-align=center;display:table;">(and log in later to involve your team)<\/span>';t+="            <\/span>";t+="            <br />";t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;">';t+='            <div class="divSignInButton" onclick="displayLearnMore(\'New Offline Request\');" style="width:75px;height:150px;text-align:right;font-size:70pt;border-radius:120px 10px 10px 120px;vertical-align:middle;">';t+="                ?&nbsp;";t+="            <\/div>";t+="        <\/td>";t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+='            <div class="divSignInButton" onclick="populateStartPageItem(\'divNewRequestOffline\', \'Reports\', \'\');" style="width:850px;height:150px;text-align:center;line-height:1.5em;font-size:60pt;border-radius: 10px 10px 10px 10px;"><span style="font-weight:normal;color:white;">Create Request<\/span><\/div>';t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";t+='            <span style="font-size:30pt;margin:auto;text-align=center;display:table;font-style:italic;">';t+="               <span>Your requests saved on this device<\/span>";t+="            <\/span>";t+="            <br />";t+="        <\/td>";t+="    <\/tr>";t+="    <tr>";t+='        <td style="width:75px;"><\/td>';t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>';t+='        <td style="width:5px;"><\/td>';t+="        <td>";s=n.target.result;u=r.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests");u.openCursor().onsuccess=function(r){var u,h,l,a,v,y,p;console.log("In ios8.js.renderWelcomePageOffline().request.onsuccess.objectStore.openCursor().onsuccess");try{if(t+='<table style="width:100%;">',u=r.target.result,u){h=u.value.ProjectTitle;h==""&&(h="<em>[no description]<\/em>");console.log("Retrieved request: "+h+": "+u.value.bwBudgetRequestId);t+="  <tr>";t+='    <td class="tdHomePageSubNotificationIos8" style="cursor:pointer;width:95%;" onclick="displayForm_DisplayCachedAr(\''+u.value.bwBudgetRequestId+"');\">";t+='      <div style="display:inline-block;">';t+='        <span title="Click to view the request." style="cursor:pointer;font-size:30pt;width:100%;">'+h+" (<em>"+formatCurrency(u.value.RequestedCapital)+"<\/em>)<\/span>";t+="        <br />";var c=u.value.bwDocumentXml,b=33,k=c.indexOf("<my:Brief_Description_of_Project>")+b,d=c.indexOf("<\/my:Brief_Description_of_Project>"),s=decodeURIComponent(c.substring(k,d));s=s.replace("<br>","");console.log("tmpDescription2:"+s);s.length>0?(console.log("tmpDescription2.length > 0: tmpDescription2.length="+s.length),l="",l=s.length>39?s.substring(0,38)+"...":s,t+="      <span>",t+="      <em>"+l+"&nbsp;&nbsp;&#128247;&nbsp;&nbsp;&#127908;<\/em>",t+="      <\/span>"):(console.log("!(tmpDescription2.length > 0): tmpDescription2.length="+s.length),a=i.indexOf(u.value.bwBudgetRequestId)>-1?"&#128193;":'<span style="opacity: 0.20;">&#128193;<\/span>',v=f.indexOf(u.value.bwBudgetRequestId)>-1?"&#127908;":'<span style="opacity: 0.20;">&#127908;<\/span>',y=e.indexOf(u.value.bwBudgetRequestId)>-1?"&#128249;":'<span style="opacity: 0.20;">&#128249;<\/span>',p=o.indexOf(u.value.bwBudgetRequestId)>-1?"&#128247;":'<span style="opacity: 0.20;">&#128247;<\/span>',console.log("[no details] [no details] [no details] [no details] [no details] [no details] [no details] [no details] [no details] "),t+="      <span>",t+="      <em>[no details]&nbsp;&nbsp;"+a+"&nbsp;"+v+"&nbsp;"+y+"&nbsp;"+p+"<\/em>",t+="      <\/span>");t+="      <\/div>";t+="    <\/td>";t+="  <\/tr>";u.continue()}else console.log("DONE LOOPING, so rendering."),t+="  <tr>",t+="    <td>",t+="      <table>",t+="        <tr>",t+='          <td class="tdHomePageSubNotificationIos8" style="font-size:70pt;cursor:pointer;padding-top:0;" onclick="cmdOfflineDeviceSynchronization();" title="Offline request device synchronization...">',t+="            &#128187;&#8652;&#128187;",t+="          <\/td>",t+="        <\/tr>",t+="      <\/table>",t+="    <\/td>",t+="  <\/tr>",t+="<\/table>",t+="        <\/td>",t+="    <\/tr>",t+="    <tr>",t+='        <td style="width:75px;"><\/td>',t+='        <td style="border-right:1px solid grey;width:1px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>',t+='        <td style="width:5px;"><\/td>',t+="        <td>",t+="            <br /><br /><br /><br /><br /><br />",t+="        <\/td>",t+="    <\/tr>",$("#divOfflineWelcomeContent").html(t),document.title="Budgeting ("+n.target.result+")"}catch(w){console.log("xxError: "+w.message+", "+w.stack)}}};h.onerror=function(){console.log("In ios8.js.renderWelcomePageOffline.req.error(). "+this.error);displayAlertDialog("In ios8.js.renderWelcomePageOffline.req.error(). "+this.error)}}catch(u){u.message=="NotFoundError"?(console.log('Found the database "'+n.target.result.name+'", but didn\'t find the objectStore "objectStoreCachedRequests". Attempting to create it now.'),t="",t+="<br />",t+="<br />",t+="<br />",t+="<br />",t+='<span style="font-size:35pt;margin:auto;text-align=center;display:table;font-style:italic;"><span>Sign in, or create a free account.<\/span><br /><span style="font-size:25pt;margin:auto;text-align=center;display:table;">(no credit card required!)<\/span><\/span>',t+="<br />",t+='<div class="divSignInButton" id="xx" onclick="displayTheLogon();" style="width:850px;height:150px;text-align:center;line-height:1.5em;font-size:60pt;">Sign In<\/div>',t+="<br />",t+="<br />",t+="<br />",t+="<br />",t+='<span style="font-size:30pt;margin:auto;text-align=center;display:table;font-style:italic;">Create a new request on this device, including any attached files <em>(pictures, voice memos, any kind of file)<\/em>, and have sent to the next person specified for the selected financial area approvals. ',t+="<br /><br />",t+="- Invite participants, it's your own Budgeting Social Network!",t+="<br /><br />",t+="- The system sends emails to let everyone know if they have things to do, and reminds them on a regular basis for recurring expenses.",t+="<br /><br />",t+="- You can view the status and activity of all requests from the top menu bar.",t+="<br /><br />",t+="- Owners see everything, participants see less. It is a secure role based system!",t+="<br />",t+="<br />",t+='<span style="font-size:25pt;margin:auto;text-align=center;display:table;">You can create an offline request right now, then log in to involve your team.<\/span>',t+="<br />",t+="<\/span>",t+="<br />",t+='<div class="divSignInButton" onclick="displayLearnMore(\'New Offline Request\');" style="width:150px;height:150px;text-align:left;line-height:1.275em;font-size:30pt;display: inline-block;margin-bottom:40px;">',t+="Learn<br />more...",t+="<\/div>",t+="&nbsp;",t+='<div class="divSignInButton" id="xx" onclick="populateStartPageItem(\'divNewRequestOffline\', \'Reports\', \'\');" style="width:850px;height:150px;text-align:center;line-height:1.5em;font-size:60pt;display: inline-block;margin-bottom:40px;">New Offline Request<\/div>',t+="<br />",t+="<br />",t+="<br />",t+="<br />",t+='<span style="font-size:35pt;margin:auto;text-align=center;display:table;font-style:italic;"><span>Manage offline requests on this device.<\/span><br /><span style="font-size:25pt;margin:auto;text-align=center;display:table;">(View your requests saved on this device.)<\/span><\/span>',t+="<br />",t+='<div class="divSignInButton" id="xx" onclick="displayAlertDialog(\'DEV: Exception in ios8.js.renderWelcomePageOffline.NotFoundError: Error locating objectStoreCachedRequests...\');" style="width:850px;height:325px;text-align:center;line-height:1.5em;font-size:50pt;">Offline Archive<br />(error locating<br />objectStoreCachedRequests)<\/div>',t+="<br />",t+="<br />",t+="<br />",$("#divOfflineWelcomeMessage").html(t),t+="There was an error. The expected, previously created IndexDb seems to have disappeared. This issue needs to be addressed, perhaps your device is running low on memory, but please report this error as we need to fix this issue. Thanks! - Todd Hiltz (todd_hiltz@hotmail.com)",$("#divOfflineWelcomeMessage").html(t),document.title="Budgeting (Error:IndexDb)",a=getCookie("bypassHomePageCookie"),a=="checked"&&(t="",t+='&nbsp;&nbsp;<input type="checkbox" checked id="cbAlwaysBypassHomePageAndLaunchApp" onclick="cbAlwaysBypassHomePageAndLaunchAppClicked();"><span style="font-size:30pt;font-style:italic;">&nbsp;&nbsp;&nbsp;&nbsp;Always bypass home page and launch app.<\/span>',$("#divAlwaysBypassHomePageAndLaunchApp").html(t))):(console.log("XXXXXXXXXXXyerror: "+u.message),displayAlertDialog("XXXXXXXXXXXyerror: "+u.message))}}}catch(u){console.log("Exception ios8.js.renderWelcomePageOffline.request.onsuccess(): "+u.message+", "+u.stack);displayAlertDialog("Exception ios8.js.renderWelcomePageOffline.request.onsuccess(): "+u.message+", "+u.stack)}}}catch(t){console.log("Exception in ios8.js.renderWelcomePageOffline(): "+t.message+", "+t.stack);displayAlertDialog("Error in ios8.js.renderWelcomePageOffline():2:"+t.message)}}function displayLearnMore(n){$("#divLearnMoreDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Sign Up",width:"760",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divLearnMoreDialog").dialog("close")})}});$("#divLearnMoreDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();var t="";t+="<br />";t+='<span style="font-size:30pt;margin:auto;text-align=center;display:table;font-style:italic;">Create a new request on this device, including any attached files <em>(pictures, voice memos, any kind of file)<\/em>, and have sent to the next person specified for the selected financial area approvals. ';t+="<br /><br />";t+="- Invite participants, it's your own Budgeting Social Network!";t+="<br /><br />";t+="- The system sends emails to let everyone know if they have things to do, and reminds them on a regular basis for recurring expenses.";t+="<br /><br />";t+="- You can view the status and activity of all requests from the top menu bar.";t+="<br /><br />";t+="- Owners see everything, participants see less. It is a secure role based system!";t+="<br />";t+="<br />";document.getElementById("divLearnMoreDialogContent").innerHTML=t;(n="New Offline Request")&&(document.getElementById("spanLearnMoreDialogTitle").innerHTML=n)}function cbAlwaysBypassHomePageAndLaunchAppClicked(){var n=document.getElementById("cbAlwaysBypassHomePageAndLaunchApp").checked;n==!0?setCookie("bypassHomePageCookie","checked",30):setCookie("bypassHomePageCookie","",30)}function displayTheAboutBudgetNetDialog(){$("#divTheAboutBudgetNetDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"970px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divTheAboutBudgetNetDialog").dialog("close")})}});$("#divTheAboutBudgetNetDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}function uploadAttachmentOffline(n,t){var i,r,u;console.log("In ios8.js.uploadAttachmentOffline("+n+", "+t+").1");try{try{i=document.getElementById("OfflineRequestBudgetRequestIdInXslForm").innerHTML}catch(f){i=document.getElementById("OfflineRequestBudgetRequestId").innerHTML}console.log("In ios8.js.uploadAttachmentOffline("+n+", "+t+"). Preparing to upload file for _budgetRequestId: "+i);r=document.getElementById(t);u=r.files[0];u.size>1e8?(displayAlertDialog("Currently the system does not allow files over 100MB."),$("#"+t).replaceWith($("#"+t).clone())):cmdDisplayConfirmFileUploadOfflineDialog(n,t,i)}catch(f){displayAlertDialog("Exception in uploadAttachmentOffline("+n+", "+t+"): "+f.message)}}function cmdDisplayDeleteUnsubmittedBudgetRequestDialog(n,t){try{if(console.log("In ios8.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog("+n+", "+t+")."),!n){var i=!0;n=document.getElementById("OfflineRequestBudgetRequestIdInXslForm").innerHTML;t="this request...";console.log("requestId: "+n)}$("#divDeleteABudgetRequestOfflineDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"Delete "+n,width:"570px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divDeleteABudgetRequestOfflineDialog").dialog("close")})}});$("#divDeleteABudgetRequestOfflineDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("spanDeleteABudgetRequestOfflineDialogTitle").innerHTML="Delete "+t;$("#divDeleteABudgetRequestOfflineDialogDeleteRequestButton").off("click").click(function(){var t=indexedDB.open(indexDBName,dbVersion);t.onblocked=function(n){console.log("indexDB BLOCKED1. errorCode: "+n.target.errorCode)};t.onerror=function(n){console.log("In cmdDisplayDeleteUnsubmittedBudgetRequestDialog(). Error creating/accessing IndexedDB database1. errorCode: "+n.target.errorCode)};t.onsuccess=function(t){var r=t.target.result,u;console.log('In cmdDisplayDeleteUnsubmittedBudgetRequestDialog(). Successfully opened the database "'+t.target.result.name+'".');r.onerror=function(n){console.log('Error in ios8.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};u=r.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests");u.openCursor().onsuccess=function(t){var u,e,f;try{u=t.target.result;u?(u.value.bwBudgetRequestId==n&&(e=r.transaction("objectStoreCachedRequests","readwrite"),f=e.objectStore("objectStoreCachedRequests").delete(u.primaryKey),f.onsuccess=function(){console.log("In cmdDisplayDeleteUnsubmittedBudgetRequestDialog(). Successfully deleted request from the database.");i==!0?($("#divDeleteABudgetRequestOfflineDialog").dialog("close"),$("#divOfflineRequestFormDialog").dialog("close")):($("#divDeleteABudgetRequestOfflineDialog").dialog("close"),cmdDisplayClientRequestsNotYetSubmittedDialog(!0));participantId?populateStartPageItem("divWelcome","Reports",""):renderWelcomePageOffline()},f.onerror=function(){console.error("In cmdDisplayDeleteUnsubmittedBudgetRequestDialog(). Error deleting request from the database.",this.error)}),u.continue()):console.log("In ios8.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog. DONE LOOPING.")}catch(o){console.log("In ios8.js.cmdDisplayDeleteUnsubmittedBudgetRequestDialog. xxError: "+o.message+", "+o.stack)}}}})}catch(r){displayAlertDialog("Error in cmdDisplayDeleteUnsubmittedBudgetRequestDialog(): "+r.message)}}function appHasBeenLaunchedFromEmail(n){appHasBeenLaunchedFromEmailForThisRequestId=n;participantId&&participantFriendlyName&&participantEmail&&participantLogonType&&participantLogonTypeUserId&&renderWelcomeScreen()}function timedCheckForAlertsForIosBadgeUpdateUsingTitle(){participantId&&participantId!=""&&renderAlerts()}function readDeviceOrientation(){Math.abs(window.orientation)===90?InitializeThePage("Landscape"):InitializeThePage("Portrait")}function InitializeThePage(n){try{n=="Landscape"?(document.getElementById("tableTopPageSpacer").style.display="inline",document.body.scrollTop=0,document.body.clientWidth="100%"):n=="Portrait"?(document.getElementById("tableTopPageSpacer").style.display="inline",document.body.scrollTop=0,document.body.clientWidth="100%"):displayAlertDialog("CRITICAL: Error in rotation values.")}catch(t){}}function sleep(n){for(var t=(new Date).getTime();t+n>=(new Date).getTime(););}function checkConnectionAndRemoveAlertDialog(){$.ajax({url:webserviceurl+"/writearchivederrorstoexceptionlog",type:"POST",timeout:ajaxTimeout,data:{Errors:"re-established communication"},headers:{Accept:"application/json; odata=verbose"},success:function(){clearInterval(connectionTimerObject);connectionTimerObject=null;$("#divAlertDialog").dialog("close")},error:function(){}})}function cmdDisplayCommunicationsError(){displayAlertDialog("Communications error.")}function checkConnectionAndRemoveBlueBarErrorMessage(){$.ajax({url:webserviceurl+"/writearchivederrorstoexceptionlog",type:"POST",timeout:ajaxTimeout,data:{Errors:"re-established communication"},headers:{Accept:"application/json; odata=verbose"},success:function(){clearInterval(connectionTimerObject);connectionTimerObject=null;document.getElementById("spanErrorLink").style.display="none";document.getElementById("spanErrorLinkNewRequest").style.display="none";document.getElementById("spanErrorLinkMyStuff").style.display="none";document.getElementById("spanErrorLinkSummary").style.display="none";document.getElementById("spanErrorLinkConfiguration").style.display="none";document.getElementById("spanErrorLinkHelp").style.display="none"},error:function(){}})}function displayAlertDialog(n){if(n){try{$("#divWorkingOnItDialog").dialog("close")}catch(i){}try{WriteToErrorLog("displayAlertDialog()",n)}catch(i){}var t=!1;if($("#divAlertDialog").hasClass("ui-dialog-content")&&$("#divAlertDialog").dialog("isOpen")&&(t=!0),t==!1)try{if(n.toString().toUpperCase().indexOf("SERVICE UNAVAILABLE")>-1||n.toString().toUpperCase().indexOf("BACKEND FETCH FAILED")>-1||n.toString().toUpperCase().indexOf("ERROR RENDERING")>-1||n.toString().toUpperCase().indexOf("UNDEFINED IS NOT AN OBJECT")>-1||n.toString().toUpperCase().indexOf("NULL IS NOT AN OBJECT")>-1){try{$("#divAlertDialog").dialog("close")}catch(i){}document.getElementById("spanErrorLink").style.display="inline";document.getElementById("spanErrorLinkNewRequest").style.display="inline";document.getElementById("spanErrorLinkMyStuff").style.display="inline";document.getElementById("spanErrorLinkSummary").style.display="inline";document.getElementById("spanErrorLinkConfiguration").style.display="inline";document.getElementById("spanErrorLinkHelp").style.display="inline";connectionTimerObject=setInterval("checkConnectionAndRemoveBlueBarErrorMessage()",6e3)}else $("#divAlertDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Alert",width:"720",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divAlertDialog").dialog("close")})}}),$("#divAlertDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),document.getElementById("spanErrorMessage").innerHTML=n}catch(i){displayAlertDialog(i.message)}}}function cmdCloseError(){$("#divAlertDialog").dialog("close")}function cmdCloseArDialog(){$("#ArDialog").dialog("close")}function cmdCustomSignUp(){$("#divCustomLogonDialog").dialog("close");$("#divCustomSignUpDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Sign Up",width:"800",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divCustomSignUpDialog").dialog("close")})}});$("#divCustomSignUpDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}function logonWith_BudgetWorkflow(n){var i,r,u,t;n&&n=="logonandthenpresentattachmentdialog"?(i=document.getElementById("txtCustomLogonAndPresentAttachmentDialogEmail").value,r=document.getElementById("txtCustomLogonAndPresentAttachmentDialogPassword").value,i.trim()==""?displayAlertDialog("Please enter an Email Address before continuing the logon process."):r.trim()==""?displayAlertDialog("Please enter an Password before continuing the logon process."):(u=[],u={userEmailAddress:i,userPassword:r},t=webserviceurl+"/bwworkflow/usercustomlogon",$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:u,headers:{Accept:"application/json; odata=verbose"},success:function(n){n.message!="The password is correct"?displayAlertDialog(n.message):(setCookie("customlogonusername",i,30),setCookie("customlogonpassword",r,30),participantLogonType="custom",participantLogonTypeUserId=n.id,participantId=n.id,participantFriendlyName=n.participantFriendlyName,participantEmail=n.participantEmail,$("#divCustomLogonAndPresentAttachmentDialog").dialog("close"),initializeTheForm(),attachSharedFileFromIos(sharedFileFromIosFileContents,sharedFileFromIosFileName,sharedFileFromIosFileDescription))},error:function(n,i,r){i==="timeout"&&r==="timeout"?displayAlertDialog("Cannot connect to the server at this time."):JSON.stringify(n).toUpperCase().indexOf("ERROR 503 SERVICE UNAVAILABLE")>-1?(displayAlertDialog("Our back end database is not responding. Please try again in a few minutes."),WriteToErrorLog("LOGIN FAILURE1!!!!!!!!!!! Error in ios8.js.logonWith_BudgetWorkflow().usercustomlogon: "+t+", "+i+", "+r+", "+JSON.stringify(n))):n.readyState==0?displayAlertDialog("This happens when wifi is turned off. You do not have any network connectivity at the moment."):(displayAlertDialog("Error in ios8.js.logonWith_BudgetWorkflow().usercustomlogon. Incorrect .js file version: "+t+", "+i+", "+r+", "+JSON.stringify(n)),WriteToErrorLog("Error in ios8.js.logonWith_BudgetWorkflow().usercustomlogon. Incorrect .js file version: "+t+", "+i+", "+r+", "+JSON.stringify(n)))}}))):(i=document.getElementById("txtCustomLogonEmail").value,r=document.getElementById("txtCustomLogonPassword").value,i.trim()==""?displayAlertDialog("Please enter an Email Address before continuing the logon process."):r.trim()==""?displayAlertDialog("Please enter an Password before continuing the logon process."):(u=[],u={userEmailAddress:i,userPassword:r},t=webserviceurl+"/bwworkflow/usercustomlogon",$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:u,headers:{Accept:"application/json; odata=verbose"},success:function(n){n.message!="The password is correct"?displayAlertDialog(n.message):(setCookie("customlogonusername",i,30),setCookie("customlogonpassword",r,30),participantLogonType="custom",participantLogonTypeUserId=n.id,participantFriendlyName=n.participantFriendlyName,participantEmail=n.participantEmail,$("#divCustomLogonDialog").dialog("close"),initializeTheForm())},error:function(n,i,r){i==="timeout"&&r==="timeout"?displayAlertDialog("Cannot connect to the server at this time."):JSON.stringify(n).toUpperCase().indexOf("ERROR 503 SERVICE UNAVAILABLE")>-1?(displayAlertDialog("Our back end database is not responding. Please try again in a few minutes."),WriteToErrorLog("LOGIN FAILURE1!!!!!!!!!!! Error in ios8.js.logonWith_BudgetWorkflow().usercustomlogon: "+t+", "+i+", "+r+", "+JSON.stringify(n))):n.readyState==0?displayAlertDialog("You do not have any network connectivity at the moment. Please try again when you have an active internet connection."):(displayAlertDialog("Error in ios8.js.logonWith_BudgetWorkflow().usercustomlogon. Incorrect .js file version: "+t+", "+i+", "+r+", "+JSON.stringify(n)),WriteToErrorLog("Error in ios8.js.logonWith_BudgetWorkflow().usercustomlogon. Incorrect .js file version: "+t+", "+i+", "+r+", "+JSON.stringify(n)))}})))}function getANewPasswordViaTextMessage(){displayAlertDialog("In getANewPasswordViaTextMessage() this functionality is not complete.COming soon!")}function cmdDisplayForgottenPasswordDialog(){$("#divCustomLogonResetPasswordDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Sign Up",width:"760",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divCustomLogonResetPasswordDialog").dialog("close")})}});$("#divCustomLogonResetPasswordDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();var n=getCookie("customlogonusername");document.getElementById("txtCustomLogonResetPasswordEmail").value=n}function cmdSendResetPasswordEmail(){var i=document.getElementById("txtCustomLogonResetPasswordEmail").value,n=[],t;n={userEmailAddress:i};t=webserviceurl+"/bwworkflow/sendresetpasswordemail";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n.message=="INVALID EMAIL ADDRESS"?displayAlertDialog("This email address is not valid."):n.message=="SUCCESS"?(displayAlertDialog("The email has been sent. You should receive it shortly."),$("#divCustomLogonResetPasswordDialog").dialog("close")):displayAlertDialog(n.message)},error:function(n,t,i){displayAlertDialog("Error in my.js.cmdSendResetPasswordEmail(): "+i)}})}function cmdCustomRegistration(){var i=document.getElementById("txtCustomSignUpFriendlyName").value,r=document.getElementById("txtCustomSignUpEmail").value,n=document.getElementById("txtCustomSignUpPassword").value,t,u;i.trim()==""?displayAlertDialog("Please enter a Name before continuing the registration process."):r.trim()==""?displayAlertDialog("Please enter an Email Address before continuing the registration process."):n.trim()==""?displayAlertDialog("Please enter an Password before continuing the registration process."):n.trim().length<4||n.trim().length>15?displayAlertDialog("Please enter an Password that is 4-15 characters in length."):(t=[],t={newUserFriendlyName:i,newUserEmailAddress:r,newUserPassword:n,appweburl:appweburl},u=webserviceurl+"/bwworkflow/registeranewuser",$.ajax({url:u,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(n){var t,i;if(n.message=="This email address is already in use")displayAlertDialog("This email address is already registered with us. Please enter a different one, or login using the existing credentials.");else if(n.message=="SUCCESS"){participantId=n.participant.bwParticipantId;participantFriendlyName=n.participant.bwParticipantFriendlyName;participantEmail=n.participant.bwParticipantEmail;tenantId=n.participant.bwTenantId;workflowAppId=n.participant.bwLastSelectedWorkflowAppId;workflowAppTitle=n.participant.bwWorkflowAppTitle;participantLogonType="custom";participantLogonTypeUserId=participantId;emailNotificationFrequency=n.participant.bwEmailNotificationFrequency;emailNotificationTypes=n.participant.bwEmailNotificationTypes;tipsDisplayOn=n.participant.bwTipsDisplayOn=="true"?!0:!1;displayInvitationsOnHomePageDisplayOn=n.participant.bwInvitationsOnHomePageDisplayOn=="true"?!0:!1;displayNewRequestsOnHomePageDisplayOn=n.participant.bwNewRequestsOnHomePageDisplayOn=="true"?!0:!1;t="";try{t=getUrlParams().invitation.toString().split("#")[0]}catch(r){}t!=""&&invitationAlreadyAccepted==!1&&(i=webserviceurl+"/bwinvitations/"+t,$.ajax({url:i,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog("ACCEPTING INVITATION");cmdAcceptInvitation(t,n.d.results[0].bwTenantId,n.d.results[0].bwWorkflowAppId,n.d.results[0].bwWorkflowAppTitle,n.d.results[0].bwInvitationParticipantRole)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdCustomRegistration():1:",t+", "+i+" data:"+n)}}));displayAlertDialog("Your login was created successfully. Enjoy using BudgetRequests.com!");$("#divCustomLogonDialog").dialog("close");$("#divCustomSignUpDialog").dialog("close");initializeTheForm()}else displayAlertDialog(n.message)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdCustomRegistration().registeranewuser: "+i)}}))}function renderLeftButtons(n){var i,r,t;try{console.log('In renderLeftButtons("'+n+'").');try{r=$("#selectHomePageWorkflowAppDropDown option:selected").val();i=r.split("|")[1]}catch(u){i="notloggedin"}t="";t+="";t+='<table style="width:100%;padding:0 0 0 0;margin:0 0 0 0;">';i=="notloggedin"?(t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;">',t+='<div id="'+n+"WelcomeButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\">Home<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"NewRequestButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divNewRequest', 'Reports', '');\">New Request<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"HelpButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divHelp', 'Reports', '');\">Help<\/div>",t+="<\/td>",t+="<\/tr>"):i=="owner"?(t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;">',t+='<div id="'+n+"WelcomeButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\">Home<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"NewRequestButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divNewRequest', 'Reports', '');\">New Request<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"ArchiveButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divArchive', 'Reports', '');\">Archive<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"SummaryButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divSummaryReport', 'Reports', '');\">Activity&nbsp;&nbsp;&nbsp;&nbsp;<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"ConfigurationButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divConfiguration', 'Reports', '');\">Configuration<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"HelpButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divHelp', 'Reports', '');\">Help<\/div>",t+="<\/td>",t+="<\/tr>"):i=="archiveviewer"?(t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;">',t+='<div id="'+n+"WelcomeButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\">Home<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"NewRequestButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divNewRequest', 'Reports', '');\">New Request<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"ArchiveButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divArchive', 'Reports', '');\">Archive<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"ConfigurationButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divConfiguration', 'Reports', '');\">Configuration<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"HelpButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divHelp', 'Reports', '');\">Help<\/div>",t+="<\/td>",t+="<\/tr>"):i=="reportviewer"?(t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;">',t+='<div id="'+n+"WelcomeButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\">Home<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"NewRequestButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divNewRequest', 'Reports', '');\">New Request<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"ArchiveButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divArchive', 'Reports', '');\">Archive<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"SummaryButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divSummaryReport', 'Reports', '');\">Activity&nbsp;&nbsp;&nbsp;&nbsp;<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"ConfigurationButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divConfiguration', 'Reports', '');\">Configuration<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"HelpButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divHelp', 'Reports', '');\">Help<\/div>",t+="<\/td>",t+="<\/tr>"):i=="configurationmanager"?(t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;">',t+='<div id="'+n+"WelcomeButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\">Home<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"NewRequestButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divNewRequest', 'Reports', '');\">New Request<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"ArchiveButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divArchive', 'Reports', '');\">Archive<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"SummaryButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divSummaryReport', 'Reports', '');\">Activity&nbsp;&nbsp;&nbsp;&nbsp;<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"ConfigurationButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divConfiguration', 'Reports', '');\">Configuration<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"HelpButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divHelp', 'Reports', '');\">Help<\/div>",t+="<\/td>",t+="<\/tr>"):i=="participant"?(t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;">',t+='<div id="'+n+"WelcomeButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\">Home<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"NewRequestButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divNewRequest', 'Reports', '');\">New Request<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"ConfigurationButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divConfiguration', 'Reports', '');\">Configuration<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"HelpButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divHelp', 'Reports', '');\">Help<\/div>",t+="<\/td>",t+="<\/tr>"):(displayAlertDialog("Error in renderLeftButtonsForRole("+i+")"),t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;">',t+='<div id="'+n+"WelcomeButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\">Home<\/div>",t+="<\/td>",t+="<\/tr>",t+="<tr><td><\/td><\/tr>",t+="<tr>",t+='<td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='<div id="'+n+"HelpButton\" class=\"divLeftButtonIos8\" onclick=\"populateStartPageItem('divHelp', 'Reports', '');\">Help<\/div>",t+="<\/td>",t+="<\/tr>");t+="<\/table>";document.getElementById("divIos8LeftMenu").innerHTML=t;console.log('Rendered buttons in "'+n+'" for role: '+i+".");switch(n){case"divWelcomePageLeftButtons":document.getElementById(n+"WelcomeButton").className="divLeftButtonSelectedIos8";break;case"divNewRequestPageLeftButtons":document.getElementById(n+"NewRequestButton").className="divLeftButtonSelectedIos8";break;case"divArchivePageLeftButtons":document.getElementById(n+"ArchiveButton").className="divLeftButtonSelectedIos8";break;case"divSummaryPageLeftButtons":document.getElementById(n+"SummaryButton").className="divLeftButtonSelectedIos8";break;case"divConfigurationPageLeftButtons":document.getElementById(n+"ConfigurationButton").className="divLeftButtonSelectedIos8";break;case"divHelpPageLeftButtons":document.getElementById(n+"HelpButton").className="divLeftButtonSelectedIos8";break;case"divRequestFormPageLeftButtons":document.getElementById(n+"HelpButton").className="divLeftButtonSelectedIos8";break;default:displayAlertDialog("Error in renderLeftButtons("+n+").")}}catch(u){console.log('Exception in renderLeftButtons("'+n+'"): '+u.message+", "+u.stack)}}function initializeTheLogonForParticipantIdAndDisplayUnsubscribePage(n){try{var t,i=webserviceurl+"/getparticipantlogontype/"+n;$.ajax({url:i,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var r,u,i;if(t=n[0].bwParticipantLogonType,t=="facebook")window.fbAsyncInit=function(){FB.init({appId:"39139756228",cookie:!0,xfbml:!0,version:"v2.2"});checkFbLoginState()},function(n,t,i){var r,u=n.getElementsByTagName(t)[0];n.getElementById(i)||(r=n.createElement(t),r.id=i,r.src="//connect.facebook.net/en_US/sdk.js",u.parentNode.insertBefore(r,u))}(document,"script","facebook-jssdk");else if(t=="microsoft"){var f=window.location.href,e=f.split("#")[1],o=e.split("access_token=")[1],s=o.split("&")[0],h="https://apis.live.net/v5.0/me?access_token="+s;$.ajax({url:h,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){participantLogonType="microsoft";participantLogonTypeUserId=n.id;participantFriendlyName=n.name;initializeTheForm()},error:function(n,t,i){displayAlertDialog("Error:"+t+":"+i+":"+JSON.stringify(n))}})}else if(t=="google"){r="Google logon...";u="";try{u=getUrlParams().unsubscribe.toString().split("#")[0]}catch(v){}u!=""&&(i="",i+="<hr>It would be better if you can log in prior to completing your email unsubscribe request, but if you prefer to do it now <br />",i+='then you can <a href="javascript:cmdForceUnsubscribe();">Click here to unsubscribe<\/a><br /><br />',i+="<hr>",i+="<i>You will receive a confirmation email. We send this out to ensure you have authorized this request.<br /><br />",i+="We will also send emails to the participants of the workflow so they know you won't be participating in the workflows.<\/i>",r="Unsubscribe...",$("#divGoogleLogonButtonUnsubscribeOptions").html(i),$("#divGoogleLogonButtonUnsubscribeOptions").show());$("#divGoogleLogonButton").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:r,width:"650px",dialogClass:"no-close",hide:!1});var c=function(){gapi.client.load("oauth2","v2",function(){gapi.client.oauth2.userinfo.get().execute(function(n){participantLogonType="google";participantLogonTypeUserId=n.id;participantFriendlyName=n.name;participantEmail=n.email;try{$("#divGoogleLogonButton").dialog("close")}catch(t){}participantLogonTypeUserId?initializeTheForm():window.location="index.html"})})},l={callback:c,approvalprompt:"force",clientid:googleOAuth2ClientId,scope:"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email",requestvisibleactions:"http://schemas.google.com/CommentActivity http://schemas.google.com/ReviewActivity",cookiepolicy:"single_host_origin"},a=function(){gapi.signin.render("renderMe",l)};a()}},error:function(n,t,i){displayAlertDialog("You have no internet connectivity, or the website is not processing requests at this time. Additional information: Error in ios8.js.initializeTheLogonForParticipantIdAndDisplayUnsubscribePage():1:",t+", "+i+" data:"+n)}})}catch(r){displayAlertDialog("Error in ios8.js.initializeTheLogonForParticipantIdAndDisplayUnsubscribePage():2:",r.message)}}function cmdTopBarExpandCollapse(n){WriteToErrorLog("","");n="#"+n;$("#divIos8LeftMenu").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"760px",dialogClass:"Ios8LeftMenu",hide:!1,position:{my:"left top",at:"left bottom",of:$(n)},open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divIos8LeftMenu").dialog("close")})}});$("#divIos8LeftMenu").dialog().parents(".ui-dialog").css("background-color","transparent");$("#divIos8LeftMenu").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}function cmdSecondTopBarExpandCollapse(n){try{n="#"+n;$("#divIos8SecondLeftMenu").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"760px",dialogClass:"Ios8LeftMenu",hide:!1,position:{my:"left top",at:"left bottom",of:$(n)},open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divIos8SecondLeftMenu").dialog("close")})}});$("#divIos8SecondLeftMenu").dialog().parents(".ui-dialog").css("background-color","transparent");$("#divIos8SecondLeftMenu").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}catch(t){displayAlertDialog("Exception in ios8.js.cmdSecondTopBarExpandCollapse("+n+"): "+t.message)}}function cmdConfigurationTopBarExpandCollapse(n){n="#"+n;$("#divIos8ConfigurationLeftMenu").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"760px",dialogClass:"Ios8LeftMenu",hide:!1,position:{my:"left top",at:"left bottom",of:$(n)},open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divIos8ConfigurationLeftMenu").dialog("close")})}});$("#divIos8ConfigurationLeftMenu").dialog().parents(".ui-dialog").css("background-color","transparent");$("#divIos8ConfigurationLeftMenu").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}function cmdSignInNow(n){$("#"+n).dialog("close");$("#divCustomLogonDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Sign Up",width:"970px",dialogClass:"no-close",hide:!1});$("#divCustomLogonDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();var t=getCookie("customlogonusername"),i=getCookie("customlogonpassword");$("#txtCustomLogonEmail").val(t);$("#txtCustomLogonPassword").val(i)}function initializeTheLogon(){var n,t;try{n="";try{n=getUrlParams().ActiveStateIdentifier.toString().split("#")[0]}catch(i){}n!=""?(console.log("In initializeTheLogon(). Got activeStateIdentifier: "+n),t=webserviceurl+"/getparticipantdetailsusingactivestateidentifier/"+n,$.ajax({url:t,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){if(n.d.message=="ERROR")displayAlertDialog(n.d.error);else if(n.d.message=="FAILED"){var t=globalUrlPrefix+globalUrl+"/ios8.html?logontype=custom";window.location=t}else participantLogonType="custom",participantLogonTypeUserId=n.d.results[0].bwParticipantId,participantFriendlyName=n.d.results[0].bwParticipantFriendlyName,participantEmail=n.d.results[0].bwParticipantEmail,initializeTheForm()},error:function(n,t,i){displayAlertDialog("Error in my.js.initializeTheLogon():1:"+t+", "+i+" data:"+JSON.stringify(n))}})):displayTheLogon()}catch(i){displayAlertDialog("There was a problem logging you in. Please try again by clicking one of the logon links below."+i.message);window.location.href=globalUrlPrefix+globalUrl}}function displayTheLogon(n){var t,i;try{n&&n=="logonandthenpresentattachmentdialog"?(t=getCookie("customlogonusername"),i=getCookie("customlogonpassword"),$("#txtCustomLogonAndPresentAttachmentDialogEmail").val(t),$("#txtCustomLogonAndPresentAttachmentDialogPassword").val(i),$("#divCustomLogonAndPresentAttachmentDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Sign In",width:"760px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divCustomLogonAndPresentAttachmentDialog").dialog("close")})}}),$("#divCustomLogonAndPresentAttachmentDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()):(t=getCookie("customlogonusername"),i=getCookie("customlogonpassword"),$("#txtCustomLogonEmail").val(t),$("#txtCustomLogonPassword").val(i),$("#divCustomLogonDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Sign In",width:"970px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divCustomLogonDialog").dialog("close")})}}),$("#divCustomLogonDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove())}catch(r){console.log("Exception in displayTheLogon(): "+r.message+", "+r.stack)}}function loginWithLinkedIn(){IN.User.authorize(function(){IN.API.Profile("me").fields(["firstName","lastName","emailAddress"]).result(function(n){var t=n.values[0];participantLogonType="linkedin";t.hasOwnProperty("firstName")&&(participantFriendlyName=t.firstName);t.hasOwnProperty("lastName")&&(participantFriendlyName+=" "+t.lastName);t.hasOwnProperty("emailAddress")&&(participantEmail=t.emailAddress);initializeTheForm()})})}function checkFbLoginState(){FB.getLoginStatus(function(n){facebookStatusChangeCallback(n)})}function facebookStatusChangeCallback(n){var i,r,t;if(n.status==="connected")FB.login(function(n){n.authResponse?FB.api("/me",function(n){participantLogonType="facebook";participantLogonTypeUserId=n.id;participantFriendlyName=n.name;participantEmail=n.email;try{$("#divFacebookLogonButton").dialog("close")}catch(t){}initializeTheForm()}):displayAlertDialog("User cancelled login or did not fully authorize.")});else if(n.status==="not_authorized")displayAlertDialog("FB NOT AUTHORIZED - logged into facebook but not the app");else{i="Facebook logon...";r="";try{r=getUrlParams().unsubscribe.toString().split("#")[0]}catch(u){}r!=""&&(t="",t+="<hr>It would be better if you can log in prior to completing your email unsubscribe request, but if you prefer to do it now <br />",t+='then you can <a href="javascript:cmdForceUnsubscribe();">Click here to unsubscribe<\/a><br /><br />',t+="<hr>",t+="<i>You will receive a confirmation email. We send this out to ensure you have authorized this request.<br /><br />",t+="We will also send emails to the participants of the workflow so they know you won't be participating in the workflows.<\/i>",t+="",i="Unsubscribe...",$("#divFacebookLogonButtonUnsubscribeOptions").html(t),$("#divFacebookLogonButtonUnsubscribeOptions").show());$("#divFacebookLogonButton").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:i,width:"650px",dialogClass:"no-close",hide:!1})}}function cmdForceUnsubscribe(){displayAlertDialog("This functionality is incomplete. Coming soon! cmdForceUnsubscribe().")}function cmdUnsubscribe(){var n=[],t;n={participantId:participantId};t=webserviceurl+"/unsubscribe";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdUnsubscribe():1:"+i+" "+JSON.stringify(n))}})}function initializeTheForm(){try{console.log("In initializeTheForm()");$("#bwStartPageAccordion").show();$("#liWelcome").show();$("#liOfflineWelcome").hide();$("#liNewRequest").hide();$("#liArchive").hide();$("#liSummaryReport").hide();$("#liConfiguration").hide();$("#liHelp").hide();$("#liOfflineRequestForm").hide();$("input#financialOrParticipantSummary").switchButton({checked:!1,show_labels:!0,labels_placement:"both",on_label:"<span style='font-size:30pt;'>Participant<br />Summary<\/span>",off_label:"<span style='font-size:30pt;'>Financial<br />Summary<\/span>",width:200,height:88,button_width:96,clear_after:null});$("#financialOrParticipantSummary").change(function(){$("#financialOrParticipantSummary").is(":checked")?$("#financialOrParticipantSummary").is(":checked")?$("#budgetRequestsOrQuotes").is(":checked")?$("#budgetRequestsOrQuotes").is(":checked")?renderParticipantSummary(!0):displayAlertDialog("budgetRequestsOrQuotes is in an invalid state."):renderParticipantSummary(!1):displayAlertDialog("financialOrParticipantSummary is in an invalid state."):$("#budgetRequestsOrQuotes").is(":checked")?$("#budgetRequestsOrQuotes").is(":checked")?renderFinancialSummary9(!0):displayAlertDialog("budgetRequestsOrQuotes is in an invalid state."):renderFinancialSummary9(!1)});attachmentsFolderName="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)});renderWelcomeScreen()}catch(n){console.log("Exception in ios8.js.initializeTheForm(): "+n.message+", "+n.stack);displayAlertDialog("Error in ios8.js.initializeTheForm(): "+n.message)}}function formatRequestedCapital_InitBudgetRequestIos8(){var n=document.getElementById("dblRequestedCapital").value.replace(/[^0-9-.]/g,"");document.getElementById("dblRequestedCapital").value=n}function ReassignAParticipantAndReplaceWithNewUser(){var t=!0,i,n;try{i=document.getElementById("txtReassignUserTasksDialogUserToReplaceFriendyName").value;t=!1}catch(r){}t==!1?(n=confirm("This action cannot be undone.\n\n\nClick the OK button to proceed..."),n&&(cmdDeleteParticipantAndAssignANewUser(userId),$(this).dialog("close"))):(n=confirm("This action cannot be undone.\n\n\nClick the OK button to proceed..."),n&&(cmdDeleteParticipant(userId),$(this).dialog("close")))}function cmdDisplayReassignUserTasksDialog(n,t,i){try{$("#ReassignUserTasksDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"800px",dialogClass:"no-close",hide:!1,open:function(){var r,u;$(".ui-widget-overlay").bind("click",function(){$("#ReassignUserTasksDialog").dialog("close")});r=[];r={bwParticipantId:n,bwWorkflowAppId:workflowAppId};u=webserviceurl+"/bwworkflow/itemizeparticipantdependencies";$.ajax({url:u,type:"POST",timeout:ajaxTimeout,data:r,headers:{Accept:"application/json; odata=verbose"},success:function(r){var u;try{if(r.message!="SUCCESS")displayAlertDialog(JSON.stringify(r));else if(r.NumberOfFunctionalAreas==0&&r.NumberOfIncompleteTasks==0&&r.NumberOfIncompleteBudgetRequestsSpecifiedAsManager==0)u="",u+="This user has no Tasks, is not an approver for any Functional Areas, and is not a Manager for any Budget Requests.",document.getElementById("spanReassignUserTasksDialogUserDependencyDetails").innerHTML=u,document.getElementById("spanReassignUserTasksDialogChooseAUserSection").style.display="none",document.getElementById("spanReassignUserTasksDialogReassignTasksButton").style.display="none",document.getElementById("spanReassignUserTasksDialogEmailMessage").style.display="none";else{document.getElementById("spanReassignUserTasksDialogChooseAUserSection").style.display="inline";document.getElementById("spanReassignUserTasksDialogReassignTasksButton").style.display="inline";document.getElementById("spanReassignUserTasksDialogEmailMessage").style.display="inline";try{document.getElementById("txtReassignUserTasksDialogUserToReplaceFriendyName").value="";document.getElementById("txtReassignUserTasksDialogUserToReplaceId").value="";document.getElementById("txtReassignUserTasksDialogUserToReplaceEmail").value=""}catch(f){displayAlertDialog("Error:"+f.message+f.stack)}u="";u+="When this users' tasks are reassigned, the following will need to be reassigned to a new user (alternatively you can go back and change them one at a time):";u+="<ul>";u+='<li style="color:red;"><span style="color:black;">'+r.NumberOfFunctionalAreas+" Financial Area(s)<\/span><\/li>";u+='<li style="color:red;"><span style="color:black;">'+r.NumberOfIncompleteTasks+" incomplete Task(s)<\/span><\/li>";u+='<li style="color:red;"><span style="color:black;">'+r.NumberOfIncompleteBudgetRequestsSpecifiedAsManager+" incomplete Budget Request(s) where specified as the Manager<\/span><\/li>";u+="<\/ul>";document.getElementById("spanReassignUserTasksDialogUserDependencyDetails").innerHTML=u;u="";u+='Select the user to take over these items from <span style="white-space:nowrap;"><i>'+t+" ("+i+")<\/i><\/span>";document.getElementById("spanReassignUserTasksDialogUserToReassignFriendlyName").innerHTML=u;u="";u+='<div id="btnReassignUserTasksDialogReassignTasks" class="divSignInButton" onclick="ReassignParticipantResponsibilities(\''+n+"','"+t+"','"+i+'\');" style="width:90%;text-align:center;line-height:0.8em;font-weight:bold;word-wrap:break-word;">';u+="Reassign Responsibilities (#)";u+="<\/div>";document.getElementById("spanReassignUserTasksDialogReassignTasksButton").innerHTML=u}}catch(f){displayAlertDialog("Error in ios8.js.cmdDisplayReassignUserTasksDialog():1: "+f.message+", "+f.stack)}},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdDisplayReassignUserTasksDialog().itemizeparticipantdependencies: "+i)}})}});$("#ReassignUserTasksDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("spanReassignUserTasksDialogTitle").innerHTML="Reassign "+t+"'s responsibilities in this workflow."}catch(r){displayAlertDialog("Error in ios8.js.cmdDisplayReassignUserTasksDialog():3: "+r.message+", "+r.stack)}}function cmdDisplayChangeUserRoleDialog(n,t,i,r,u){var e,f,o;for($("#ChangeUserRoleDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"Change the role for "+t+"...",width:"800px",dialogClass:"no-close",hide:!1,buttons:{"Change Role":{text:"Change Role",id:"btnUserRoleDialogChangeRole",disabled:"true",style:"color:red;font-size:30pt;",click:function(){cmdChangeUserRoleAndSendEmail(n,t,i,u);$(this).dialog("close")}},Close:{text:"Close",style:"font-size:30pt;",click:function(){$(this).dialog("close")}}},open:function(){$(".ui-widget-overlay").bind("click",function(){$("#ChangeUserRoleDialog").dialog("close")})}}),$("#ChangeUserRoleDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),document.getElementById("spanChangeUserRoleDialogTitle").innerHTML="Change the role for "+t+".",document.getElementById("cbUserRoleDialogEmailMessage").removeAttribute("checked",""),e=document.getElementsByName("rbChangeUserRole"),f=0;f<e.length;f++)e[f].value==r&&(e[f].checked=!0);o="Send email notification to "+t+" ("+i+"). You can include an additional message as well:";$("#spanUserRoleDialogEmailMessageText").text(o);$("#cbUserRoleDialogEmailMessage").off("click").click(function(){var t=document.getElementById("cbUserRoleDialogEmailMessage").checked,n;t==!0?(n=$("#ChangeUserRoleDialog").dialog("option","buttons"),$.each(n,function(n,t){t.id==="btnUserRoleDialogChangeRole"&&(t.text="Change Role and Send Email",t.style="color:red;font-size:30pt;")}),$("#ChangeUserRoleDialog").dialog("option","buttons",n)):(n=$("#ChangeUserRoleDialog").dialog("option","buttons"),$.each(n,function(n,t){t.id==="btnUserRoleDialogChangeRole"&&(t.text="Change Role",t.style="color:red;font-size:30pt;")}),$("#ChangeUserRoleDialog").dialog("option","buttons",n))});$("input:radio[name=rbChangeUserRole]").click(function(){var n;this.value==r?(n=$("#ChangeUserRoleDialog").dialog("option","buttons"),$.each(n,function(n,t){t.id==="btnUserRoleDialogChangeRole"&&(t.disabled=!0)}),$("#ChangeUserRoleDialog").dialog("option","buttons",n)):(n=$("#ChangeUserRoleDialog").dialog("option","buttons"),$.each(n,function(n,t){t.id==="btnUserRoleDialogChangeRole"&&(t.disabled=!1)}),$("#ChangeUserRoleDialog").dialog("option","buttons",n))})}function deleteAParticipantAndReplaceWithNewUser(){var t=!0,i,n;try{i=document.getElementById("txtDeleteAParticipantDialogUserToReplaceFriendyName").value;t=!1}catch(r){}t==!1?(n=confirm("This action cannot be undone.\n\n\nClick the OK button to proceed..."),n&&(cmdDeleteParticipantAndAssignANewUser(userId),$(this).dialog("close"))):(n=confirm("This action cannot be undone.\n\n\nClick the OK button to proceed..."),n&&(cmdDeleteParticipant(userId),$(this).dialog("close")))}function cmdDisplayDeleteUserDialog(n,t,i){try{$("#DeleteAParticipantDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"Remove "+t+" from this workflow.",width:"800px",dialogClass:"no-close",hide:!1,open:function(){var r,u;try{$(".ui-widget-overlay").bind("click",function(){$("#DeleteAParticipantDialog").dialog("close")});r=[];r={bwParticipantId:n,bwWorkflowAppId:workflowAppId};u=webserviceurl+"/bwworkflow/itemizeparticipantdependencies";$.ajax({url:u,type:"POST",timeout:ajaxTimeout,data:r,headers:{Accept:"application/json; odata=verbose"},success:function(n){var r;try{n.message!="SUCCESS"?displayAlertDialog(JSON.stringify(n)):n.NumberOfFunctionalAreas==0&&n.NumberOfIncompleteTasks==0&&n.NumberOfIncompleteBudgetRequestsSpecifiedAsManager==0?(r="",r+="This user has no Tasks, is not an approver for any Functional Areas, and is not a Manager for any Budget Requests.",document.getElementById("spanDeleteAParticipantDialogUserDependencyDetails").innerHTML=r,document.getElementById("spanDeleteAParticipantDialogChooseAUserSection").innerHTML=""):(r="",r+="When this user is removed, the following will need to be re-assigned to a new user (or you may be able to go back and change them one at a time):",r+="<ul>",r+='<li style="color:red;"><span style="color:black;">'+n.NumberOfFunctionalAreas+" Financial Area(s)<\/span><\/li>",r+='<li style="color:red;"><span style="color:black;">'+n.NumberOfIncompleteTasks+" incomplete Task(s)<\/span><\/li>",r+='<li style="color:red;"><span style="color:black;">'+n.NumberOfIncompleteBudgetRequestsSpecifiedAsManager+" incomplete Budget Request(s) where specified as the Manager<\/span><\/li>",r+="<\/ul>",document.getElementById("spanDeleteAParticipantDialogUserDependencyDetails").innerHTML=r,r="",r+='Select the user to take over these items from <span style="white-space:nowrap;"><i>'+t+" ("+i+")<\/i><\/span>",document.getElementById("spanDeleteAParticipantDialogUserToDeleteFriendlyName").innerHTML=r,$("#divDeleteAParticipantDialogReassignTasks").innerHTML="Replace "+t+" with the new user")}catch(u){displayAlertDialog("Error in ios8.js.cmdDisplayDeleteUserDialog():1: "+u.message)}},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdDisplayDeleteUserDialog().itemizeparticipantdependencies: "+i)}})}catch(f){displayAlertDialog("Error in ios8.js.cmdDisplayDeleteUserDialog():2x: "+f.message+", "+f.stack)}}});$("#DeleteAParticipantDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("spanDeleteAParticipantDialogTitle").innerHTML="Remove "+t+" from this workflow."}catch(r){displayAlertDialog("Error in ios8.js.cmdDisplayDeleteUserDialog():2: "+r.message+r.stack)}}function cmdDeleteParticipantAndAssignANewUser(n){var i=document.getElementById("txtDeleteAParticipantDialogUserToReplaceFriendyName").value,u=document.getElementById("txtDeleteAParticipantDialogUserToReplaceId").value,f=document.getElementById("txtDeleteAParticipantDialogUserToReplaceEmail").value,t,r;i!=""&&(t=[],t={oldUserId:n,ModifiedById:participantId,ModifiedByFriendlyName:participantFriendlyName,ModifiedByEmail:participantEmail,bwWorkflowAppId:workflowAppId,newUserFriendlyName:i,newUserId:u,newUserEmail:f},r=webserviceurl+"/bwworkflow/removeaparticipantandreassigntoanewuser",$.ajax({url:r,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog(n);populateStartPageItem("divParticipants","Reports","")},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdDeleteParticipantAndAssignANewUser(): "+i)}}))}function cmdDeleteParticipant(n){var t=[],i;t={oldUserId:n,bwWorkflowAppId:workflowAppId};i=webserviceurl+"/bwworkflow/removeaparticipant";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog(n);populateStartPageItem("divParticipants","Reports","")},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdDeleteParticipant(): "+i)}})}function cmdChangeUserRoleAndSendEmail(n,t,i,r){for(var e,s,h=document.getElementById("cbUserRoleDialogEmailMessage").checked,c=document.getElementById("txtUserRoleDialogEmailMessage").textContent,o,f=document.getElementsByName("rbChangeUserRole"),u=0;u<f.length;u++)f[u].checked&&(o=f[u].value);e=[];e={sendEmailNotification:h,emailNotificationAdditionalMessage:c,bwWorkflowAppId:workflowAppId,bwWorkflowAppTitle:workflowAppTitle,bwParticipantId:n,bwParticipantFriendlyName:t,bwParticipantEmail:i,bwParticipantLogonType:r,bwParticipantRole:o,ModifiedById:participantId,ModifiedByFriendlyName:participantFriendlyName,ModifiedByEmail:participantEmail};s=webserviceurl+"/bwparticipant/updateuserrole";$.ajax({url:s,type:"POST",timeout:ajaxTimeout,data:e,headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog(n);populateStartPageItem("divParticipants","Reports","")},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdChangeUserRoleAndSendEmail(): "+i+" "+JSON.stringify(n))}})}function attachSharedFileFromIos(n,t,i){var r,u;try{sharedFileFromIosFileContents=n;sharedFileFromIosFileName=t;sharedFileFromIosFileDescription=i;WriteToErrorLog("In attachSharedFileFromIos(sharedFileFromIosFileContents)",sharedFileFromIosFileContents);$("#divAttachSharedFileFromIosDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"970px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divAttachSharedFileFromIosDialog").dialog("close")})}});$("#divAttachSharedFileFromIosDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();r="";r+="<br />";r+="<br />";participantId&&participantId!=""?(r+='<div class="divSignInButton" style="width: 850px; height: 150px; text-align: center; line-height: 1.5em; font-size: 60pt;" onclick="attachSharedFileFromIosToANewRequest(\''+n+"', '"+t+"', '"+i+"');\">New Request<\/div>",r+="<br />",r+='<div class="divSignInButton" style="width: 850px; height: 150px; text-align: center; line-height: 1.5em; font-size: 60pt;" onclick="attachSharedFileFromIosToAnExistingRequest();">Existing Request<\/div>',r+="<br />"):(r+='<div class="divSignInButton" style="width: 850px; height: 450px; text-align: center; line-height: 1.5em; font-size: 60pt;" onclick="displayTheLogon(\'logonandthenpresentattachmentdialog\');">Sign In<br /><em>(to attach this file<br />to an online request)<\/em><\/div>',r+="<br />");r+='<div class="divSignInButton" style="width: 850px; height: 150px; text-align: center; line-height: 1.5em; font-size: 60pt;" onclick="attachSharedFileFromIosToANewOfflineRequest();">New Offline Request<\/div>';r+="<br />";u=indexedDB.open(indexDBName,dbVersion);u.onblocked=function(n){console.log("indexDB BLOCKED1. errorCode: "+n.target.errorCode)};u.onerror=function(n){console.log('In ios8.js.attachSharedFileFromIos(): Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};u.onsuccess=function(n){var t,u,i;console.log('In ios8.js.attachSharedFileFromIos(): Success accessing database "'+n.target.result.name+'".');t=n.target.result;t.onerror=function(n){console.log('In ios8.js.attachSharedFileFromIos(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};try{u=t.transaction("objectStoreCachedRequests","readonly");i=u.objectStore("objectStoreCachedRequests").count()}catch(f){console.log("In ios8.js.attachSharedFileFromIos(): XXXXXXXXXXXerror: "+f.message)}i.onsuccess=function(n){n.target.result>0&&(r+='<div class="divSignInButton" style="width: 850px; height: 150px; text-align: center; line-height: 1.5em; font-size: 60pt;" onclick="attachSharedFileFromIosToAnExistingOfflineRequest();">Existing Offline Request<\/div>',r+="<br />");r+="<br />";r+='<div class="divSignInButton" style="width: 850px; height: 150px; text-align: center; line-height: 1.5em; font-size: 60pt;" onclick="$(\'#divAttachSharedFileFromIosDialog\').dialog(\'close\');">Close<\/div>';r+="<br />";document.getElementById("divAttachSharedFileFromIosDialogContent").innerHTML=r};i.onerror=function(){console.error("In ios8.js.attachSharedFileFromIos(): add error",this.error)}}}catch(f){displayAlertDialog("Exception in ios8.js.attachSharedFileFromIos(): "+f.message+", "+f.stack)}}function attachSharedFileFromIosToANewRequest(n,t){var e,y,p,r,f,u,s,o,l,a,i,h,c,v;try{if(WriteToErrorLog("In attachSharedFileFromIosToANewRequest()","liNewRequest.style.display: "+document.getElementById("liNewRequest").style.display),document.getElementById("liNewRequest").style.display!="none")e=document.getElementById("BudgetRequestId").innerHTML,WriteToErrorLog("In attachSharedFileFromIosToANewRequest()","New request screen already displayed. _budgetRequestId: "+e);else{if(bwLastSelectedNewRequestType=="recurringexpense"?$("#trNewRequestRecurringExpenseSection").show():$("#trNewRequestRecurringExpenseSection").hide(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),document.getElementById("BudgetRequestId").innerHTML=e,y="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),document.getElementById("RecurringExpenseId").innerHTML=y,document.getElementById("strProjectTitle").value="",document.getElementById("strBriefDescriptionOfProject").value="",document.getElementById("dblRequestedCapital").value="",document.getElementById("txtProjectManagerName").value="",document.getElementById("ddlFunctionalArea").innerHTML="",document.getElementById("newrequestattachments").innerHTML="",$("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").hide(),$("#liOfflineWelcome").hide(),$("#liArchive").hide(),$("#liSummaryReport").hide(),$("#liConfiguration").hide(),$("#liHelp").hide(),$("#liNewRequest").show(),p=document.getElementById("divNewRequestMasterDiv"),p.style.borderRadius="120px 0 0 120px",r=[],r=[],f=["budgetrequest","Budget Request","selected"],r.push(f),quotingEnabled==!0&&(f=["quoterequest","Quote Request",""],r.push(f)),reimbursementRequestsEnabled==!0&&(f=["expenserequest","Reimbursement Request",""],r.push(f)),recurringExpensesEnabled==!0&&(f=["recurringexpense","Recurring Expense",""],r.push(f)),u="",r.length==1)u+='<span style="font-size: 300%;">New <strong>'+r[0][1]+"<\/strong><\/span>",document.getElementById("spanRequestForm_Title").innerHTML=u;else{for(u+='<span style="font-size: 300%;">New <strong>',u+='<select id="selectNewRequestFormRequestTypeDropDown" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1.25em; font-weight: bold; cursor: pointer;\'>',i=0;i<r.length;i++)u+=r[i][0]==bwLastSelectedNewRequestType?'<option value="'+r[i][0]+'" '+r[i][2]+" selected >"+r[i][1]+"<\/option>":'<option value="'+r[i][0]+'" '+r[i][2]+">"+r[i][1]+"<\/option>";u+="<\/select>";u+="<\/span>";document.getElementById("spanRequestForm_Title").innerHTML=u;$("#selectNewRequestFormRequestTypeDropDown").change(function(){var t=$("#selectNewRequestFormRequestTypeDropDown option:selected").val(),n,i;bwLastSelectedNewRequestType=t;n=[];n={bwParticipantId:participantId,bwWorkflowAppId:workflowAppId,bwLastSelectedNewRequestType:bwLastSelectedNewRequestType};i=webserviceurl+"/bwparticipant/updateuserconfigurationselectednewrequestscreenrequesttype";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"?displayAlertDialog(n):t=="recurringexpense"?$("#trNewRequestRecurringExpenseSection").show():$("#trNewRequestRecurringExpenseSection").hide()},error:function(n,t,i){displayAlertDialog("Error in ios8.js.attachSharedFileFromIosToANewRequest(): "+t+" "+i)}})})}populateFunctionalAreas();$("#spanRequestForm_ManagerTitle").html(newBudgetRequestManagerTitle);document.getElementById("spanNewRequestDetailsLabel").innerHTML=requireRequestDetails==!0?'<span class="xdlabel">Justification details:<\/span>&nbsp;<span style="color:red;font-size:medium;">*<\/span>':'<span class="xdlabel">Justification details:<\/span>';requireStartEndDates==!0?(document.getElementById("spanNewRequestStartDateLabel").innerHTML='<span class="xdlabel" style="white-space:nowrap;">Start date (estimated):&nbsp;<\/span><span style="color:red;font-size:medium;">*<\/span>',document.getElementById("spanNewRequestEndDateLabel").innerHTML='<span class="xdlabel" style="white-space:nowrap;">End date (estimated):&nbsp;<\/span><span style="color:red;font-size:medium;">*<\/span>'):(document.getElementById("spanNewRequestStartDateLabel").innerHTML='<span class="xdlabel">Start date (estimated):<\/span>',document.getElementById("spanNewRequestEndDateLabel").innerHTML='<span class="xdlabel">End date (estimated):<\/span>');enableNewRequestAttachments==!0?$("#trNewRequestAttachmentsSection").show():$("#trNewRequestAttachmentsSection").hide();enableNewRequestBarcodeAttachments==!0?$("#trNewRequestBarcodeAttachmentsSection").show():$("#trNewRequestBarcodeAttachmentsSection").hide();renderLeftButtons("divNewRequestPageLeftButtons");$("#txtProjectManagerName").autocomplete({source:function(n,t){$.ajax({url:webserviceurl+"/workflow/"+workflowAppId+"/participants/"+n.term,dataType:"json",success:function(n){for(var r=[],i=0;i<n.participants.length;i++)r[i]=n.participants[i].participant;t(r)}})},minLength:1,select:function(){},open:function(){},close:function(){var n=this.value.split("|")[0],t=this.value.split("|")[1],i=this.value.split("|")[2];n.indexOf("undefined")>-1?(document.getElementById("txtProjectManagerName").value="",document.getElementById("txtProjectManagerId").value="",document.getElementById("txtProjectManagerEmail").value=""):(document.getElementById("txtProjectManagerName").value=n,document.getElementById("txtProjectManagerId").value=t,document.getElementById("txtProjectManagerEmail").value=i)}});monkeyPatchAutocomplete()}for(s=e,$("#divAttachSharedFileFromIosDialog").dialog("close"),$("#divFileUploadSpinnerDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"970px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divFileUploadSpinnerDialog").dialog("close")})}}),$("#divFileUploadSpinnerDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),document.getElementById("spanFileUploadSpinnerDialogTitle").innerHTML="Uploading "+t+"...",WriteToErrorLog("In attachSharedFileFromIosToANewRequest():2.","bwBudgetRequestId:"+s),o=atob(sharedFileFromIosFileContents),l=new Uint8Array(o.length),i=0,h=o.length;i<h;++i)l[i]=o.charCodeAt(i);for(a="",i=0,h=o.length;i<h;++i)a+=String.fromCharCode(l[i]);c=[];c={bwWorkflowAppId:workflowAppId,bwBudgetRequestId:s,Filename:sharedFileFromIosFileName,FileContent:a,Description:sharedFileFromIosFileDescription};v=globalUrlPrefix+globalUrlForWebServices+"/_files/uploadattachment";console.log("In ios8.js.attachSharedFileFromIosToANewRequest(). Preparing to upload using operationUri: "+v+", fileAndData: "+JSON.stringify(c));$.ajax({url:v,type:"PUT",data:c,headers:{Accept:"application/json; odata=verbose"},success:function(n){$("#divFileUploadSpinnerDialog").dialog("close");console.log("in ios8.js.attachSharedFileFromIosToANewRequest(). SUCCESSS UPLOADING FILE! response data: "+JSON.stringify(n));populateAttachments(workflowAppId,s,"newrequestattachments")},error:function(n,t,i){console.log("Error in ios8.js.attachSharedFileFromIosToANewRequest(): data: "+JSON.stringify(n)+", errorCode: "+t+", errorMessage: "+i)}})}catch(w){displayAlertDialog("Exception in ios8.js.attachSharedFileFromIosToANewRequest(): "+w.message+", "+w.stack+", sharedFileFromIosFileContents: "+sharedFileFromIosFileContents)}}function confirmItsOkToCancelTheNewRequest(){try{document.getElementById("newrequestattachments").innerHTML.length>0?($("#divConfirmItsOkToCancelTheNewRequestDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"970px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divConfirmItsOkToCancelTheNewRequestDialog").dialog("close")})}}),$("#divConfirmItsOkToCancelTheNewRequestDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()):populateStartPageItem("divWelcome","Reports","")}catch(n){displayAlertDialog("Exception in ios8.js.confirmItsOkToCancelTheNewRequest(): "+n.message)}}function attachSharedFileFromIosToAnExistingRequest(){try{$("#divAttachSharedFileFromIosToAnExistingRequestDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"970px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divAttachSharedFileFromIosToAnExistingRequestDialog").dialog("close")})}});$("#divAttachSharedFileFromIosToAnExistingRequestDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();var t=webserviceurl+"/bwtenants/"+tenantId.toString();$.ajax({url:t,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(){var n=webserviceurl+"/bwworkflowapps/"+tenantId.toString();$.ajax({url:n,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(){$.ajax({url:webserviceurl+"/getfunctionalareasbyappid/"+workflowAppId+"/RETURNALL",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var t={bwParticipantId:participantId};$.ajax({url:webserviceurl+"/bwworkflowapps/listofworklflowappsthathavebeeninvitedto",type:"DELETE",contentType:"application/json",data:JSON.stringify(t),success:function(t){var i,r,u;if(1){if(i="",r="",r+="<br />",r+="<span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 2.77em;\">Your budgeting network: ",t.length==1)r+='<span id="spanHomePageWorkflowAppTitleForAttachmentSearchDialog" style="font-weight:bold;cursor:default;white-space:nowrap;" title="You are the owner of this workflow.">'+t[0].bwWorkflowAppTitle+"<\/span>";else{for(r+='<span id="spanHomePageWorkflowAppTitleForAttachmentSearchDialog">',r+='<select id="selectHomePageWorkflowAppDropDownForAttachmentSearchDialog" onchange="selectHomePageWorkflowAppDropDowForAttachmentSearchDialogn_change();" class="selectHomePageWorkflowAppDropDown" style="cursor:pointer;font-weight:bold;border-color:whitesmoke;font-family: \'Segoe UI Light\',\'Segoe UI\',\'Segoe\',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 1.25em;">',u=0;u<t.length;u++)r+=workflowAppId==t[u].bwWorkflowAppId?'<option value="'+t[u].bwWorkflowAppId+"|"+t[u].bwParticipantRole+'" selected>'+t[u].bwWorkflowAppTitle+"<\/option>":'<option value="'+t[u].bwWorkflowAppId+"|"+t[u].bwParticipantRole+'">'+t[u].bwWorkflowAppTitle+"<\/option>";r+="<\/select><\/span>"}r+="<\/span>";$("#divYourBudgetingNetworkSelector").html(r);i+="<br />";i+='<span id="spanHomePagePersonalizedSectionForAttachmentSearchDialog"><\/span>';n.length==0?(i+="You need to create at least one financial area before you can begin using your budget workflow.<br />",i+="<a href=\"javascript:populateStartPageItem('divConfiguration', 'Reports', '');\">Click here to create the first Financial Area<\/a>",i+="<br /><br />",i+="",i+="",i+="",i+="",$("#divAttachSharedFileFromIosToAnExistingRequestDialogContent").html(i)):($("#divAttachSharedFileFromIosToAnExistingRequestDialogContent").html(i),renderHomePagePersonalizedSectionForAttachmentSearchDialog())}else alert("In attachSharedFileFromIosToAnExistingRequest(), section: This section is for users who are participants and not tenant owners.")},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderWelcomeScreen():2.1:"+t+", "+i+", "+JSON.stringify(n))}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderWelcomeScreen():2:"+t+", "+i+", "+JSON.stringify(n))}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderWelcomeScreen():3:",t+", "+i)}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderWelcomeScreen():4:",t+", "+i)}})}catch(n){displayAlertDialog("Exception in ios8.js.attachSharedFileFromIosToAnExistingRequest(): "+n.message+", "+n.stack)}}function attachSharedFileFromIosToANewOfflineRequest(){var r,c,i,u,l,e,h,f,n,o,s,a,t;try{for(console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest()."),document.getElementById("OfflineRequestBudgetRequestId").innerHTML==""?(r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),document.getElementById("OfflineRequestBudgetRequestId").innerHTML=r):r=document.getElementById("OfflineRequestBudgetRequestId").innerHTML,document.getElementById("OfflineRequestRecurringExpenseId").innerHTML==""?(c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),document.getElementById("OfflineRequestRecurringExpenseId").innerHTML=c):c=document.getElementById("OfflineRequestRecurringExpenseId").innerHTML,document.getElementById("strProjectTitle").value="",document.getElementById("strBriefDescriptionOfProject").value="",document.getElementById("dblRequestedCapital").value="",document.getElementById("txtProjectManagerName").value="",document.getElementById("ddlFunctionalArea").innerHTML="",document.getElementById("newrequestattachments").innerHTML="",$("#liWelcome").hide(),$("#liOfflineWelcome").hide(),$("#liArchive").hide(),$("#liNewRequest").hide(),$("#liAbout").hide(),$("#liOfflineRequestForm").show(),i=[],i=[],t=["budgetrequest","Budget Request","selected"],i.push(t),t=["quoterequest","Quote Request",""],i.push(t),t=["expenserequest","Reimbursement Request",""],i.push(t),t=["recurringexpense","Recurring Expense",""],i.push(t),u="",u+='<span style="font-size: 350%;">New <strong>',u+='<select id="selectOfflineNewRequestFormRequestTypeDropDown" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1.0em; font-weight: bold; cursor: pointer;\'>',n=0;n<i.length;n++)u+='<option value="'+i[n][0]+'" '+i[n][2]+">"+i[n][1]+"<\/option>";if(u+="<\/select>",u+="<\/span>",document.getElementById("spanOfflineNewRequestFormRequestTypeDropDownSection").innerHTML=u,document.getElementById("spanNewRequestDetailsLabel").innerHTML='<span class="xdlabel">Justification details:<\/span>',document.getElementById("spanNewRequestStartDateLabel").innerHTML='<span class="xdlabel">Start date (estimated):<\/span>',document.getElementById("spanNewRequestEndDateLabel").innerHTML='<span class="xdlabel">End date (estimated):<\/span>',$("#trNewRequestAttachmentsSection").show(),$("#trNewRequestBarcodeAttachmentsSection").show(),console.log("XXXXXXXXXXXXXXXXXXXXXXXXXXX"),$("#divAttachSharedFileFromIosDialog").dialog("close"),$("#divFileUploadSpinnerDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"970px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divFileUploadSpinnerDialog").dialog("close")})}}),$("#divFileUploadSpinnerDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),document.getElementById("spanFileUploadSpinnerDialogTitle").innerHTML="Uploading "+sharedFileFromIosFileName+"...",l="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)){for(e=atob(sharedFileFromIosFileContents),f=new Uint8Array(e.length),n=0,o=e.length;n<o;++n)f[n]=e.charCodeAt(n);s=f.buffer;console.log("In attachSharedFileFromIosToANewOfflineRequest. THIS IS THE WORKAROUND FOR THE IOS STORING BLOB IN INDEXDB ISSUE");a={encodingType:"uInt8Array",fileContents:s,fileName:sharedFileFromIosFileName,fileDescription:sharedFileFromIosFileDescription,bwBudgetRequestId:r,id:l}}else{for(h=atob(sharedFileFromIosFileContents),f=new Uint8Array(h.length),n=0,o=h.length;n<o;++n)f[n]=h.charCodeAt(n);s=new Blob([f.buffer],{type:"image/jpeg"});a={encodingType:"blob",fileContents:s,fileName:sharedFileFromIosFileName,fileDescription:sharedFileFromIosFileDescription,bwBudgetRequestId:r,id:l}}t=indexedDB.open(indexDBName,dbVersion);t.onblocked=function(n){console.error(n.target);console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().request.onblocked: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().request.onblocked: "+n.target.error.name||n.target.error||n.target.errorCode)};t.onerror=function(n){console.error(n.target);console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().request.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().request.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)};t.onsuccess=function(n){var i,f,u;try{console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().request.onsuccess. Success accessing IndexedDB database.");i=n.target.result;i.onerror=function(n){console.error(n.target);console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().db.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().db.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)};try{f=i.transaction("OfflineAttachedFiles","readwrite")}catch(t){console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest(). ERROR ACCESSING OfflineAttachedFiles DATABASE11!!!!!!!!!!!!"+t.message+", "+t.stack);displayAlertDialog("In ios8.js.attachSharedFileFromIosToANewOfflineRequest(). ERROR ACCESSING OfflineAttachedFiles DATABASE11!!!!!!!!!!!!"+t.message+", "+t.stack)}try{u=f.objectStore("OfflineAttachedFiles").add(a)}catch(t){console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest(). ERROR ACCESSING OfflineAttachedFiles DATABASE22!!!!!!!!!!!!"+t.message+", "+t.stack);displayAlertDialog("In ios8.js.attachSharedFileFromIosToANewOfflineRequest(). ERROR ACCESSING OfflineAttachedFiles DATABASE22!!!!!!!!!!!!"+t.message+", "+t.stack)}console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest(). Successfully executed var put = transaction.objectStore(OfflineAttachedFiles).add(dbRecord);");u.onsuccess=function(){console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest(). Successfully stored file in the database.");$("#divFileUploadSpinnerDialog").dialog("close");var n="OfflineRequestnewrequestattachments",u=i.transaction("OfflineAttachedFiles","readonly"),t;t=u.objectStore("OfflineAttachedFiles").count();t.onsuccess=function(t){var f,o,e;try{t.target.result==0?$("#"+n)[0].innerHTML="<i>no attachments found<\/i>":(console.log("In attachSharedFileFromIosToANewOfflineRequest("+n+"). Found "+t.target.result+" files on my device."),f="",f+="<br /><br />",o=t.target.result,e=i.transaction("OfflineAttachedFiles").objectStore("OfflineAttachedFiles"),e.openCursor().onsuccess=function(t){var i,u,o,h,f,l,c,w,b;try{if(i=t.target.result,i){if(console.log("In attachSharedFileFromIosToANewOfflineRequest("+n+"): _budgetRequestId: "+r+", cursor.value.bwBudgetRequestId: "+i.value.bwBudgetRequestId),r==i.value.bwBudgetRequestId){console.log("In attachSharedFileFromIosToANewOfflineRequest("+n+"). Rendering list of attachments for _budgetRequestId: "+r);u=i.value.fileName;o=i.value.fileDescription;console.log("In attachSharedFileFromIosToANewOfflineRequest("+n+"): _budgetRequestId == cursor.value.bwBudgetRequestId");navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)?(u.toUpperCase().indexOf(".JPG")!=-1||u.toUpperCase().indexOf(".JPEG")?f="image/jpeg":u.toUpperCase().indexOf(".PNG")!=-1?f="image/png":u.toUpperCase().indexOf(".BMP")!=-1?f="image/bmp":u.toUpperCase().indexOf(".GIF")!=-1?f="image/gif":u.toUpperCase().indexOf(".TIFF")!=-1&&(f="image/tiff"),h=new Blob([i.value.fileContents],{type:f})):h=i.value.fileContents;l=window.URL||window.webkitURL;c=l.createObjectURL(h);console.log("In attachSharedFileFromIosToANewOfflineRequest("+n+"): Got fileUrl: "+c);var a=800,v=600,y=(screen.width-a)/2,p=(screen.height-v)/2,e="";e+=Platform=="IOS8"?'<div class="attachmentsSectionFileLink" onclick="displayAttachmentInDialogOffline2(\''+u+"', '"+o+"', '"+r+"', '"+n+"');\">":'<div class="attachmentsSectionFileLink" onclick="window.open(\''+c+"', 'window1', 'width="+a+", height="+v+", top="+p+", left="+y+", resizable=yes');return false;\">";e+=u;e+=o.length>0?'&nbsp;&nbsp;<span class="attachmentsSectionDescription"> - "'+o+'"<\/span>':'&nbsp;&nbsp;<span class="attachmentsSectionDescription"> - [no description]'+o+"<\/span>";w="xx";b=0;e+="<\/div>";e+="<\/br>";console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest("+n+"). Preparing to render in attachmentsTagId "+n);$("#"+n).append(e)}i.continue()}}catch(s){console.log("Exception in ios8.js.attachSharedFileFromIosToANewOfflineRequest("+n+"):8: "+s.message+", "+s.stack);displayAlertDialog("Exception in ios8.js.attachSharedFileFromIosToANewOfflineRequest("+n+"):8: "+s.message+", "+s.stack)}})}catch(u){console.log("Exception in ios8.js.attachSharedFileFromIosToANewOfflineRequest("+n+"):9: "+u.message+", "+u.stack);displayAlertDialog("Exception in ios8.js.attachSharedFileFromIosToANewOfflineRequest("+n+"):9: "+u.message+", "+u.stack)}};t.onerror=function(){console.error("In ios8.js.attachSharedFileFromIosToANewOfflineRequest("+n+").req.onerror: add error",this.error);console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest("+n+").req.onerror:10: "+this.error);displayAlertDialog("In ios8.js.attachSharedFileFromIosToANewOfflineRequest("+n+").req.onerror:10: "+this.error)}};u.onerror=function(n){console.error(n.target);console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().put.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().put.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)};u.transaction.oncomplete=function(n){console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().put.transaction.oncomplete: "+n)};u.transaction.onerror=function(n){console.log("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().put.transaction.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In ios8.js.attachSharedFileFromIosToANewOfflineRequest().put.transaction.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)}}catch(t){console.log("Exception in ios8.js.attachSharedFileFromIosToANewOfflineRequest(). indexDBName: "+indexDBName+", dbVersion: "+dbVersion+", error: "+t.message+", "+t.stack)}}}catch(v){displayAlertDialog("Exception in ios8.js.attachSharedFileFromIosToANewOfflineRequest(): "+v.message+", "+v.stack)}}function attachSharedFileFromIosToAnExistingOfflineRequest(){console.log("In attachSharedFileFromIosToAnExistingOfflineRequest().");try{var t=indexedDB.open(indexDBName,dbVersion);t.onblocked=function(n){console.log("In attachSharedFileFromIosToAnExistingOfflineRequest(). indexDB BLOCKED1. errorCode: "+n.target.errorCode);displayAlertDialog("In attachSharedFileFromIosToAnExistingOfflineRequest(). indexDB BLOCKED1. errorCode: "+n.target.errorCode)};t.onerror=function(n){console.log('In ios8.js.attachSharedFileFromIosToAnExistingOfflineRequest(). Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);displayAlertDialog('In ios8.js.attachSharedFileFromIosToAnExistingOfflineRequest(). Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};t.onsuccess=function(n){var t,r,i;console.log('In ios8.js.attachSharedFileFromIosToAnExistingOfflineRequest(). Success accessing database "'+n.target.result.name+'".');t=n.target.result;t.onerror=function(n){console.log('Error in ios8.js.attachSharedFileFromIosToAnExistingOfflineRequest(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);displayAlertDialog('Error in ios8.js.attachSharedFileFromIosToAnExistingOfflineRequest(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};try{r=t.transaction("objectStoreCachedRequests","readonly");i=r.objectStore("objectStoreCachedRequests").count()}catch(u){console.log("In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialog().XXXXXXXXXXXerror: "+u.message);displayAlertDialog("In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialog().XXXXXXXXXXXerror: "+u.message)}i.onsuccess=function(n){var i,u,r;document.getElementById("spanClientRequestsNotYetSubmittedDialogTitle").innerHTML=n.target.result+" Requests on this device are waiting to be submitted.";document.getElementById("divClientRequestsNotYetSubmittedContent").innerHTML="";i="";i+='<span style="font-style:italic;font-size:30pt;">If this device runs low on storage, it may delete them without asking you.<\/span>';i+="<br />";i+="<br />";i+="<br />";i+='<table class="myStuffTable" style="width:100%;">';i+="  <tr>";i+='    <td class="bwHPNDrillDownLinkCell" style="text-align:left;" colspan="2"><span>There are '+n.target.result+" requests saved on this device.<\/span><\/td>";i+="  <\/tr>";u=n.target.result;r=t.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests");r.openCursor().onsuccess=function(n){var t,u;try{t=n.target.result;t?(u="",console.log("Retrieved request: "+t.value.ProjectTitle+": "+t.value.bwBudgetRequestId),i+="  <tr>",i+='    <td class="tdHomePageSubNotificationIos8" style="cursor:pointer;width:95%;" onclick="selectOfflineArForAttachmentSearchDialog(\''+t.value.bwBudgetRequestId+"');\">",i+='      <div style="display:inline-block;">',i+='        <span title="Click to view the request." style="cursor:pointer;font-size:30pt;width:100%;">'+t.value.ProjectTitle+" (<em>"+formatCurrency(t.value.RequestedCapital)+"<\/em>)<\/span>",i+="      <\/div>",i+="    <\/td>",i+="    <td>",i+='      <img src="images/trash-can.png" onclick="cmdDisplayDeleteUnsubmittedBudgetRequestDialog(\''+t.value.bwBudgetRequestId+"', '"+t.value.ProjectTitle+"', '"+t.value.RequestedCapital+'\');" title="Delete" class="trashcan" style="cursor:pointer;">',i+="    <\/td>",i+="  <\/tr>",t.continue()):(console.log("In attachSharedFileFromIosToAnExistingOfflineRequest(). DONE LOOPING, so rendering."),i+='<tr><td colspan="12"><\/td><\/tr>',i+="<\/table>",document.getElementById("divAttachSharedFileFromIosToAnExistingOfflineRequestDialogContent").innerHTML=i,$("#divAttachSharedFileFromIosToAnExistingOfflineRequestDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"970px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divAttachSharedFileFromIosToAnExistingOfflineRequestDialog").dialog("close")})}}),$("#divAttachSharedFileFromIosToAnExistingOfflineRequestDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove())}catch(r){console.log("InattachSharedFileFromIosToAnExistingOfflineRequest(). xxError: "+r.message+", "+r.stack);displayAlertDialog("InattachSharedFileFromIosToAnExistingOfflineRequest(). xxError: "+r.message+", "+r.stack)}}};i.onerror=function(){console.error("In ios8.js.attachSharedFileFromIosToAnExistingOfflineRequest(). add error",this.error);console.log("In ios8.js.attachSharedFileFromIosToAnExistingOfflineRequest(). add error: "+this.error);displayAlertDialog("In ios8.js.attachSharedFileFromIosToAnExistingOfflineRequest(). add error: "+this.error)}}}catch(n){console.log("In ios8.js.attachSharedFileFromIosToAnExistingOfflineRequest(). FAILED TO OPEN A TRANSACTION to the database..."+n.message+", "+n.stack);displayAlertDialog("In ios8.js.attachSharedFileFromIosToAnExistingOfflineRequest(). FAILED TO OPEN A TRANSACTION to the database..."+n.message+", "+n.stack)}}function cmdDisplayPeoplePickerDialog(n,t,i,r){document.getElementById("txtPeoplePickerDialogSearchBox").value="";document.getElementById("txtPeoplePickerDialogParticipantId").value="";document.getElementById("txtPeoplePickerDialogParticipantEmail").value="";$("#PeoplePickerDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"Select a person...",width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#PeoplePickerDialog").dialog("close")})}});$("#PeoplePickerDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();$("#txtPeoplePickerDialogSearchBox").autocomplete({source:function(u){u.term==""?renderAllParticipantsInThePeoplePicker():$.ajax({url:webserviceurl+"/workflow/"+workflowAppId+"/participants/"+u.term,dataType:"json",success:function(u){var e,f;if($("#spanPeoplePickerParticipantsList").empty(),e="",u.participants.length>0)for(f=0;f<u.participants.length;f++)e+='<a style="white-space:nowrap;" href="javascript:cmdReturnParticipantIdToField(\''+n+"', '"+t+"', '"+i+"', '"+u.participants[f].participant.split("|")[0]+"', '"+u.participants[f].participant.split("|")[1]+"', '"+u.participants[f].participant.split("|")[2]+"', '"+r+"');\">"+u.participants[f].participant.split("|")[0]+"&nbsp;&nbsp;<i>("+u.participants[f].participant.split("|")[2]+")<\/i><\/a>",e+="<br />";else e+="<span><i>There were no results<\/i><\/span>";$("#spanPeoplePickerParticipantsList").append(e)}})},minLength:0,select:function(){},open:function(){},close:function(){var n=this.value.split("|")[0],t=this.value.split("|")[1],i=this.value.split("|")[2];n.indexOf("undefined")>-1?(document.getElementById("txtPeoplePickerDialogSearchBox").value="",document.getElementById("txtPeoplePickerDialogParticipantId").value="",document.getElementById("txtPeoplePickerDialogParticipantEmail").value=""):(document.getElementById("txtPeoplePickerDialogSearchBox").value=n,document.getElementById("txtPeoplePickerDialogParticipantId").value=t,document.getElementById("txtPeoplePickerDialogParticipantEmail").value=i)}});renderAllParticipantsInThePeoplePicker(n,t,i,r)}function renderAllParticipantsInThePeoplePicker(n,t,i,r){$("#spanPeoplePickerParticipantsList").empty();var u={bwWorkflowId:workflowAppId};$.ajax({url:webserviceurl+"/workflow/participants",type:"DELETE",contentType:"application/json",data:JSON.stringify(u),success:function(u){for(var e="",f=0;f<u.length;f++)e+='<a style="white-space:nowrap;" href="javascript:cmdReturnParticipantIdToField(\''+n+"', '"+t+"', '"+i+"', '"+u[f].bwParticipantFriendlyName+"', '"+u[f].bwParticipantId+"', '"+u[f].bwParticipantEmail+"', '"+r+"');\">"+u[f].bwParticipantFriendlyName+"&nbsp;&nbsp;<i>("+u[f].bwParticipantEmail+")<\/i><\/a>",e+="<br />";$("#spanPeoplePickerParticipantsList").append(e)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllParticipants():"+t+", "+i)}})}function cmdReturnParticipantIdToField(n,t,i,r,u,f,e){try{console.log('In cmdReturnParticipantIdToField(value "'+r+'" should display in field: '+n+". Element type: "+document.getElementById(n).nodeName+").");document.getElementById(n).nodeName=="SPAN"?(console.log("In cmdReturnParticipantIdToField(). This is  a SPAN tag, so handle appropriately. selectedParticipantFriendlyName: "+r),document.getElementById(n).innerHTML=r,document.getElementById(n).setAttribute("title",f),document.getElementById(t).innerHTML=u,document.getElementById(i).innerHTML=f):(document.getElementById(n).value=r,document.getElementById(n).setAttribute("title",f),document.getElementById(t).value=u,document.getElementById(i).value=f);e&&e!="undefined"&&(document.getElementById(e).disabled=!1);$("#PeoplePickerDialog").dialog("close")}catch(o){console.log('Exception in cmdReturnParticipantIdToField(value "'+r+'" should display in field: '+n+"): "+o.message+", "+o.stack)}}function renderWelcomeScreen(){try{$("#divWelcomeMasterDivTitle").text("Home");$("#divMenuMasterDivWelcomeButton").css({"border-width":"0px",margin:"0px 0px 0px 0px",padding:"12px 0px 0px 20px",outline:"rgb(59, 103, 142) dashed 1px","border-radius":"0px",width:"92%",height:"28px",color:"#dcdcdc","background-color":"white"});participantLogonType&&($("#spanLoggedInUser").text(participantFriendlyName),$("#spanLoggedInUserNewRequestPage").text(participantFriendlyName),$("#spanLoggedInUserMyStuffPage").text(participantFriendlyName),$("#spanLoggedInUserSummaryReportPage").text(participantFriendlyName),$("#spanLoggedInUserConfigurationPage").text(participantFriendlyName),$("#spanLoggedInUserHelpPage").text(participantFriendlyName));$("#spanbwLoggedInUserDropDownTitle").html("Logged in: "+participantFriendlyName);$("#spanAlertLink").qtip({content:{text:'<span style="font-size:50pt;">Click here to display the tips!<\/span>'},position:{at:"left bottom"},style:{classes:"bwQtip"}})}catch(n){displayAlertDialog("Error in ios8.js.renderWelcomeScreen():6:",n.message)}}function renderHomePagePersonalizedSection(){var t="",i,n;try{i=$("#selectHomePageWorkflowAppDropDown option:selected").val();t=i.split("|")[1]}catch(r){t="owner"}try{n="";t=="owner"?($("#divFunctionalAreasButton").show(),$("#divParticipantsButton").show(),$("#divWorkflowSettingsButton").show(),n+='<div id="divInvitationSectionOnHomePage">',n=="<br /><br />",n+='<button id="btnInviteNewParticipant1" onclick="cmdInviteNewParticipant2();" class="BwButton350">Generate a new invitation link<\/button>',n+="<br />",n+='<span id="invitationLink2" style="font-size:40pt;"><\/span>',n+="<br /><br />",n+="<\/div>",n+='<div id="divHomePageAlert"><\/div>',n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;" title="There is only one owner.">You are the owner of this budget request system.<\/span>',$("#spanHomePagePersonalizedSection").html(n),displayInvitationsOnHomePageDisplayOn==!0?$("#divInvitationSectionOnHomePage").show():$("#divInvitationSectionOnHomePage").hide(),renderAlerts(),renderTenantOwnerStuff()):t=="participant"?($("#divMenuMasterDivArchiveButton").hide(),$("#divMenuMasterDivSummaryButton").hide(),$("#divConfigurationLeftSideMenu").hide(),$("#divFunctionalAreasButton").hide(),$("#divParticipantsButton").hide(),$("#divWorkflowSettingsButton").hide(),n+="<br />",n+='<div id="divHomePageAlert"><\/div>',n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;">You are a participant in this budget request system.<\/span><br /><br />',$("#spanHomePagePersonalizedSection").html(n),renderAlerts(),renderTenantOwnerStuff()):t=="archiveviewer"?($("#divFunctionalAreasButton").hide(),$("#divParticipantsButton").hide(),$("#divWorkflowSettingsButton").hide(),n+="<br />",n+='<div id="divHomePageAlert"><\/div>',n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;">You are a participant in this budget request system.<\/span><br /><br />',$("#spanHomePagePersonalizedSection").html(n),renderAlerts(),renderTenantOwnerStuff()):t=="reportviewer"?($("#divFunctionalAreasButton").hide(),$("#divParticipantsButton").hide(),$("#divWorkflowSettingsButton").hide(),n+="<br />",n+='<div id="divHomePageAlert"><\/div>',n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;">You are a participant in this budget request system.<\/span><br /><br />',$("#spanHomePagePersonalizedSection").html(n),renderAlerts(),renderTenantOwnerStuff()):t=="configurationmanager"?($("#divFunctionalAreasButton").show(),$("#divParticipantsButton").show(),$("#divWorkflowSettingsButton").show(),n+="<br />",n+='<div id="divHomePageAlert"><\/div>',n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;">You are a participant in this budget request system.<\/span><br /><br />',$("#spanHomePagePersonalizedSection").html(n),renderAlerts(),renderTenantOwnerStuff()):(n+="<br />",n+="<br /><br />ERROR",n+='<div id="divHomePageAlert"><\/div>',n+="<br />",n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;">You are neither an owner or participant in this budget request system.<\/span><br /><br />',$("#spanHomePagePersonalizedSection").html(n),renderAlerts(),renderTenantOwnerStuff());renderLeftButtons("divWelcomePageLeftButtons");$(".divBwCoreComponent").bwCoreComponent("loadWorkflowAppConfigurationDetails9")}catch(r){displayAlertDialog("Error in renderHomePagePersonalizedSection(): "+r.message+" "+r.stack)}}function renderHomePagePersonalizedSectionForAttachmentSearchDialog(){var t="",r,n;try{r=$("#selectHomePageWorkflowAppDropDownForAttachmentSearchDialog option:selected").val();t=r.split("|")[1]}catch(i){t="owner"}try{n="";t=="owner"?(n+="<br /><br />",n+='<div id="divHomePageAlertForAttachmentSearchDialog"><\/div>',n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;" title="There is only one owner.">You are the owner of this budget request system.<\/span>',$("#spanHomePagePersonalizedSectionForAttachmentSearchDialog").html(n),renderAlertsForAttachmentSearchDialog(),renderTenantOwnerStuff()):t=="participant"?(n+="<br /><br />",n+='<div id="divHomePageAlertForAttachmentSearchDialog"><\/div>',n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;">You are a participant in this budget request system.<\/span><br /><br />',$("#spanHomePagePersonalizedSectionForAttachmentSearchDialog").html(n),renderAlertsForAttachmentSearchDialog(),renderTenantOwnerStuff()):t=="archiveviewer"?(n+="<br /><br />",n+='<div id="divHomePageAlertForAttachmentSearchDialog"><\/div>',n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;">You are a participant in this budget request system.<\/span><br /><br />',$("#spanHomePagePersonalizedSectionForAttachmentSearchDialog").html(n),renderAlertsForAttachmentSearchDialog(),renderTenantOwnerStuff()):t=="reportviewer"?(n+="<br /><br />",n+='<div id="divHomePageAlertForAttachmentSearchDialog"><\/div>',n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;">You are a participant in this budget request system.<\/span><br /><br />',$("#spanHomePagePersonalizedSectionForAttachmentSearchDialog").html(n),renderAlertsForAttachmentSearchDialog(),renderTenantOwnerStuff()):t=="configurationmanager"?(n+="<br /><br />",n+='<div id="divHomePageAlertForAttachmentSearchDialog"><\/div>',n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;">You are a participant in this budget request system.<\/span><br /><br />',$("#spanHomePagePersonalizedSectionForAttachmentSearchDialog").html(n),renderAlertsForAttachmentSearchDialog(),renderTenantOwnerStuff()):(n+="<br />",n+="<br /><br />ERROR",n+='<div id="divHomePageAlertForAttachmentSearchDialog"><\/div>',n+="<br />",n+="<br /><br /><hr />",n+='<span style="cursor:help;font-size:22pt;">You are neither an owner or participant in this budget request system.<\/span><br /><br />',$("#spanHomePagePersonalizedSectionForAttachmentSearchDialog").html(n),renderAlertsForAttachmentSearchDialog(),renderTenantOwnerStuff());GetWorkflowAppConfigurationData9=$.Deferred();GetWorkflowAppConfigurationData9.done(function(){}).fail(function(){displayAlertDialog("Error in ios8.js.renderHomePagePersonalizedSectionForAttachmentSearchDialog()","GetWorkflowAppConfigurationData9.fail()")});loadWorkflowAppConfigurationDetails9()}catch(i){console.log("Error in ios8.js.renderHomePagePersonalizedSectionForAttachmentSearchDialog(): "+i.message+", "+i.stack);displayAlertDialog("Error in ios8.js.renderHomePagePersonalizedSectionForAttachmentSearchDialog(): "+i.message+" "+i.stack)}}function cmdContactTheTenantAdministrator(){displayAlertDialog("This functionality is not yet completed Coming soon! cmdContactTheTenantAdministrator().")}function renderAlerts(){if($("#divHomePageAlert").is(":visible")!=!1&&$("#divHomePageAlert").is(":visible")==!0){$("#invitationLink2").empty();var n={bwWorkflowAppId:workflowAppId,bwParticipantId:participantId};$.ajax({url:webserviceurl+"/bwinvitationsunclaimed",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(t){var i=webserviceurl+"/bwtasksoutstanding";$.ajax({url:i,type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(i){$.ajax({url:webserviceurl+"/bwtenants",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(){$("#divUserDropdownTenantMembershipLink").html("");$.ajax({url:webserviceurl+"/bwparticipants",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(){$.ajax({url:webserviceurl+"/bwbudgetrequestspending",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var o,f,a,v,h,y,u,c,r,p,e,l,s,b,w;if(i.length>0?(document.title="My Budgets ("+i.length+")",document.getElementById("welcomePageMyTasksTabTitle").innerHTML="Tasks("+i.length+')<span style="color:red;font-weight:bold;">*<\/span>',renderFavicon(!0)):(document.title="My Budgets",document.getElementById("welcomePageMyTasksTabTitle").innerHTML="Tasks",renderFavicon(!1)),o="",i.length==0&&n.PendingBudgetRequests.length==0&&n.PendingPOBudgetRequests.length==0&&(o+='<span class="spanH3_40">You have no pending tasks, and there are no pending budget requests.<\/span>'),f=1,o+='<table id="tblHomePageAlertSectionForWorkflow'+f.toString()+'" style="cursor:default;" title="">',o+='<tr id="functionalAreaRow_'+f.toString()+'_Top_1" style="visibility:hidden;"><td colspan="7"><\/td><\/tr>',o+='<tr id="functionalAreaRow_'+f.toString()+'_Top_2" style="visibility:hidden;"><td colspan="7"><\/td><\/tr>',a="",v="",notifications=new Array(4),notifications[0]=[],notifications[0]=new Array(3),notifications[1]=[],notifications[1]=new Array(3),notifications[2]=[],notifications[2]=new Array(3),notifications[3]=[],notifications[3]=new Array(3),notifications[0][0]="task",notifications[0][1]=i.length==1?"You have "+i.length+" pending task.":"You have "+i.length+" pending tasks.",notifications[0][2]=[],i.length>0)for(notifications[0][2]=new Array(i.length),r=0;r<i.length;r++)notifications[0][2][r]=new Array(15),notifications[0][2][r][0]=i[r].bwTaskTitle,notifications[0][2][r][1]=i[r].bwStatus,notifications[0][2][r][2]=i[r].bwPercentComplete,notifications[0][2][r][3]=i[r].bwRelatedItemId,notifications[0][2][r][4]=i[r].bwAssignedTo,notifications[0][2][r][5]=i[r].bwAssignedToId,notifications[0][2][r][6]=i[r].bwDueDate,notifications[0][2][r][7]=i[r].ProjectTitle,notifications[0][2][r][8]=i[r].BudgetAmount,notifications[0][2][r][9]=i[r].FinancialAreaId,notifications[0][2][r][10]=i[r].CreatedBy,notifications[0][2][r][11]=i[r].Title,notifications[0][2][r][12]=i[r].RequestedCapital,notifications[0][2][r][13]=i[r].RequestedExpense,notifications[0][2][r][14]=i[r].TaskType;if(h=n.PendingBudgetRequests.length+n.PendingPOBudgetRequests.length,notifications[1][0]="budget request",notifications[1][1]=h==1?"There is "+h+" budget request going through the approval process.":"There are "+h+" budget requests going through the approval process.",notifications[1][2]=[],h>0){for(notifications[1][2]=new Array(h),y=0,r=0;r<n.PendingBudgetRequests.length;r++)notifications[1][2][r]=new Array(13),notifications[1][2][r][0]=n.PendingBudgetRequests[r].bwBudgetRequestId,notifications[1][2][r][1]=n.PendingBudgetRequests[r].CreatedBy,notifications[1][2][r][2]=n.PendingBudgetRequests[r].Title,notifications[1][2][r][3]=n.PendingBudgetRequests[r].ProjectTitle,notifications[1][2][r][4]=n.PendingBudgetRequests[r].BudgetAmount,notifications[1][2][r][5]=n.PendingBudgetRequests[r].FunctionalAreaId,notifications[1][2][r][6]=n.PendingBudgetRequests[r].ARStatus,notifications[1][2][r][7]=n.PendingBudgetRequests[r].BudgetWorkflowStatus,notifications[1][2][r][8]=n.PendingBudgetRequests[r].Quote,notifications[1][2][r][9]=n.PendingBudgetRequests[r].CurrentOwner,notifications[1][2][r][10]=n.PendingBudgetRequests[r].ManagerId,notifications[1][2][r][11]=n.PendingBudgetRequests[r].RequestedCapital,notifications[1][2][r][12]=n.PendingBudgetRequests[r].RequestedExpense,y+=1;for(r=0;r<n.PendingPOBudgetRequests.length;r++)u=r+y,notifications[1][2][u]=new Array(13),notifications[1][2][u][0]=n.PendingPOBudgetRequests[r].bwBudgetRequestId,notifications[1][2][u][1]=n.PendingPOBudgetRequests[r].CreatedBy,notifications[1][2][u][2]=n.PendingPOBudgetRequests[r].Title,notifications[1][2][u][3]=n.PendingPOBudgetRequests[r].ProjectTitle,notifications[1][2][u][4]=n.PendingPOBudgetRequests[r].BudgetAmount,notifications[1][2][u][5]=n.PendingPOBudgetRequests[r].FunctionalAreaId,notifications[1][2][u][6]=n.PendingPOBudgetRequests[r].ARStatus,notifications[1][2][u][7]=n.PendingPOBudgetRequests[r].BudgetWorkflowStatus,notifications[1][2][u][8]=n.PendingPOBudgetRequests[r].Quote,notifications[1][2][u][9]=n.PendingPOBudgetRequests[r].CurrentOwner,notifications[1][2][u][10]=n.PendingPOBudgetRequests[r].ManagerId,notifications[1][2][u][11]=n.PendingPOBudgetRequests[r].RequestedCapital,notifications[1][2][u][12]=n.PendingPOBudgetRequests[r].RequestedExpense}if(notifications[2][0]="invitation",notifications[2][1]=t.length==1?"There is "+t.length+" unclaimed invitation.":"There are "+t.length+" unclaimed invitations.",notifications[2][2]=[],t.length>0)for(notifications[2][2]=new Array(t.length),r=0;r<t.length;r++)notifications[2][2][r]=new Array(7),notifications[2][2][r][0]=globalUrlPrefix+globalUrl+"?invitation="+t[r].bwInvitationId,notifications[2][2][r][1]=t[r].bwInvitationParticipantRole,notifications[2][2][r][2]=t[r].bwInvitationCreatedByFriendlyName;for(notifications[3][0]="recommendations",notifications[3][1]=t.length==1?"There is "+t.length+" recommendation. (DEV: This functionality is under development.)":"There are "+t.length+" recommendations. (DEV: This functionality is under development.)",notifications[3][2]=[],c=-1,r=0;r<notifications.length;r++)notifications[r][2].length>0&&(p=!1,e="",e+='<tr id="functionalAreaRow_'+f.toString()+"_"+r.toString()+'" class="bwFunctionalAreaRow">',l=0,l=1,l>0?(p=!0,l==1?notifications[r][0]=="task"?(e+='<td><img src="/images/red-dot.png" width="33" height="33" alt="" style="cursor:pointer;vertical-align:top;" /><\/td>',c=r):e+="<td><\/td>":e+=notifications[r][0]=="task"?'<td><img src="/images/red-dot.png" width="33" height="33" alt="" style="cursor:pointer;vertical-align:top;" /><\/td>':"<td><\/td>"):e+='   <td style="width:15px;"><\/td>',e+='   <td style="text-align:left;" class="bwHPNDrillDownLinkCell" onclick="expandHomePageNotificationAndRenderAlerts(\''+notifications[r][0]+"', '"+f+"', 'functionalAreaRow_"+f.toString()+"_"+r.toString()+"');\"><span>"+notifications[r][1]+"<\/span><\/td>",e+="<\/tr>",p==!0?a+=e:v+=e);o+=a+v;o+="<\/table>";s="";s+='<div id="BWFunctionalAreaDiv'+f.toString()+'" style="cursor:pointer;" >';s+='<table id="BWFunctionalArea'+f.toString()+'" style="vertical-align:top;width:100%;">';s+=o;s+="<\/table><br />";s+="<\/div>";$("#divHomePageAlert").html(s);c!=-1&&(b="functionalAreaRow_"+f.toString()+"_"+c.toString(),expandHomePageNotificationAndRenderAlerts("task",f,b));try{w=indexedDB.open(indexDBName,dbVersion);w.onerror=function(n){console.log('In ios8.js.renderAlerts(). Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};w.onsuccess=function(n){var i=n.target.result,r,t;try{r=i.transaction("objectStoreCachedRequests","readonly");t=r.objectStore("objectStoreCachedRequests").count()}catch(u){console.log("XXXXXXXXXXXerror: "+u.message)}t.onsuccess=function(n){var t,u,r;n.target.result>0&&(t="",t+='  <table style="width:100%;">',t+="    <tr>",t+='        <td style="width:10px;"><\/td>',t+='        <td style="width:10px;"><\/td>',t+="        <td>",t+="            <br />",t+="            <br />",t+='            <span style="font-size:30pt;margin:auto;text-align=center;display:table;font-style:italic;">',t+="               <span>Your requests saved on this device<\/span>",t+="               <br />",t+="               <span>Submit them now to involve your team.<\/span>",t+="            <\/span>",t+="            <br />",u=n.target.result,r=i.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),r.openCursor().onsuccess=function(n){var r,u,e;console.log("In ios8.js.renderWelcomePageOffline().request.onsuccess.objectStore.openCursor().onsuccess");try{if(t+='<table style="width:100%;">',r=n.target.result,r){u=r.value.ProjectTitle;u==""&&(u="<em>[no description]<\/em>");console.log("Retrieved request: "+u+": "+r.value.bwBudgetRequestId);t+="  <tr>";t+='    <td class="tdHomePageSubNotificationIos8" style="cursor:pointer;width:95%;" onclick="displayForm_DisplayOfflineArReadyToSubmit(\''+r.value.bwBudgetRequestId+"');\">";t+='      <div style="display:inline-block;">';t+='        <span title="Click to view the request." style="cursor:pointer;font-size:30pt;width:100%;">'+u+" (<em>"+formatCurrency(r.value.RequestedCapital)+"<\/em>)<\/span>";t+="        <br />";var f=r.value.bwDocumentXml,c=33,o=f.indexOf("<my:Brief_Description_of_Project>")+c,s=f.indexOf("<\/my:Brief_Description_of_Project>"),i=decodeURIComponent(f.substring(o,s));i=i.replace("<br>","");console.log("tmpDescription2:"+i);console.log("tmpXml: ["+f+"], tmpIndex1: "+o+", tmpIndex2: "+s);i.length>0?(console.log("tmpDescription2.length > 0: tmpDescription2.length="+i.length),e="",e=i.length>39?i.substring(0,38)+"...":i,t+="      <span>",t+="      <em>"+e+"&nbsp;&nbsp;&#128247;&nbsp;&nbsp;&#127908;<\/em>",t+="      <\/span>"):(console.log("!(tmpDescription2.length > 0): tmpDescription2.length="+i.length),t+="      <span>",t+='      <em>y[no details]&nbsp;&nbsp;&#128193;&nbsp;<span style="opacity: 0.20;">&#127908;<\/span>&nbsp;<span style="opacity: 0.20;">&#128249;<\/span>&nbsp;<span style="opacity: 0.20;">&#128247;<\/span><\/em>',t+="      <\/span>");t+="      <\/div>";t+="    <\/td>";t+="  <\/tr>";r.continue()}else console.log("DONE LOOPING, so rendering."),t+="<\/table>",t+="      <\/td>",t+="    <\/tr>",t+="  <\/table>",$("#divHomePageAlert").append(t)}catch(h){console.log("xxError: "+h.message+", "+h.stack)}})};t.onerror=function(){console.error("In ios8.js.renderAlerts(). add error",this.error)}}}catch(k){console.log("In ios8.js.renderAlerts(). FAILED TO OPEN A TRANSACTION to the database..."+k.message+", "+k.stack)}},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderAlerts():1:"+t+", "+i+" I believe this happens when wifi goes down. SERVICE UNAVAILABLE ")}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderAlerts():2:"+t+", "+i)}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderAlerts():3:"+t+", "+i)}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderAlerts():4:"+t+", "+i+", "+JSON.stringify(n))}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderAlerts():5:"+t+", "+i+": Most likely service unavailable issue.")}})}}function renderAlertsForAttachmentSearchDialog(){if($("#divHomePageAlertForAttachmentSearchDialog").is(":visible")!=!1&&$("#divHomePageAlertForAttachmentSearchDialog").is(":visible")==!0){var n={bwWorkflowAppId:workflowAppId,bwParticipantId:participantId};$.ajax({url:webserviceurl+"/bwinvitationsunclaimed",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(t){var i=webserviceurl+"/bwtasksoutstanding";$.ajax({url:i,type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(i){$.ajax({url:webserviceurl+"/bwtenants",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(){$("#divUserDropdownTenantMembershipLinkForAttachmentSearchDialog").html("");$.ajax({url:webserviceurl+"/bwparticipants",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(){$.ajax({url:webserviceurl+"/bwbudgetrequestspending",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var o="",f,a,v,h,y,u,c,r,p,e,l,s,b,w;if(i.length==0&&n.PendingBudgetRequests.length==0&&n.PendingPOBudgetRequests.length==0&&(o+='<span class="spanH3_40">You have no pending tasks, and there are no pending budget requests.<\/span>'),f=1,o+='<table id="tblHomePageAlertSectionForWorkflowForAttachmentSearchDialog'+f.toString()+'" style="cursor:default;" title="">',o+='<tr id="functionalAreaRowForAttachmentSearchDialog_'+f.toString()+'_Top_1" style="visibility:hidden;"><td colspan="7"><\/td><\/tr>',o+='<tr id="functionalAreaRowForAttachmentSearchDialog_'+f.toString()+'_Top_2" style="visibility:hidden;"><td colspan="7"><\/td><\/tr>',a="",v="",notifications=new Array(3),notifications[0]=[],notifications[0]=new Array(3),notifications[1]=[],notifications[1]=new Array(3),notifications[2]=[],notifications[2]=new Array(3),notifications[0][0]="task",notifications[0][1]=i.length==1?"You have "+i.length+" pending task.":"You have "+i.length+" pending tasks.",notifications[0][2]=[],i.length>0)for(notifications[0][2]=new Array(i.length),r=0;r<i.length;r++)notifications[0][2][r]=new Array(15),notifications[0][2][r][0]=i[r].bwTaskTitle,notifications[0][2][r][1]=i[r].bwStatus,notifications[0][2][r][2]=i[r].bwPercentComplete,notifications[0][2][r][3]=i[r].bwRelatedItemId,notifications[0][2][r][4]=i[r].bwAssignedTo,notifications[0][2][r][5]=i[r].bwAssignedToId,notifications[0][2][r][6]=i[r].bwDueDate,notifications[0][2][r][7]=i[r].ProjectTitle,notifications[0][2][r][8]=i[r].BudgetAmount,notifications[0][2][r][9]=i[r].FinancialAreaId,notifications[0][2][r][10]=i[r].CreatedBy,notifications[0][2][r][11]=i[r].Title,notifications[0][2][r][12]=i[r].RequestedCapital,notifications[0][2][r][13]=i[r].RequestedExpense,notifications[0][2][r][14]=i[r].TaskType;if(h=n.PendingBudgetRequests.length+n.PendingPOBudgetRequests.length,notifications[1][0]="budget request",notifications[1][1]=h==1?"There is "+h+" budget request going through the approval process.":"There are "+h+" budget requests going through the approval process.",notifications[1][2]=[],h>0){for(notifications[1][2]=new Array(h),y=0,r=0;r<n.PendingBudgetRequests.length;r++)notifications[1][2][r]=new Array(13),notifications[1][2][r][0]=n.PendingBudgetRequests[r].bwBudgetRequestId,notifications[1][2][r][1]=n.PendingBudgetRequests[r].CreatedBy,notifications[1][2][r][2]=n.PendingBudgetRequests[r].Title,notifications[1][2][r][3]=n.PendingBudgetRequests[r].ProjectTitle,notifications[1][2][r][4]=n.PendingBudgetRequests[r].BudgetAmount,notifications[1][2][r][5]=n.PendingBudgetRequests[r].FunctionalAreaId,notifications[1][2][r][6]=n.PendingBudgetRequests[r].ARStatus,notifications[1][2][r][7]=n.PendingBudgetRequests[r].BudgetWorkflowStatus,notifications[1][2][r][8]=n.PendingBudgetRequests[r].Quote,notifications[1][2][r][9]=n.PendingBudgetRequests[r].CurrentOwner,notifications[1][2][r][10]=n.PendingBudgetRequests[r].ManagerId,notifications[1][2][r][11]=n.PendingBudgetRequests[r].RequestedCapital,notifications[1][2][r][12]=n.PendingBudgetRequests[r].RequestedExpense,y+=1;for(r=0;r<n.PendingPOBudgetRequests.length;r++)u=r+y,notifications[1][2][u]=new Array(13),notifications[1][2][u][0]=n.PendingPOBudgetRequests[r].bwBudgetRequestId,notifications[1][2][u][1]=n.PendingPOBudgetRequests[r].CreatedBy,notifications[1][2][u][2]=n.PendingPOBudgetRequests[r].Title,notifications[1][2][u][3]=n.PendingPOBudgetRequests[r].ProjectTitle,notifications[1][2][u][4]=n.PendingPOBudgetRequests[r].BudgetAmount,notifications[1][2][u][5]=n.PendingPOBudgetRequests[r].FunctionalAreaId,notifications[1][2][u][6]=n.PendingPOBudgetRequests[r].ARStatus,notifications[1][2][u][7]=n.PendingPOBudgetRequests[r].BudgetWorkflowStatus,notifications[1][2][u][8]=n.PendingPOBudgetRequests[r].Quote,notifications[1][2][u][9]=n.PendingPOBudgetRequests[r].CurrentOwner,notifications[1][2][u][10]=n.PendingPOBudgetRequests[r].ManagerId,notifications[1][2][u][11]=n.PendingPOBudgetRequests[r].RequestedCapital,notifications[1][2][u][12]=n.PendingPOBudgetRequests[r].RequestedExpense}if(notifications[2][0]="invitation",notifications[2][1]=t.length==1?"There is "+t.length+" unclaimed invitation.":"There are "+t.length+" unclaimed invitations.",notifications[2][2]=[],t.length>0)for(notifications[2][2]=new Array(t.length),r=0;r<t.length;r++)notifications[2][2][r]=new Array(7),notifications[2][2][r][0]=globalUrlPrefix+globalUrl+"?invitation="+t[r].bwInvitationId,notifications[2][2][r][1]=t[r].bwInvitationParticipantRole,notifications[2][2][r][2]=t[r].bwInvitationCreatedByFriendlyName;for(c=1,r=0;r<notifications.length;r++)notifications[r][2].length>0&&(p=!1,e="",e+='<tr id="functionalAreaRowForAttachmentSearchDialog_'+f.toString()+"_"+r.toString()+'" class="bwFunctionalAreaRow">',l=0,l=1,l>0?(p=!0,l==1?notifications[r][0]=="task"?(e+='<td><img src="/images/red-dot.png" width="33" height="33" alt="" style="cursor:pointer;vertical-align:top;" /><\/td>',c=r):e+="<td><\/td>":e+=notifications[r][0]=="task"?'<td><img src="/images/red-dot.png" width="33" height="33" alt="" style="cursor:pointer;vertical-align:top;" /><\/td>':"<td><\/td>"):e+='   <td style="width:15px;"><\/td>',e+='   <td style="text-align:left;" class="bwHPNDrillDownLinkCell" onclick="expandHomePageNotificationAndRenderAlertsForAttachmentSearchDialog(\''+notifications[r][0]+"', '"+f+"', 'functionalAreaRowForAttachmentSearchDialog_"+f.toString()+"_"+r.toString()+"');\"><span>"+notifications[r][1]+"<\/span><\/td>",e+="<\/tr>",p==!0?a+=e:v+=e);o+=a+v;o+="<\/table>";s="";s+='<div id="BWFunctionalAreaDivForAttachmentSearchDialog'+f.toString()+'" style="cursor:pointer;" >';s+='<table id="BWFunctionalAreaForAttachmentSearchDialog'+f.toString()+'" style="vertical-align:top;width:100%;">';s+=o;s+="<\/table><br />";s+="<\/div>";$("#divHomePageAlertForAttachmentSearchDialog").html(s);c!=-1&&(b="functionalAreaRowForAttachmentSearchDialog_"+f.toString()+"_"+c.toString(),expandHomePageNotificationAndRenderAlertsForAttachmentSearchDialog("task",f,b));try{w=indexedDB.open(indexDBName,dbVersion);w.onerror=function(n){console.log('In ios8.js.renderAlertsForAttachmentSearchDialog(). Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};w.onsuccess=function(n){var r=n.target.result,i,t;try{i=r.transaction("objectStoreCachedRequests","readonly");t=i.objectStore("objectStoreCachedRequests").count()}catch(u){console.log("XXXXXXXXXXXerror: "+u.message)}t.onsuccess=function(n){var t;n.target.result==1?(t='<a href="javascript:cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit();" style="font-size:30pt;">You have '+n.target.result+" un-submitted request saved on this device.<\/a>",$("#divHomePageAlertForAttachmentSearchDialog").append(t)):n.target.result>1&&(t='<a href="javascript:cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit();" style="font-size:30pt;">You have '+n.target.result+" un-submitted requests saved on this device.<\/a>",$("#divHomePageAlertForAttachmentSearchDialog").append(t))};t.onerror=function(){console.error("In ios8.js.renderAlertsForAttachmentSearchDialog(). add error",this.error)}}}catch(k){console.log("In ios8.js.renderAlertsForAttachmentSearchDialog(). FAILED TO OPEN A TRANSACTION to the database..."+k.message+", "+k.stack)}},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderAlertsForAttachmentSearchDialog():1:"+t+", "+i+" I believe this happens when wifi goes down. SERVICE UNAVAILABLE ")}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderAlertsForAttachmentSearchDialog():2:"+t+", "+i)}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderAlertsForAttachmentSearchDialog():3:"+t+", "+i)}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderAlertsForAttachmentSearchDialog():4:"+t+", "+i+", "+JSON.stringify(n))}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.renderAlertsForAttachmentSearchDialog():5:"+t+", "+i+": Most likely service unavailable issue.")}})}}function expandHomePageNotificationAndRenderAlerts(n,t,i){var k,ft,u,wt,f,s,w,d,c,ct,e,o,r,lt,at;try{var vt=$("#"+i)[0].innerHTML,v="functionalAreaRow_"+t.toString()+"_Top_1",b="functionalAreaRow_"+t.toString()+"_Top_2",ut=document.getElementById(v),yt=document.getElementById(b),pt=document.getElementById(i);if(ut.style.visibility=="visible")try{for(s=0;s<1e3;s++)k="functionalAreaRow_"+t.toString()+"_"+s.toString(),ft=document.getElementById(k),ft.style.visibility="visible",$("#"+k).show()}catch(et){}for($("#"+v)[0].innerHTML=vt,ut.style.visibility="visible",$("#"+v).show(),$("#"+v).find(".bwFADrillDownLinkCell").css({"background-color":"white",color:"#444",cursor:"default"}),pt.style.visibility="hidden",$("#"+i).hide(),u="",wt=3,u+="<tr>",u+='    <td colspan="7">',u+="        <table>",s=0;s<notifications.length;s++)n==notifications[s][0]&&(f=s);if(n=="task")for(r=0;r<notifications[f][2].length;r++){var ii=notifications[f][2][r][0],g=appweburl,l=notifications[f][2][r][3],nt=notifications[f][2][r][11],a=notifications[f][2][r][7],h=notifications[f][2][r][11],y=notifications[f][2][r][8],ot=notifications[f][2][r][12],st=notifications[f][2][r][13],ht=notifications[f][2][r][14],p=0;p=y=="null"?Number(ot)+Number(st):y;w=0;try{var tt=notifications[f][2][r][6],bt=tt.split("-")[0],kt=tt.split("-")[1],dt=tt.split("-")[2].split("T")[0],it=new Date(Number(bt),Number(kt)-1,Number(dt)-1),rt=new Date,gt=Date.UTC(it.getFullYear(),it.getMonth(),it.getDate()),ni=Date.UTC(rt.getFullYear(),rt.getMonth(),rt.getDate());w=Math.floor((ni-gt)/864e5)}catch(et){}u+="   <tr>";u+='       <td style="width:10px;"><\/td>';u+='       <td style="width:10px;"><\/td>';d=notifications[f][2][r][9];c="";try{for(e=0;e<BWMData[0].length;e++)if(BWMData[0][e][0]=workflowAppId)for(o=0;o<BWMData[0][e][4].length;o++)d==BWMData[0][e][4][o][0]&&(c=BWMData[0][e][4][o][1])}catch(et){}ht=="RECURRING_EXPENSE_NOTIFICATION_TASK"?u+='            <td class="tdHomePageSubNotificationIos8" style="cursor:pointer;" colspan="5" onclick="displayRecurringExpenseOnTheHomePage(\''+l+"', '"+participantId+"', '"+h+'\');"><div style="display:inline-block;"><a style="cursor:pointer;" onclick="displayRecurringExpenseOnTheHomePage(\''+l+"', '"+participantId+"', '"+h+'\');" target="_blank" title="Click to view the recurring expense...">'+w.toString()+" days overdue: Recurring expense <em>("+a+" - "+c+") is due to be submitted<\/em><\/a><\/div><\/td>":ht=="BUDGET_REQUEST_WORKFLOW_TASK"?(ct=h.replace("-","&#8209;"),u+='            <td class="tdHomePageSubNotificationIos8" style="cursor:pointer;" colspan="5" onclick="$(\'.bwRequest\').bwRequest(\'displayArInMobileTab\', \''+g+"', '"+l+"', '"+nt+"', '"+encodeHtmlAttribute(a)+"', '"+h+'\');" title="Click to view the request '+h+'."><div style="display:inline-block;"><a style="cursor:pointer;" onclick="displayArInDialog(\''+g+"', '"+l+"', '"+nt+"', '"+a+"', '"+h+'\');" title="Click to view the request '+h+'.">'+w.toString()+" days overdue: "+a+" (<em>"+formatCurrency(p)+"<\/em>) - <em>"+c+" ("+ct+")<\/em><\/a><\/div><\/td>"):u+='            <td class="tdHomePageSubNotificationIos8" colspan="5">UNKNOWN TASK TYPE<\/td>';u+="        <\/tr>"}else if(n=="budget request")for(r=0;r<notifications[f][2].length;r++){var ti=notifications[f][2][r][3],y=notifications[f][2][r][4],d=notifications[f][2][r][5],c="";for(e=0;e<BWMData[0].length;e++)if(BWMData[0][e][0]=workflowAppId)for(o=0;o<BWMData[0][e][4].length;o++)d==BWMData[0][e][4][o][0]&&(c=BWMData[0][e][4][o][1]);var g=appweburl,l=notifications[f][2][r][0],nt=notifications[f][2][r][2],a=notifications[f][2][r][3],h=notifications[f][2][r][2],ot=notifications[f][2][r][11],st=notifications[f][2][r][12],p=0;p=y=="null"?Number(ot)+Number(st):y;u+="   <tr>";u+='       <td style="width:10px;"><\/td>';u+='       <td style="width:10px;"><\/td>';u+='            <td class="tdHomePageSubNotificationIos8" colspan="5"><a style="cursor:pointer;" onclick="$(\'.bwRequest\').bwRequest(\'displayArInMobileTab\', \''+g+"', '"+l+"', '"+nt+"', '"+encodeHtmlAttribute(a)+"', '"+h+'\');" target="_blank" title="Click to view the request '+h+'.">'+ti+" (<em>"+formatCurrency(p)+"<\/em>) - <em>"+c+"<\/em><\/a><\/td>";u+="        <\/tr>"}else for(r=0;r<notifications[f][2].length;r++)u+="        <tr>",u+='            <td style="width:90px;"><\/td>',u+="            <td>&nbsp;&nbsp;<\/td>",lt=notifications[f][2][r][0].indexOf("=")+1,at=notifications[f][2][r][0].substring(lt),u+='            <td colspan="5" class="tdHomePageSubNotificationIos8"><div id="tdUnclaimedInvitationLinkSwipeEnabled'+r+'"><a style="cursor:pointer;" onclick="cmdViewInvitation(\''+at+'\');" target="_blank" title="Send this link in an email to invite someone to participate in this workflow. You will be notified when they have confirmed their participation.">'+notifications[f][2][r][0]+"<\/a><\/div><\/td>",u+="        <\/tr>";u+="        <\/td>";u+="    <\/tr>";u+="<\/table>";u+="   <\/td>";u+="<\/tr>";$("#"+b)[0].innerHTML=u;yt.style.visibility="visible";$("#"+b).show()}catch(et){console.log("Exception in ios8.js.expandHomePageNotificationAndRenderAlerts() 2:"+et.message+" "+et.stack)}}function expandHomePageNotificationAndRenderAlertsForAttachmentSearchDialog(n,t,i){var k,rt,f,pt,u,s,w,d,c,e,o,r,ct,lt;try{var at=$("#"+i)[0].innerHTML,l="functionalAreaRowForAttachmentSearchDialog_"+t.toString()+"_Top_1",b="functionalAreaRowForAttachmentSearchDialog_"+t.toString()+"_Top_2",it=document.getElementById(l),vt=document.getElementById(b),yt=document.getElementById(i);if(it.style.visibility=="visible")try{for(s=0;s<1e3;s++)k="functionalAreaRowForAttachmentSearchDialog_"+t.toString()+"_"+s.toString(),rt=document.getElementById(k),rt.style.visibility="visible",$("#"+k).show()}catch(ut){}for($("#"+l)[0].innerHTML=at,it.style.visibility="visible",$("#"+l).show(),$("#"+l).find(".bwFADrillDownLinkCell").css({"background-color":"white",color:"#444",cursor:"default"}),yt.style.visibility="hidden",$("#"+i).hide(),f="",pt=3,f+="<tr>",f+='    <td colspan="7">',f+="        <table>",s=0;s<notifications.length;s++)n==notifications[s][0]&&(u=s);if(n=="task")for(r=0;r<notifications[u][2].length;r++){var ti=notifications[u][2][r][0],ft=appweburl,a=notifications[u][2][r][3],et=notifications[u][2][r][11],v=notifications[u][2][r][7],h=notifications[u][2][r][11],y=notifications[u][2][r][8],ot=notifications[u][2][r][12],st=notifications[u][2][r][13],ht=notifications[u][2][r][14],p=0;p=y=="null"?Number(ot)+Number(st):y;w=0;try{var g=notifications[u][2][r][6],wt=g.split("-")[0],bt=g.split("-")[1],kt=g.split("-")[2].split("T")[0],nt=new Date(Number(wt),Number(bt)-1,Number(kt)-1),tt=new Date,dt=Date.UTC(nt.getFullYear(),nt.getMonth(),nt.getDate()),gt=Date.UTC(tt.getFullYear(),tt.getMonth(),tt.getDate());w=Math.floor((gt-dt)/864e5)}catch(ut){}for(f+="   <tr>",f+='       <td style="width:10px;"><\/td>',f+='       <td style="width:10px;"><\/td>',d=notifications[u][2][r][9],c="",e=0;e<BWMData[0].length;e++)if(BWMData[0][e][0]=workflowAppId)for(o=0;o<BWMData[0][e][4].length;o++)d==BWMData[0][e][4][o][0]&&(c=BWMData[0][e][4][o][1]);f+=ht=="RECURRING_EXPENSE_NOTIFICATION_TASK"?'            <td class="tdHomePageSubNotificationIos8" style="cursor:pointer;" colspan="5" onclick="displayRecurringExpenseOnTheHomePage(\''+a+"', '"+participantId+"', '"+h+'\');"><div style="display:inline-block;"><a style="cursor:pointer;" onclick="displayRecurringExpenseOnTheHomePage(\''+a+"', '"+participantId+"', '"+h+'\');" target="_blank" title="Click to view the recurring expense...">'+w.toString()+" days overdue: Recurring expense <em>("+v+" - "+c+") is due to be submitted<\/em><\/a><\/div><\/td>":ht=="BUDGET_REQUEST_WORKFLOW_TASK"?'            <td class="tdHomePageSubNotificationIos8" colspan="5"><div style="display:inline-block;"><a style="cursor:pointer;" onclick="selectArForAttachmentSearchDialog(\''+ft+"', '"+a+"', '"+et+"', '"+v+"', '"+h+'\');" target="_blank" title="Click to view the request '+h+'.">'+w.toString()+" days overdue: "+v+" (<em>"+formatCurrency(p)+"<\/em>) - <em>"+c+"<\/em><\/a><\/div><\/td>":'            <td class="tdHomePageSubNotificationIos8" colspan="5">UNKNOWN TASK TYPE<\/td>';f+="        <\/tr>"}else if(n=="budget request")for(r=0;r<notifications[u][2].length;r++){var ni=notifications[u][2][r][3],y=notifications[u][2][r][4],d=notifications[u][2][r][5],c="";for(e=0;e<BWMData[0].length;e++)if(BWMData[0][e][0]=workflowAppId)for(o=0;o<BWMData[0][e][4].length;o++)d==BWMData[0][e][4][o][0]&&(c=BWMData[0][e][4][o][1]);var ft=appweburl,a=notifications[u][2][r][0],et=notifications[u][2][r][2],v=notifications[u][2][r][3],h=notifications[u][2][r][2],ot=notifications[u][2][r][11],st=notifications[u][2][r][12],p=0;p=y=="null"?Number(ot)+Number(st):y;f+="   <tr>";f+='       <td style="width:10px;"><\/td>';f+='       <td style="width:10px;"><\/td>';f+='            <td class="tdHomePageSubNotificationIos8" colspan="5"><a style="cursor:pointer;" onclick="selectArForAttachmentSearchDialog(\''+ft+"', '"+a+"', '"+et+"', '"+v+"', '"+h+'\');" target="_blank" title="Click to view the request '+h+'.">'+ni+" (<em>"+formatCurrency(p)+"<\/em>) - <em>"+c+"<\/em><\/a><\/td>";f+="        <\/tr>"}else for(r=0;r<notifications[u][2].length;r++)f+="        <tr>",f+='            <td style="width:90px;"><\/td>',f+="            <td>&nbsp;&nbsp;<\/td>",ct=notifications[u][2][r][0].indexOf("=")+1,lt=notifications[u][2][r][0].substring(ct),f+='            <td colspan="5" class="tdHomePageSubNotificationIos8"><div id="tdUnclaimedInvitationLinkSwipeEnabledForAttachmentSearchDialog'+r+'"><a style="cursor:pointer;" onclick="cmdViewInvitation(\''+lt+'\');" target="_blank" title="Send this link in an email to invite someone to participate in this workflow. You will be notified when they have confirmed their participation.">'+notifications[u][2][r][0]+"<\/a><\/div><\/td>",f+="        <\/tr>";f+="        <\/td>";f+="    <\/tr>";f+="<\/table>";f+="   <\/td>";f+="<\/tr>";$("#"+b)[0].innerHTML=f;vt.style.visibility="visible";$("#"+b).show()}catch(ut){displayAlertDialog("Error in ios8.js.expandHomePageNotificationAndRenderAlertsForAttachmentSearchDialog() 2:"+ut.message+" "+ut.stack+" This is not necessarily a service unavailable error but we dont want to bother the user!!")}}function swipedetect(n,t){displayAlertDialog("swipedetect");var f=n,i,e,o,r,u,s=150,h=100,a=300,c,l,v=t||function(){};f.addEventListener("touchstart",function(n){var t=n.changedTouches[0];i="none";dist=0;e=t.pageX;o=t.pageY;l=(new Date).getTime();n.preventDefault()},!1);f.addEventListener("touchmove",function(n){n.preventDefault()},!1);f.addEventListener("touchend",function(n){var t=n.changedTouches[0];r=t.pageX-e;u=t.pageY-o;c=(new Date).getTime()-l;c<=a&&(Math.abs(r)>=s&&Math.abs(u)<=h?i=r<0?"left":"right":Math.abs(u)>=s&&Math.abs(r)<=h&&(i=u<0?"up":"down"));v(i);n.preventDefault()},!1)}function renderTenantOwnerStuff(){}function cmdAcceptInvitation(n,t,i,r,u){try{var f={participantId:participantId,bwInvitationId:n,bwTenantId:t,bwWorkflowAppId:i,bwWorkflowAppTitle:r,bwInvitationParticipantRole:u,bwParticipantLogonType:participantLogonType};$.ajax({url:webserviceurl+"/participants/acceptinvitation",type:"PUT",contentType:"application/json",data:JSON.stringify(f),success:function(n){try{n.message=="SUCCESS"?(invitationAlreadyAccepted=!0,renderWelcomeScreen()):displayAlertDialog(n.message)}catch(t){displayAlertDialog("Error in ios8.js.cmdAcceptInvitation():1:"+t.message)}},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdAcceptInvitation():"+t+", "+i+"::"+JSON.stringify(n))}})}catch(e){displayAlertDialog("Error in ios8.js.cmdAcceptInvitation():2:"+e.message)}}function cmdDisplayToDoList(){tipToggle=tipToggle==!1?!0:!1;tipsInitialized==!0?($("#btnInviteNewParticipant1").qtip("toggle",tipToggle),$("#divWelcomePageLeftButtonsConfigurationButton").qtip("toggle",tipToggle),$("#divWelcomePageLeftButtonsNewRequestButton").qtip("toggle",tipToggle)):($("#btnInviteNewParticipant1").qtip({content:{text:"Step 1: Email the invitation link to your participants."},position:{at:"bottom center"},style:{classes:"bwQtip",width:"900",height:"66"}}),$("#divWelcomePageLeftButtonsConfigurationButton").qtip({content:{text:'<span style="font-size:50pt;width:100%;"><b>Step 2:<\/b> Go to the Configuration section to configure Financial Areas, specifying the participants.<\/span>'},position:{at:"bottom center"},style:{classes:"bwQtip",tip:{corner:"bottom center",mimic:"bottom left",border:1,width:900,height:66}}}),$("#divWelcomePageLeftButtonsNewRequestButton").qtip({content:{text:'<span style="font-size:50px;width:100%;"><b>Step 3:<\/b> Create a new Budget Request. The choice of Financial Area determines who participates in the approval of this budget request!<\/span>'},position:{at:"right bottom"},style:{classes:"bwQtip",tip:{corner:"bottom center",mimic:"bottom left",border:1,width:900,height:66}}}),tipsInitialized=!0,$("#btnInviteNewParticipant1").qtip("toggle",tipToggle),$("#divWelcomePageLeftButtonsConfigurationButton").qtip("toggle",tipToggle),$("#divWelcomePageLeftButtonsNewRequestButton").qtip("toggle",tipToggle),tipToggle=!0)}function cmdDisplayLoggedInUserDetailsInDropDown(){$("#spanLoggedInUserDropDownDialogTitle").html(participantFriendlyName);$("#bwLoggedInUserDropDown").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"970px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#bwLoggedInUserDropDown").dialog("close")})}});$("#bwLoggedInUserDropDown").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}function hideLoggedInUserDropDown(){if(hideLoggedInUserDropDownFirstClickTracker==!1)hideLoggedInUserDropDownFirstClickTracker=!0;else{$("#bwLoggedInUserDropDown").dialog("close");var n=document.getElementById("divDocumentBody");n.removeAttribute("click")}}function displayArOnTheHomePage(n,t,i){var u,r,f;try{$("#ArDialog").dialog("close")}catch(e){}try{r="";r+='<span id="welcomePageMyTasksTabSpanTag1" ';r+="  onmouseover=\"this.style.cursor='pointer';this.style.textDecoration='underline';var taskTabContent = document.getElementById('welcomePageMyTasksTabSpanTag1').innerHTML;document.getElementById('welcomePageMyTasksTabSpanTag1').innerHTML = '<< Tasks (6)*';\" ";r+="  onmouseout=\"this.style.textDecoration='none';document.getElementById('welcomePageMyTasksTabSpanTag1').innerHTML = taskTabContent;\" ";r+='  onclick="redirectForm();" ';r+=">";r+=i+' <span style="color:red;font-weight:bold;">';r+=" (6*)<\/span>";r+="<\/span>";document.getElementById("welcomePageMyTasksTabTitle").innerHTML=r;$("#welcomePageTabs").tabs("option","active",1);$("#bwQuickLaunchMenuTd").css({width:"0"});$("#liWelcome").show();$("#liOfflineWelcome").hide();$("#liNewRequest").hide();$("#liArchive").hide();$("#liSummaryReport").hide();$("#liConfiguration").hide();$("#liHelp").hide();$("#liOfflineRequestForm").hide();u=document.getElementById("divNewRequestMasterDiv");u.style.borderRadius="120px 0 0 120px";$("#divWelcomeMasterDivTitle").text("Authorization Request: "+i);try{document.getElementById("divWelcomePageLeftButtonsWelcomeButton").className="divLeftButtonIos8"}catch(e){}$("#divWelcomePageLeftButtonsWelcomeButton").off("click").click(function(){redirectForm()});r='<div id="myxml" align="left" style="FONT-SIZE: 10pt; FONT-FAMILY: Calibri;"><\/div>';$("#welcomePageMyTasksTab").html(r);f="";filename=n;displayForm_DisplayArBasedOnWorkflowStatus2(n,f,t)}catch(e){displayAlertDialog("Error in ios8.js.displayArOnTheHomePage(): "+e.message)}}function displayRecurringExpenseOnTheHomePage(n,t){var i,r,u;try{$("#bwQuickLaunchMenuTd").css({width:"0"});$("#liWelcome").show();$("#liOfflineWelcome").hide();$("#liNewRequest").hide();$("#liArchive").hide();$("#liSummaryReport").hide();$("#liConfiguration").hide();$("#liHelp").hide();$("#liOfflineRequestForm").hide();i=document.getElementById("divNewRequestMasterDiv");i.style.borderRadius="120px 0 0 120px";$("#divWelcomeMasterDivTitle").text("Recurring Expense: New Budget Request");document.getElementById("divWelcomePageLeftButtonsWelcomeButton").className="divLeftButtonIos8";$("#divWelcomePageLeftButtonsWelcomeButton").off("click").click(function(){redirectForm()});r='<div id="myxml" align="left" style="FONT-SIZE: 10pt; FONT-FAMILY: Calibri;"><\/div>';$("#welcomePageMyTasksTab").html(r);u="";document.getElementById("divWelcomePageLeftButtonsNewRequestButton").className="divLeftButtonSelected";displayForm_DisplayRecurringExpense(n,u,t)}catch(f){displayAlertDialog("Error in ios8.js.displayRecurringExpenseOnTheHomePage(): "+f.message)}}function hookUpThePeoplePickers(){$("#txtApprover1FriendlyName").autocomplete({source:function(n,t){$.ajax({url:webserviceurl+"/tenant/"+tenantId+"/participants/"+n.term,dataType:"json",success:function(n){for(var r=[],i=0;i<n.participants.length;i++)r[i]=n.participants[i].participant;t(r)}})},minLength:1,select:function(){},open:function(){},close:function(){var n=this.value.split("|")[0],i=this.value.split("|")[1],t=this.value.split("|")[2];n.indexOf("undefined")>-1?(document.getElementById("txtApprover1FriendlyName").value="",document.getElementById("txtApprover1Id").value="",document.getElementById("txtApprover1Email").value=""):(document.getElementById("txtApprover1FriendlyName").value=n,document.getElementById("txtApprover1FriendlyName").setAttribute("title",t),document.getElementById("txtApprover1Id").value=i,document.getElementById("txtApprover1Email").value=t)}});$("#txtApprover2FriendlyName").autocomplete({source:function(n,t){$.ajax({url:webserviceurl+"/tenant/"+tenantId+"/participants/"+n.term,dataType:"json",success:function(n){for(var r=[],i=0;i<n.participants.length;i++)r[i]=n.participants[i].participant;t(r)}})},minLength:1,select:function(){},open:function(){},close:function(){var n=this.value.split("|")[0],i=this.value.split("|")[1],t=this.value.split("|")[2];n.indexOf("undefined")>-1?(document.getElementById("txtApprover2FriendlyName").value="",document.getElementById("txtApprover2Id").value="",document.getElementById("txtApprover2Email").value=""):(document.getElementById("txtApprover2FriendlyName").value=n,document.getElementById("txtApprover2FriendlyName").setAttribute("title",t),document.getElementById("txtApprover2Id").value=i,document.getElementById("txtApprover2Email").value=t)}})}function populateTheYearDropdown(n){var f,u,t;try{var i=BWMData[1][0],r=BWMData[1][1],e=(new Date).getFullYear(),o=$("#ddlYear").val();if($("#ddlYear").empty(),o==null){if(n==!1)if(i.indexOf(e)>-1)for(t=0;t<i.length;t++)i[t]==e?$("<option value='"+i[t].toString()+"' selected>"+i[t].toString()+"<\/option>").appendTo($("#ddlYear")):$("<option value='"+i[t].toString()+"'>"+i[t].toString()+"<\/option>").appendTo($("#ddlYear"));else{for(f=null,u=0;u<i.length;u++)i[u]<e&&(f=i[u]);for(t=0;t<i.length;t++)i[t]==f?$("<option value='"+i[t].toString()+"' selected>"+i[t].toString()+"<\/option>").appendTo($("#ddlYear")):$("<option value='"+i[t].toString()+"'>"+i[t].toString()+"<\/option>").appendTo($("#ddlYear"))}else if(n==!0)if(r.indexOf(e)>-1)for(t=0;t<r.length;t++)r[t]==e?$("<option value='"+r[t].toString()+"' selected>"+r[t].toString()+"<\/option>").appendTo($("#ddlYear")):$("<option value='"+r[t].toString()+"'>"+r[t].toString()+"<\/option>").appendTo($("#ddlYear"));else{for(f=null,u=0;u<r.length;u++)r[u]<e&&(f=r[u]);for(t=0;t<r.length;t++)r[t]==f?$("<option value='"+r[t].toString()+"' selected>"+r[t].toString()+"<\/option>").appendTo($("#ddlYear")):$("<option value='"+r[t].toString()+"'>"+r[t].toString()+"<\/option>").appendTo($("#ddlYear"))}}else if(n==!1)if(i.indexOf(o)>-1)for(t=0;t<i.length;t++)i[t]==o?$("<option value='"+i[t].toString()+"' selected>"+i[t].toString()+"<\/option>").appendTo($("#ddlYear")):$("<option value='"+i[t].toString()+"'>"+i[t].toString()+"<\/option>").appendTo($("#ddlYear"));else{for(f=null,u=0;u<i.length;u++)i[u]<e&&(f=i[u]);for(t=0;t<i.length;t++)i[t]==f?$("<option value='"+i[t].toString()+"' selected>"+i[t].toString()+"<\/option>").appendTo($("#ddlYear")):$("<option value='"+i[t].toString()+"'>"+i[t].toString()+"<\/option>").appendTo($("#ddlYear"))}else if(n==!0)if(r.indexOf(o)>-1)for(t=0;t<r.length;t++)r[t]==o?$("<option value='"+r[t].toString()+"' selected>"+r[t].toString()+"<\/option>").appendTo($("#ddlYear")):$("<option value='"+r[t].toString()+"'>"+r[t].toString()+"<\/option>").appendTo($("#ddlYear"));else{for(f=null,u=0;u<r.length;u++)r[u]<e&&(f=r[u]);for(t=0;t<r.length;t++)r[t]==o?$("<option value='"+r[t].toString()+"' selected>"+r[t].toString()+"<\/option>").appendTo($("#ddlYear")):$("<option value='"+r[t].toString()+"'>"+r[t].toString()+"<\/option>").appendTo($("#ddlYear"))}}catch(s){displayAlertDialog("Error in Start.js.populateTheYearDropdown()",s.message)}}function cmdCreateNewBudgetRequest(){var n=appweburl2+"/InitBudgetRequest.html";window.location=n}function cmdListAllWorkflowTasks(){$("#spanBwWorkflowTasks").empty();var n={bwTenantId:tenantId,bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwtasks",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var t="",i;for(t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td>task title<\/td>",t+="    <td>created<\/td>",t+="    <td>due date<\/td>",t+="    <td>task outcome<\/td>",t+="    <td>percent complete<\/td>",t+="    <td>hasbeenprocessedbytheworkflowengine<\/td>",t+="    <td>assigned to id<\/td>",t+="    <td>assigned to<\/td>",t+="    <td>assigned to email<\/td>",t+="    <td>workflow app id<\/td>",t+="    <td>related item id<\/td>",t+="  <\/tr>",i=0;i<n.length;i++)t+="  <tr>",t+='    <td><a class="aDisplayArLink" href="javascript:displayArOnTheHomePage(\''+n[i].bwRelatedItemId+"', '"+participantId+"', 'x2x2x2');\">"+n[i].bwTaskTitle+"<\/a><\/td>",t+="    <td>"+n[i].Created+"<\/td>",t+="    <td>"+n[i].bwDueDate+"<\/td>",t+="    <td>"+n[i].bwTaskOutcome+"<\/td>",t+="    <td>"+n[i].bwPercentComplete+"<\/td>",t+="    <td>"+n[i].bwHasBeenProcessedByTheWorkflowEngine+"<\/td>",t+="    <td>"+n[i].bwAssignedToId+"<\/td>",t+="    <td>"+n[i].bwAssignedToFriendlyName+"<\/td>",t+="    <td>"+n[i].bwAssignedToEmail+"<\/td>",t+="    <td>"+n[i].bwWorkflowAppId+"<\/td>",t+="    <td>"+n[i].bwRelatedItemId+"<\/td>",t+="  <\/tr>";t+='<tr><td colspan="10">DONE<\/td><\/tr>';t+="<\/table>";$("#spanBwWorkflowTasks").append(t)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllWorkflowTasks():"+t+", "+i)}})}function cmdListAllParticipants(){$("#spanBwParticipants").empty();var n={bwTenantId:tenantId,bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwparticipants",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var t="",i;for(t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td>friendly name of participant<\/td>",t+="    <td>role<\/td>",t+="    <td>email<\/td>",t+="    <td>participant id<\/td>",t+="    <td>tenant id<\/td>",t+="  <\/tr>",i=0;i<n.length;i++)t+="  <tr>",t+="    <td>"+n[i].bwParticipantFriendlyName+"<\/td>",t+="    <td>"+n[i].bwParticipantRole+"<\/td>",t+="    <td>"+n[i].bwParticipantEmail+"<\/td>",t+="    <td>"+n[i].bwParticipantId+"<\/td>",t+="    <td>"+n[i].bwTenantId+"<\/td>",t+="  <\/tr>";t+='<tr><td colspan="4">DONE<\/td><\/tr>';t+="<\/table>";$("#spanBwParticipants").append(t)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllParticipants():"+t+", "+i)}})}function cmdListAllInvitations(){$("#spanBwInvitations").empty();var n={bwTenantId:tenantId,bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwinvitationsunclaimed",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var t="",i;for(t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td>role<\/td>",t+="    <td>created by<\/td>",t+="    <td>created<\/td>",t+="    <td>delivered to<\/td>",t+="    <td>delivered<\/td>",t+="    <td>accepted by<\/td>",t+="    <td>accepted<\/td>",t+="    <td>tenant id<\/td>",t+="    <td>workflow app id<\/td>",t+="  <\/tr>",i=0;i<n.length;i++)t+="  <tr>",t+="    <td>"+n[i].bwInvitationParticipantRole+"<\/td>",t+="    <td>"+n[i].bwInvitationCreatedByFriendlyName+"<\/td>",t+="    <td>"+n[i].bwInvitationCreatedTimestamp+"<\/td>",t+="    <td>"+n[i].bwInvitationDeliveredToEmail+"<\/td>",t+="    <td>"+n[i].bwInvitationDeliveredTimestamp+"<\/td>",t+="    <td>"+n[i].bwInvitationAcceptedById+"<\/td>",t+="    <td>"+n[i].bwInvitationAcceptedTimestamp+"<\/td>",t+="    <td>"+n[i].bwTenantId+"<\/td>",t+="    <td>"+n[i].bwWorkflowAppId+"<\/td>",t+="  <\/tr>";t+='<tr><td colspan="5">DONE<\/td><\/tr>';t+="<\/table>";$("#spanBwInvitations").append(t)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllInvitations():"+t+", "+i)}})}function cmdListAllTenants(){$("#spanBwTenants").empty();var n={bwTenantId:tenantId,bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwtenants",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var t="",i;for(t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td>tenant title<\/td>",t+="    <td>owner id<\/td>",t+="    <td>owner name<\/td>",t+="    <td>owner email<\/td>",t+="    <td>tenant id<\/td>",t+="  <\/tr>",i=0;i<n.length;i++)t+="  <tr>",t+="    <td>"+n[i].bwTenantTitle+"<\/td>",t+="    <td>"+n[i].bwTenantOwnerId+"<\/td>",t+="    <td>"+n[i].bwTenantOwnerFriendlyName+"<\/td>",t+="    <td>"+n[i].bwTenantOwnerEmail+"<\/td>",t+="    <td>"+n[i].bwTenantId+"<\/td>",t+="  <\/tr>";t+='<tr><td colspan="4">DONE<\/td><\/tr>';t+="<\/table>";$("#spanBwTenants").append(t)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllTenants():"+t+", "+i)}})}function cmdListAllWorkflowApps(){$("#spanBwWorkflowApps").empty();$.ajax({url:webserviceurl+"/bwworkflowapps/"+tenantId,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var t="",i;for(t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td>title<\/td>",t+="    <td>workflow app id<\/td>",t+="  <\/tr>",i=0;i<n.d.results.length;i++)t+="  <tr>",t+="    <td>"+n.d.results[i].bwWorkflowAppTitle+"<\/td>",t+="    <td>"+n.d.results[i].bwWorkflowAppId+"<\/td>",t+="  <\/tr>";t+='<tr><td colspan="4">DONE<\/td><\/tr>';t+="<\/table>";$("#spanBwWorkflowApps").append(t)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllWorkflowApps():"+t+", "+i)}})}function cmdListAllFunctionalAreas(){$("#spanBwFunctionalAreas").empty();$.ajax({url:webserviceurl+"/getfunctionalareasbyappid/"+workflowAppId+"/RETURNALL",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var t="",i;for(t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td><\/td>",t+="    <td>year<\/td>",t+="    <td>yearly budget<\/td>",t+="    <td>id<\/td>",t+="    <td>workflow app id<\/td>",t+="    <td>Approver1Id<\/td>",t+="    <td>Approver2Id<\/td>",t+="    <td>Approver3Id<\/td>",t+="    <td>Approver4Id<\/td>",t+="    <td>Approver5Id<\/td>",t+="    <td>Approver6Id<\/td>",t+="    <td>Approver7Id<\/td>",t+="    <td>Approver8Id<\/td>",t+="    <td>Approver9Id<\/td>",t+="    <td>Approver10Id<\/td>",t+="  <\/tr>",i=0;i<n.d.results.length;i++)t+="  <tr>",t+='    <td style="white-space:nowrap;">financial area: '+n.d.results[i].bwFunctionalAreaTitle+"<\/td>",t+="    <td>"+n.d.results[i].bwFunctionalAreaYear+"<\/td>",t+="    <td>"+n.d.results[i].bwFunctionalAreaYearlyBudget+"<\/td>",t+="    <td>"+n.d.results[i].bwFunctionalAreaId+"<\/td>",t+="    <td>"+n.d.results[i].bwWorkflowAppId+"<\/td>",t+="    <td>"+n.d.results[i].Approver1Id+"<\/td>",t+="    <td>"+n.d.results[i].Approver2Id+"<\/td>",t+="    <td>"+n.d.results[i].Approver3Id+"<\/td>",t+="    <td>"+n.d.results[i].Approver4Id+"<\/td>",t+="    <td>"+n.d.results[i].Approver5Id+"<\/td>",t+="    <td>"+n.d.results[i].Approver6Id+"<\/td>",t+="    <td>"+n.d.results[i].Approver7Id+"<\/td>",t+="    <td>"+n.d.results[i].Approver8Id+"<\/td>",t+="    <td>"+n.d.results[i].Approver9Id+"<\/td>",t+="    <td>"+n.d.results[i].Approver10Id+"<\/td>",t+="  <\/tr>",t+="  <tr>",t+="    <td>budget thresholds:<\/td>",t+="    <td><\/td>",t+="    <td><\/td>",t+="    <td><\/td>",t+="    <td><\/td>",t+="    <td><\/td>",t+="    <td><\/td>",t+="    <td>"+n.d.results[i].Approval3BudgetThreshold+"<\/td>",t+="    <td>"+n.d.results[i].Approval4BudgetThreshold+"<\/td>",t+="    <td>"+n.d.results[i].Approval5BudgetThreshold+"<\/td>",t+="    <td>"+n.d.results[i].Approval6BudgetThreshold+"<\/td>",t+="    <td>"+n.d.results[i].Approval7BudgetThreshold+"<\/td>",t+="    <td>"+n.d.results[i].Approval8BudgetThreshold+"<\/td>",t+="    <td>"+n.d.results[i].Approval9BudgetThreshold+"<\/td>",t+="    <td>"+n.d.results[i].Approval10BudgetThreshold+"<\/td>",t+="  <\/tr>",t+="  <tr>",t+='    <td colspan="15"><\/td>',t+="  <\/tr>";t+='<tr><td colspan="4">DONE<\/td><\/tr>';t+="<\/table>";$("#spanBwFunctionalAreas").append(t)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllFunctionalAreas():"+t+", "+i)}})}function cmdListAllDepartments(){$("#spanBwDepartments").empty();var n={bwTenantId:tenantId,bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwdepartments",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var t="",i;for(t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td>department title<\/td>",t+="    <td>user name<\/td>",t+="    <td>user id<\/td>",t+="  <\/tr>",i=0;i<n.length;i++)t+="  <tr>",t+="    <td>"+n[i].bwDepartmentTitle+"<\/td>",t+="    <td>"+n[i].bwDepartmentUserName+"<\/td>",t+="    <td>"+n[i].bwDepartmentUserId+"<\/td>",t+="  <\/tr>";t+='<tr><td colspan="4">DONE<\/td><\/tr>';t+="<\/table>";$("#spanBwDepartments").append(t)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllDepartments():"+t+", "+i)}})}function cmdDisplayConfirmFileUploadOfflineDialog(n,t,i){try{console.log("In ios8.js.cmdDisplayConfirmFileUploadOfflineDialog("+n+", "+t+", "+i+").");document.getElementById("txtConfirmFileUploadOfflineDialogFilename").value="";$("#txtConfirmFileUploadOfflineDialogFileDescription").empty();$("#divConfirmFileUploadOfflineDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"",width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divConfirmFileUploadOfflineDialog").dialog("close")})}});$("#divConfirmFileUploadOfflineDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("spanConfirmFileUploadOfflineDialogUploadTheFileNowButton").innerHTML='<button title="Click here to upload the attachment." class="BwButton" onclick="ProcessOfflineUpload(\''+n+"', '"+t+"', '"+i+"');\">Upload<\/button>";document.getElementById("spanConfirmFileUploadOfflineDialogCancelButton").innerHTML='<button title="" class="BwButton" onclick="$(\'#divConfirmFileUploadOfflineDialog\').dialog(\'close\');">Cancel<\/button>'}catch(r){console.log("Error in ios8.js.cmdDisplayConfirmFileUploadOfflineDialog("+n+", "+t+", "+i+"): "+r.message+", "+r.stack);displayAlertDialog("Error in ios8.js.cmdDisplayConfirmFileUploadOfflineDialog("+n+", "+t+", "+i+"): "+r.message+", "+r.stack)}}function populateOfflineAttachments(n){try{console.log("In ios8.js.populateOfflineAttachments("+n+"). Rendering the list of files.");$("#"+n).empty();var i=indexedDB.open(indexDBName,dbVersion);i.onblocked=function(t){console.log("In ios8.js.populateOfflineAttachments("+n+"): indexDB BLOCKED1. errorCode: "+t.target.errorCode);displayAlertDialog("In ios8.js.populateOfflineAttachments("+n+"): indexDB BLOCKED1. errorCode: "+t.target.errorCode)};i.onerror=function(t){console.log("In ios8.js.populateOfflineAttachments("+n+'): Error accessing database "'+t.target.result.name+'". errorCode: '+t.target.errorCode);displayAlertDialog("In ios8.js.populateOfflineAttachments("+n+'): Error accessing database "'+t.target.result.name+'". errorCode: '+t.target.errorCode)};i.onsuccess=function(t){var i,u,r;console.log("In ios8.js.populateOfflineAttachments("+n+'): Success accessing database "'+t.target.result.name+'".');i=t.target.result;i.onerror=function(t){console.log("In ios8.js.populateOfflineAttachments("+n+'). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+t.target.result.name+'". errorCode: '+t.target.errorCode);displayAlertDialog("In ios8.js.populateOfflineAttachments("+n+'). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+t.target.result.name+'". errorCode: '+t.target.errorCode)};u=i.transaction("OfflineAttachedFiles","readonly");r=u.objectStore("OfflineAttachedFiles").count();r.onsuccess=function(t){var u,e,f;try{t.target.result==0?$("#"+n)[0].innerHTML="<i>no attachments found<\/i>":(console.log("In populateOfflineAttachments("+n+"). Found "+t.target.result+" files on my device."),u="",u+="<br /><br />",e=t.target.result,f=i.transaction("OfflineAttachedFiles").objectStore("OfflineAttachedFiles"),f.openCursor().onsuccess=function(t){var u,e,l,a,v,w,f,b,h,g,o;try{if(u=t.target.result,u){try{e=document.getElementById("OfflineRequestBudgetRequestIdInXslForm").innerHTML}catch(c){e=document.getElementById("OfflineRequestBudgetRequestId").innerHTML}if(console.log("In populateOfflineAttachments("+n+"): _budgetRequestId: "+e+", cursor.value.bwBudgetRequestId: "+u.value.bwBudgetRequestId),e==u.value.bwBudgetRequestId){console.log("In populateOfflineAttachments("+n+"). Rendering list of attachments for _budgetRequestId: "+e);var i=u.value.fileName,s=u.value.fileDescription,e=u.value.bwBudgetRequestId;if(console.log("In populateOfflineAttachments("+n+"): _budgetRequestId == cursor.value.bwBudgetRequestId"),navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i))if(u.value.encodingType=="uInt8Array")i.toUpperCase().indexOf(".JPG")!=-1||i.toUpperCase().indexOf(".JPEG")?f="image/jpeg":i.toUpperCase().indexOf(".PNG")!=-1?f="image/png":i.toUpperCase().indexOf(".BMP")!=-1?f="image/bmp":i.toUpperCase().indexOf(".GIF")!=-1?f="image/gif":i.toUpperCase().indexOf(".TIFF")!=-1&&(f="image/tiff"),l=new Blob([u.value.fileContents],{type:f});else{for(a=atob(u.value.fileContents),v=new Uint8Array(a.length),o=0,w=a.length;o<w;++o)v[o]=a.charCodeAt(o);i.toUpperCase().indexOf(".JPG")!=-1||i.toUpperCase().indexOf(".JPEG")?f="image/jpeg":i.toUpperCase().indexOf(".PNG")!=-1?f="image/png":i.toUpperCase().indexOf(".BMP")!=-1?f="image/bmp":i.toUpperCase().indexOf(".GIF")!=-1?f="image/gif":i.toUpperCase().indexOf(".TIFF")!=-1&&(f="image/tiff");l=new Blob([v.buffer],{type:f})}else l=u.value.fileContents;b=window.URL||window.webkitURL;h=b.createObjectURL(l);console.log("In populateOfflineAttachments("+n+"): Got fileUrl: "+h);var y=800,p=600,k=(screen.width-y)/2,d=(screen.height-p)/2,r="";r+='<table style="width:100%;">';r+="  <tr>";r+='    <td style="width:10%;">';(i.toLowerCase().indexOf(".png")>-1||i.toLowerCase().indexOf(".jpg")>-1||i.toLowerCase().indexOf(".jpeg")>-1)&&(r+='<img src="'+h+'" style="height:120px;display:block;margin-left:auto;margin-right:auto;cursor:pointer;" alt="" ',r+=Platform=="IOS8"?"onclick=\"displayAttachmentInDialogOffline2('"+i+"', '"+s+"', '"+e+"', '"+n+"');\"":"onclick=\"window.open('"+h+"', 'window1', 'width="+y+", height="+p+", top="+d+", left="+k+", resizable=yes');return false;\"",r+=" />");r+="    <\/td>";r+='    <td style="width:90%;">';r+=Platform=="IOS8"?'<div class="attachmentsSectionFileLink" onclick="displayAttachmentInDialogOffline2(\''+i+"', '"+s+"', '"+e+"', '"+n+"');\">":'<div class="attachmentsSectionFileLink" onclick="window.open(\''+h+"', 'window1', 'width="+y+", height="+p+", top="+d+", left="+k+", resizable=yes');return false;\">";r+=i;r+=s.length>0?'&nbsp;&nbsp;<span class="attachmentsSectionDescription"> - "'+s+'"<\/span>':'&nbsp;&nbsp;<span class="attachmentsSectionDescription"> - [no description]'+s+"<\/span>";g="xx";o=0;r+="<\/div>";r+="    <\/td>";r+="  <\/tr>";r+="<\/table>";r+="<\/br>";console.log("In ios8.js.populateOfflineAttachments("+n+"). Preparing to render in attachmentsTagId "+n);$("#"+n).append(r);console.log("In ios8.js.populateOfflineAttachments("+n+"). After rendering in attachmentsTagId "+n);try{$("#divFileUploadSpinnerDialog").dialog("close")}catch(c){}}u.continue()}}catch(c){console.log("Exception in ios8.js.populateOfflineAttachments("+n+"):8: "+c.message+", "+c.stack);displayAlertDialog("Exception in ios8.js.populateOfflineAttachments("+n+"):8: "+c.message+", "+c.stack)}})}catch(r){console.log("Exception in ios8.js.populateOfflineAttachments("+n+"):9: "+r.message+", "+r.stack);displayAlertDialog("Exception in ios8.js.populateOfflineAttachments("+n+"):9: "+r.message+", "+r.stack)}};r.onerror=function(){console.error("In ios8.js.populateOfflineAttachments("+n+").req.onerror: add error",this.error);console.log("In ios8.js.populateOfflineAttachments("+n+").req.onerror:10: "+this.error);displayAlertDialog("In ios8.js.populateOfflineAttachments("+n+").req.onerror:10: "+this.error)}}}catch(t){console.log("Exception in ios8.js.populateOfflineAttachments("+n+"): "+t.message+", "+t.stack);displayAlertDialog("Exception in ios8.js.populateOfflineAttachments("+n+"): "+t.message+", "+t.stack)}}function displayAttachmentInDialogOffline2(n,t,i,r){try{if(console.log("In ios8.js.displayAttachmentInDialogOffline2("+n+", "+t+", "+i+")."),!(n.toLowerCase().indexOf(".txt")>-1))if(n.toLowerCase().indexOf(".jpg")>-1||n.toLowerCase().indexOf(".jpeg")>-1||n.toLowerCase().indexOf(".png")>-1||n.toLowerCase().indexOf(".bmp")>-1||n.toLowerCase().indexOf(".gif")>-1||n.toLowerCase().indexOf(".tiff")>-1||n.toLowerCase().indexOf(".svg")>-1||n.toLowerCase().indexOf(".pdf")>-1||n.toLowerCase().indexOf(".rtf")>-1||n.toLowerCase().indexOf(".doc")>-1||n.toLowerCase().indexOf(".docx")>-1||n.toLowerCase().indexOf(".xsl")>-1||n.toLowerCase().indexOf(".xslx")>-1||n.toLowerCase().indexOf(".odt")>-1||n.toLowerCase().indexOf(".ods")>-1||n.toLowerCase().indexOf(".odp")>-1||n.toLowerCase().indexOf(".mp3")>-1||n.toLowerCase().indexOf(".mp4")>-1||n.toLowerCase().indexOf(".m4a")>-1||n.toLowerCase().indexOf(".m4r")>-1||n.toLowerCase().indexOf(".m4v")>-1||n.toLowerCase().indexOf(".avi")>-1||n.toLowerCase().indexOf(".mov")>-1){console.log("Display the image: "+n);var f=indexedDB.open(indexDBName,dbVersion);f.onblocked=function(n){console.log("In ios8.js.displayAttachmentInDialogOffline2(): indexDB BLOCKED1. errorCode: "+n.target.errorCode);displayAlertDialog("In ios8.js.displayAttachmentInDialogOffline2(): indexDB BLOCKED1. errorCode: "+n.target.errorCode)};f.onerror=function(n){console.log('In ios8.js.displayAttachmentInDialogOffline2(): Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);displayAlertDialog('In ios8.js.displayAttachmentInDialogOffline2(): Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};f.onsuccess=function(t){var i,u;console.log('In ios8.js.displayAttachmentInDialogOffline2(): Success accessing database "'+t.target.result.name+'".');i=t.target.result;i.onerror=function(n){console.log('In ios8.js.displayAttachmentInDialogOffline2(): DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);displayAlertDialog('In ios8.js.displayAttachmentInDialogOffline2(): DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};u=i.transaction("OfflineAttachedFiles").objectStore("OfflineAttachedFiles");u.openCursor().onsuccess=function(t){var e,c,l,f,u;try{if(e=t.target.result,e){var i=e.value.fileName,v=e.value.fileDescription,s=e.value.bwBudgetRequestId,h=s;if(console.log("In ios8.js.displayAttachmentInDialogOffline2(): _budgetRequestId: "+s+", cursor.value.bwBudgetRequestId: "+e.value.bwBudgetRequestId),s==e.value.bwBudgetRequestId&&n==e.value.fileName){if(console.log("In ios8.js.displayAttachmentInDialogOffline2(): _budgetRequestId == cursor.value.bwBudgetRequestId"),c=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)?new Blob([e.value.fileContents],{type:"image/jpeg"}):e.value.fileContents,l=window.URL||window.webkitURL,f=l.createObjectURL(c),console.log("In displayAttachmentInDialogOffline()2: Got fileUrl2: "+f),$("#divAttachmentsOfflineDialogContents").empty(),$("#divAttachmentsOfflineDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divAttachmentsOfflineDialog").dialog("close")})}}),$("#divAttachmentsOfflineDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),console.log("In ios8.js.displayAttachmentInDialogOffline2(): fileUrl2: "+f),u="",i.toUpperCase().indexOf(".JFIF")!=-1||i.toUpperCase().indexOf(".PNG")!=-1||i.toUpperCase().indexOf(".JPG")!=-1||i.toUpperCase().indexOf(".JPEG")!=-1||i.toUpperCase().indexOf(".BMP")!=-1||i.toUpperCase().indexOf(".GIF")!=-1||i.toUpperCase().indexOf(".TIFF")!=-1||i.toUpperCase().indexOf(".SVG")!=-1?($("#spanAttachmentsOfflineDialogTitle").html("Select the thumbnail to view the actual image..."),u+='<img src="'+f+'" style="width:700px;display:block;margin-left:auto;margin-right:auto;cursor:pointer;" onclick="displayFullSizedAttachmentInDialog(\''+f+"');\" />"):i.toUpperCase().indexOf(".PDF")!=-1||i.toUpperCase().indexOf(".RTF")!=-1||i.toUpperCase().indexOf(".DOC")!=-1||i.toUpperCase().indexOf(".DOCX")!=-1||i.toUpperCase().indexOf(".XSL")!=-1||i.toUpperCase().indexOf(".XSLX")!=-1||i.toUpperCase().indexOf(".TXT")!=-1||i.toUpperCase().indexOf(".ODT")!=-1||i.toUpperCase().indexOf(".ODS")!=-1||i.toUpperCase().indexOf(".ODP")!=-1?($("#spanAttachmentsOfflineDialogTitle").html("Select the link below to view the document..."),u+='<a href="'+f+'" target="_blank">yClick here to view the document: '+f+"<\/a>"):i.toUpperCase().indexOf(".MP3")!=-1||i.toUpperCase().indexOf(".M4A")!=-1||i.toUpperCase().indexOf(".M4R")!=-1?($("#spanAttachmentsOfflineDialogTitle").html("Select the link below to listen..."),u+=iOSApp=="YES"?'<a href="'+f+'">Click here to listen<\/a>':'<audio src="'+f+'" controls="controls" style="width:80%;">Click here to listen<\/audio>'):i.toUpperCase().indexOf(".M4V")!=-1||i.toUpperCase().indexOf(".AVI")!=-1||i.toUpperCase().indexOf(".MOV")!=-1||i.toUpperCase().indexOf(".MP4")!=-1?($("#spanAttachmentsOfflineDialogTitle").html("Select the link below to view..."),u+=iOSApp=="YES"?'<a href="'+f+'">Click here to view<\/a>':'<audio src="'+f+'" controls="controls">Click here to view<\/audio>'):($("#spanAttachmentsOfflineDialogTitle").html("This attachment has an unknown file extension..."),u+='<a href="'+f+'" target="_blank">Click here to try to open this file<\/a>'),$("#divAttachmentsOfflineDialogContents").html(u),u="",u+='<div class="divDialogButton" onclick="cmdSaveAttachmentMetadataOffline(\''+h+"', '"+n+"', '"+r+"');\">Save<\/div>",$("#spanAttachmentsOfflineDialogSaveMetadataButton").html(u),u="",u+='<div class="divDialogButton" onclick="removeAttachmentOffline(\''+i+"', '"+r+"', 'xx', '"+h+"');\">Delete<\/div>",$("#spanAttachmentsOfflineDialogDeleteAttachmentButton").html(u),n!="undefined"){var a=n.lastIndexOf("."),y=n.substring(0,a),p="."+n.substring(a+1,n.length);document.getElementById("txtAttachmentsOfflineDialogFilename").value=y;document.getElementById("spanAttachmentsOfflineDialogFileExtension").innerHTML=p}else document.getElementById("txtAttachmentsOfflineDialogFilename").value="";document.getElementById("txtAttachmentsOfflineDialogFileDescription").value=n!="description"?v:""}e.continue()}}catch(o){console.log("Exception in ios8.js.displayAttachmentInDialogOffline2():8: "+o.message+", "+o.stack);displayAlertDialog("Exception in ios8.js.displayAttachmentInDialogOffline2():8: "+o.message+", "+o.stack)}}}}else displayAlertDialog("2Support for displaying this kind of file is coming soon! <i>"+n+"<\/i>")}catch(u){console.log("Exception in ios8.js.displayAttachmentInDialogOffline2("+r+"): "+u.message+", "+u.stack);displayAlertDialog("Exception in ios8.js.displayAttachmentInDialogOffline2("+r+"): "+u.message+", "+u.stack)}}function cmdDisplayConfirmFileUploadDialog(n,t){try{var i=document.getElementById("inputFile"),r=i.files[0],u=r.name.trim().split(".")[0];document.getElementById("txtConfirmFileUploadDialogFilename").value=u;$("#divConfirmFileUploadDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"",width:"800px",dialogClass:"no-close",hide:!1});$("#divConfirmFileUploadDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();$("#btnUploadTheFileNow").off("click").click(function(){$("#divConfirmFileUploadDialog").dialog("close");$("#divWorkingOnItDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Working on it...",width:"800",dialogClass:"no-close",hide:!1});$("#divWorkingOnItDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();ProcessUpload(n,t)});$("#btnCancelUploadTheFileNow").off("click").click(function(){$("#divConfirmFileUploadDialog").dialog("close");$("#inputFile").replaceWith($("#inputFile").clone())})}catch(f){displayAlertDialog("Error in cmdDisplayConfirmFileUploadDialog(): "+f.message)}}function cmdDisplayDeleteBudgetRequestDialog(n,t){try{document.getElementById("cbDeleteABudgetRequestDialogEmailMessage").checked="";document.getElementById("txtDeleteABudgetRequestDialogEmailMessage").innerHTML="";$("#DeleteABudgetRequestDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"Delete "+n,width:"800px",dialogClass:"no-close",hide:!1,buttons:{"Delete Budget Request":{text:"Delete Budget Request, supplementals and tasks",id:"btnDeleteABudgetRequest",disabled:"true",click:function(){cmdDeleteBudgetRequest(n);populateStartPageItem("divArchive","Reports","");$(this).dialog("close")}},Cancel:{text:"Cancel",id:"btnCancelDeleteABudgetRequest",click:function(){$(this).dialog("close")}}},open:function(){var t,i;$(".ui-widget-overlay").bind("click",function(){$("#DeleteABudgetRequestDialog").dialog("close")});t=[];t={bwBudgetRequestId:n,bwWorkflowAppId:workflowAppId};i=webserviceurl+"/bwworkflow/itemizebudgetrequestdependencies";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){var i,r;t.message!="SUCCESS"?displayAlertDialog(JSON.stringify(t)):(i="",i+=t.NumberOfIncompleteTasksForBudgetRequest==0&&t.NumberOfCompletedTasksForBudgetRequest==0&&t.NumberOfSupplementals==0?"This Budget Request has no dependencies, and can be deleted immediately.":"When this Budget Request is deleted, the following will also be deleted:",(t.NumberOfIncompleteTasksForBudgetRequest>0||t.NumberOfCompletedTasksForBudgetRequest>0)&&(i+="<ul>",t.NumberOfIncompleteTasksForBudgetRequest>0&&(i+='<li style="color:red;"><span style="color:black;">'+t.NumberOfIncompleteTasksForBudgetRequest+" incomplete Task(s)<\/span><\/li>"),t.NumberOfCompletedTasksForBudgetRequest>0&&(i+='<li style="color:red;"><span style="color:black;">'+t.NumberOfCompletedTasksForBudgetRequest+" completed Task(s)<\/span><\/li>"),i+="<\/ul>"),t.NumberOfSupplementals>0&&(i+="Also, "+t.NumberOfSupplementals+" Supplemental Request(s) will be deleted, along with the following:",i+="<ul>",t.NumberOfIncompleteTasksForSupplementals>0&&(i+='<li style="color:red;"><span style="color:black;">'+t.NumberOfIncompleteTasksForSupplementals+" incomplete Task(s)<\/span><\/li>"),t.NumberOfCompletedTasksForSupplementals>0&&(i+='<li style="color:red;"><span style="color:black;">'+t.NumberOfCompletedTasksForSupplementals+" complete Task(s)<\/span><\/li>"),i+="<\/ul>"),document.getElementById("spanDeleteABudgetRequestDialogDependencyDetails").innerHTML=i);t.NumberOfIncompleteTasksForBudgetRequest==0&&t.NumberOfCompletedTasksForBudgetRequest==0&&t.NumberOfSupplementals==0?(r=$("#DeleteABudgetRequestDialog").dialog("option","buttons"),$.each(r,function(t,i){i.id==="btnDeleteABudgetRequest"&&(i.text="Delete "+n,i.disabled=!1)}),$("#DeleteABudgetRequestDialog").dialog("option","buttons",r)):(r=$("#DeleteABudgetRequestDialog").dialog("option","buttons"),$.each(r,function(n,t){t.id==="btnDeleteABudgetRequest"?(t.text="Delete the Budget Request and all related items",t.disabled=!1,t.style="'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;color:red;"):t.id==="btnCancelDeleteABudgetRequest"&&(t.style="'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #3f3f3f;font-size: 30pt;color:black;")}),$("#DeleteABudgetRequestDialog").dialog("option","buttons",r))},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdDisplayDeleteBudgetRequestDialog().itemizebudgetrequestdependencies: "+i)}})}});$("#DeleteABudgetRequestDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("spanDeleteABudgetRequestDialogTitle").innerHTML='Delete <span style="white-space:nowrap;">'+t.replace("-","&#8208;")+"<\/span>";document.getElementById("cbDeleteABudgetRequestDialogEmailMessage").removeAttribute("checked","")}catch(i){displayAlertDialog("Error in cmdDisplayDeleteBudgetRequestDialog(): "+i.message)}}function cmdDisplayDeleteRecurringExpenseRequestDialog(n,t){try{$("#DeleteARecurringExpenseDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"Delete "+n,width:"800px",dialogClass:"no-close",hide:!1,buttons:{"Delete Recurring Expense":{text:"Delete Recurring Expense, supplementals and tasks",id:"btnDeleteARecurringExpense",disabled:"true",click:function(){var t=confirm("This action cannot be undone.\n\n\nClick the OK button to proceed...");t&&(cmdDeleteRecurringExpense(n),$(this).dialog("close"))}},Cancel:function(){$(this).dialog("close")}},open:function(){var t=[],i;t={bwRecurringExpenseId:n,bwWorkflowAppId:workflowAppId};i=webserviceurl+"/bwworkflow/itemizerecurringexpensedependencies";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){var i,r;t.message!="SUCCESS"?displayAlertDialog(JSON.stringify(t)):(i="",i+=t.NumberOfIncompleteTasksForRecurringExpense==0&&t.NumberOfCompletedTasksForRecurringExpense==0&&t.NumberOfSupplementals==0?"This Recurring Expense has no dependencies, and can be deleted immediately.":"When this Recurring Expense is deleted, the following will also be deleted:",(t.NumberOfIncompleteTasksForRecurringExpense>0||t.NumberOfCompletedTasksForRecurringExpense>0)&&(i+="<ul>",t.NumberOfIncompleteTasksForRecurringExpense>0&&(i+='<li style="color:red;"><span style="color:black;">'+t.NumberOfIncompleteTasksForRecurringExpense+" incomplete Task(s)<\/span><\/li>"),t.NumberOfCompletedTasksForRecurringExpense>0&&(i+='<li style="color:red;"><span style="color:black;">'+t.NumberOfCompletedTasksForRecurringExpense+" completed Task(s)<\/span><\/li>"),i+="<\/ul>"),t.NumberOfSupplementals>0&&(i+="Also, "+t.NumberOfSupplementals+" Supplemental Request(s) will be deleted, along with the following:",i+="<ul>",t.NumberOfIncompleteTasksForSupplementals>0&&(i+='<li style="color:red;"><span style="color:black;">'+t.NumberOfIncompleteTasksForSupplementals+" incomplete Task(s)<\/span><\/li>"),t.NumberOfCompletedTasksForSupplementals>0&&(i+='<li style="color:red;"><span style="color:black;">'+t.NumberOfCompletedTasksForSupplementals+" complete Task(s)<\/span><\/li>"),i+="<\/ul>"),document.getElementById("spanDeleteARecurringExpenseDialogDependencyDetails").innerHTML=i);t.NumberOfIncompleteTasksForRecurringExpense==0&&t.NumberOfCompletedTasksForRecurringExpense==0&&t.NumberOfSupplementals==0?(r=$("#DeleteARecurringExpenseDialog").dialog("option","buttons"),$.each(r,function(t,i){i.id==="btnDeleteARecurringExpense"&&(i.text="Delete "+n,i.disabled=!1)}),$("#DeleteARecurringExpenseDialog").dialog("option","buttons",r)):(r=$("#DeleteARecurringExpenseDialog").dialog("option","buttons"),$.each(r,function(n,t){t.id==="btnDeleteARecurringExpense"&&(t.text="Delete the Recurring Expense and all related items",t.disabled=!1,t.style="color:red;")}),$("#DeleteARecurringExpenseDialog").dialog("option","buttons",r))},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdDisplayDeleteRecurringExpenseRequestDialog().itemizerecurringexpensedependencies: "+i)}})}});$("#DeleteARecurringExpenseDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("spanDeleteARecurringExpenseDialogTitle").innerHTML="Delete "+t+".";document.getElementById("cbDeleteARecurringExpenseDialogEmailMessage").removeAttribute("checked","")}catch(i){displayAlertDialog("Error in cmdDisplayDeleteBudgetRequestDialog(): "+i.message)}}function cmdDeleteBudgetRequest(n){var i,r,t,u;$("#divWorkingOnItDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Working on it...",width:"800",dialogClass:"no-close",hide:!1});$("#divWorkingOnItDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();r=document.getElementById("cbDeleteABudgetRequestDialogEmailMessage").checked;r==!0&&(i=document.getElementById("txtDeleteABudgetRequestDialogEmailMessage").textContent);t=[];t={bwBudgetRequestId:n,bwWorkflowAppId:workflowAppId,BudgetRequestDeletedByFriendlyName:participantId,AdditionalEmailMessage:i};u=webserviceurl+"/bwworkflow/removeabudgetrequest";$.ajax({url:u,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(n){$("#divWorkingOnItDialog").dialog("close");displayAlertDialog(n);populateStartPageItem("divArchive","Reports","")},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdDeleteBudgetRequest(): "+i)}})}function cmdListAllBudgetRequestsUsingClientDatasetApproach(){var t,n;$("#spanArchiveTopBarText").text("Archive: Budget Requests");t="all";$("#spanBwBudgetRequests").empty();n={bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwbudgetrequestsdataset",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var c=n.d.results[0],o=n.d.results[1],l,s,t,a,v,f,i,r,e,u,h;if(c.length==0&&o.length==0)t="",t+="<br /><br />",t+='<span style="font-size:30pt;font-style:italic;">There have been no Budget Requests created in this workflow yet.<\/span>',$("#spanBwBudgetRequests").append(t);else{for(budgetRequests=[],budgetRequests=new Array(c.length),supplementals=[],supplementals=new Array(c.length),statusesForTheStatusDropdown=[],statusesForTheStatusDropdown=[],i=0;i<c.length;i++)budgetRequests[i]=c[i];for(i=0;i<budgetRequests.length;i++){for(s=!1,f=0;f<statusesForTheStatusDropdown.length;f++)budgetRequests[i].BudgetWorkflowStatus==statusesForTheStatusDropdown[f]&&(s=!0);for(s!=!0&&statusesForTheStatusDropdown.push(budgetRequests[i].BudgetWorkflowStatus),l=budgetRequests[i].bwBudgetRequestId,supplementals[i]=[],supplementals[i]=[],r=0;r<o.length;r++)if(l==o[r].RelatedBudgetRequestId){for(supplementals[i].push(o[r]),s=!1,f=0;f<statusesForTheStatusDropdown.length;f++)o[r].BudgetWorkflowStatus==statusesForTheStatusDropdown[f]&&(s=!0);s!=!0&&statusesForTheStatusDropdown.push(o[r].BudgetWorkflowStatus)}}for(t="",a=(new Date).getFullYear().toString(),t+='<br /><span style="font-size:30pt;">Year:&nbsp;<select id="" style="font-size:30pt;"><option>'+a+"<\/option><\/select><\/span>",t+='&nbsp;&nbsp;<input type="button" disabled value="View trashbin contents" class="BwButton350" onclick="cmdDisplayArchivePageTrashbinContents();" style="cursor:pointer;display:none;" />&nbsp;&nbsp;<input type="button" disabled value="View extended information" class="BwButton350" onclick="cmdDisplayArchivePageExtendedInformation();" style="cursor:pointer;display:none;" />',t+="<br /><br />",t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td><\/td>",t+="    <td>Description<\/td>",t+='    <td style="white-space:nowrap;">Financial Area<\/td>',t+="    <td>Budget Amount<\/td>",t+="    <td>Status<\/td>",t+="    <td>ARStatus<\/td>",t+="    <td>Current Owner<\/td>",t+="  <\/tr>",t+="  <tr>",t+="    <td><\/td>",t+='    <td style="white-space:nowrap;"><input type="text" id="txtArchivePageDescriptionFilter" class="archivePageFilterBox" title="Type here to limit search results, using * as a wildcard character."/>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" /><\/td>',t+='    <td style="white-space:nowrap;">',t+='      <select id="ddlArchivePageFinancialAreaDropDownFilter" class="archivePageFilterDropDown" title="Select here to limit the search results.">',r=0;r<BWMData[0].length;r++)if(BWMData[0][r][0]==workflowAppId)for(t+='<option value="" class="archivePageFilterOptionDropDown">Show all...<\/option>',u=0;u<BWMData[0][r][4].length;u++)v=BWMData[0][r][4][u][0],h=BWMData[0][r][4][u][1],t+='<option value="'+v+'" class="archivePageFilterOptionDropDown">',t+=h,t+="<\/option>";for(t+="      <\/select>",t+="    <\/td>",t+='    <td style="white-space:nowrap;"><input type="text" id="txtArchivePageBudgetAmountFilter" class="archivePageFilterBox" title="Enter a number. Shows all equal to or greater than."/>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" /><\/td>',t+='    <td style="white-space:nowrap;">',t+='<select id="selectArchivePageFilterDropDown" class="archivePageFilterDropDown" title="Select here to limit the search results.">',t+='<option value="" class="archivePageFilterOptionDropDown">Show all...<\/option>',f=0;f<statusesForTheStatusDropdown.length;f++)t+='<option value="'+statusesForTheStatusDropdown[f]+'" class="archivePageFilterOptionDropDown">'+statusesForTheStatusDropdown[f]+"<\/option>";for(t+='<\/select>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" />',t+="    <\/td>",t+="    <td><\/td>",t+="    <td><\/td>",t+="  <\/tr>",i=0;i<budgetRequests.length;i++){for(t+="  <tr>",t+="    <td>",t+='        <img src="images/trash-can.png" class="trashcan" onclick="cmdDisplayDeleteBudgetRequestDialog(\''+budgetRequests[i].bwBudgetRequestId+"', '"+budgetRequests[i].Title+'\');" title="Delete" style="cursor:pointer;" />',t+="    <\/td>",t+='      <td><a class="aDisplayArLink" href="javascript:displayArOnTheHomePage(\''+budgetRequests[i].bwBudgetRequestId+"', '"+participantId+"', '"+budgetRequests[i].Title+"');\">"+budgetRequests[i].ProjectTitle+"<\/a><\/td>",r=0;r<BWMData[0].length;r++)if(BWMData[0][r][0]==workflowAppId)for(u=0;u<BWMData[0][r][4].length;u++)BWMData[0][r][4][u][0]==budgetRequests[i].FunctionalAreaId&&(h=BWMData[0][r][4][u][1],t+="<td>",t+=h,t+="<\/td>");for(t+=budgetRequests[i].ARStatus=="Rejected"?'    <td style="text-align:right;"><strike>'+formatCurrency(budgetRequests[i].BudgetAmount)+"<\/strike><\/td>":'    <td style="text-align:right;">'+formatCurrency(budgetRequests[i].BudgetAmount)+"<\/td>",t+="    <td>"+budgetRequests[i].BudgetWorkflowStatus+"<\/td>",t+="    <td>"+budgetRequests[i].ARStatus+"<\/td>",t+="    <td>"+budgetRequests[i].CurrentOwner+"<\/td>",t+="  <\/tr>",r=0;r<supplementals[i].length;r++){for(t+='  <tr style="font-style:italic;font-size:small;">',t+='      <td><a class="aDisplayArLink" href="javascript:displayArOnTheHomePage(\''+supplementals[i][r].bwBudgetRequestId+"', '"+participantId+"', '"+supplementals[i][r].Title+"');\">"+supplementals[i][r].ProjectTitle+"<\/a><\/td>",e=0;e<BWMData[0].length;e++)if(BWMData[0][e][0]==workflowAppId)for(u=0;u<BWMData[0][e][4].length;u++)BWMData[0][e][4][u][0]==supplementals[i][r].FunctionalAreaId&&(h=BWMData[0][e][4][u][1],t+="<td>",t+=h,t+="<\/td>");t+='    <td style="text-align:right;">'+supplementals[i][r].BudgetAmount+"<\/td>";t+="    <td>"+supplementals[i][r].BudgetWorkflowStatus+"<\/td>";t+="    <td><\/td>";t+="    <td>"+supplementals[i][r].CurrentOwner+"<\/td>";t+="  <\/tr>"}}t+='<tr><td colspan="12"><\/td><\/tr>';t+="<\/table>";$("#spanBwBudgetRequests").append(t);$("#txtArchivePageDescriptionFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageDescriptionFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageBudgetAmountFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#txtArchivePageBudgetAmountFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#ddlArchivePageFinancialAreaDropDownFilter").change(function(){renderArchivePageApplyingDescriptionFilter("ddlArchivePageFinancialAreaDropDownFilter")});$("#selectArchivePageFilterDropDown").change(function(){renderArchivePageApplyingDescriptionFilter("selectArchivePageFilterDropDown")})}},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllBudgetRequestsUsingClientDatasetApproach():"+t+", "+i)}})}function cmdListAllQuoteRequestsUsingClientDatasetApproach(){var t,n;$("#spanArchiveTopBarText").text("Archive: Quote requests");t="all";$("#spanBwBudgetRequests").empty();n={bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwquoterequestsdataset",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var c=n.d.results[0],o=n.d.results[1],l,s,t,a,v,f,i,r,e,u,h;if(c.length==0&&o.length==0)t="",t+="<br /><br />",t+='<span style="font-size:30pt;font-style:italic;">There have been no Quote Requests created in this workflow yet.<\/span>',$("#spanBwBudgetRequests").append(t);else{for(budgetRequests=[],budgetRequests=new Array(c.length),supplementals=[],supplementals=new Array(c.length),statusesForTheStatusDropdown=[],statusesForTheStatusDropdown=[],i=0;i<c.length;i++)budgetRequests[i]=c[i];for(i=0;i<budgetRequests.length;i++){for(s=!1,f=0;f<statusesForTheStatusDropdown.length;f++)budgetRequests[i].BudgetWorkflowStatus==statusesForTheStatusDropdown[f]&&(s=!0);for(s!=!0&&statusesForTheStatusDropdown.push(budgetRequests[i].BudgetWorkflowStatus),l=budgetRequests[i].bwBudgetRequestId,supplementals[i]=[],supplementals[i]=[],r=0;r<o.length;r++)if(l==o[r].RelatedBudgetRequestId){for(supplementals[i].push(o[r]),s=!1,f=0;f<statusesForTheStatusDropdown.length;f++)o[r].BudgetWorkflowStatus==statusesForTheStatusDropdown[f]&&(s=!0);s!=!0&&statusesForTheStatusDropdown.push(o[r].BudgetWorkflowStatus)}}for(t="",a=(new Date).getFullYear().toString(),t+='<br /><span style="font-size:30pt;">Year:&nbsp;<select id="" style="font-size:30pt;"><option>'+a+"<\/option><\/select><\/span>",t+='&nbsp;&nbsp;<input type="button" disabled value="View trashbin contents" class="BwButton350" onclick="cmdDisplayArchivePageTrashbinContents();" style="cursor:pointer;display:none;" />&nbsp;&nbsp;<input type="button" disabled value="View extended information" class="BwButton350" onclick="cmdDisplayArchivePageExtendedInformation();" style="cursor:pointer;display:none;" />',t+="<br /><br />",t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td><\/td>",t+="    <td>Description<\/td>",t+='    <td style="white-space:nowrap;">Financial Area<\/td>',t+="    <td>Quote Amount<\/td>",t+="    <td>Status<\/td>",t+="    <td>ARStatus<\/td>",t+="    <td>Current Owner<\/td>",t+="  <\/tr>",t+="  <tr>",t+="    <td><\/td>",t+='    <td style="white-space:nowrap;"><input type="text" id="txtArchivePageDescriptionFilter" class="archivePageFilterBox" title="Type here to limit search results, using * as a wildcard character."/>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" /><\/td>',t+='    <td style="white-space:nowrap;">',t+='      <select id="ddlArchivePageFinancialAreaDropDownFilter" class="archivePageFilterDropDown" title="Select here to limit the search results.">',r=0;r<BWMData[0].length;r++)if(BWMData[0][r][0]==workflowAppId)for(t+='<option value="" class="archivePageFilterOptionDropDown">Show all...<\/option>',u=0;u<BWMData[0][r][4].length;u++)v=BWMData[0][r][4][u][0],h=BWMData[0][r][4][u][1],t+='<option value="'+v+'" class="archivePageFilterOptionDropDown">',t+=h,t+="<\/option>";for(t+="      <\/select>",t+="    <\/td>",t+='    <td style="white-space:nowrap;"><input type="text" id="txtArchivePageBudgetAmountFilter" class="archivePageFilterBox" title="Enter a number. Shows all equal to or greater than."/>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" /><\/td>',t+='    <td style="white-space:nowrap;">',t+='<select id="selectArchivePageFilterDropDown" class="archivePageFilterDropDown" title="Select here to limit the search results.">',t+='<option value="" class="archivePageFilterOptionDropDown">Show all...<\/option>',f=0;f<statusesForTheStatusDropdown.length;f++)t+='<option value="'+statusesForTheStatusDropdown[f]+'" class="archivePageFilterOptionDropDown">'+statusesForTheStatusDropdown[f]+"<\/option>";for(t+='<\/select>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" />',t+="    <\/td>",t+="    <td><\/td>",t+="    <td><\/td>",t+="  <\/tr>",i=0;i<budgetRequests.length;i++){for(t+="  <tr>",t+="    <td>",t+='        <img src="images/trash-can.png" class="trashcan" onclick="cmdDisplayDeleteBudgetRequestDialog(\''+budgetRequests[i].bwBudgetRequestId+"', '"+budgetRequests[i].Title+'\');" title="Delete" style="cursor:pointer;" />',t+="    <\/td>",t+='      <td><a class="aDisplayArLink" href="javascript:displayArOnTheHomePage(\''+budgetRequests[i].bwBudgetRequestId+"', '"+participantId+"', '"+budgetRequests[i].Title+"');\">"+budgetRequests[i].ProjectTitle+"<\/a><\/td>",r=0;r<BWMData[0].length;r++)if(BWMData[0][r][0]==workflowAppId)for(u=0;u<BWMData[0][r][4].length;u++)BWMData[0][r][4][u][0]==budgetRequests[i].FunctionalAreaId&&(h=BWMData[0][r][4][u][1],t+="<td>",t+=h,t+="<\/td>");for(t+=budgetRequests[i].ARStatus=="Rejected"?'    <td style="text-align:right;"><strike>'+formatCurrency(budgetRequests[i].BudgetAmount)+"<\/strike><\/td>":'    <td style="text-align:right;">'+formatCurrency(budgetRequests[i].BudgetAmount)+"<\/td>",t+="    <td>"+budgetRequests[i].BudgetWorkflowStatus+"<\/td>",t+="    <td>"+budgetRequests[i].ARStatus+"<\/td>",t+="    <td>"+budgetRequests[i].CurrentOwner+"<\/td>",t+="  <\/tr>",r=0;r<supplementals[i].length;r++){for(t+='  <tr style="font-style:italic;font-size:small;">',t+='      <td><a class="aDisplayArLink" href="javascript:displayArOnTheHomePage(\''+supplementals[i][r].bwBudgetRequestId+"', '"+participantId+"', '"+supplementals[i][r].Title+"');\">"+supplementals[i][r].ProjectTitle+"<\/a><\/td>",e=0;e<BWMData[0].length;e++)if(BWMData[0][e][0]==workflowAppId)for(u=0;u<BWMData[0][e][4].length;u++)BWMData[0][e][4][u][0]==supplementals[i][r].FunctionalAreaId&&(h=BWMData[0][e][4][u][1],t+="<td>",t+=h,t+="<\/td>");t+='    <td style="text-align:right;">'+supplementals[i][r].BudgetAmount+"<\/td>";t+="    <td>"+supplementals[i][r].BudgetWorkflowStatus+"<\/td>";t+="    <td><\/td>";t+="    <td>"+supplementals[i][r].CurrentOwner+"<\/td>";t+="  <\/tr>"}}t+='<tr><td colspan="12"><\/td><\/tr>';t+="<\/table>";$("#spanBwBudgetRequests").append(t);$("#txtArchivePageDescriptionFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageDescriptionFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageBudgetAmountFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#txtArchivePageBudgetAmountFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#ddlArchivePageFinancialAreaDropDownFilter").change(function(){renderArchivePageApplyingDescriptionFilter("ddlArchivePageFinancialAreaDropDownFilter")});$("#selectArchivePageFilterDropDown").change(function(){renderArchivePageApplyingDescriptionFilter("selectArchivePageFilterDropDown")})}},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllQuoteRequestsUsingClientDatasetApproach():"+t+", "+i)}})}function cmdListAllReimbursementRequestsUsingClientDatasetApproach(){var t,n;$("#spanArchiveTopBarText").text("Archive: Reimbursement requests");t="all";$("#spanBwBudgetRequests").empty();n={bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwreimbursementrequestsdataset",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var c=n.d.results[0],o=n.d.results[1],l,s,t,a,v,f,i,r,e,u,h;if(c.length==0&&o.length==0)t="",t+="<br /><br />",t+='<span style="font-size:30pt;font-style:italic;">There have been no Reimbursement Requests created in this workflow yet.<\/span>',$("#spanBwBudgetRequests").append(t);else{for(budgetRequests=[],budgetRequests=new Array(c.length),supplementals=[],supplementals=new Array(c.length),statusesForTheStatusDropdown=[],statusesForTheStatusDropdown=[],i=0;i<c.length;i++)budgetRequests[i]=c[i];for(i=0;i<budgetRequests.length;i++){for(s=!1,f=0;f<statusesForTheStatusDropdown.length;f++)budgetRequests[i].BudgetWorkflowStatus==statusesForTheStatusDropdown[f]&&(s=!0);for(s!=!0&&statusesForTheStatusDropdown.push(budgetRequests[i].BudgetWorkflowStatus),l=budgetRequests[i].bwBudgetRequestId,supplementals[i]=[],supplementals[i]=[],r=0;r<o.length;r++)if(l==o[r].RelatedBudgetRequestId){for(supplementals[i].push(o[r]),s=!1,f=0;f<statusesForTheStatusDropdown.length;f++)o[r].BudgetWorkflowStatus==statusesForTheStatusDropdown[f]&&(s=!0);s!=!0&&statusesForTheStatusDropdown.push(o[r].BudgetWorkflowStatus)}}for(t="",a=(new Date).getFullYear().toString(),t+='<br /><span style="font-size:30pt;">Year:&nbsp;<select id="" style="font-size:30pt;"><option>'+a+"<\/option><\/select><\/span>",t+='&nbsp;&nbsp;<input type="button" disabled value="View trashbin contents" class="BwButton350" onclick="cmdDisplayArchivePageTrashbinContents();" style="cursor:pointer;display:none;" />&nbsp;&nbsp;<input type="button" disabled value="View extended information" class="BwButton350" onclick="cmdDisplayArchivePageExtendedInformation();" style="cursor:pointer;display:none;" />',t+="<br /><br />",t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td><\/td>",t+="    <td>Description<\/td>",t+='    <td style="white-space:nowrap;">Financial Area<\/td>',t+="    <td>Reimbursement Amount<\/td>",t+="    <td>Status<\/td>",t+="    <td>ARStatus<\/td>",t+="    <td>Current Owner<\/td>",t+="  <\/tr>",t+="  <tr>",t+="    <td><\/td>",t+='    <td style="white-space:nowrap;"><input type="text" id="txtArchivePageDescriptionFilter" class="archivePageFilterBox" title="Type here to limit search results, using * as a wildcard character."/>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" /><\/td>',t+='    <td style="white-space:nowrap;">',t+='      <select id="ddlArchivePageFinancialAreaDropDownFilter" class="archivePageFilterDropDown" title="Select here to limit the search results.">',r=0;r<BWMData[0].length;r++)if(BWMData[0][r][0]==workflowAppId)for(t+='<option value="" class="archivePageFilterOptionDropDown">Show all...<\/option>',u=0;u<BWMData[0][r][4].length;u++)v=BWMData[0][r][4][u][0],h=BWMData[0][r][4][u][1],t+='<option value="'+v+'" class="archivePageFilterOptionDropDown">',t+=h,t+="<\/option>";for(t+="      <\/select>",t+="    <\/td>",t+='    <td style="white-space:nowrap;"><input type="text" id="txtArchivePageBudgetAmountFilter" class="archivePageFilterBox" title="Enter a number. Shows all equal to or greater than."/>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" /><\/td>',t+='    <td style="white-space:nowrap;">',t+='<select id="selectArchivePageFilterDropDown" class="archivePageFilterDropDown" title="Select here to limit the search results.">',t+='<option value="" class="archivePageFilterOptionDropDown">Show all...<\/option>',f=0;f<statusesForTheStatusDropdown.length;f++)t+='<option value="'+statusesForTheStatusDropdown[f]+'" class="archivePageFilterOptionDropDown">'+statusesForTheStatusDropdown[f]+"<\/option>";for(t+='<\/select>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" />',t+="    <\/td>",t+="    <td><\/td>",t+="    <td><\/td>",t+="  <\/tr>",i=0;i<budgetRequests.length;i++){for(t+="  <tr>",t+="    <td>",t+='        <img src="images/trash-can.png" class="trashcan" onclick="cmdDisplayDeleteBudgetRequestDialog(\''+budgetRequests[i].bwBudgetRequestId+"', '"+budgetRequests[i].Title+'\');" title="Delete" style="cursor:pointer;" />',t+="    <\/td>",t+='      <td><a class="aDisplayArLink" href="javascript:displayArOnTheHomePage(\''+budgetRequests[i].bwBudgetRequestId+"', '"+participantId+"', '"+budgetRequests[i].Title+"');\">"+budgetRequests[i].ProjectTitle+"<\/a><\/td>",r=0;r<BWMData[0].length;r++)if(BWMData[0][r][0]==workflowAppId)for(u=0;u<BWMData[0][r][4].length;u++)BWMData[0][r][4][u][0]==budgetRequests[i].FunctionalAreaId&&(h=BWMData[0][r][4][u][1],t+="<td>",t+=h,t+="<\/td>");for(t+=budgetRequests[i].ARStatus=="Rejected"?'    <td style="text-align:right;"><strike>'+formatCurrency(budgetRequests[i].BudgetAmount)+"<\/strike><\/td>":'    <td style="text-align:right;">'+formatCurrency(budgetRequests[i].BudgetAmount)+"<\/td>",t+="    <td>"+budgetRequests[i].BudgetWorkflowStatus+"<\/td>",t+="    <td>"+budgetRequests[i].ARStatus+"<\/td>",t+="    <td>"+budgetRequests[i].CurrentOwner+"<\/td>",t+="  <\/tr>",r=0;r<supplementals[i].length;r++){for(t+='  <tr style="font-style:italic;font-size:small;">',t+='      <td><a class="aDisplayArLink" href="javascript:displayArOnTheHomePage(\''+supplementals[i][r].bwBudgetRequestId+"', '"+participantId+"', '"+supplementals[i][r].Title+"');\">"+supplementals[i][r].ProjectTitle+"<\/a><\/td>",e=0;e<BWMData[0].length;e++)if(BWMData[0][e][0]==workflowAppId)for(u=0;u<BWMData[0][e][4].length;u++)BWMData[0][e][4][u][0]==supplementals[i][r].FunctionalAreaId&&(h=BWMData[0][e][4][u][1],t+="<td>",t+=h,t+="<\/td>");t+='    <td style="text-align:right;">'+supplementals[i][r].BudgetAmount+"<\/td>";t+="    <td>"+supplementals[i][r].BudgetWorkflowStatus+"<\/td>";t+="    <td><\/td>";t+="    <td>"+supplementals[i][r].CurrentOwner+"<\/td>";t+="  <\/tr>"}}t+='<tr><td colspan="12"><\/td><\/tr>';t+="<\/table>";$("#spanBwBudgetRequests").append(t);$("#txtArchivePageDescriptionFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageDescriptionFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageBudgetAmountFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#txtArchivePageBudgetAmountFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#ddlArchivePageFinancialAreaDropDownFilter").change(function(){renderArchivePageApplyingDescriptionFilter("ddlArchivePageFinancialAreaDropDownFilter")});$("#selectArchivePageFilterDropDown").change(function(){renderArchivePageApplyingDescriptionFilter("selectArchivePageFilterDropDown")})}},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllReimbursementRequestsUsingClientDatasetApproach():"+t+", "+i)}})}function cmdListAllRecurringExpensesUsingClientDatasetApproach(){var t,n;$("#spanArchiveTopBarText").text("Archive: Recurring expenses");t="all";$("#spanBwBudgetRequests").empty();n={bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwrecurringexpensesdataset",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var s=n.d.results[0],e=n.d.results[1],l,c,h,t,a,v,i,r,f,u,o;if(s.length==0&&e.length==0)t="",t+="<br /><br />",t+='<span style="font-size:30pt;font-style:italic;">There have been no recurring expenses created in this workflow yet.<\/span>',$("#spanBwBudgetRequests").append(t);else{for(budgetRequests=[],budgetRequests=new Array(s.length),supplementals=[],supplementals=new Array(s.length),statusesForTheStatusDropdown=[],statusesForTheStatusDropdown=[],i=0;i<s.length;i++)budgetRequests[i]=s[i];for(i=0;i<budgetRequests.length;i++)for(l=budgetRequests[i].bwRecurringExpenseId,supplementals[i]=[],supplementals[i]=[],r=0;r<e.length;r++)if(l==e[r].RelatedRecurringExpenseId){for(supplementals[i].push(e[r]),c=!1,h=0;h<statusesForTheStatusDropdown.length;h++)e[r].BudgetWorkflowStatus==statusesForTheStatusDropdown[h]&&(c=!0);c!=!0&&statusesForTheStatusDropdown.push(e[r].BudgetWorkflowStatus)}for(t="",a=(new Date).getFullYear().toString(),t+='<br /><span style="font-size:30pt;">Year:&nbsp;<select id="" style="font-size:30pt;"><option>'+a+"<\/option><\/select><\/span>",t+='&nbsp;&nbsp;<input type="button" disabled value="View trashbin contents" class="BwButton350" onclick="cmdDisplayArchivePageTrashbinContents();" style="cursor:pointer;" />&nbsp;&nbsp;<input type="button" disabled value="View extended information" class="BwButton350" onclick="cmdDisplayArchivePageExtendedInformation();" style="cursor:pointer;" /><br /><br />',t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td>Description<\/td>",t+='    <td style="white-space:nowrap;">Financial Area<\/td>',t+="    <td>Budget Amount<\/td>",t+="    <td>Reminder Date<\/td>",t+="    <td><\/td>",t+="  <\/tr>",t+="  <tr>",t+='    <td style="white-space:nowrap;"><input type="text" id="txtArchivePageDescriptionFilter" class="archivePageFilterBox" title="Type here to limit search results, using * as a wildcard character."/>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" /><\/td>',t+='    <td style="white-space:nowrap;">',t+='      <select id="ddlArchivePageFinancialAreaDropDownFilter" class="archivePageFilterDropDown" title="Select here to limit the search results.">',r=0;r<BWMData[0].length;r++)if(BWMData[0][r][0]==workflowAppId)for(t+='<option value="" class="archivePageFilterOptionDropDown">Show all...<\/option>',u=0;u<BWMData[0][r][4].length;u++)v=BWMData[0][r][4][u][0],o=BWMData[0][r][4][u][1],t+='<option value="'+v+'" class="archivePageFilterOptionDropDown">',t+=o,t+="<\/option>";for(t+="      <\/select>",t+="    <\/td>",t+='    <td style="white-space:nowrap;"><input type="text" id="txtArchivePageBudgetAmountFilter" class="archivePageFilterBox" title="Enter a number. Shows all equal to or greater than."/>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" /><\/td>',t+="    <td><\/td>",t+="    <td><\/td>",t+="  <\/tr>",i=0;i<budgetRequests.length;i++){for(t+="  <tr>",t+="      <td><a href=\"javascript:displayRecurringExpenseOnTheHomePage('"+budgetRequests[i].bwRecurringExpenseId+"', '"+participantId+"', '"+budgetRequests[i].Title+"');\">"+budgetRequests[i].ProjectTitle+"<\/a><\/td>",r=0;r<BWMData[0].length;r++)if(BWMData[0][r][0]==workflowAppId)for(u=0;u<BWMData[0][r][4].length;u++)BWMData[0][r][4][u][0]==budgetRequests[i].FunctionalAreaId&&(o=BWMData[0][r][4][u][1],t+="<td>",t+=o,t+="<\/td>");for(t+=budgetRequests[i].ARStatus=="Rejected"?'    <td style="text-align:right;"><strike>'+formatCurrency(budgetRequests[i].BudgetAmount)+"<\/strike><\/td>":'    <td style="text-align:right;">'+formatCurrency(budgetRequests[i].BudgetAmount)+"<\/td>",t+="    <td>"+formatDateFromBW(budgetRequests[i].ReminderDate)+"<\/td>",t+="<td>",t+='  <img src="images/trash-can.png" class="trashcan" onclick="cmdDisplayDeleteRecurringExpenseRequestDialog(\''+budgetRequests[i].bwRecurringExpenseId+"', '"+budgetRequests[i].Title+'\');" title="Delete" style="cursor:pointer;" />',t+="<\/td>",t+="  <\/tr>",r=0;r<supplementals[i].length;r++){for(t+='  <tr style="font-style:italic;font-size:small;">',t+='      <td><a class="aDisplayArLink" href="javascript:displayArOnTheHomePage(\''+supplementals[i][r].bwBudgetRequestId+"', '"+participantId+"', '"+supplementals[i][r].Title+"');\">"+supplementals[i][r].ProjectTitle+"<\/a><\/td>",f=0;f<BWMData[0].length;f++)if(BWMData[0][f][0]==workflowAppId)for(u=0;u<BWMData[0][f][4].length;u++)BWMData[0][f][4][u][0]==supplementals[i][r].FunctionalAreaId&&(o=BWMData[0][f][4][u][1],t+="<td>",t+=o,t+="<\/td>");t+='    <td style="text-align:right;">'+supplementals[i][r].BudgetAmount+"<\/td>";t+="  <\/tr>"}}t+='<tr><td colspan="12"><\/td><\/tr>';t+="<\/table>";$("#spanBwBudgetRequests").append(t);$("#txtArchivePageDescriptionFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageDescriptionFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageBudgetAmountFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#txtArchivePageBudgetAmountFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#ddlArchivePageFinancialAreaDropDownFilter").change(function(){renderArchivePageApplyingDescriptionFilter("ddlArchivePageFinancialAreaDropDownFilter")});$("#selectArchivePageFilterDropDown").change(function(){renderArchivePageApplyingDescriptionFilter("selectArchivePageFilterDropDown")})}},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListAllRecurringExpensesUsingClientDatasetApproach():"+t+", "+i)}})}function cmdListAllParticipantsUsingClientDatasetApproach(){var i,n;try{$("#spanArchiveTopBarText").text("Archive: Participants");i="all";$("#spanBwBudgetRequests").empty();n={bwWorkflowId:workflowAppId};$.ajax({url:webserviceurl+"/workflow/participants",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var t,i;try{for(t="",t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td>Name<\/td>",t+="    <td>Email<\/td>",t+="    <td>Role<\/td>",t+="    <td><\/td>",t+="    <td><\/td>",t+="  <\/tr>",i=0;i<n.length;i++)t+="  <tr>",t+="    <td>"+n[i].bwParticipantFriendlyName+"<\/td>",t+="    <td>"+n[i].bwParticipantEmail+"<\/td>",t+="    <td>"+n[i].bwParticipantRole+"<\/td>",n[i].bwParticipantId==participantId||n[i].bwParticipantRole=="owner"?(t+="    <td><\/td>",t+="    <td><\/td>"):(t+="    <td><\/td>",t+="    <td><\/td>"),t+="  <\/tr>";t+="<\/table>";t+="<\/table>";t+="<br />";$("#spanBwBudgetRequests").append(t);$("#txtArchivePageDescriptionFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageDescriptionFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageBudgetAmountFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#txtArchivePageBudgetAmountFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#ddlArchivePageFinancialAreaDropDownFilter").change(function(){renderArchivePageApplyingDescriptionFilter("ddlArchivePageFinancialAreaDropDownFilter")});$("#selectArchivePageFilterDropDown").change(function(){renderArchivePageApplyingDescriptionFilter("selectArchivePageFilterDropDown")})}catch(r){displayAlertDialog("Error in my.js.cmdListAllParticipantsUsingClientDatasetApproach():3:"+r.message+", "+r.stack)}},error:function(n,t,i){displayAlertDialog("Error in my.js.cmdListAllParticipantsUsingClientDatasetApproach():2:"+t+", "+i)}})}catch(t){displayAlertDialog("Error in my.js.cmdListAllParticipantsUsingClientDatasetApproach():1:"+t.message+", "+t.stack)}}function renderArchivePageApplyingDescriptionFilter(n){var r=document.getElementById("txtArchivePageDescriptionFilter").value.toLowerCase(),u=document.getElementById("txtArchivePageBudgetAmountFilter").value.toLowerCase(),e=document.getElementById("ddlArchivePageFinancialAreaDropDownFilter").value,o=document.getElementById("selectArchivePageFilterDropDown").value,v=(new Date).getFullYear().toString(),t="",h,i,f,s,l;for(t+='<br />Year:&nbsp;<select id=""><option>'+v+"<\/option><\/select>",t+="<br /><br />",t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td>Description<\/td>",t+='    <td style="white-space:nowrap;">Financial Area<\/td>',t+="    <td>Budget Amount<\/td>",t+="    <td>Status<\/td>",t+="    <td>ARStatus<\/td>",t+="    <td>Current Owner<\/td>",t+="    <td><\/td>",t+="  <\/tr>",t+="  <tr>",t+='    <td style="white-space:nowrap;"><input type="text" id="txtArchivePageDescriptionFilter" class="archivePageFilterBox" title="Type here to limit the search results, using * as a wildcard character."/>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" /><\/td>',t+='    <td style="white-space:nowrap;">',t+='      <select id="ddlArchivePageFinancialAreaDropDownFilter" class="archivePageFilterDropDown" title="Select here to limit search results.">',f=0;f<BWMData[0].length;f++)if(BWMData[0][f][0]==workflowAppId)for(t+='<option value="" class="archivePageFilterOptionDropDown">Show all...<\/option>',s=0;s<BWMData[0][f][4].length;s++){var c=BWMData[0][f][4][s][0],l=BWMData[0][f][4][s][1],a=!1;for(i=0;i<budgetRequests.length;i++)(r==""&&u==""||u==""&&budgetRequests[i].ProjectTitle.toLowerCase().indexOf(r)>-1||r==""&&Number(budgetRequests[i].BudgetAmount)>=Number(u)||budgetRequests[i].ProjectTitle.toLowerCase().indexOf(r)>-1&&Number(budgetRequests[i].BudgetAmount)>=Number(u))&&c==budgetRequests[i].FunctionalAreaId&&(a=!0);a==!0&&(t+=e==c?'<option value="'+c+'" class="archivePageFilterOptionDropDown" selected >':'<option value="'+c+'" class="archivePageFilterOptionDropDown">',t+=l,t+="<\/option>")}for(t+="      <\/select>",t+="    <\/td>",t+='    <td style="white-space:nowrap;"><input type="text" id="txtArchivePageBudgetAmountFilter" class="archivePageFilterBox" title="Enter a number. Shows all equal to or greater than."/>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" /><\/td>',t+='    <td style="white-space:nowrap;">',t+='<select id="selectArchivePageFilterDropDown" class="archivePageFilterDropDown" title="Select here to limit search results.">',t+='<option value="" class="archivePageFilterOptionDropDown">Show all...<\/option>',h=0;h<statusesForTheStatusDropdown.length;h++)t+=o==statusesForTheStatusDropdown[h]?'<option value="'+statusesForTheStatusDropdown[h]+'" class="archivePageFilterOptionDropDown" selected >'+statusesForTheStatusDropdown[h]+"<\/option>":'<option value="'+statusesForTheStatusDropdown[h]+'" class="archivePageFilterOptionDropDown">'+statusesForTheStatusDropdown[h]+"<\/option>";for(t+='<\/select>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" />',t+="    <\/td>",t+="    <td><\/td>",t+="    <td><\/td>",t+="    <td><\/td>",t+="  <\/tr>",i=0;i<budgetRequests.length;i++)if(r==""&&e==""&&u==""&&o==""||r==""&&e==""&&u==""&&o==budgetRequests[i].BudgetWorkflowStatus||budgetRequests[i].ProjectTitle.toLowerCase().indexOf(r)>-1&&e==""&&u==""&&o==""||budgetRequests[i].ProjectTitle.toLowerCase().indexOf(r)>-1&&e==budgetRequests[i].FunctionalAreaId&&u==""&&o==""||budgetRequests[i].ProjectTitle.toLowerCase().indexOf(r)>-1&&e==budgetRequests[i].FunctionalAreaId&&Number(budgetRequests[i].BudgetAmount)>=Number(u)&&o==""||budgetRequests[i].ProjectTitle.toLowerCase().indexOf(r)>-1&&e==budgetRequests[i].FunctionalAreaId&&Number(budgetRequests[i].BudgetAmount)>=Number(u)&&o==budgetRequests[i].BudgetWorkflowStatus||r==""&&e==budgetRequests[i].FunctionalAreaId&&u==""&&o==""||r==""&&e==budgetRequests[i].FunctionalAreaId&&Number(budgetRequests[i].BudgetAmount)>=Number(u)&&o==""||r==""&&e==budgetRequests[i].FunctionalAreaId&&Number(budgetRequests[i].BudgetAmount)>=Number(u)&&o==budgetRequests[i].BudgetWorkflowStatus||r==""&&e==""&&Number(budgetRequests[i].BudgetAmount)>=Number(u)&&o==""||r==""&&e==""&&Number(budgetRequests[i].BudgetAmount)>=Number(u)&&o==budgetRequests[i].BudgetWorkflowStatus){for(t+="  <tr>",t+='      <td><a class="aDisplayArLink" href="javascript:displayArOnTheHomePage(\''+budgetRequests[i].bwBudgetRequestId+"', '"+participantId+"', '"+budgetRequests[i].Title+"');\">"+budgetRequests[i].ProjectTitle+"<\/a><\/td>",f=0;f<BWMData[0].length;f++)if(BWMData[0][f][0]==workflowAppId)for(s=0;s<BWMData[0][f][4].length;s++)BWMData[0][f][4][s][0]==budgetRequests[i].FunctionalAreaId&&(l=BWMData[0][f][4][s][1],t+="<td>",t+=l,t+="<\/td>");t+=budgetRequests[i].ARStatus=="Rejected"?'    <td style="text-align:right;"><strike>'+formatCurrency(budgetRequests[i].BudgetAmount)+"<\/strike><\/td>":'    <td style="text-align:right;">'+formatCurrency(budgetRequests[i].BudgetAmount)+"<\/td>";t+="    <td>"+budgetRequests[i].BudgetWorkflowStatus+"<\/td>";t+="    <td>"+budgetRequests[i].ARStatus+"<\/td>";t+="    <td>"+budgetRequests[i].CurrentOwner+"<\/td>";t+='<td><img src="images/trash-can.png" class="trashcan" onclick="cmdDisplayDeleteBudgetRequestDialog(\''+budgetRequests[i].bwBudgetRequestId+"', '"+budgetRequests[i].Title+'\');" title="Delete" style="cursor:pointer;" /><\/td>';t+="  <\/tr>"}t+='<tr><td colspan="12"><\/td><\/tr>';t+="<\/table>";$("#spanBwBudgetRequests").empty();$("#spanBwBudgetRequests").append(t);document.getElementById("txtArchivePageDescriptionFilter").value=r;document.getElementById("txtArchivePageBudgetAmountFilter").value=u;n=="txtArchivePageDescriptionFilter"&&($("#"+n).focus(function(){var n=this;setTimeout(function(){n.selectionStart=n.selectionEnd=1e4},0)}),$("#"+n).focus());n=="txtArchivePageBudgetAmountFilter"&&($("#"+n).focus(function(){var n=this;setTimeout(function(){n.selectionStart=n.selectionEnd=1e4},0)}),$("#"+n).focus());$("#txtArchivePageDescriptionFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageDescriptionFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageDescriptionFilter")});$("#txtArchivePageBudgetAmountFilter").change(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#txtArchivePageBudgetAmountFilter").keyup(function(){renderArchivePageApplyingDescriptionFilter("txtArchivePageBudgetAmountFilter")});$("#ddlArchivePageFinancialAreaDropDownFilter").change(function(){renderArchivePageApplyingDescriptionFilter("ddlArchivePageFinancialAreaDropDownFilter")});$("#selectArchivePageFilterDropDown").change(function(){renderArchivePageApplyingDescriptionFilter("selectArchivePageFilterDropDown")})}function cmdListPendingBudgetRequests(){$("#spanBwPendingBudgetRequests").empty();var n={bwTenantId:tenantId,bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwbudgetrequestspending",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(n){var t="",i;for(t+='<table class="myStuffTable">',t+="  <tr>",t+="    <td>project title<\/td>",t+="    <td>requested capital<\/td>",t+="    <td>budget amount<\/td>",t+="    <td>ar status<\/td>",t+="    <td>budget workflow status<\/td>",t+="    <td>budget request id<\/td>",t+="    <td>workflow app id<\/td>",t+="    <td>functional area id<\/td>",t+="    <td>created by<\/td>",t+="    <td>created by id<\/td>",t+="    <td>created<\/td>",t+="    <td>modified by id<\/td>",t+="    <td>modified<\/td>",t+="    <td>current owner<\/td>",t+="    <td>approval level workflow token<\/td>",t+="  <\/tr>",i=0;i<n.length;i++)t+="  <tr>",t+='      <td><a class="aDisplayArLink" href="javascript:displayArOnTheHomePage(\''+n[i].bwBudgetRequestId+"', '"+participantId+"', '"+n[i].Title+"');\">"+n[i].ProjectTitle+"<\/a><\/td>",t+="    <td>"+n[i].RequestedCapital+"<\/td>",t+="    <td>"+n[i].BudgetAmount+"<\/td>",t+="    <td>"+n[i].ARStatus+"<\/td>",t+="    <td>"+n[i].BudgetWorkflowStatus+"<\/td>",t+="    <td>"+n[i].bwBudgetRequestId+"<\/td>",t+="    <td>"+n[i].bwWorkflowAppId+"<\/td>",t+="    <td>"+n[i].FunctionalAreaId+"<\/td>",t+="    <td>"+n[i].CreatedBy+"<\/td>",t+="    <td>"+n[i].CreatedById+"<\/td>",t+="    <td>"+n[i].Created+"<\/td>",t+="    <td>"+n[i].ModifiedById+"<\/td>",t+="    <td>"+n[i].Modified+"<\/td>",t+="    <td>"+n[i].CurrentOwner+"<\/td>",t+="    <td>"+n[i].bwApprovalLevelWorkflowToken+"<\/td>",t+="  <\/tr>";t+='<tr><td colspan="13">DONE<\/td><\/tr>';t+="<\/table>";$("#spanBwPendingBudgetRequests").append(t)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdListPendingBudgetRequests():"+t+", "+i)}})}function addInLicenseCheck(){try{var n=SP.ClientContext.get_current(),t=SP.Utilities.Utility.getAppLicenseInformation(n,"ea5f27c4-6885-43fb-8935-2cdaf759d549");n.executeQueryAsync(function(){var r;if(t.get_count()>0){var u=t.get_item(0).get_rawXMLLicenseToken(),f=encodeURIComponent(u),i=new SP.WebRequestInfo;i.set_url("https://verificationservice.officeapps.live.com/ova/verificationagent.svc/rest/verify?token="+f);i.set_method("GET");r=SP.WebProxy.invoke(n,i);n.executeQueryAsync(function(){var n=r.get_body();n==null?displayFreeTrialExpiredDialog():$(n).find("IsValid").text()=="true"||displayFreeTrialExpiredDialog()},function(){displayFreeTrialExpiredDialog()})}else displayFreeTrialExpiredDialog()},function(){displayFreeTrialExpiredDialog()})}catch(i){displayAlertDialog("Error in Start.js.addInLicenseCheck()",i.message)}}function handleExceptionWithAlert(n,t){displayAlertDialog(n+": "+t)}function refreshThePage(){try{populateStartPageItem("divSummaryReport","Reports","")}catch(n){displayAlertDialog("Error in Start.js.refreshThePage()",n.message)}}function cmdYearSelectedChanged(){try{displayAlertDialog("In cmdYearSelectedChanged(). Code needed here.")}catch(n){displayAlertDialog("Error in Start.js.cmdYearSelectedChanged()",n.message)}}function displayFreeTrialExpiredDialog(){var t,i,n,r;try{t=450;i=250;try{navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)?(t=950,i=675):navigator.userAgent.toLowerCase().indexOf("android")>-1?(t=950,i=850):navigator.userAgent.toLowerCase().indexOf("nokia")>-1?(t=950,i=950):navigator.userAgent.toLowerCase().indexOf("mobile safari")>-1?(t=950,i=950):navigator.userAgent.toLowerCase().indexOf("playbook")>-1?(t=950,i=700):navigator.userAgent.toLowerCase().indexOf("silk")>-1?(t=950,i=600):(t=450,i=300)}catch(u){}$("#trialVersionHasExpired").dialog({modal:!0,resizable:!1,width:t,height:i,hide:!1});$("#ui-id-1").parent().hide();$("#ui-id-1").parent().parent().css("background","white");n="";try{navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)?(n+='<table style="font-size:36px;">',n+="   <tr>",n+="       <td>",n+='           <br /><a href="http://budgetworkflow.com/purchase-budget-workflow-manager" target="_blank">This free trial has expired. <br /><br />Click here to find out how to purchase!<\/a>',n+="           <br /><br />OR<br /><br />",n+='           <a href="http://budgetworkflow.com/budget-workflow-manager-suggestions" target="_blank">Click here to send us suggestions for improvements. If they make it into the next version, we\'ll give you a copy for FREE!<\/a>',n+="       <\/td>",n+="   <\/tr>",n+="<\/table>"):navigator.userAgent.toLowerCase().indexOf("android")>-1?(n+='<table style="font-size:36px;">',n+="   <tr>",n+="       <td>",n+='           <br /><a href="http://budgetworkflow.com/purchase-budget-workflow-manager" target="_blank">This free trial has expired. <br /><br />Click here to find out how to purchase!<\/a>',n+="           <br /><br />OR<br /><br />",n+='           <a href="http://budgetworkflow.com/budget-workflow-manager-suggestions" target="_blank">Click here to send us suggestions for improvements. If they make it into the next version, we\'ll give you a copy for FREE!<\/a>',n+="       <\/td>",n+="   <\/tr>",n+="<\/table>"):navigator.userAgent.toLowerCase().indexOf("nokia")>-1?(n+='<table style="font-size:36px;">',n+="   <tr>",n+="       <td>",n+='           <br /><a href="http://budgetworkflow.com/purchase-budget-workflow-manager" target="_blank">This free trial has expired. <br /><br />Click here to find out how to purchase!<\/a>',n+="           <br /><br />OR<br /><br />",n+='           <a href="http://budgetworkflow.com/budget-workflow-manager-suggestions" target="_blank">Click here to send us suggestions for improvements. If they make it into the next version, we\'ll give you a copy for FREE!<\/a>',n+="       <\/td>",n+="   <\/tr>",n+="<\/table>"):navigator.userAgent.toLowerCase().indexOf("mobile safari")>-1?(n+='<table style="font-size:36px;">',n+="   <tr>",n+="       <td>",n+='           <br /><a href="http://budgetworkflow.com/purchase-budget-workflow-manager" target="_blank">This free trial has expired. <br /><br />Click here to find out how to purchase!<\/a>',n+="           <br /><br />OR<br /><br />",n+='           <a href="http://budgetworkflow.com/budget-workflow-manager-suggestions" target="_blank">Click here to send us suggestions for improvements. If they make it into the next version, we\'ll give you a copy for FREE!<\/a>',n+="       <\/td>",n+="   <\/tr>",n+="<\/table>"):navigator.userAgent.toLowerCase().indexOf("playbook")>-1?(n+='<table style="font-size:36px;">',n+="   <tr>",n+="       <td>",n+='           <br /><a href="http://budgetworkflow.com/purchase-budget-workflow-manager" target="_blank">This free trial has expired. <br /><br />Click here to find out how to purchase!<\/a>',n+="           <br /><br />OR<br /><br />",n+='           <a href="http://budgetworkflow.com/budget-workflow-manager-suggestions" target="_blank">Click here to send us suggestions for improvements. If they make it into the next version, we\'ll give you a copy for FREE!<\/a>',n+="       <\/td>",n+="   <\/tr>",n+="<\/table>"):navigator.userAgent.toLowerCase().indexOf("silk")>-1?(n+='<table style="font-size:36px;">',n+="   <tr>",n+="       <td>",n+='           <br /><a href="http://budgetworkflow.com/purchase-budget-workflow-manager" target="_blank">This free trial has expired. <br /><br />Click here to find out how to purchase!<\/a>',n+="           <br /><br />OR<br /><br />",n+='           <a href="http://budgetworkflow.com/budget-workflow-manager-suggestions" target="_blank">Click here to send us suggestions for improvements. If they make it into the next version, we\'ll give you a copy for FREE!<\/a>',n+="       <\/td>",n+="   <\/tr>",n+="<\/table>"):(n+="<table>",n+="   <tr>",n+='       <td style="font-size:large;">',n+='           <br /><a href="http://budgetworkflow.com/purchase-budget-workflow-manager" target="_blank">This free trial has expired. <br /><br />Click here to find out how to purchase!<\/a>',n+="           <br /><br />OR<br /><br />",n+='           <a href="http://budgetworkflow.com/budget-workflow-manager-suggestions" target="_blank">Click here to send us suggestions for improvements. If they make it into the next version, we\'ll give you a copy for FREE!<\/a>',n+="       <\/td>",n+="   <\/tr>",n+="<\/table>")}catch(u){}$("#trialVersionHasExpired").append(n);r=function(n,t,i){n!=null&&typeof n!="undefined"&&(n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent?n.attachEvent("on"+t,i):n["on"+t]=i)};r(window,"resize",function(){var n={width:$(window).width(),height:$(window).height()},r=n.width,u=n.height,f=r/2-t/2,e=u/2-i/2;$("#trialVersionHasExpired").dialog().position().left=f})}catch(u){displayAlertDialog("Error in Start.js.displayFreeTrialExpiredDialog()",u.message)}}function setCustomSizesDependingOnTheDevice(){try{navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.toLowerCase().indexOf("android")>-1||navigator.userAgent.toLowerCase().indexOf("nokia")>-1||navigator.userAgent.toLowerCase().indexOf("mobile safari")>-1||navigator.userAgent.toLowerCase().indexOf("playbook")>-1||navigator.userAgent.toLowerCase().indexOf("silk")>-1}catch(n){displayAlertDialog("Error in Start.js.setCustomSizesDependingOnTheDevice()",n.message)}}function loadSingleWorkflowConfigurationDetails9(n,t){try{var i=webserviceurl+"/getfunctionalareasbyappid/"+workflowAppId+"/RETURNALL";$.ajax({url:i,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){for(var r,i=0;i<n.d.results.length;i++)for(r=[Number(n.d.results[i].bwFunctionalAreaYear)],n.d.results[i].bwFunctionalAreaQuote==!0?BWMData[1][1].push(r):BWMData[1][0].push(r),BWMData[0][t][4].length=n.d.results.length,i=0;i<n.d.results.length;i++){var u=[n.d.results[i].Approver1Id,n.d.results[i].Approver1FriendlyName,n.d.results[i].Approver1Email],f=[n.d.results[i].Approver2Id,n.d.results[i].Approver2FriendlyName,n.d.results[i].Approver2Email],e=[n.d.results[i].Approver3Id,n.d.results[i].Approver3FriendlyName,n.d.results[i].Approver3Email,n.d.results[i].Approval3BudgetThreshold],o=[n.d.results[i].Approver4Id,n.d.results[i].Approver4FriendlyName,n.d.results[i].Approver4Email,n.d.results[i].Approval4BudgetThreshold],s=[n.d.results[i].Approver5Id,n.d.results[i].Approver5FriendlyName,n.d.results[i].Approver5Email,n.d.results[i].Approval5BudgetThreshold],h=[n.d.results[i].Approver6Id,n.d.results[i].Approver6FriendlyName,n.d.results[i].Approver6Email,n.d.results[i].Approval6BudgetThreshold],c=[n.d.results[i].Approver7Id,n.d.results[i].Approver7FriendlyName,n.d.results[i].Approver7Email,n.d.results[i].Approval7BudgetThreshold],l=[n.d.results[i].Approver8Id,n.d.results[i].Approver8FriendlyName,n.d.results[i].Approver8Email,n.d.results[i].Approval8BudgetThreshold],a=[n.d.results[i].Approver9Id,n.d.results[i].Approver9FriendlyName,n.d.results[i].Approver9Email,n.d.results[i].Approval9BudgetThreshold],v=[n.d.results[i].Approver10Id,n.d.results[i].Approver10FriendlyName,n.d.results[i].Approver10Email,n.d.results[i].Approval10BudgetThreshold],y=[e,o,s,h,c,l,a,v],p=[n.d.results[i].bwFunctionalAreaId,n.d.results[i].bwFunctionalAreaTitle,n.d.results[i].bwFunctionalAreaQuote,Number(n.d.results[i].bwFunctionalAreaYear),Number(n.d.results[i].bwFunctionalAreaYearlyBudget),u,f,y,0,0,0,[],null,n.d.results[i].IsHidden];BWMData[0][t][4][i]=p}GetWorkflowAppConfigurationData[t].resolve()},error:function(n,i,r){i=="-1002"?displayAlertDialog("Error in ios8.js.loadSingleWorkflowConfigurationDetails9()","1:"+i+", "+r):(GetWorkflowAppConfigurationData[t].resolve(),displayAlertDialog("Error in ios8.js.loadSingleWorkflowConfigurationDetails9()","2:"+i+", "+r))}})}catch(r){GetWorkflowAppConfigurationData[t].resolve();displayAlertDialog("Error in ios8.js.loadSingleWorkflowConfigurationDetails9()","3:"+r.message)}}function thereAreNoConnectedWorkflowsSoDisplayTheConfigurationScreenAppropriately(){try{populateStartPageItem("divConfiguration","","")}catch(n){displayAlertDialog("Error in Start.js.thereAreNoConnectedWorkflowsSoDisplayTheConfigurationScreenAppropriately()",n.message)}}function collapseOrExpandBwFunctionalAreaDiv(n,t){var i,r,u,f,s;try{if(i=document.getElementById(n),r=i.style.visibility,r=="")i.style.visibility="hidden",$("#"+n).hide();else if(r=="visible")i.style.visibility="hidden",$("#"+n).hide();else if(r=="hidden"){var h="functionalAreaRow_"+t.toString()+"_Top_1",c="functionalAreaRow_"+t.toString()+"_Top_2",e=document.getElementById(h),o=document.getElementById(c);try{e.style.visibility="hidden";e.style.display="none";o.style.visibility="hidden";o.style.display="none"}catch(l){}i.style.visibility="visible";$("#"+n).show();try{for(u=0;u<1e3;u++)f="functionalAreaRow_"+t.toString()+"_"+u.toString(),s=document.getElementById(f),s.style.visibility="visible",$("#"+f).show()}catch(l){}}else i.style.visibility="hidden",$("#"+n).hide()}catch(l){}}function expandFunctionalAreaAndRenderAlerts(n,t,i){var e,h,c,r,l;try{var o=BWMData[0][t][1],a=$("#"+i)[0].innerHTML,u="functionalAreaRow_"+t.toString()+"_Top_1",f="functionalAreaRow_"+t.toString()+"_Top_2",s=document.getElementById(u),v=document.getElementById(f),y=document.getElementById(i);if(s.style.visibility=="visible")try{for(r=0;r<1e3;r++)e="functionalAreaRow_"+t.toString()+"_"+r.toString(),h=document.getElementById(e),h.style.visibility="visible",$("#"+e).show()}catch(p){}for($("#"+u)[0].innerHTML=a,s.style.visibility="visible",$("#"+u).show(),$("#"+u).find(".bwFADrillDownLinkCell").css({"background-color":"white",color:"#444",cursor:"default"}),y.style.visibility="hidden",$("#"+i).hide(),r=0;r<BWMData[0][t][4].length;r++)BWMData[0][t][4][r][1]==n&&(c=BWMData[0][t][4][r][0]);l=webserviceurl+"/bwbudgetrequests/getbyfunctionalareaid/"+c;$.ajax({url:l,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){for(var h,u,e,s=[],r=0;r<i.d.results.length;r++)h=[],h.push(o),h.push(i.d.results[r].ProjectTitle),h.push(i.d.results[r].BudgetAmount),h.push(i.d.results[r].bwBudgetRequestId),h.push(i.d.results[r].CurrentOwner),h.push(i.d.results[r].Title),h.push(i.d.results[r].Created),(i.d.results[r].ARStatus=="Submitted"||i.d.results[r].ARStatus=="Approved"&&(i.d.results[r].BudgetWorkflowStatus=="Procurement: Issue PO#"||i.d.results[r].BudgetWorkflowStatus=="Issue PO#: Additional Info Needed"))&&s.push(h);for(u="",r=0;r<BWMData[0][t][4].length;r++)if(BWMData[0][t][4][r][1]==n){for(u+="<tr>",u+='    <td colspan="7">',u+="        <table>",e=0;e<s.length;e++)u+="        <tr>",u+='            <td style="width:90px;"><\/td>',u+="            <td>&nbsp;&nbsp;<\/td>",u+='            <td style="background-color:#d8d8d8;padding:10px 10px 10px 10px;" class="tdHomePageSubNotificationIos8" colspan="5"><a style="cursor:pointer;" onclick="$(\'.bwRequest\').bwRequest(\'displayArInMobileTab\', \''+o+"', '"+s[e][3]+"', '"+s[e][5]+"', '"+encodeHtmlAttribute(s[e][1])+"', '"+s[e][5]+'\');" target="_blank" title="Click to view the request...">'+s[e][1]+" (<em>"+formatCurrency(s[e][2])+" - Submitted "+formatDateFromBW(s[e][6])+"<\/em>)<\/a><\/td>",u+="        <\/tr>";u+="        <\/td>";u+="    <\/tr>";u+="<\/table>";u+="   <\/td>";u+="<\/tr>"}$("#"+f)[0].innerHTML=u;v.style.visibility="visible";$("#"+f).show()},error:function(n,t,i){displayAlertDialog("Error in ios8.js.expandFunctionalAreaAndRenderAlerts()","1:"+t+", "+i)}})}catch(p){displayAlertDialog("Error in ios8.js.expandFunctionalAreaAndRenderAlerts()","2:"+p.message)}}function getUserDetails(n,t,i){try{var u=webserviceurl+"/bwparticipants/getuserdetailsbyparticipantid/"+n;$.ajax({url:u,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var t=new Array(3);n.d.results.length>0&&(t[0]=n.d.results[0].bwParticipantId,t[1]=n.d.results[0].bwParticipantFriendlyName,t[2]=n.d.results[0].bwParticipantEmail);GetUserDetails[i].resolve(t)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.getUserDetails():1: "+t+", "+i+" Most likely service unavailable issue.")}})}catch(r){displayAlertDialog("Error in ios8.js.getUserDetails():2: "+r.message+" "+r.stack)}}function arDialogFailedSoCallItAgain(n,t,i,r,u){clearInterval(arDialogDisplayRetryAttemptTimerObject);arDialogDisplayRetryAttemptTimerObject=null;document.getElementById("spanArDialogContents").innerHTML==""&&($("#ArDialog").dialog("close"),arDialogDisplayRetryAttempt+=1,WriteToErrorLog("arDialogFailedSoCallItAgain()","spanArDialogContents is empty, so calling displayArInDialog() again. arDialogDisplayRetryAttempt: "+arDialogDisplayRetryAttempt),displayArInDialog(n,t,i,r,u))}function selectArForAttachmentSearchDialog(n,t,i,r,u){var o,e,l,a,f,s,h,v;try{for(displayArOnTheHomePage(t,participantId,u),o=t,$("#divAttachSharedFileFromIosDialog").dialog("close"),$("#divFileUploadSpinnerDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"970px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divFileUploadSpinnerDialog").dialog("close")})}}),$("#divFileUploadSpinnerDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),document.getElementById("spanFileUploadSpinnerDialogTitle").innerHTML="xUploading "+sharedFileFromIosFileName+"...",WriteToErrorLog("In selectArForAttachmentSearchDialog():2.","bwBudgetRequestId:"+o),e=atob(sharedFileFromIosFileContents),l=new Uint8Array(e.length),f=0,s=e.length;f<s;++f)l[f]=e.charCodeAt(f);for(a="",f=0,s=e.length;f<s;++f)a+=String.fromCharCode(l[f]);h=[];h={bwWorkflowAppId:workflowAppId,bwBudgetRequestId:o,Filename:sharedFileFromIosFileName,FileContent:a,Description:sharedFileFromIosFileDescription};v=globalUrlPrefix+globalUrlForWebServices+"/_files/uploadattachment";console.log("In ios8.js.attachSharedFileFromIosToANewRequest(). Preparing to upload using operationUri: "+v+", fileAndData: "+JSON.stringify(h));$.ajax({url:v,type:"PUT",data:h,headers:{Accept:"application/json; odata=verbose"},success:function(n){$("#divFileUploadSpinnerDialog").dialog("close");$("#divAttachSharedFileFromIosToAnExistingRequestDialog").dialog("close");console.log("in ios8.js.selectArForAttachmentSearchDialog(). SUCCESSS UPLOADING FILE! response data: "+JSON.stringify(n));populateAttachments(workflowAppId,o,"newrequestattachments")},error:function(n,t,i){console.log("Error in ios8.js.selectArForAttachmentSearchDialog(): data: "+JSON.stringify(n)+", errorCode: "+t+", errorMessage: "+i)}})}catch(c){console.log("Exception in ios8.js.selectArForAttachmentSearchDialog(): "+c.message+", "+c.stack);displayAlertDialog("Exception in ios8.js.selectArForAttachmentSearchDialog(): "+c.message+", "+c.stack)}}function selectOfflineArForAttachmentSearchDialog(n){var r,c,f,s,i,t,e,o,l,h;try{displayCachedArOnTheHomePage(n,"no-title-we-need-it-in-selectOfflineArForAttachmentSearchDialog()");try{$("#divAttachSharedFileFromIosToAnExistingOfflineRequestDialog").dialog("close")}catch(u){}try{$("#divAttachSharedFileFromIosDialog").dialog("close")}catch(u){}if(r="attachmentsInXslForm",c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)){for(f=atob(sharedFileFromIosFileContents),i=new Uint8Array(f.length),t=0,e=f.length;t<e;++t)i[t]=f.charCodeAt(t);o=i.buffer;console.log("In selectOfflineArForAttachmentSearchDialog. THIS IS THE WORKAROUND FOR THE IOS STORING BLOB IN INDEXDB ISSUE");l={encodingType:"uInt8Array",fileContents:o,fileName:sharedFileFromIosFileName,fileDescription:sharedFileFromIosFileDescription,bwBudgetRequestId:n,id:c}}else{for(s=atob(sharedFileFromIosFileContents),i=new Uint8Array(s.length),t=0,e=s.length;t<e;++t)i[t]=s.charCodeAt(t);o=new Blob([i.buffer],{type:"image/jpeg"});l={encodingType:"blob",fileContents:o,fileName:sharedFileFromIosFileName,fileDescription:sharedFileFromIosFileDescription,bwBudgetRequestId:n,id:c}}h=indexedDB.open(indexDBName,dbVersion);h.onblocked=function(n){console.error(n.target);console.log("In ios8.js.selectOfflineArForAttachmentSearchDialog().request.onblocked: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In ios8.js.selectOfflineArForAttachmentSearchDialog().request.onblocked: "+n.target.error.name||n.target.error||n.target.errorCode)};h.onerror=function(n){console.error(n.target);console.log("In ios8.js.selectOfflineArForAttachmentSearchDialog().request.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In ios8.js.selectOfflineArForAttachmentSearchDialog().request.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)};h.onsuccess=function(t){var f,e,u;try{console.log("In ios8.js.selectOfflineArForAttachmentSearchDialog().request.onsuccess. Success accessing IndexedDB database.");f=t.target.result;f.onerror=function(n){console.error(n.target);console.log("In ios8.js.selectOfflineArForAttachmentSearchDialog().db.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In ios8.js.selectOfflineArForAttachmentSearchDialog().db.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)};try{e=f.transaction("OfflineAttachedFiles","readwrite")}catch(i){console.log("In ios8.js.selectOfflineArForAttachmentSearchDialog(). ERROR ACCESSING OfflineAttachedFiles DATABASE11!!!!!!!!!!!!"+i.message+", "+i.stack);displayAlertDialog("In ios8.js.selectOfflineArForAttachmentSearchDialog(). ERROR ACCESSING OfflineAttachedFiles DATABASE11!!!!!!!!!!!!"+i.message+", "+i.stack)}try{u=e.objectStore("OfflineAttachedFiles").add(l)}catch(i){console.log("In ios8.js.selectOfflineArForAttachmentSearchDialog(). ERROR ACCESSING OfflineAttachedFiles DATABASE22!!!!!!!!!!!!"+i.message+", "+i.stack);displayAlertDialog("In ios8.js.selectOfflineArForAttachmentSearchDialog(). ERROR ACCESSING OfflineAttachedFiles DATABASE22!!!!!!!!!!!!"+i.message+", "+i.stack)}console.log("In ios8.js.selectOfflineArForAttachmentSearchDialog(). Successfully executed var put = transaction.objectStore(OfflineAttachedFiles).add(dbRecord);");u.onsuccess=function(){try{console.log("In ios8.js.selectOfflineArForAttachmentSearchDialog(). Successfully stored file in the database for bwBudgetRequestId: "+n);try{$("#divFileUploadSpinnerDialog").dialog("close")}catch(t){}$("#"+r)[0].innerHTML="";populateOfflineAttachments(r)}catch(t){console.log("Exception in ios8.js.selectOfflineArForAttachmentSearchDialog("+r+").put.onsuccess:11: "+t.message+", "+t.stack);displayAlertDialog("Exception in ios8.js.selectOfflineArForAttachmentSearchDialog("+r+").put.onsuccess:11: "+t.message+", "+t.stack)}};u.onerror=function(n){console.error(n.target);console.log("In ios8.js.selectOfflineArForAttachmentSearchDialog().put.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In ios8.js.selectOfflineArForAttachmentSearchDialog().put.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)};u.transaction.oncomplete=function(n){console.log("In ios8.js.selectOfflineArForAttachmentSearchDialog().put.transaction.oncomplete: "+n)};u.transaction.onerror=function(n){console.log("In ios8.js.selectOfflineArForAttachmentSearchDialog().put.transaction.onerror: "+n.target.error.name||n.target.error||n.target.errorCode);displayAlertDialog("In ios8.js.selectOfflineArForAttachmentSearchDialog().put.transaction.onerror: "+n.target.error.name||n.target.error||n.target.errorCode)}}catch(i){console.log("Exception in ios8.js.selectOfflineArForAttachmentSearchDialog(). indexDBName: "+indexDBName+", dbVersion: "+dbVersion+", error: "+i.message+", "+i.stack)}}}catch(u){console.log("Exception in ios8.js.selectOfflineArForAttachmentSearchDialog(): "+u.message+", "+u.stack);displayAlertDialog("Exception in ios8.js.selectOfflineArForAttachmentSearchDialog(): "+u.message+", "+u.stack)}}function setIOSAppToYes(){iOSApp="YES";$(".bwImgSwitchPlatform").hide()}function switchToLargeDevice(){setCookie("userselecteddeviceplatform","DESKTOP");window.location="https://budgetworkflow.com"}function userHasStartedRecordingAnAudioMemo(){var n="";n+='<a href="https://budgetworkflow.com?memo=stoprecordingaudio" target="_blank" style="font-size:40pt;">Click here to stop recording a memo.<\/a>';document.getElementById("spanRecordAMemoLink").innerHTML=n}function displayRecordAVoiceMemoDialog(){try{$("#divRecordAVoiceMemoDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Sign Up",width:"760",dialogClass:"no-close",hide:!1});$("#divRecordAVoiceMemoDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}catch(n){displayAlertDialog("Error in startRecordingMemo: "+n.message)}}function uploadAudioMemo(n){$("#divRecordAVoiceMemoDialog").dialog("close");$("#divConfirmFileUploadDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Sign Up",width:"760",dialogClass:"no-close",hide:!1});$("#divConfirmFileUploadDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("txtConfirmFileUploadDialogFilename").value=n;$("#btnUploadTheFileNow").off("click").click(function(){$("#divConfirmFileUploadDialog").dialog("close");$("#divWorkingOnItDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Working on it...",width:"800",dialogClass:"no-close",hide:!1});$("#divWorkingOnItDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();ProcessUploadForIOS(n,"xxxx")});$("#btnCancelUploadTheFileNow").off("click").click(function(){$("#divConfirmFileUploadDialog").dialog("close");$("#inputFile").replaceWith($("#inputFile").clone())})}function displayAttachmentInDialog(n,t,i,r){var u;try{if(console.log('Launching ios8.js.displayAttachmentInDialog("'+n+'", "'+t+'", "'+i+'", "'+r+'").'),$("#divAttachmentsDialog1Contents").empty(),$("#AttachmentsDialog1").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#AttachmentsDialog1").dialog("close")})}}),$("#AttachmentsDialog1").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),u="",n.toUpperCase().indexOf(".PNG")!=-1||n.toUpperCase().indexOf(".JPG")!=-1||n.toUpperCase().indexOf(".JPEG")!=-1||n.toUpperCase().indexOf(".BMP")!=-1||n.toUpperCase().indexOf(".GIF")!=-1||n.toUpperCase().indexOf(".TIFF")!=-1||n.toUpperCase().indexOf(".SVG")!=-1?($("#spanAttachmentsDialog1Title").html("Select the thumbnail to view the actual image..."),u+='<img src="'+n+'" style="width:700px;display:block;margin-left:auto;margin-right:auto;cursor:pointer;" onclick="displayFullSizedAttachmentInDialog(\''+n+"');\" />"):n.toUpperCase().indexOf(".PDF")!=-1||n.toUpperCase().indexOf(".RTF")!=-1||n.toUpperCase().indexOf(".DOC")!=-1||n.toUpperCase().indexOf(".DOCX")!=-1||n.toUpperCase().indexOf(".XSL")!=-1||n.toUpperCase().indexOf(".XSLX")!=-1||n.toUpperCase().indexOf(".TXT")!=-1||n.toUpperCase().indexOf(".ODT")!=-1||n.toUpperCase().indexOf(".ODS")!=-1||n.toUpperCase().indexOf(".ODP")!=-1?($("#spanAttachmentsDialog1Title").html("Select the link below to view the document..."),u+='<a href="'+n+'" target="_blank">Click here to view the document<\/a>'):n.toUpperCase().indexOf(".MP3")!=-1||n.toUpperCase().indexOf(".M4A")!=-1||n.toUpperCase().indexOf(".M4R")!=-1?($("#spanAttachmentsDialog1Title").html("Select the link below to listen..."),u+=iOSApp=="YES"?'<a href="'+n+'">Click here to listen<\/a>':'<audio src="'+n+'" controls="controls">Click here to listen<\/audio>'):n.toUpperCase().indexOf(".M4V")!=-1||n.toUpperCase().indexOf(".AVI")!=-1||n.toUpperCase().indexOf(".MOV")!=-1||n.toUpperCase().indexOf(".MP4")!=-1?($("#spanAttachmentsDialog1Title").html("Select the link below to view..."),u+=iOSApp=="YES"?'<a href="'+n+'">Click here to view<\/a>':'<audio src="'+n+'" controls="controls">Click here to view<\/audio>'):($("#spanAttachmentsDialog1Title").html("This attachment has an unknown file extension..."),u+='<a href="'+n+'" target="_blank">Click here to try to open this file<\/a>'),$("#divAttachmentsDialog1Contents").html(u),u="",u+='<div id="btnAttachmentsDialog1SaveMetadata" class="divDialogButton" onclick="cmdSaveAttachmentMetadata(\''+r+"', '"+t+"');\">Save<\/div>",$("#spanAttachmentsDialog1SaveMetadataButton").html(u),u="",u+='<div id="btnAttachmentsDialog1DeleteAttachment" class="divDialogButton" onclick="cmdDeleteAttachment(\''+r+"', '"+t+"');\">Delete<\/div>",$("#spanAttachmentsDialog1DeleteAttachmentButton").html(u),t!="undefined"){var f=t.lastIndexOf("."),e=t.substring(0,f),o="."+t.substring(f+1,t.length);document.getElementById("txtAttachmentsDialog1Filename").value=e;document.getElementById("spanAttachmentsDialog1FileExtension").innerHTML=o}else document.getElementById("txtAttachmentsDialog1Filename").value="";document.getElementById("txtAttachmentsDialog1FileDescription").value=t!="description"?i:""}catch(s){displayAlertDialog("Error in ios8.js.displayAttachmentInDialog():2:"+s.message+n)}}function displayFullSizedAttachmentInDialog(n){try{$("#AttachmentsDialog1").dialog("close");$("#divAttachmentsDialog2Contents").empty();$("#AttachmentsDialog2").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#AttachmentsDialog2").dialog("close")})}});$("#AttachmentsDialog2").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();var t="";t+=n.toUpperCase().indexOf(".PNG")!=-1||n.toUpperCase().indexOf(".JPG")!=-1||n.toUpperCase().indexOf(".JPEG")!=-1?'<img src="'+n+'" style="display:block;margin-left:auto;margin-right:auto;" />':'<span style="font-size:40pt;">Unknown file extension<\/span>';$("#divAttachmentsDialog2Contents").html(t)}catch(i){displayAlertDialog("Error in ios8.js.displayFullSizedAttachmentInDialog()","2:"+i.message+n)}}function cmdDeleteAttachment(n,t){try{console.log("In ios8.js.cmdDeleteAttachment("+n+", "+t+").");$("#divDeleteAnAttachmentOfflineDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"570px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divDeleteAnAttachmentOfflineDialog").dialog("close")})}});$("#divDeleteAnAttachmentOfflineDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();document.getElementById("spanDeleteAnAttachmentOfflineDialogTitle").innerHTML="Delete "+t;$("#divDeleteAnAttachmentOfflineDialogDeleteRequestButton").off("click").click(function(){var u=globalUrlPrefix+globalUrlForWebServices+"/_files",i=[],r;i={bwBudgetRequestId:n,Filename:t};r=u+"/removeattachment";$.ajax({url:r,type:"POST",timeout:ajaxTimeout,data:i,headers:{Accept:"application/json; odata=verbose"},success:function(t){$("#divDeleteAnAttachmentOfflineDialog").dialog("close");JSON.stringify(t).toUpperCase().indexOf("THE FILE WAS DELETED")>-1?($("#AttachmentsDialog1").dialog("close"),populateAttachments(workflowAppId,n,"attachmentsInXslForm",!0)):displayAlertDialog("There was an error deleting the file: "+JSON.stringify(t))},error:function(i,r,u){displayAlertDialog("Error In ios8.js.cmdDeleteAttachment("+n+", "+t+").removeattachment: "+u)}})})}catch(i){displayAlertDialog("Error In ios8.js.cmdDeleteAttachment("+n+", "+t+"): "+i.message)}}function cmdSaveAttachmentMetadata(n,t){var r;try{var f=document.getElementById("txtAttachmentsDialog1Filename").value+document.getElementById("spanAttachmentsDialog1FileExtension").innerHTML,e=document.getElementById("txtAttachmentsDialog1FileDescription").value.replace(/["']/g,""),o=globalUrlPrefix+globalUrlForWebServices+"/_files",i=[];i={bwWorkflowAppId:workflowAppId,bwBudgetRequestId:n,OriginalFilename:t,NewFilename:f,Description:e};r=o+"/saveattachmentmetadata";$.ajax({url:r,type:"POST",timeout:ajaxTimeout,data:i,headers:{Accept:"application/json; odata=verbose"},success:function(t){JSON.stringify(t).toUpperCase().indexOf("THE FILE WAS SAVED")>-1?($("#AttachmentsDialog1").dialog("close"),document.getElementById("attachmentsInXslForm")?populateAttachments(workflowAppId,n,"attachmentsInXslForm",!0):populateAttachments(workflowAppId,n,"newrequestattachments",!0)):displayAlertDialog("Failed to update metadata: "+JSON.stringify(t))},error:function(n,t,i){$("#AttachmentsDialog1").dialog("close");displayAlertDialog("Error in ios8.js.cmdSaveAttachmentMetadata().saveattachmentmetadata: "+n+", "+i)}})}catch(u){displayAlertDialog("Error in ios8.js.cmdSaveAttachmentMetadata(): "+u.message+", "+u.stack)}}function displayRecurringExpenseInDialog(){var i=$('span[xd\\:binding = "my:RecurringExpenseId"]')[0].innerHTML,n=[],t;n={bwRecurringExpenseId:i};t=webserviceurl+"/bwrecurringexpense/getrelatedbudgetrequests";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){var r=n.RecurringExpense[0].ProjectTitle,u=n.RecurringExpense[0].Title,t,i;if($("#spanRecurringExpenseDialogBudgetRequestsList").empty(),$("#RecurringExpenseDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#RecurringExpenseDialog").dialog("close")})}}),$("#RecurringExpenseDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove(),document.getElementById("spanRecurringExpenseDialogTitle").innerHTML='Recurring Expense "'+r+'" <span style="white-space:nowrap;">(RE&#8209;18000x)<\/span>',document.getElementById("spanRecurringExpenseDialogContents2").innerHTML=r+" ("+u+")",n.BudgetRequests.length==0)t="",t+="<span>",t+="No budget requests have been submitted for this recurring expense yet.",t+="<\/span>",$(t).appendTo($("#spanRecurringExpenseDialogBudgetRequestsList"));else{for(t="",t+='<span style="cursor:help;" title="Created by '+n.RecurringExpense[0].CreatedByEmail+" on "+formatDateAndTimeFromBW(n.RecurringExpense[0].Created)+'.">This recurring expense was created by '+n.RecurringExpense[0].CreatedBy+' <span style="white-space:nowrap;">on '+formatDateFromBW(n.RecurringExpense[0].Created)+".<\/span><\/span><br /><br />",t+="<span>Since then, the following new budget requests have been created:<\/span><br />",i=0;i<n.BudgetRequests.length;i++){var f=n.BudgetRequests[i].ProjectTitle,u=n.BudgetRequests[i].Title,e=n.BudgetRequests[i].BudgetWorkflowStatus,o=n.BudgetRequests[i].Modified,s=n.BudgetRequests[i].ModifiedByFriendlyName;t+="<span>";t+=o+" - "+f+" ("+e+" "+s+")";t+="<\/span>";t+="<br />"}$(t).appendTo($("#spanRecurringExpenseDialogBudgetRequestsList"))}},error:function(n,t,i){displayAlertDialog("Error in ios8.js.displayRecurringExpenseInDialog(): "+i)}})}function checkForAlerts(){try{var n={bwTenantId:tenantId,bwWorkflowAppId:workflowAppId,bwParticipantId:participantId},t=webserviceurl+"/bwtasksoutstanding";$.ajax({url:t,type:"DELETE",contentType:"application/json",data:n,success:function(n){n.length>0?($("#spanAlertLink").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkNewRequest").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkMyStuff").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkSummary").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkConfiguration").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkHelp").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;")):($("#spanAlertLink").html("&nbsp;"),$("#spanAlertLinkNewRequest").html("&nbsp;"),$("#spanAlertLinkMyStuff").html("&nbsp;"),$("#spanAlertLinkSummary").html("&nbsp;"),$("#spanAlertLinkConfiguration").html("&nbsp;"),$("#spanAlertLinkHelp").html("&nbsp;"))},error:function(){$("#spanAlertLink").html("error!&nbsp;&nbsp;&nbsp;&nbsp;");$("#spanAlertLinkNewRequest").html("error!&nbsp;&nbsp;&nbsp;&nbsp;");$("#spanAlertLinkMyStuff").html("error!&nbsp;&nbsp;&nbsp;&nbsp;");$("#spanAlertLinkSummary").html("error!&nbsp;&nbsp;&nbsp;&nbsp;");$("#spanAlertLinkConfiguration").html("error!&nbsp;&nbsp;&nbsp;&nbsp;");$("#spanAlertLinkHelp").html("error!&nbsp;&nbsp;&nbsp;&nbsp;")}})}catch(i){$("#spanAlertLink").html("error!&nbsp;&nbsp;&nbsp;&nbsp;");$("#spanAlertLinkNewRequest").html("error!&nbsp;&nbsp;&nbsp;&nbsp;");$("#spanAlertLinkMyStuff").html("error!&nbsp;&nbsp;&nbsp;&nbsp;");$("#spanAlertLinkSummary").html("error!&nbsp;&nbsp;&nbsp;&nbsp;");$("#spanAlertLinkConfiguration").html("error!&nbsp;&nbsp;&nbsp;&nbsp;");$("#spanAlertLinkHelp").html("error!&nbsp;&nbsp;&nbsp;&nbsp;")}}function cmdDisplayArchivePageTrashbinContents(){displayAlertDialog("This functionality is incomplete. Coming soon! cmdDisplayArchivePageTrashbinContents()")}function cmdDisplayArchivePageExtendedInformation(){displayAlertDialog("This functionality is incomplete. Coming soon! cmdDisplayArchivePageExtendedInformation()")}function cmdDisplayArchivePageRecurringExpenses(){cmdListAllRecurringExpensesUsingClientDatasetApproach()}function monkeyPatchAutocomplete(){$.ui.autocomplete.prototype._renderItem=function(n,t){var i=t.label,r=i.split("|")[0],u=i.split("|")[2];t.label=r+" ("+u+")";var f=this.term.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),e=$.trim(f).replace("  "," ").split(" ").join("|"),o=new RegExp("("+e+")","gi"),s=t.label.replace(o,'<span class="ui-menu-item-highlight">$1<\/span>');return $("<li>").append($("<a>").html(s)).appendTo(n)}}function populateStartPageItem(n){var s,h,c,l,t,i,u,r,e,a,f;try{try{$("#divIos8LeftMenu").dialog("close")}catch(o){}try{$("#divIos8SecondLeftMenu").dialog("close")}catch(o){}if(n=="divWelcomeOffline")renderWelcomePageOffline();else if(n=="divWelcome")renderWelcomeScreen(),renderAlerts(),$("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").show(),$("#liOfflineWelcome").hide(),$("#liNewRequest").hide(),$("#liArchive").hide(),$("#liSummaryReport").hide(),$("#liConfiguration").hide(),$("#liHelp").hide(),$("#liOfflineRequestForm").hide(),$("#divWelcomeMasterDiv").show(),f=document.getElementById("divWelcomeMasterDiv"),f.style.borderRadius="120px 0 0 120px",renderLeftButtons("divWelcomePageLeftButtons");else if(n=="divNewRequestOffline"){console.log('In ios8.js.populateStartPageItem("divNewRequestOffline").');try{for(s="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),document.getElementById("OfflineRequestBudgetRequestId").innerHTML=s,h="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),document.getElementById("OfflineRequestRecurringExpenseId").innerHTML=h,document.getElementById("strOfflineRequestProjectTitle").value="",document.getElementById("strOfflineRequestBriefDescriptionOfProject").value="",document.getElementById("dblOfflineRequestRequestedCapital").value="",document.getElementById("dtOfflineRequestEstimatedStartDate").value="",document.getElementById("dtOfflineRequestEstimatedEndDate").value="",document.getElementById("OfflineRequestnewrequestattachments").value="",document.getElementById("strOfflineRequestProjectTitle").innerHTML="",document.getElementById("strOfflineRequestBriefDescriptionOfProject").innerHTML="",document.getElementById("dblOfflineRequestRequestedCapital").innerHTML="",document.getElementById("OfflineRequestnewrequestattachments").innerHTML="",$("#liWelcome").hide(),$("#liOfflineWelcome").hide(),$("#liArchive").hide(),$("#liNewRequest").hide(),$("#liAbout").hide(),$("#liOfflineRequestForm").show(),t=[],t=[],r=["budgetrequest","Budget Request","selected"],t.push(r),r=["quoterequest","Quote Request",""],t.push(r),r=["expenserequest","Reimbursement Request",""],t.push(r),r=["recurringexpense","Recurring Expense",""],t.push(r),i="",i+='<span style="font-size: 350%;">New <strong>',i+='<select id="selectOfflineNewRequestFormRequestTypeDropDown" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1.0em; font-weight: bold; cursor: pointer;\'>',u=0;u<t.length;u++)i+='<option value="'+t[u][0]+'" '+t[u][2]+">"+t[u][1]+"<\/option>";i+="<\/select>";i+="<\/span>";document.getElementById("spanOfflineNewRequestFormRequestTypeDropDownSection").innerHTML=i;document.getElementById("spanNewRequestDetailsLabel").innerHTML='<span class="xdlabel">Justification details:<\/span>';document.getElementById("spanNewRequestStartDateLabel").innerHTML='<span class="xdlabel">Start date (estimated):<\/span>';document.getElementById("spanNewRequestEndDateLabel").innerHTML='<span class="xdlabel">End date (estimated):<\/span>';$("#trNewRequestAttachmentsSection").show();$("#trNewRequestBarcodeAttachmentsSection").show();console.log("XXXXXXXXXXXXXXXXXXXXXXXXXXX");populateOfflineAttachments("OfflineRequestnewrequestattachments")}catch(o){console.log('Exception in ios8.js.populateStartPageItem("divNewRequestOffline"): '+o.message+", "+o.stack)}}else if(n=="divNewRequest"){if(bwLastSelectedNewRequestType=="recurringexpense"?$("#trNewRequestRecurringExpenseSection").show():$("#trNewRequestRecurringExpenseSection").hide(),s="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),document.getElementById("BudgetRequestId").innerHTML=s,h="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),document.getElementById("RecurringExpenseId").innerHTML=h,document.getElementById("strProjectTitle").value="",document.getElementById("strBriefDescriptionOfProject").value="",document.getElementById("dblRequestedCapital").value="",document.getElementById("txtProjectManagerName").value="",document.getElementById("ddlFunctionalArea").innerHTML="",document.getElementById("newrequestattachments").innerHTML="",$("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").hide(),$("#liOfflineWelcome").hide(),$("#liArchive").hide(),$("#liSummaryReport").hide(),$("#liConfiguration").hide(),$("#liHelp").hide(),$("#liNewRequest").show(),f=document.getElementById("divNewRequestMasterDiv"),f.style.borderRadius="120px 0 0 120px",t=[],t=[],r=["budgetrequest","Budget Request","selected"],t.push(r),quotingEnabled==!0&&(r=["quoterequest","Quote Request",""],t.push(r)),reimbursementRequestsEnabled==!0&&(r=["expenserequest","Reimbursement Request",""],t.push(r)),recurringExpensesEnabled==!0&&(r=["recurringexpense","Recurring Expense",""],t.push(r)),r=["capitalplanproject","Capital Plan Project",""],t.push(r),i="",t.length==1)i+='<span style="font-size: 300%;">New <strong>'+t[0][1]+"<\/strong><\/span>",document.getElementById("spanRequestForm_Title").innerHTML=i,document.getElementById("spanRequestForm_Title2").innerHTML=i;else{for(i+='<span style="font-size: 300%;">New <strong>',i+='<select id="selectNewRequestFormRequestTypeDropDown" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1.25em; font-weight: bold; cursor: pointer;\'>',u=0;u<t.length;u++)i+=t[u][0]==bwLastSelectedNewRequestType?'<option value="'+t[u][0]+'" '+t[u][2]+" selected >"+t[u][1]+"<\/option>":'<option value="'+t[u][0]+'" '+t[u][2]+">"+t[u][1]+"<\/option>";i+="<\/select>";i+="<\/span>";document.getElementById("spanRequestForm_Title").innerHTML=i;document.getElementById("spanRequestForm_Title2").innerHTML=i;$("#selectNewRequestFormRequestTypeDropDown").change(function(){var t=$("#selectNewRequestFormRequestTypeDropDown option:selected").val(),n,i;bwLastSelectedNewRequestType=t;n=[];n={bwParticipantId:participantId,bwWorkflowAppId:workflowAppId,bwLastSelectedNewRequestType:bwLastSelectedNewRequestType};i=webserviceurl+"/bwparticipant/updateuserconfigurationselectednewrequestscreenrequesttype";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"?displayAlertDialog(n):t=="recurringexpense"?$("#trNewRequestRecurringExpenseSection").show():$("#trNewRequestRecurringExpenseSection").hide()},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdChooseSelectedWorkflow(): "+t+" "+i)}})})}populateFunctionalAreas();$("#spanRequestForm_ManagerTitle").html(newBudgetRequestManagerTitle);document.getElementById("spanNewRequestDetailsLabel").innerHTML=requireRequestDetails==!0?'<span class="xdlabel">Justification details:<\/span>&nbsp;<span style="color:red;font-size:medium;">*<\/span>':'<span class="xdlabel">Justification details:<\/span>';requireStartEndDates==!0?(document.getElementById("spanNewRequestStartDateLabel").innerHTML='<span class="xdlabel" style="white-space:nowrap;">Start date (estimated):&nbsp;<\/span><span style="color:red;font-size:medium;">*<\/span>',document.getElementById("spanNewRequestEndDateLabel").innerHTML='<span class="xdlabel" style="white-space:nowrap;">End date (estimated):&nbsp;<\/span><span style="color:red;font-size:medium;">*<\/span>'):(document.getElementById("spanNewRequestStartDateLabel").innerHTML='<span class="xdlabel">Start date (estimated):<\/span>',document.getElementById("spanNewRequestEndDateLabel").innerHTML='<span class="xdlabel">End date (estimated):<\/span>');enableNewRequestAttachments==!0?$("#trNewRequestAttachmentsSection").show():$("#trNewRequestAttachmentsSection").hide();enableNewRequestBarcodeAttachments==!0?$("#trNewRequestBarcodeAttachmentsSection").show():$("#trNewRequestBarcodeAttachmentsSection").hide();renderLeftButtons("divNewRequestPageLeftButtons");$("#txtProjectManagerName").autocomplete({source:function(n,t){$.ajax({url:webserviceurl+"/workflow/"+workflowAppId+"/participants/"+n.term,dataType:"json",success:function(n){for(var r=[],i=0;i<n.participants.length;i++)r[i]=n.participants[i].participant;t(r)}})},minLength:1,select:function(){},open:function(){},close:function(){var n=this.value.split("|")[0],t=this.value.split("|")[1],i=this.value.split("|")[2];n.indexOf("undefined")>-1?(document.getElementById("txtProjectManagerName").value="",document.getElementById("txtProjectManagerId").value="",document.getElementById("txtProjectManagerEmail").value=""):(document.getElementById("txtProjectManagerName").value=n,document.getElementById("txtProjectManagerId").value=t,document.getElementById("txtProjectManagerEmail").value=i)}});monkeyPatchAutocomplete()}else if(n=="divArchive"){if($("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").hide(),$("#liOfflineWelcome").hide(),$("#liNewRequest").hide(),$("#liSummaryReport").hide(),$("#liConfiguration").hide(),$("#liHelp").hide(),$("#liArchive").show(),$("#liOfflineRequestForm").hide(),f=document.getElementById("divArchiveMasterDiv"),f.style.borderRadius="120px 0 0 120px",t=[],t=[],r=["budgetrequests","Budget Requests","selected"],t.push(r),quotingEnabled==!0&&(r=["quoterequests","Quote Requests",""],t.push(r)),reimbursementRequestsEnabled==!0&&(r=["expenserequests","Reimbursement Requests",""],t.push(r)),recurringExpensesEnabled==!0&&(r=["recurringexpenses","Recurring Expenses",""],t.push(r)),i="",t.length==1)i+='<span style="font-size: 200%;">View <strong>'+t[0][1]+"<\/strong><\/span>",document.getElementById("spanArchiveScreenRequestTypeDropDownSection").innerHTML=i;else{for(i+="<span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size:30pt;\">",i+="View ",i+='<select id="selectArchiveScreenRequestTypeDropDown" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1.25em; font-weight: bold; cursor: pointer;\'>',u=0;u<t.length;u++)i+=t[u][0]==bwLastSelectedArchiveScreenRequestType?'<option value="'+t[u][0]+'" '+t[u][2]+" selected >"+t[u][1]+"<\/option>":'<option value="'+t[u][0]+'" '+t[u][2]+">"+t[u][1]+"<\/option>";i+="<\/select>";i+='&nbsp;for&nbsp;<span style="font-weight:bold;white-space:nowrap;">'+workflowAppTitle+"<\/span>";i+="<\/span>";document.getElementById("spanArchiveScreenRequestTypeDropDownSection").innerHTML=i;$("#selectArchiveScreenRequestTypeDropDown").change(function(){var n=$("#selectArchiveScreenRequestTypeDropDown option:selected").val(),t,i;bwLastSelectedArchiveScreenRequestType=n;t=[];t={bwParticipantId:participantId,bwWorkflowAppId:workflowAppId,bwLastSelectedArchiveScreenRequestType:bwLastSelectedArchiveScreenRequestType};i=webserviceurl+"/bwparticipant/updateuserconfigurationselectedarchivescreenrequesttype";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){t!="SUCCESS"?displayAlertDialog(t):n=="budgetrequests"?cmdListAllBudgetRequestsUsingClientDatasetApproach():n=="quoterequests"?cmdListAllQuoteRequestsUsingClientDatasetApproach():n=="expenserequests"?cmdListAllReimbursementRequestsUsingClientDatasetApproach():n=="recurringexpenses"?cmdDisplayArchivePageRecurringExpenses():n=="participants"&&cmdListAllParticipantsUsingClientDatasetApproach()},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdChooseSelectedWorkflow(): "+t+" "+i)}})})}e=$("#selectArchiveScreenRequestTypeDropDown option:selected").val();bwLastSelectedArchiveScreenRequestType=e;GetWorkflowAppConfigurationData9=$.Deferred();GetWorkflowAppConfigurationData9.done(function(){bwLastSelectedArchiveScreenRequestType||(bwLastSelectedArchiveScreenRequestType="budgetrequests");bwLastSelectedArchiveScreenRequestType=="budgetrequests"?cmdListAllBudgetRequestsUsingClientDatasetApproach():bwLastSelectedArchiveScreenRequestType=="quoterequests"?cmdListAllQuoteRequestsUsingClientDatasetApproach():bwLastSelectedArchiveScreenRequestType=="expenserequests"?cmdListAllReimbursementRequestsUsingClientDatasetApproach():bwLastSelectedArchiveScreenRequestType=="recurringexpenses"?cmdDisplayArchivePageRecurringExpenses():e=="participants"&&cmdListAllParticipantsUsingClientDatasetApproach();renderLeftButtons("divArchivePageLeftButtons")}).fail(function(){displayAlertDialog("Error in ios8.js.populateStartPageItem(divFunctionalAreas)","GetWorkflowAppConfigurationData9.fail()")});try{loadWorkflowAppConfigurationDetails9()}catch(o){console.log("Exception in xcx33994586: loadWorkflowAppConfigurationDetails9(): "+o.message+", "+o.stack)}}else if(n=="divArchive2"){if(t=[],t=[],r=["budgetrequests","Budget Requests","selected"],t.push(r),quotingEnabled==!0&&(r=["quoterequests","Quote Requests",""],t.push(r)),reimbursementRequestsEnabled==!0&&(r=["expenserequests","Reimbursement Requests",""],t.push(r)),recurringExpensesEnabled==!0&&(r=["recurringexpenses","Recurring Expenses",""],t.push(r)),i="",t.length==1)i+='<span style="font-size: 200%;">View <strong>'+t[0][1]+"<\/strong><\/span>",document.getElementById("spanArchiveScreenRequestTypeDropDownSection").innerHTML=i;else{for(i+="<span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size:30pt;\">",i+="View ",i+='<select id="selectArchiveScreenRequestTypeDropDown" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1.25em; font-weight: bold; cursor: pointer;\'>',u=0;u<t.length;u++)i+=t[u][0]==bwLastSelectedArchiveScreenRequestType?'<option value="'+t[u][0]+'" '+t[u][2]+" selected >"+t[u][1]+"<\/option>":'<option value="'+t[u][0]+'" '+t[u][2]+">"+t[u][1]+"<\/option>";i+="<\/select>";i+='&nbsp;for&nbsp;<span style="font-weight:bold;white-space:nowrap;">'+workflowAppTitle+"<\/span>";i+="<\/span>";document.getElementById("spanArchiveScreenRequestTypeDropDownSection").innerHTML=i;$("#selectArchiveScreenRequestTypeDropDown").change(function(){var n=$("#selectArchiveScreenRequestTypeDropDown option:selected").val(),t,i;bwLastSelectedArchiveScreenRequestType=n;t=[];t={bwParticipantId:participantId,bwWorkflowAppId:workflowAppId,bwLastSelectedArchiveScreenRequestType:bwLastSelectedArchiveScreenRequestType};i=webserviceurl+"/bwparticipant/updateuserconfigurationselectedarchivescreenrequesttype";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){t!="SUCCESS"?displayAlertDialog(t):n=="budgetrequests"?cmdListAllBudgetRequestsUsingClientDatasetApproach():n=="quoterequests"?cmdListAllQuoteRequestsUsingClientDatasetApproach():n=="expenserequests"?cmdListAllReimbursementRequestsUsingClientDatasetApproach():n=="recurringexpenses"?cmdDisplayArchivePageRecurringExpenses():n=="participants"&&cmdListAllParticipantsUsingClientDatasetApproach()},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdChooseSelectedWorkflow(): "+t+" "+i)}})})}e=$("#selectArchiveScreenRequestTypeDropDown option:selected").val();bwLastSelectedArchiveScreenRequestType=e;bwLastSelectedArchiveScreenRequestType=e;c=[];c={bwParticipantId:participantId,bwWorkflowAppId:workflowAppId,bwLastSelectedArchiveScreenRequestType:bwLastSelectedArchiveScreenRequestType};l=webserviceurl+"/bwparticipant/updateuserconfigurationselectedarchivescreenrequesttype";$.ajax({url:l,type:"POST",timeout:ajaxTimeout,data:c,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"?displayAlertDialog(n):e=="budgetrequests"?cmdListAllBudgetRequestsUsingClientDatasetApproach():e=="quoterequests"?cmdListAllQuoteRequestsUsingClientDatasetApproach():e=="expenserequests"?cmdListAllReimbursementRequestsUsingClientDatasetApproach():e=="recurringexpenses"?cmdDisplayArchivePageRecurringExpenses():e=="participants"&&cmdListAllParticipantsUsingClientDatasetApproach()},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdChooseSelectedWorkflow(): "+t+" "+i)}});GetWorkflowAppConfigurationData9=$.Deferred();GetWorkflowAppConfigurationData9.done(function(){bwLastSelectedArchiveScreenRequestType||(bwLastSelectedArchiveScreenRequestType="budgetrequests");bwLastSelectedArchiveScreenRequestType=="budgetrequests"?cmdListAllBudgetRequestsUsingClientDatasetApproach():bwLastSelectedArchiveScreenRequestType=="quoterequests"?cmdListAllQuoteRequestsUsingClientDatasetApproach():bwLastSelectedArchiveScreenRequestType=="expenserequests"?cmdListAllReimbursementRequestsUsingClientDatasetApproach():bwLastSelectedArchiveScreenRequestType=="recurringexpenses"?cmdDisplayArchivePageRecurringExpenses():e=="participants"&&cmdListAllParticipantsUsingClientDatasetApproach();renderLeftButtons("divArchivePageLeftButtons")}).fail(function(){displayAlertDialog("Error in ios8.js.populateStartPageItem(divFunctionalAreas)","GetWorkflowAppConfigurationData9.fail()")});$(".divBwCoreComponent").bwCoreComponent("loadWorkflowAppConfigurationDetails9")}else if(n=="divArchiveOffline"){for(console.log("In poulateStartPageItem(divArchiveOffline)."),$("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").hide(),$("#liNewRequest").hide(),$("#liArchive").show(),$("#liAbout").hide(),$("#liRequestForm").hide(),renderLeftButtons("divArchivePageLeftButtons"),t=[],t=[],r=["budgetrequests","Budget Requests","selected"],t.push(r),r=["quoterequests","Quote Requests",""],t.push(r),r=["expenserequests","Reimbursement Requests",""],t.push(r),r=["recurringexpenses","Recurring Expenses",""],t.push(r),i="",i+="<span style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 1.77em;white-space:nowrap;\">",i+="These ",i+='<select id="selectArchiveScreenRequestTypeDropDown" style=\'border-color: whitesmoke; color: rgb(38, 38, 38); font-family: "Segoe UI Light","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif; font-size: 1.25em; font-weight: bold; cursor: pointer;\'>',u=0;u<t.length;u++)i+=t[u][0]=="Budget Requests"?'<option value="'+t[u][0]+'" '+t[u][2]+" selected >"+t[u][1]+"<\/option>":'<option value="'+t[u][0]+'" '+t[u][2]+">"+t[u][1]+"<\/option>";i+="<\/select>";i+='&nbsp;have been&nbsp;<span style="font-weight:bold;">saved on this device.<\/span>';i+='<br /><span style="font-size:14pt;white-space:normal;font-style:italic;">The next time you log in, you will be prompted to upload them to your budget request system.<\/span><br /><span style="font-style:normal;font-size:14pt;white-space:normal;"><a href="javascript:displayCustomLogonDialog();">Click here to log in<\/a>, or <a href="javascript:displayCreateFreeAccountDialog();">click here to create a new account<\/a>.<\/span>';i+="<\/span>";document.getElementById("spanArchiveScreenRequestTypeDropDownSection").innerHTML=i;console.log("Rendering the list.");try{r=indexedDB.open(indexDBName,dbVersion);r.onblocked=function(n){console.log("indexDB BLOCKED1. errorCode: "+n.target.errorCode)};r.onerror=function(t){console.log("In index.js.populateStartPageItem("+n+'): Error accessing database "'+t.target.result.name+'". errorCode: '+t.target.errorCode)};r.onsuccess=function(t){var i,u,r;console.log("In index.js.populateStartPageItem("+n+'): Success accessing database "'+t.target.result.name+'".');i=t.target.result;i.onerror=function(n){console.log('DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};try{u=i.transaction("objectStoreCachedRequests","readonly");r=u.objectStore("objectStoreCachedRequests").count()}catch(f){console.log("XXXXXXXXXXXerror: "+f.message)}r.onsuccess=function(n){var t,r,u,e,f;$("#spanBwBudgetRequests").empty();n.target.result==0?($("#divArchivePageTopBarTextContents").text("Archive: Budget Requests"),t="",t+="<br /><br />",t+='<span style="font-size:large;font-style:italic;">There have been no Budget Requests created on this device yet.<\/span>',document.getElementById("spanBwBudgetRequests").innerHTML=t):(console.log("xFound "+n.target.result+" requests on my device."),n.target.result==1?$("#divArchivePageTopBarTextContents").text("Archive: "+n.target.result+" Budget Request is waiting to be submitted..."):$("#divArchivePageTopBarTextContents").text("Archive: "+n.target.result+" Budget Requests are waiting to be submitted..."),document.getElementById("spanBwBudgetRequests").innerHTML="xFound "+n.target.result+" requests on my device.",t="",t+="<br /><br />",t+='<table class="myStuffTable" style="width:100%;">',t+="  <tr>",t+='    <td style="font-size:14pt;font-weight:normal;">Title<\/td>',t+='    <td style="font-size:14pt;">Description<\/td>',t+='    <td style="font-size:14pt;white-space:nowrap;">Financial Area<\/td>',t+='    <td style="font-size:14pt;">Capital<\/td>',t+='    <td style="font-size:14pt;">Expense<\/td>',t+='    <td style="font-size:14pt;">Total<\/td>',t+='    <td style="font-size:14pt;">Timestamp<\/td>',t+='    <td style="font-size:14pt;">Attachments<\/td>',t+="    <td><\/td>",t+="  <\/tr>",t+="  <tr>",t+='    <td style="white-space:nowrap;"><input type="text" id="txtArchivePageDescriptionFilter" class="archivePageFilterBox" title="Type here to limit search results, using * as a wildcard character."/>&nbsp;<img src="images/icon-down.png" title="Sort order" style="cursor:pointer;" /><\/td>',t+="    <td>xdescription<\/td>",t+='    <td style="white-space:nowrap;">',t+='      <select id="ddlArchivePageFinancialAreaDropDownFilter" class="archivePageFilterDropDown" title="Select here to limit the search results.">',t+='       <option value="" class="archivePageFilterOptionDropDown">Show all...<\/option>',r="xx",u="xx",t+='       <option value="'+r+'" class="archivePageFilterOptionDropDown">',t+=u,t+="       <\/option>",t+="     <\/select>",t+="    <\/td>",t+="    <td>xcapital<\/td>",t+="    <td>xexpense<\/td>",t+="    <td>xtotal<\/td>",t+="    <td>xtimestamp<\/td>",t+="    <td>xattachments<\/td>",t+="    <td><\/td>",t+="  <\/tr>",e=n.target.result,f=i.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),f.openCursor().onsuccess=function(n){var i,u;try{i=n.target.result;i?(u="",console.log("Retrieved request: "+i.value.ProjectTitle+": "+i.value.bwBudgetRequestId),t+="  <tr>",t+="    <td style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:14pt;\"><a href=\"javascript:displayCachedArOnTheHomePage('"+i.value.bwBudgetRequestId+"', '"+i.value.ProjectTitle+"');\">"+i.value.ProjectTitle+"<\/a><\/td>",t+="    <td style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:14pt;\">xxdesc<\/td>",t+="    <td style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:14pt;\">xxFunctionalAreaId",t+=i.value.FunctionalAreaId,t+="    <\/td>",t+="    <td style=\"text-align:right;font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;\">xxcap"+formatCurrency(i.value.BudgetAmount)+"<\/td>",t+="    <td style=\"text-align:right;font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;\">xxexp"+formatCurrency(i.value.BudgetAmount)+"<\/td>",t+="    <td style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:14pt;\">xxtotal<\/td>",t+="    <td style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:14pt;\">xxts<\/td>",t+="    <td style=\"font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;font-size:14pt;\">xxatt<\/td>",t+="    <td>",t+='      <img src="images/trash-can.png" onclick="cmdDisplayDeleteUnsubmittedBudgetRequestDialog(\''+i.value.bwBudgetRequestId+"', '"+i.value.ProjectTitle+"', '"+i.value.RequestedCapital+'\');" title="Delete" style="cursor:pointer;" />',t+="    <\/td>",t+="  <\/tr>",i.continue()):(console.log("DONE LOOPING, so rendering."),t+='<tr><td colspan="12"><\/td><\/tr>',t+="<\/table>",document.getElementById("spanBwBudgetRequests").innerHTML=t)}catch(r){console.log("xxError: "+r.message+", "+r.stack)}})};r.onerror=function(){console.error("In index.js.populateStartPageItem("+n+"): add error",this.error)}}}catch(o){console.log("Error in index.js.populateStartPageItem("+n+"): "+o.message+", "+o.stack)}$("#selectArchiveScreenRequestTypeDropDown").change(function(){var n=$("#selectArchiveScreenRequestTypeDropDown option:selected").val();bwLastSelectedArchiveScreenRequestType=n});e=$("#selectArchiveScreenRequestTypeDropDown option:selected").val()}else n=="divSummaryReport"?($("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").hide(),$("#liOfflineWelcome").hide(),$("#liNewRequest").hide(),$("#liHelp").hide(),$("#liArchive").hide(),$("#liConfiguration").hide(),$("#liSummaryReport").show(),$("#liOfflineRequestForm").hide(),f=document.getElementById("divSummaryReportMasterDiv"),f.style.borderRadius="120px 0 0 120px",quotingEnabled==!0?($("#divBudgetRequestsOrQuotes").html('<label for="budgetRequestsOrQuotes"><\/label><input type="checkbox" name="budgetRequestsOrQuotes" id="budgetRequestsOrQuotes" />'),a={show_labels:!0,labels_placement:"both",on_label:"<span style='font-size:30pt;'>Quotes<\/span>",off_label:"<span style='font-size:30pt;'>Budget<br />Requests<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#budgetRequestsOrQuotes").switchButton(a),$("#budgetRequestsOrQuotes").change(function(){$("#budgetRequestsOrQuotes").is(":checked")?$("#financialOrParticipantSummary").is(":checked")?$("#financialOrParticipantSummary").is(":checked")?renderParticipantSummary(!0):displayAlertDialog("financialOrParticipantSummary is in an invalid state."):renderFinancialSummary9(!0):$("#budgetRequestsOrQuotes").is(":checked")?displayAlertDialog("budgetRequestsOrQuotes is in an invalid state."):$("#financialOrParticipantSummary").is(":checked")?$("#financialOrParticipantSummary").is(":checked")?renderParticipantSummary(!1):displayAlertDialog("financialOrParticipantSummary is in an invalid state."):renderFinancialSummary9(!1)})):$("#divBudgetRequestsOrQuotes").empty(),GetWorkflowAppConfigurationData9=$.Deferred(),GetWorkflowAppConfigurationData9.done(function(){renderLeftButtons("divSummaryPageLeftButtons");var n="";n+=(new Date).getFullYear().toString();document.getElementById("spanSummaryReportYear").innerHTML=n;$("#financialOrParticipantSummary").is(":checked")?$("#financialOrParticipantSummary").is(":checked")&&($("#budgetRequestsOrQuotes").is(":checked")?$("#budgetRequestsOrQuotes").is(":checked")&&renderParticipantSummary(!0):renderParticipantSummary(!1)):$("#budgetRequestsOrQuotes").is(":checked")?$("#budgetRequestsOrQuotes").is(":checked")&&(displayAlertDialog("renderFinancialSummary9(true);"),renderFinancialSummary9(!0)):renderFinancialSummary9(!1)}).fail(function(){displayAlertDialog("Error in ios8.js.populateStartPageItem(divSummaryReport)","GetWorkflowAppConfigurationData9.fail()")}),loadWorkflowAppConfigurationDetails9()):n=="divHelp"?($("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").hide(),$("#liOfflineWelcome").hide(),$("#liNewRequest").hide(),$("#liArchive").hide(),$("#liSummaryReport").hide(),$("#liConfiguration").hide(),$("#liHelp").show(),$("#liOfflineRequestForm").hide(),f=document.getElementById("divHelpMasterDiv"),f.style.borderRadius="120px 0 0 120px",renderLeftButtons("divHelpPageLeftButtons")):n=="divConfiguration"?($("#bwQuickLaunchMenuTd").css({width:"0"}),$("#liWelcome").hide(),$("#liOfflineWelcome").hide(),$("#liNewRequest").hide(),$("#liArchive").hide(),$("#liSummaryReport").hide(),$("#liHelp").hide(),$("#liConfiguration").show(),$("#liOfflineRequestForm").hide(),f=document.getElementById("divConfigurationMasterDiv"),f.style.borderRadius="120px 0 0 120px",f=document.getElementById("divFunctionalAreas"),f.style.borderRadius="120px 0 0 120px",generateConfigurationLeftSideMenu(),renderLeftButtons("divConfigurationPageLeftButtons")):n=="divAddAFunctionalArea"?($("#bwQuickLaunchMenuTd").css({width:"0"}),$("#spanFunctionalAreasTopBarTextContentsIos8").text("Add a financial area:"),$("#btnFunctionalAreaDelete").hide(),$("#divFunctionalAreaSection").html($("#divFunctionalAreaTemplate").html()),$("#txtFunctionalAreaId").empty,document.getElementById("divMenuMasterDivAddAFunctionalArea").className="divLeftButtonSelectedIos8",$("#divFunctionalAreasMasterSubMenuDiv").show(),hookUpThePeoplePickers(),f=document.getElementById("divFunctionalAreas"),f.style.borderRadius="120px 0 0 120px"):n=="divFunctionalAreas"?($("#bwQuickLaunchMenuTd").css({width:"0"}),GetWorkflowAppConfigurationData9=$.Deferred(),GetWorkflowAppConfigurationData9.done(function(){generateFunctionalAreasListButtons()}).fail(function(){displayAlertDialog("Error in ios8.js.populateStartPageItem(divFunctionalAreas)","GetWorkflowAppConfigurationData9.fail()")}),loadWorkflowAppConfigurationDetails9()):n=="divParticipants"?($("#bwQuickLaunchMenuTd").css({width:"0"}),generateParticipantsListButtons()):n=="divBehavior"?($("#bwQuickLaunchMenuTd").css({width:"0"}),generateBehaviorPage()):n=="divWorkflowSettings"&&($("#bwQuickLaunchMenuTd").css({width:"0"}),generateWorkflowSettingsPage())}catch(o){displayAlertDialog("Error in ios8.js.populateStartPageItem("+n+")"+o.message+", "+o.stack)}}function displayForm_DisplayCachedAr(n){try{$("#divClientRequestsNotYetSubmittedDialog").dialog("close")}catch(i){}var t=indexedDB.open(indexDBName,dbVersion);t.onblocked=function(n){console.log("In ios8.js.displayForm_DisplayCachedAr(): indexDB BLOCKED1. errorCode: "+n.target.errorCode);displayAlertDialog("In ios8.js.displayForm_DisplayCachedAr(): indexDB BLOCKED1. errorCode: "+n.target.errorCode)};t.onerror=function(n){console.log('In ios8.js.displayForm_DisplayCachedAr(): Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);displayAlertDialog('In ios8.js.displayForm_DisplayCachedAr(): Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};t.onsuccess=function(t){console.log('In ios8.js.displayForm_DisplayCachedAr(): Success accessing database "'+t.target.result.name+'".');var i=t.target.result;i.onerror=function(n){console.log('Error in ios8.js.displayForm_DisplayCachedAr(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode);displayAlertDialog('Error in ios8.js.displayForm_DisplayCachedAr(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};i.transaction("objectStoreCachedXsltFiles").objectStore("objectStoreCachedXsltFiles").get("UnsubmittedBudgetRequestIos8").onsuccess=function(t){var r=t.target.result,u;r?(console.log("In ios8.js.displayForm_DisplayCachedAr("+n+"). Loaded the Xsl file from the indexDB!"),u=i.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),u.openCursor().onsuccess=function(t){var i,f,e;try{i=t.target.result;i?(i.value.bwBudgetRequestId==n&&(status='<img class="imgRedDot" alt="" src="/images/red-dot.png"> You will be prompted to submit this request the next time you <a href="javascript:displayCustomLogonDialog();">sign in.<\/a>',f=i.value.bwDocumentXml,e=TransformToHtmlTextOffline(f,r),console.log("In ios8.js.displayForm_DisplayCachedAr("+n+"). Preparing to display in divOfflineRequestFormPageMainPageContent."),document.getElementById("divOfflineRequestFormDialogContent").innerHTML=e,$("#divOfflineRequestFormDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!0,width:"1100",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divOfflineRequestFormDialog").dialog("close")});console.log("Completed display in displayForm_DisplayCachedAr divOfflineRequestFormPageMainPageContent.");try{console.log("In ios8.js.displayForm_DisplayCachedAr(): Populating offline attachments 1!!!!");populateOfflineAttachments("attachmentsInXslForm")}catch(n){displayAlertDialog("Exception in ios8.js.displayForm_DisplayCachedAr(): Error rendering "+file+". "+n.message+n.stack)}}}),$("#divOfflineRequestFormDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()),i.continue()):console.log("In ios8.js.displayForm_DisplayCachedAr. DONE LOOPING.")}catch(u){console.log("Exception in ios8.js.displayForm_DisplayCachedAr. xxError: "+u.message+", "+u.stack);displayAlertDialog("Exception in ios8.js.displayForm_DisplayCachedAr. xxError: "+u.message+", "+u.stack)}}):(console.log("ERRROR LOADING XSL FILE!!! "+r),displayAlertDialog("ERRROR LOADING XSL FILE!!!"))}}}function displayForm_DisplayOfflineArReadyToSubmit(n){var t=indexedDB.open(indexDBName,dbVersion);t.onblocked=function(n){console.log(" displayForm_DisplayOfflineArReadyToSubmit indexDB BLOCKED1. errorCode: "+n.target.errorCode)};t.onerror=function(n){console.log('In ios8.js.displayForm_DisplayOfflineArReadyToSubmit(): Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};t.onsuccess=function(t){var i,r;console.log('In ios8.js.displayForm_DisplayOfflineArReadyToSubmit(): Success accessing database "'+t.target.result.name+'".');i=t.target.result;i.onerror=function(n){console.log('Error in ios8.js.displayForm_DisplayOfflineArReadyToSubmit(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};console.log("In ios8.js.displayForm_DisplayOfflineArReadyToSubmit("+n+"). Loaded the Xsl file from the indexDB!");r=i.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests");r.openCursor().onsuccess=function(t){var r,h,o,u,i,e,s;try{if(r=t.target.result,r){if(r.value.bwBudgetRequestId==n){status='<img class="imgRedDot" alt="" src="/images/red-dot.png"> This offline request is ready to be submitted.';h=r.value.bwDocumentXml;o="";o="/"+viewsFolderName+"/OfflineBudgetRequestSubmissionForm.xsl";u=appweburl2+o;i=null;try{i=new ActiveXObject("Microsoft.XMLDOM");i.async=!1;i.load(u)}catch(f){try{i=document.implementation.createDocument("","",null);i.async=!1;i.load(u)}catch(f){try{e=new window.XMLHttpRequest;e.open("GET",u,!1);e.send(null);i=e.responseXML.documentElement}catch(f){displayAlertDialog("Failure attempting to parse XSLT in the browser.");WriteToErrorLog("Error in ios8.js.displayForm_DisplayOfflineArReadyToSubmit()","Resubmit: Failure attempting to parse XSLT in the browser: "+f.name+", "+f.message+", "+f.stack);redirectForm()}}}s=TransformToHtmlText(h,i);console.log("In ios8.js.displayForm_DisplayOfflineArReadyToSubmit("+n+"). Preparing to display in divOfflineRequestFormPageMainPageContent. s="+s);document.getElementById("divOfflineRequestFormDialogContent").innerHTML=s;$("#divOfflineRequestFormDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"1100",dialogClass:"no-close",hide:!1,open:function(){console.log("displayForm_DisplayOfflineArReadyToSubmit Completed display in divOfflineRequestFormPageMainPageContent.");try{document.getElementById("ddlYearInXslForm").innerHTML="2018";populateFunctionalAreasForOfflineBudgetRequestSubmissionForm();$('span[xd\\:binding = "my:Status"]')[0].innerHTML=status;decodeUriInAllFields();formatRequestedExpense();formatRequestedCapital();formatCurrency2("my:Budget_Amount2");formatCurrency2("my:ExpenseEquipmentAndParts");formatCurrency2("my:CostOfEquipmentAndParts");formatCurrency2("my:ExpenseInternalLabor");formatCurrency2("my:CostOfInternalLabor");formatCurrency2("my:ExpenseCostOfOutsideServices");formatCurrency2("my:CostOfOutsideServices");formatCurrency2("my:OtherExpense");formatCurrency2("my:OtherCapital");formatCurrency2("my:SalesTax");recalculateCosts();console.log("displayForm_DisplayOfflineArReadyToSubmit Populating offline attachments 1!!!!");populateOfflineAttachments("attachmentsInXslForm")}catch(n){displayAlertDialog("Error in ios8.js.displayForm_DisplayOfflineArReadyToSubmit(): Error rendering "+u+". "+n.message+n.stack)}}});$("#divOfflineRequestFormDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}r.continue()}else console.log("In ios8.js.displayForm_DisplayOfflineArReadyToSubmit. DONE LOOPING.")}catch(f){console.log("In ios8.js.displayForm_DisplayOfflineArReadyToSubmit. xxError: "+f.message+", "+f.stack)}}}}function cmdDisplayClientRequestsNotYetSubmittedDialog(n){console.log("In cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit().");try{var t=indexedDB.open(indexDBName,dbVersion);t.onblocked=function(n){console.log("indexDB BLOCKED1. errorCode: "+n.target.errorCode)};t.onerror=function(n){console.log('In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialog(). Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};t.onsuccess=function(t){var i,u,r;console.log('In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialog(). Success accessing database "'+t.target.result.name+'".');i=t.target.result;i.onerror=function(n){console.log('Error in ios8.js.displayForm_DisplayCachedAr(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};try{u=i.transaction("objectStoreCachedRequests","readonly");r=u.objectStore("objectStoreCachedRequests").count()}catch(f){console.log("In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialog().XXXXXXXXXXXerror: "+f.message)}r.onsuccess=function(t){var r,f,u;t.target.result==1&&n!=!0?(u=i.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),u.openCursor().onsuccess=function(n){var t,i;try{t=n.target.result;t&&(i=t.value.bwBudgetRequestId,console.log("Getting ready to display bwBudgetRequestId: "+i),displayForm_DisplayCachedAr(i))}catch(r){console.log("In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialog(). xyyyyy..."+r.message+", "+r.stack)}}):(t.target.result>1||n==!0)&&(document.getElementById("spanClientRequestsNotYetSubmittedDialogTitle").innerHTML=t.target.result+" Requests on this device are waiting to be submitted.",document.getElementById("divClientRequestsNotYetSubmittedContent").innerHTML="",r="",r+='<span style="font-style:italic;font-size:30pt;">If this device runs low on storage, it may delete them without asking you.<\/span>',r+="<br />",r+="<br />",r+="<br />",r+='<table class="myStuffTable" style="width:100%;">',r+="  <tr>",r+='    <td class="bwHPNDrillDownLinkCell" style="text-align:left;" colspan="2"><span>There are '+t.target.result+" requests saved on this device.<\/span><\/td>",r+="  <\/tr>",f=t.target.result,u=i.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),u.openCursor().onsuccess=function(n){var t,i;try{t=n.target.result;t?(i=t.value.ProjectTitle,i==""&&(i="<em>[no description]<\/em>"),console.log("Retrieved request: "+i+": "+t.value.bwBudgetRequestId),r+="  <tr>",r+='    <td class="tdHomePageSubNotificationIos8" style="cursor:pointer;width:95%;" onclick="displayForm_DisplayCachedAr(\''+t.value.bwBudgetRequestId+"');\">",r+='      <div style="display:inline-block;">',r+='        <span title="Click to view the request." style="cursor:pointer;font-size:30pt;width:100%;">'+i+" (<em>"+formatCurrency(t.value.RequestedCapital)+"<\/em>)<\/span>",r+="      <\/div>",r+="    <\/td>",r+="    <td>",r+='      <img src="images/trash-can.png" onclick="cmdDisplayDeleteUnsubmittedBudgetRequestDialog(\''+t.value.bwBudgetRequestId+"', '"+i+"', '"+t.value.RequestedCapital+'\');" title="Delete" class="trashcan" style="cursor:pointer;">',r+="    <\/td>",r+="  <\/tr>",t.continue()):(console.log("DONE LOOPING, so rendering."),r+='<tr><td colspan="12"><\/td><\/tr>',r+="<\/table>",document.getElementById("divClientRequestsNotYetSubmittedContent").innerHTML=r,$("#divClientRequestsNotYetSubmittedDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"800",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divClientRequestsNotYetSubmittedDialog").dialog("close")})}}),$("#divClientRequestsNotYetSubmittedDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove())}catch(u){console.log("xxError: "+u.message+", "+u.stack)}})};r.onerror=function(){console.error("In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialog(). add error",this.error)}}}catch(i){console.log("In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialog(). FAILED TO OPEN A TRANSACTION to the database..."+i.message+", "+i.stack)}}function cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit(n){console.log("In cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit().");try{var t=indexedDB.open(indexDBName,dbVersion);t.onblocked=function(n){console.log("cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit indexDB BLOCKED1. errorCode: "+n.target.errorCode)};t.onerror=function(n){console.log('In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit(). Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};t.onsuccess=function(t){var i,u,r;console.log('In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit(). Success accessing database "'+t.target.result.name+'".');i=t.target.result;i.onerror=function(n){console.log('Error in ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit(). DATABASE ERROR!!!!!!!!!! :Error accessing database "'+n.target.result.name+'". errorCode: '+n.target.errorCode)};try{u=i.transaction("objectStoreCachedRequests","readonly");r=u.objectStore("objectStoreCachedRequests").count()}catch(f){console.log("In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit().XXXXXXXXXXXerror: "+f.message)}r.onsuccess=function(t){var r,f,u;t.target.result==1&&n!=!0?(u=i.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),u.openCursor().onsuccess=function(n){var t,i;try{t=n.target.result;t&&(i=t.value.bwBudgetRequestId,console.log("cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit Getting ready to display bwBudgetRequestId: "+i),displayForm_DisplayOfflineArReadyToSubmit(i))}catch(r){console.log("In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit(). xyyyyy..."+r.message+", "+r.stack)}}):(t.target.result>1||n==!0)&&(document.getElementById("spanClientRequestsNotYetSubmittedDialogTitle").innerHTML=t.target.result+" Requests on this device are waiting to be submitted.",document.getElementById("divClientRequestsNotYetSubmittedContent").innerHTML="",r="",r+='<span style="font-style:italic;font-size:30pt;">If this device runs low on storage, it may delete them without asking you.<\/span>',r+="<br />",r+="<br />",r+="<br />",r+='<table class="myStuffTable" style="width:100%;">',r+="  <tr>",r+='    <td class="bwHPNDrillDownLinkCell" style="text-align:left;" colspan="2"><span>There are '+t.target.result+" requests saved on this device.<\/span><\/td>",r+="  <\/tr>",f=t.target.result,u=i.transaction("objectStoreCachedRequests").objectStore("objectStoreCachedRequests"),u.openCursor().onsuccess=function(n){var t,i;try{t=n.target.result;t?(i=t.value.ProjectTitle,i==""&&(i="<em>[no description]<\/em>"),console.log("Retrieved request: "+i+": "+t.value.bwBudgetRequestId),r+="  <tr>",r+='    <td class="tdHomePageSubNotificationIos8" style="cursor:pointer;width:95%;" onclick="displayForm_DisplayOfflineArReadyToSubmit(\''+t.value.bwBudgetRequestId+"');\">",r+='      <div style="display:inline-block;">',r+='        <span title="Click to view the request." style="cursor:pointer;font-size:30pt;width:100%;">'+i+" (<em>"+formatCurrency(t.value.RequestedCapital)+"<\/em>)<\/span>",r+="      <\/div>",r+="    <\/td>",r+="    <td>",r+='      <img src="images/trash-can.png" onclick="cmdDisplayDeleteUnsubmittedBudgetRequestDialog(\''+t.value.bwBudgetRequestId+"', '"+i+"', '"+t.value.RequestedCapital+'\');" title="Delete" class="trashcan" style="cursor:pointer;">',r+="    <\/td>",r+="  <\/tr>",t.continue()):(console.log("DONE LOOPING, so rendering."),r+='<tr><td colspan="12"><\/td><\/tr>',r+="<\/table>",document.getElementById("divClientRequestsNotYetSubmittedContent").innerHTML=r,$("#divClientRequestsNotYetSubmittedDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,width:"800",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#divClientRequestsNotYetSubmittedDialog").dialog("close")})}}),$("#divClientRequestsNotYetSubmittedDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove())}catch(u){console.log("cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit xxError: "+u.message+", "+u.stack)}})};r.onerror=function(){console.error("In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit(). add error",this.error)}}}catch(i){console.log("In ios8.js.cmdDisplayClientRequestsNotYetSubmittedDialogReadyToSubmit(). FAILED TO OPEN A TRANSACTION to the database..."+i.message+", "+i.stack)}}function displayCachedArOnTheHomePage(n,t){try{$("#ArDialog").dialog("close")}catch(i){}try{$("#bwQuickLaunchMenuTd").css({width:"0"});$("#liWelcome").hide();$("#liNewRequest").hide();$("#liArchive").hide();$("#liAbout").hide();$("#liRequestForm").show();renderLeftButtons("divRequestFormPageLeftButtons");$("#divRequestFormPageTopBarTextContents").text("Authorization Request: "+t);$("#divWelcomePageLeftButtonsWelcomeButton").off("click").click(function(){redirectForm()});displayForm_DisplayCachedAr(n)}catch(i){console.log("Error in ios8.js.displayCachedArOnTheHomePage(): "+i.message)}}function renderBarcodeDetails(){var n={"3211":"0","2221":"1","2122":"2","1411":"3","1132":"4","1231":"5","1114":"6","1312":"7","1213":"8","3112":"9"},t=function(t){var rt=document,b="object"==typeof t?t:rt.getElementById(t),k=rt.createElement("canvas"),u=b.width,ut=b.height,ft=k.getContext("2d"),d=[1,9,2,8,3,7,4,6,5],a=d.length,lt=ut/(a+1),v=Math.round,o,ot,c,nt,f,r,i,ct,l,it;for(k.width=u,k.height=ut,ft.drawImage(b,0,0);a--;){console.log(d[a]);var e=ft.getImageData(0,lt*d[a],u,2).data,y=[],p=0,g=0;for(f=0;f<2;f++)for(r=0;r<u;r++){var i=(f*u+r)*4,et=(e[i]*3+e[i+1]*4+e[i+2]*2)/9,o=y[r];e[i]=e[i+1]=e[i+2]=et;y[r]=et+(undefined==o?0:o)}for(i=0;i<u;i++)o=y[i]=y[i]/2,o<p&&(p=o),o>g&&(g=o);for(ot=p+(g-p)/2,c=[],r=0;r<u;r++){for(nt=0,f=0;f<2;f++)e[(f*u+r)*4]>ot&&nt++;c.push(nt>1)}var st=c[0],tt=1,s=[];for(r=0;r<u;r++)c[r]==st?tt++:(s.push(tt),tt=1,st=c[r]);var h="",w=~~((s[1]+s[2]+s[3])/3),ht=n;for(i=1,ct=s.length;i<ct;i++)if(l=h.length<6?s.slice(i*4,i*4+4):s.slice(i*4+5,i*4+9),it=[v(l[0]/w),v(l[1]/w),v(l[2]/w),v(l[3]/w)],h+=ht[it.join("")]||ht[it.reverse().join("")]||"X",12==h.length)return h;if(-1==h.indexOf("X"))return h||!1}return!1};return t("barcodeImage1")}function renderNewSupplementalBudgetRequestForm(n,t,i,r){var f="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),u;document.getElementById("myxml").innerHTML="";u="";u+='<table style="BORDER-TOP-STYLE: none; WORD-WRAP: break-word; BORDER-LEFT-STYLE: none; BORDER-COLLAPSE: collapse; TABLE-LAYOUT: fixed; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; WIDTH: 654px" class="xdFormLayout">';u+="  <colgroup>";u+='    <col style="WIDTH: 654px" />';u+="  <\/colgroup>";u+="  <tbody>";u+='    <tr class="xdTableContentRow">';u+='      <td style="BORDER-TOP: #d8d8d8 1pt solid; BORDER-RIGHT: #d8d8d8 1pt solid; VERTICAL-ALIGN: top; BORDER-BOTTOM: #d8d8d8 1pt solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; BORDER-LEFT: #d8d8d8 1pt solid; PADDING-RIGHT: 0px" class="xdTableContentCell">';u+="        <div />";u+='        <!--<img src="../Lists/LogoImage/CompanyLogo.png" style="HEIGHT: 96px; WIDTH: 96px" />-->';u+="        <table>";u+="        <!--<tr><td>&nbsp;<\/td><\/tr>-->";u+="          <tr><td>&nbsp;<\/td><\/tr>";u+="          <tr>";u+='            <td width="5px"><\/td>';u+='            <td><!--<img src="../Lists/LogoImage/CompanyLogo.png" style="HEIGHT: 96px; WIDTH: 96px" />--><\/td>';u+='            <td><span id="spanNewRequestFormTitle"><br /><span style="font-size:200%;">&nbsp;&nbsp;&nbsp;Supplemental <strong>Budget Request<\/strong><\/span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-style:italic;font-size:150%;">for '+r+"<br /><br /><\/span><\/span><\/td>";u+="          <\/tr>";u+="        <\/table>";u+='        <div align="right">';u+='        <span class="xdlabel">';u+="          <em />";u+="        <\/span>";u+="        <\/div>";u+='        <div align="right">';u+='          <span class="xdlabel">';u+="            <em>";u+='            <span class="spanH3">';u+='            <!--<a xd:disableEditing="yes" href="http://sp2010/budget/_layouts/help.aspx?Lcid=1033&amp;amp;Key=HelpHome&amp;amp;ShowNav=true">';u+='              <img setWidth="24" setHeight="22" src="30837E49.png" alt="SharePoint-Help-Question-Mark.png" style="BORDER-TOP: #000080 1.5pt; HEIGHT: 22px; BORDER-RIGHT: #000080 1.5pt; BORDER-BOTTOM: #000080 1.5pt; BORDER-LEFT: #000080 1.5pt; WIDTH: 24px" class="ms-rtePosition-4" />';u+="            <\/a>-->";u+='            Complete the form then click the "Submit" button.';u+="            <\/span>";u+="            <\/em>";u+="          <\/span>";u+="        <\/div>";u+='        <div align="right">';u+='          <span class="xdlabel" id="spanNewBudgetRequestPageButtons">';u+='            <!-- <input tabindex="0" xd:xctname="Button" xd:ctrlid="CTRL81" value="Submit" type="button" style="margin: 1px" class="langFont" title="Click here to Submit the request, or click the Help icon in the top right corner of this screen..." /> -->';u+='            <!--<input type="button" name="startWorkflowButton" value="Submit" onclick="cmdCreateBudgetRequestAndStartWorkflow();" title="Click here to Submit the request." style="MARGIN: 1px; WIDTH: 200px;font-size: 20pt;cursor:pointer;" />-->';u+='            <button id="startWorkflowButton" onclick="cmdCreateSupplementalBudgetRequestAndStartWorkflow(\''+n+"', '"+f+"', '"+t+"', '"+i+'\');" class="BwButton200" title="Click here to Submit the supplemental request.">Submit<\/button>';u+="            &nbsp;";u+='            <!--<input type="button" value="Cancel" onclick="populateStartPageItem(\'divWelcome\', \'Reports\', \'\');" style="MARGIN: 1px; WIDTH: 200px;font-size: 20pt;cursor:pointer;" />-->';u+="            <button onclick=\"populateStartPageItem('divWelcome', 'Reports', '');\" class=\"BwButton200\">Cancel<\/button>";u+="            &nbsp;";u+="          <\/span>";u+="        <\/div>";u+='        <div align="right">';u+="          &nbsp;";u+="        <\/div>";u+='        <div align="center">';u+='          <span class="xdlabel" />';u+='          <span style="BORDER-TOP: #dcdcdc 1pt; BORDER-RIGHT: #dcdcdc 1pt; WHITE-SPACE: nowrap; BORDER-BOTTOM: #dcdcdc 1pt; COLOR: #ff0000; TEXT-ALIGN: right; BORDER-LEFT: #dcdcdc 1pt; WIDTH: 100%" tabindex="-1" xd:binding="my:GlobalError" xd:xctname="PlainText" xd:ctrlid="CTRL115" xd:disableediting="yes" hidefocus="1" class="xdTextBox" title="" />';u+="        <\/div>";u+='        <div align="center">';u+='          <span class="xdlabel" />';u+="        <\/div>";u+='    <div align="center">';u+='        <table class="xdFormLayout" style="BORDER-TOP-STYLE: none; WORD-WRAP: break-word; BORDER-LEFT-STYLE: none; BORDER-COLLAPSE: collapse; TABLE-LAYOUT: fixed; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; WIDTH: 652px">';u+="            <!-- original was  WIDTH: 652px had changed to 98% for some reason...-->";u+="            <colgroup>";u+='                <col style="WIDTH: 98%" /> <!-- was style="WIDTH: 652px"-->';u+="            <\/colgroup>";u+="            <tbody>";u+='                <tr style="MIN-HEIGHT: 4px" class="xdTableContentRow">';u+='                    <td valign="top" style="BORDER-TOP: #d8d8d8 1pt solid; BORDER-BOTTOM: #d8d8d8 1pt" class="xdTableContentCell">';u+="                        <div>";u+='                            <table class="xdFormLayout xdTableStyleTwoCol" style="BORDER-TOP-STYLE: none; WORD-WRAP: break-word; BORDER-LEFT-STYLE: none; BORDER-COLLAPSE: collapse; TABLE-LAYOUT: fixed; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; WIDTH: 649px">';u+="                                <colgroup>";u+='                                    <col style="WIDTH: 169px" />';u+='                                    <col style="WIDTH: 480px" />';u+="                                <\/colgroup>";u+='                                <tbody valign="top">';u+='                                    <tr class="xdTableOffsetRow">';u+='                                        <td class="xdTableOffsetCellLabel" style="text-align:left; BORDER-TOP: #d8d8d8 1pt; VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 22px; BORDER-LEFT: #d8d8d8 1pt; PADDING-RIGHT: 5px">';u+='                                            <font color="#000000">';u+='                                                <span class="xdlabel" />';u+='                                                <span class="xdlabel">Description:<\/span>&nbsp;<span style="color:red;font-size:medium;">*<\/span>';u+="                                            <\/font>";u+="                                        <\/td>";u+='                                        <td style="BORDER-TOP: #d8d8d8 1pt; VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 22px" class="xdTableOffsetCellComponent">';u+="                                            <div>";u+="                                                <input type=\"text\" id=\"strProjectTitle\" style=\"WIDTH: 70%;font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 20pt;\" /> <!-- was 2.77em -->";u+='                                                <!--<textarea id="strProjectTitle" rows="1" style="WIDTH: 97%; HEIGHT: 18px;"><\/textarea>-->';u+="                                           <\/div>";u+="                                       <\/td>";u+="                                    <\/tr>";u+='                                    <tr class="xdTableOffsetRow">';u+='                                        <td style="text-align:left; VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 22px; BORDER-LEFT: #d8d8d8 1pt; PADDING-RIGHT: 5px" class="xdTableOffsetCellLabel">';u+='                                            <span id="spanNewRequestDetailsLabel"><span class="xdlabel">Justification details:<\/span><\/span>';u+="                                        <\/td>";u+='                                        <td style="VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 22px" class="xdTableOffsetCellComponent">';u+="                                            <div>";u+="                                                <textarea id=\"strBriefDescriptionOfProject\" rows=\"3\" style=\"WIDTH: 97%;font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 20pt;\"><\/textarea>";u+='                                                <!--<span style="WORD-WRAP: break-word; HEIGHT: 60px; WHITE-SPACE: normal; TEXT-ALIGN: left; OVERFLOW-X: auto; OVERFLOW-Y: auto; WIDTH: 451px" tabindex="0" xd:datafmt="" xd:binding="my:Brief_Description_of_Project" xd:xctname="PlainText" xd:ctrlid="CTRL83" contenteditable="true" hidefocus="1" class="xdTextBox xdBehavior_Formatting" title="" />-->';u+="                                            <\/div>";u+="                                        <\/td>";u+="                                    <\/tr>";u+='                                    <tr class="xdTableOffsetRow">';u+='                                        <td style="text-align:left; VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 22px; BORDER-LEFT: #d8d8d8 1pt; PADDING-RIGHT: 5px" class="xdTableOffsetCellLabel">';u+='                                            <span class="xdlabel">';u+='                                                <span class="xdlabel">';u+='                                                    <font color="#000000">Requested Amount:<\/font>&nbsp;<span style="color:red;font-size:medium;">*<\/span>';u+="                                                <\/span>";u+="                                            <\/span>";u+="                                        <\/td>";u+='                                        <td style="text-align:left; VERTICAL-ALIGN: top; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 22px" class="xdTableOffsetCellComponent">';u+="                                            <div>";u+='                                                <input type="text" id="dblRequestedCapital" onblur="formatRequestedCapital_InitBudgetRequest();" style="WIDTH: 60%;font-family: \'Segoe UI Light\',\'Segoe UI\',\'Segoe\',Tahoma,Helvetica,Arial,sans-serif;color: #262626;font-size: 20pt;TEXT-ALIGN: right;" />';u+="                                            <\/div>";u+="                                        <\/td>";u+="                                    <\/tr>";enableNewRequestAttachments==!0&&(u+='                                    <tr id="trNewRequestAttachmentsSection" class="xdTableOffsetRow">',u+='                                        <td class="xdTableOffsetCellLabel" valign="top" style="text-align:left; BORDER-BOTTOM: #d8d8d8 1pt; BORDER-LEFT: #d8d8d8 1pt; BACKGROUND-COLOR: #ffffff">',u+='                                            <span class="xdlabel">Attachments:<\/span>',u+="                                        <\/td>",u+='                                        <td style="VERTICAL-ALIGN: top; BORDER-BOTTOM: #d8d8d8 1pt; PADDING-BOTTOM: 4px; PADDING-TOP: 4px; PADDING-LEFT: 5px; PADDING-RIGHT: 22px" class="xdTableOffsetCellComponent">',u+="                                            <div>",u+='                                                <div xd:widgetindex="0" tabindex="-1" xd:xctname="RepeatingSection" xd:ctrlid="CTRL90" align="left" style="MARGIN-BOTTOM: 0px; WIDTH: 100%" class="xdRepeatingSection xdRepeating" title="">',u+="                                                    <div>",u+='                                                        <!--<span tabindex="0" tabstop="true" xd:boundprop="xd:inline" xd:binding="my:CapexAttachment" xd:xctname="FileAttachment" xd:ctrlid="CTRL91" style="HEIGHT: 30px; WIDTH: 161px" hidefocus="1" class="xdFileAttachment" />-->',u+='                                                        <input id="inputFile" type="file" onchange="uploadAttachment(\'attachments\');" style="width: 75%;" />',u+="                                                    <\/div>",u+="                                                <\/div>",u+='                                                <p id="newrequestattachments"><\/p>',u+="                                            <\/div>",u+="                                        <\/td>",u+="                                    <\/tr>");u+='<span id="BudgetRequestId" style="display: none; visibility: hidden;" xd:binding="my:BudgetRequestId"><\/span>';u+="<tr>";u+="  <td>";u+="&nbsp;";u+="";u+="";u+="";u+="";u+="  <\/td>";u+="<\/tr>";u+="                                <\/tbody>";u+="                            <\/table>";u+="                        <\/div>";u+="                    <\/td>";u+="                <\/tr>";u+="            <\/tbody>";u+="        <\/table>";u+="   <\/div>";u+="<\/td>";u+="<\/tr>";u+="<\/tbody>";u+="<\/table>";document.getElementById("budgetrequestform").innerHTML=u;document.getElementById("BudgetRequestId").innerHTML=f;displayAlertDialog("ios8.js.renderNewSupplementalBudgetRequestForm. supplementalRequestId: "+f);document.getElementById("spanNewRequestDetailsLabel").innerHTML=requireRequestDetails==!0?'<span class="xdlabel">Justification details:<\/span>&nbsp;<span style="color:red;font-size:medium;">*<\/span>':'<span class="xdlabel">Justification details:<\/span>'}function enableFinancialAreasButton(){}function enableDepartmentsButton(){}function enableParticipantsButton(){}function disableFinancialAreasButton(){document.getElementById("divBehaviorButton").className="divInnerLeftButtonIos8";document.getElementById("divFunctionalAreasButton").className="divInnerLeftButtonSelectedIos8";document.getElementById("divParticipantsButton").className="divInnerLeftButtonIos8";document.getElementById("divWorkflowSettingsButton").className="divInnerLeftButtonIos8"}function disableParticipantsButton(){document.getElementById("divBehaviorButton").className="divInnerLeftButtonIos8";document.getElementById("divFunctionalAreasButton").className="divInnerLeftButtonIos8";document.getElementById("divParticipantsButton").className="divInnerLeftButtonSelectedIos8";document.getElementById("divWorkflowSettingsButton").className="divInnerLeftButtonIos8"}function disableBehaviorButton(){document.getElementById("divBehaviorButton").className="divInnerLeftButtonSelectedIos8";document.getElementById("divFunctionalAreasButton").className="divInnerLeftButtonIos8";document.getElementById("divParticipantsButton").className="divInnerLeftButtonIos8";document.getElementById("divWorkflowSettingsButton").className="divInnerLeftButtonIos8"}function disableWorkflowSettingsButton(){document.getElementById("divBehaviorButton").className="divInnerLeftButtonIos8";document.getElementById("divFunctionalAreasButton").className="divInnerLeftButtonIos8";document.getElementById("divParticipantsButton").className="divInnerLeftButtonIos8";document.getElementById("divWorkflowSettingsButton").className="divInnerLeftButtonSelectedIos8"}function cmdAddAnApprover(){for(var r=[],e,i,u,t,n,r=[],f=3;f<11;f++)if(e=$("#txtApprover"+f+"FriendlyName"),e.val()){var o=$("#txtApprover"+f+"Id").val(),s=$("#txtApprover"+f+"Email").val(),h=$("#txtApprover"+f+"FriendlyName").val(),c=$('span[xd\\:binding="my:Approval'+f+'BudgetThreshold"]')[0].innerHTML,l=parseFloat(c.replace(/[^0-9-.]/g,"")),i=[];i=new Array(4);i[0]=o;i[1]=s;i[2]=h;i[3]=l;r.push(i)}for(i=[],i=new Array(4),i[0]="",i[1]="",i[2]="",i[3]="",r.push(i),n="",n+="<table>",r.length>0&&(n+="<tr>",n+="  <td><\/td>",n+="  <td><\/td>",n+='  <td style="text-align:center;">',n+='    <span style="color:cornflowerblue;font-size:18pt;">Budget Threshold<\/span>',n+="  <\/td>",n+="  <td><\/td>",n+="<\/tr>"),u=0;u<r.length;u++)n+="<tr>",n+='  <td class="bwComTitleCell">Approver #'+(u+2).toString()+"<\/td>",n+='  <td class="bwChartCalculatorLightCurrencyTableCell" style="white-space:nowrap;">',t=u+3,n+='    <input id="txtApprover'+t+'FriendlyName" title="'+r[u][1]+'" value="'+r[u][2]+'" class="spanH2" />',n+='    <img src="images/addressbook-icon35x35.png" style="width:80px;height:80px;cursor:pointer;vertical-align:text-bottom;" onclick="cmdDisplayPeoplePickerDialog(\'txtApprover'+t+"FriendlyName', 'txtApprover"+t+"Id', 'txtApprover"+t+"Email');\" />",n+='    <input id="txtApprover'+t+'Id" style="display:none;" value="'+r[u][0]+'" />',n+='    <input id="txtApprover'+t+'Email" style="display:none;" value="'+r[u][1]+'" />',n+="  <\/td>",n+='  <td class="bwChartCalculatorLightCurrencyTableCell">',n+='    <span xd:binding="my:Approval'+t+'BudgetThreshold" class="bwCurrencyTextBox" contenteditable="true" tabindex="0">'+formatCurrency(r[u][3])+"<\/span>",n+="  <\/td>",n+='<td><img src="images/trash-can.png"  class="trashcan" onclick="cmdDeleteApproverFromFinancialArea(\''+t+'\');" title="Delete" style="cursor:pointer;" /><\/td>',n+="<\/tr>";n+="<\/table>";document.getElementById("divFunctionalAreasApproverDataEntryFields").innerHTML=n;r.length==10&&(n="",n+="<i>You have reached the limit of 10 Approvers.<\/i>",document.getElementById("spanAddAnApproverLink").innerHTML=n);$("#txtApprover"+t+"Name").autocomplete({source:function(n,t){$.ajax({url:webserviceurl+"/tenant/"+tenantId+"/participants/"+n.term,dataType:"json",success:function(n){for(var r=[],i=0;i<n.participants.length;i++)r[i]=n.participants[i].participant;t(r)}})},minLength:1,select:function(){},open:function(){},close:function(){var n=this.value.split("|")[0],r=this.value.split("|")[1],i=this.value.split("|")[2];n.indexOf("undefined")>-1?(document.getElementById("txtApprover"+t+"FriendlyName").value="",document.getElementById("txtApprover"+t+"Id").value="",document.getElementById("txtApprover"+t+"Email").value=""):(document.getElementById("txtApprover"+t+"FriendlyName").value=n,document.getElementById("txtApprover"+t+"FriendlyName").setAttribute("title",i),document.getElementById("txtApprover"+t+"Id").value=r,document.getElementById("txtApprover"+t+"Email").value=i)}});newFunctionalAreaAdditionalApprovers.length>7&&$("#aLinkCreateFunctionalAreaAddAnApprover").hide()}function cmdImmediatelyDeleteFunctionalArea(n){var t=[],i;t={bwFunctionalAreaId:n};i=webserviceurl+"/bwfunctionalareas/deletefunctionalarea";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdImmediatelyDeleteFunctionalArea(): "+i)}})}function cmdImmediatelyHideFunctionalArea(n){var t=[],i;t={bwFunctionalAreaId:n,IsHidden:"true",ModifiedByFriendlyName:participantFriendlyName,ModifiedById:participantId,ModifiedByEmail:participantEmail};i=webserviceurl+"/bwfunctionalareas/hideorshowfunctionalarea";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdImmediatelyHideFunctionalArea(): "+i)}})}function cmdDeleteFunctionalArea(){var n,t,i;try{n=$('span[xd\\:binding = "my:FunctionalAreaId"]')[0].innerHTML;t=[];t={bwFunctionalAreaId:n};i=webserviceurl+"/bwworkflow/removeafinancialarea";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){var r,i;$("#DeleteAFinancialAreaDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"Delete Financial Area",width:"800px",dialogClass:"no-close",hide:!1,buttons:{Delete:{text:"Delete",id:"btnDeleteAFinancialArea",disabled:"true",style:"font-size:30pt;",click:function(){cmdImmediatelyDeleteFunctionalArea(n);populateStartPageItem("divFunctionalAreas","Reports","");$(this).dialog("close")}},Hide:{text:"Hide",id:"btnHideAFinancialArea",disabled:"true",style:"font-size:30pt;",click:function(){cmdImmediatelyHideFunctionalArea(n);populateStartPageItem("divFunctionalAreas","Reports","");$(this).dialog("close")}},Cancel:{text:"Cancel",style:"font-size:30pt;",click:function(){$(this).dialog("close")}}},open:function(){$(".ui-widget-overlay").bind("click",function(){$("#DeleteAFinancialAreaDialog").dialog("close")})}});$("#DeleteAFinancialAreaDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();r="";t.NumberOfBudgetRequests==0?(r+="This action cannot be undone.<br /><br />Click the Delete button to delete this Financial Area...",i=$("#DeleteAFinancialAreaDialog").dialog("option","buttons"),$.each(i,function(n,t){t.id==="btnDeleteAFinancialArea"&&(t.text="Delete Financial Area",t.style="color:red;font-size:30pt;",t.disabled=!1)}),$("#DeleteAFinancialAreaDialog").dialog("option","buttons",i)):(r+="There are "+t.NumberOfBudgetRequests+" Budget Request(s) that use this Financial Area.<br /><br />Therefore you can't delete it, but you can prevent it from showing up on New Budget Requests.",i=$("#DeleteAFinancialAreaDialog").dialog("option","buttons"),$.each(i,function(n,t){t.id==="btnHideAFinancialArea"&&(t.text="Hide Financial Area",t.style="color:red;font-size:30pt;",t.disabled=!1)}),$("#DeleteAFinancialAreaDialog").dialog("option","buttons",i));document.getElementById("spanDeleteAFinancialAreaDialogDependencyDetails").innerHTML=r},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdDeleteFunctionalArea(): "+i)}})}catch(r){displayAlertDialog("Error in cmdDeleteFunctionalArea(): "+r.message)}}function cmdSaveFunctionalArea(){var i,bt,t="",r,u,n,wt,fi;t=$("#txtFunctionalAreaId").val();t!=""?(i="POST",bt="Error updating the functional area."):(i="PUT",bt="Error creating the functional area.");try{r=$("#txtFunctionalAreaTitle").val();u="false";document.getElementById("cbFunctionalAreaQuote").checked&&(u="true");var ei=(new Date).getFullYear().toString(),kt=$("#txtFunctionalAreaYearlyBudget").val().replace(/[^0-9-.]/g,""),dt=$("#txtApprover1Id").val(),gt=$("#txtApprover1FriendlyName").val(),ni=$("#txtApprover1Email").val(),ti=$("#txtApprover2Id").val(),ii=$("#txtApprover2FriendlyName").val(),ri=$("#txtApprover2Email").val(),f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt;try{for(n=3;n<11;n++)n==3?document.getElementById("txtApprover3Id")!=null&&(f=$("#txtApprover"+n+"Id").val(),e=$("#txtApprover"+n+"FriendlyName").val(),o=$("#txtApprover"+n+"Email").val(),st=parseFloat($('span[xd\\:binding="my:Approval'+n+'BudgetThreshold"]')[0].innerHTML.replace(/[^0-9-.]/g,""))):n==4?document.getElementById("txtApprover4Id")!=null&&(s=$("#txtApprover"+n+"Id").val(),h=$("#txtApprover"+n+"FriendlyName").val(),c=$("#txtApprover"+n+"Email").val(),ht=parseFloat($('span[xd\\:binding="my:Approval'+n+'BudgetThreshold"]')[0].innerHTML.replace(/[^0-9-.]/g,""))):n==5?document.getElementById("txtApprover5Id")!=null&&(l=$("#txtApprover"+n+"Id").val(),a=$("#txtApprover"+n+"FriendlyName").val(),v=$("#txtApprover"+n+"Email").val(),ct=parseFloat($('span[xd\\:binding="my:Approval'+n+'BudgetThreshold"]')[0].innerHTML.replace(/[^0-9-.]/g,""))):n==6?document.getElementById("txtApprover6Id")!=null&&(y=$("#txtApprover"+n+"Id").val(),p=$("#txtApprover"+n+"FriendlyName").val(),w=$("#txtApprover"+n+"Email").val(),lt=parseFloat($('span[xd\\:binding="my:Approval'+n+'BudgetThreshold"]')[0].innerHTML.replace(/[^0-9-.]/g,""))):n==7?document.getElementById("txtApprover7Id")!=null&&(b=$("#txtApprover"+n+"Id").val(),k=$("#txtApprover"+n+"FriendlyName").val(),d=$("#txtApprover"+n+"Email").val(),at=parseFloat($('span[xd\\:binding="my:Approval'+n+'BudgetThreshold"]')[0].innerHTML.replace(/[^0-9-.]/g,""))):n==8?document.getElementById("txtApprover8Id")!=null&&(g=$("#txtApprover"+n+"Id").val(),nt=$("#txtApprover"+n+"FriendlyName").val(),tt=$("#txtApprover"+n+"Email").val(),vt=parseFloat($('span[xd\\:binding="my:Approval'+n+'BudgetThreshold"]')[0].innerHTML.replace(/[^0-9-.]/g,""))):n==9?document.getElementById("txtApprover9Id")!=null&&(it=$("#txtApprover"+n+"Id").val(),rt=$("#txtApprover"+n+"FriendlyName").val(),ut=$("#txtApprover"+n+"Email").val(),yt=parseFloat($('span[xd\\:binding="my:Approval'+n+'BudgetThreshold"]')[0].innerHTML.replace(/[^0-9-.]/g,""))):n==10&&document.getElementById("txtApprover10Id")!=null&&(ft=$("#txtApprover"+n+"Id").val(),et=$("#txtApprover"+n+"FriendlyName").val(),ot=$("#txtApprover"+n+"Email").val(),pt=parseFloat($('span[xd\\:binding="my:Approval'+n+'BudgetThreshold"]')[0].innerHTML.replace(/[^0-9-.]/g,"")))}catch(ui){displayAlertDialog("Error in ios8.js.cmdSaveFunctionalArea():1:",ui.message)}wt=[];wt={bwFunctionalAreaId:t,bwTenantId:tenantId,bwWorkflowAppId:workflowAppId,bwFunctionalAreaTitle:r,bwFunctionalAreaQuote:u,bwFunctionalAreaYear:ei,bwFunctionalAreaYearlyBudget:kt,Approver1Id:dt,Approver1FriendlyName:gt,Approver1Email:ni,Approver2Id:ti,Approver2FriendlyName:ii,Approver2Email:ri,Approver3Id:f,Approver3FriendlyName:e,Approver3Email:o,Approver4Id:s,Approver4FriendlyName:h,Approver4Email:c,Approver5Id:l,Approver5FriendlyName:a,Approver5Email:v,Approver6Id:y,Approver6FriendlyName:p,Approver6Email:w,Approver7Id:b,Approver7FriendlyName:k,Approver7Email:d,Approver8Id:g,Approver8FriendlyName:nt,Approver8Email:tt,Approver9Id:it,Approver9FriendlyName:rt,Approver9Email:ut,Approver10Id:ft,Approver10FriendlyName:et,Approver10Email:ot,Approval3BudgetThreshold:st,Approval4BudgetThreshold:ht,Approval5BudgetThreshold:ct,Approval6BudgetThreshold:lt,Approval7BudgetThreshold:at,Approval8BudgetThreshold:vt,Approval9BudgetThreshold:yt,Approval10BudgetThreshold:pt};fi=webserviceurl+"/bwfunctionalareas";$.ajax({url:fi,type:i,data:wt,headers:{Accept:"application/json; odata=verbose"},success:function(n){var i,u;for(displayAlertDialog(n),i=0;i<BWMData[0].length;i++)if(BWMData[0][i][0]==workflowAppId)for(u=0;u<BWMData[0][i][4].length;u++)if(BWMData[0][i][4][u][0]==t){var wt=[dt,gt,ni],bt=[ti,ii,ri],ui=[f,e,o,st],fi=[s,h,c,ht],ei=[l,a,v,ct],oi=[y,p,w,lt],si=[b,k,d,at],hi=[g,nt,tt,vt],ci=[it,rt,ut,yt],li=[ft,et,ot,pt],ai=[ui,fi,ei,oi,si,hi,ci,li];BWMData[0][i][4][u][1]=r;BWMData[0][i][4][u][2]=quote;BWMData[0][i][4][u][4]=kt;BWMData[0][i][4][u][5]=wt;BWMData[0][i][4][u][6]=bt;BWMData[0][i][4][u][7]=ai}populateStartPageItem("divFunctionalAreas","Reports","")},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdSaveFunctionalArea():2:"+i+" "+JSON.stringify(n))}})}catch(ui){displayAlertDialog("Error in ios8.js.cmdSaveFunctionalArea():3:",ui.message)}}function cmdSaveAccountingDepartmentUser(){var t;try{var i=$("#txtBwDepartmentUserName").val(),r=$("#txtBwDepartmentUserId").val(),u=$("#txtBwDepartmentUserEmail").val(),n=[];n={bwTenantId:tenantId,bwWorkflowAppId:workflowAppId,bwDepartmentTitle:"Procurement",bwDepartmentUserName:i,bwDepartmentUserId:r,bwDepartmentUserEmail:u};t=webserviceurl+"/bwdepartments";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog(n);var t="";t+='<input id="btnSaveRemoveAccountingDepartmentUser" type="button" value="Remove" onclick="cmdRemoveAccountingDepartmentUser();" class="BwButton200" />';document.getElementById("spanSaveAccountingDepartmentUserButton").innerHTML=t},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdSaveAccountingDepartmentUser():1:"+i+" "+JSON.stringify(n))}})}catch(f){displayAlertDialog("Error in ios8.js.cmdSaveAccountingDepartmentUser():2:",f.message)}}function cmdRemoveAccountingDepartmentUser(){var n,t;try{n=[];n={bwWorkflowAppId:workflowAppId,bwDepartmentTitle:"Procurement"};t=webserviceurl+"/bwdepartments/removedepartmentuser";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog(n);document.getElementById("txtBwDepartmentUserName").value="";var t="";t+='<input id="btnSaveRemoveAccountingDepartmentUser" type="button" value="Save" onclick="cmdSaveAccountingDepartmentUser();" disabled class="BwButton200" />';document.getElementById("spanSaveAccountingDepartmentUserButton").innerHTML=t},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdRemoveAccountingDepartmentUser():1:"+i+" "+JSON.stringify(n))}})}catch(i){displayAlertDialog("Error in ios8.js.cmdRemoveAccountingDepartmentUser():2:",i.message)}}function cmdCancel(){renderWelcomeScreen()}function renderConfigureParticipantsScreen(){var t=(new Date).getFullYear().toString(),n="";n+='<table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">';$("#divFunctionalAreasListButtons").html(n)}function generateFunctionalAreasListButtons(){var f,n,u,r,t,i;for(disableFinancialAreasButton(),n="",n+='<table style="width:100%;padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+='<tr style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+='<td style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+='<div class="">',n+='<span id="spanSecondTopBarExpandCollapse" class="spanTopBarExpandCollapseIos8" onclick="cmdSecondTopBarExpandCollapse(\'spanSecondTopBarExpandCollapse\');">+<\/span><span id="xxxx" class="divTopBarTextContentsIos8" onclick="cmdSecondTopBarExpandCollapse(\'spanSecondTopBarExpandCollapse\');">Financial Areas...<\/span>',n+="<\/div>",n+="<\/td>",n+='<td style="text-align:right;white-space:nowrap;font-size:small;padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;"><!--Year:&nbsp;<select id="ddlYear" onchange="cmdYearSelectedChanged();"><\/select>--><\/td>',n+="<\/tr>",n+="<\/table>",$("#divFunctionalAreasMasterDiv").html(n),n="",n+='<table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+="    <tr>",n+='        <td style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+='            <table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+="                <tr>",n+='                    <td style="border-right:1px solid grey;width:15px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 1px 0 0;">&nbsp;<\/td>',n+='                    <td style="width:15px;padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;"><\/td>',n+="                    <td>",n+="                        <table>",n+="                            <tr>",n+="                                <td>",n+='                                    <div id="divFunctionalAreaSection"><\/div>',n+="                                <\/td>",n+="                            <\/tr>",n+="                        <\/table>",n+="                    <\/td>",n+="                <\/tr>",n+="            <\/table>",n+="        <\/td>",n+="    <\/tr>",n+="<\/table>",$("#divFunctionalAreasSubSubMenus").html(n),$("#divFunctionalAreaSection").html($("#divFunctionalAreaTemplate").html()),$("#divFunctionalAreaSection").show(),f=(new Date).getFullYear().toString(),n="",n+='<table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',u=!1,t=0;t<BWMData[0].length;t++)if(BWMData[0][t][0]=workflowAppId)for(i=0;i<BWMData[0][t][4].length;i++)BWMData[0][t][4][i][3]==f&&(u==!1?($("#spanFunctionalAreasTopBarTextContentsIos8").text(BWMData[0][t][4][i][1].toString()),$("#divFunctionalAreasMasterSubMenuDiv").show(),n+="    <tr>",n+='        <td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',n+='            <div id="divFunctionalAreaMasterDiv'+BWMData[0][t][4][i][0].toString()+'" class="divLeftButtonSelected">'+BWMData[0][t][4][i][1].toString()+"&nbsp;&nbsp;&nbsp;&nbsp;<\/div>",n+="        <\/td>",n+="    <\/tr>",n+="    <tr><td><\/td><\/tr>",u=!0,r=BWMData[0][t][4][i][0].toString()):(n+="    <tr>",n+='        <td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',n+='            <div id="divFunctionalAreaMasterDiv'+BWMData[0][t][4][i][0].toString()+'" class="divLeftButton" onclick="renderFunctionalAreaDetails(\''+BWMData[0][t][4][i][0].toString()+"');\">"+BWMData[0][t][4][i][1].toString()+"&nbsp;&nbsp;&nbsp;&nbsp;<\/div>",n+="        <\/td>",n+="    <\/tr>",n+="    <tr><td><\/td><\/tr>"));n+="    <tr>";n+='        <td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">';n+='            <div id="divMenuMasterDivAddAFunctionalArea" class="divLeftButtonIos8" onclick="renderFunctionalAreaDetails(\'AddAFinancialArea\');"><!--<img src="/images/plus.png" alt="" />-->+ Add a financial area&nbsp;&nbsp;&nbsp;&nbsp;<\/div>';n+="        <\/td>";n+="    <\/tr>";n+="    <tr><td><\/td><\/tr>";n+="<\/table>";$("#divFunctionalAreasListButtons").html(n);r||(r="AddAFinancialArea");renderFunctionalAreaDetails(r);hookUpThePeoplePickers()}function generateConfigurationLeftSideMenu(){$("#divConfigurationLeftSideMenu").empty();var n={bwParticipantId:participantId};$.ajax({url:webserviceurl+"/bwworkflowapps/listallforparticipant",type:"DELETE",contentType:"application/json",data:JSON.stringify(n),success:function(){try{populateStartPageItem("divBehavior","","")}catch(n){displayAlertDialog("Error in ios8.js.generateConfigurationLeftSideMenu()",n.message)}},error:function(n,t,i){displayAlertDialog("Error in ios8.js.generateConfigurationLeftSideMenu():"+t+", "+i)}})}function selectHomePageWorkflowAppDropDown_change(){var i=$("#selectHomePageWorkflowAppDropDown option:selected").val(),n=i.split("|")[0],f=i.split("|")[1],u=$("#selectHomePageWorkflowAppDropDown option:selected").text(),t,r;workflowAppId!=n&&(t=[],t={bwParticipantId:participantId,selectedWorkflowAppId:n},r=webserviceurl+"/bwparticipant/updateuserconfigurationselectedworkflowapp",$.ajax({url:r,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){t.message!="SUCCESS"?displayAlertDialog(t.message):(workflowAppId=n,workflowAppTitle=u,newBudgetRequestManagerTitle=t.d.results[0].bwNewBudgetRequestManagerTitle,requireStartEndDates=t.d.results[0].bwRequireStartEndDates=="true"?!0:!1,requireRequestDetails=t.d.results[0].bwRequireRequestDetails=="true"?!0:!1,requireRequestDetails=t.d.results[0].bwRequireRequestDetails=="true"?!0:!1,enableNewRequestAttachments=t.d.results[0].bwEnableNewRequestAttachments=="true"?!0:!1,enableNewRequestBarcodeAttachments=t.d.results[0].bwEnableNewRequestBarcodeAttachments=="true"?!0:!1,quotingEnabled=t.d.results[0].bwQuotingEnabled=="true"?!0:!1,reimbursementRequestsEnabled=t.d.results[0].bwExpenseRequestsEnabled=="true"?!0:!1,closeoutsEnabled=t.d.results[0].bwCloseoutsEnabled=="true"?!0:!1,recurringExpensesEnabled=t.d.results[0].bwRecurringExpensesEnabled=="true"?!0:!1,supplementalsEnabled=t.d.results[0].bwSupplementalsEnabled=="true"?!0:!1,strictAuditingEnabled=t.d.results[0].bwStrictAuditingEnabled=="true"?!0:!1,generateConfigurationLeftSideMenu(),populateStartPageItem("divBehavior","Reports",""),$('#selectHomePageWorkflowAppDropDown option[value="'+n+'"]').attr("selected","selected"),renderHomePagePersonalizedSection())},error:function(n,t,i){displayAlertDialog("Error in ios8.js.selectHomePageWorkflowAppDropDown_change(): "+t+" "+i)}}))}function cmdChooseSelectedWorkflow(n,t){var i,r;workflowAppId!=n&&(i=[],i={bwParticipantId:participantId,selectedWorkflowAppId:n},r=webserviceurl+"/bwparticipant/updateuserconfigurationselectedworkflowapp",$.ajax({url:r,type:"POST",timeout:ajaxTimeout,data:i,headers:{Accept:"application/json; odata=verbose"},success:function(i){i.message!="SUCCESS"?displayAlertDialog(i.message):(workflowAppId=n,workflowAppTitle=t,newBudgetRequestManagerTitle=i.d.results[0].bwNewBudgetRequestManagerTitle,requireStartEndDates=i.d.results[0].bwRequireStartEndDates=="true"?!0:!1,requireRequestDetails=i.d.results[0].bwRequireRequestDetails=="true"?!0:!1,requireRequestDetails=i.d.results[0].bwRequireRequestDetails=="true"?!0:!1,enableNewRequestAttachments=i.d.results[0].bwEnableNewRequestAttachments=="true"?!0:!1,enableNewRequestBarcodeAttachments=i.d.results[0].bwEnableNewRequestBarcodeAttachments=="true"?!0:!1,quotingEnabled=i.d.results[0].bwQuotingEnabled=="true"?!0:!1,reimbursementRequestsEnabled=i.d.results[0].bwExpenseRequestsEnabled=="true"?!0:!1,closeoutsEnabled=i.d.results[0].bwCloseoutsEnabled=="true"?!0:!1,recurringExpensesEnabled=i.d.results[0].bwRecurringExpensesEnabled=="true"?!0:!1,supplementalsEnabled=i.d.results[0].bwSupplementalsEnabled=="true"?!0:!1,strictAuditingEnabled=i.d.results[0].bwStrictAuditingEnabled=="true"?!0:!1,generateConfigurationLeftSideMenu(),populateStartPageItem("divBehavior","Reports",""),$('#selectHomePageWorkflowAppDropDown option[value="'+n+'"]').attr("selected","selected"))},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdChooseSelectedWorkflow(): "+t+" "+i)}}))}function generateBehaviorPage(){var n,t,i,r;newBudgetRequestManagerTitle==""&&(newBudgetRequestManagerTitle="Manager");$("#divFunctionalAreasMasterDiv").empty();$("#divFunctionalAreasMasterSubMenuDiv").hide();n="";n+='<table style="width:100%;padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">';n+='<tr style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">';n+='<td style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">';n+='<div class="">';n+='<span id="spanSecondTopBarExpandCollapse" class="spanTopBarExpandCollapseIos8" onclick="cmdSecondTopBarExpandCollapse(\'spanSecondTopBarExpandCollapse\');">+<\/span><span id="xxxx" class="divTopBarTextContentsIos8" onclick="cmdSecondTopBarExpandCollapse(\'spanSecondTopBarExpandCollapse\');">Behavior<\/span>';n+="<\/div>";n+="<\/td>";n+='<td style="text-align:right;white-space:nowrap;font-size:small;padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;"><!--Year:&nbsp;<select id="ddlYear" onchange="cmdYearSelectedChanged();"><\/select>--><\/td>';n+="<\/tr>";n+="<\/table>";$("#divFunctionalAreasMasterDiv").html(n);disableBehaviorButton();$("#divFunctionalAreasSubSubMenus").empty();n="";n+='<table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">';n+="  <tr>";n+="    <td>";n+='       <span style="font-size:25pt;font-style:italic;">These are your personal settings, which apply to all of your workflows.<\/span>';n+="   <\/td><\/tr><\/table>";n+="       <table>";n+="<tr><td>&nbsp;<\/td><\/tr>";n+='<tr style="display:none;"><td style="text-align:left;" class="bwSliderTitleCell">Send me email:<\/td><td class="bwTdRadiobuttonLightCurrencyTableCell"><input type="radio" id="rbMyEmailNotificationImmediately" name="rbgMyEmailNotificationFrequency" onclick="cmdRbgMyEmailNotificationFrequency_click(\'immediately\');" />&nbsp;<span id="spanRbEmailImmediately" style="color:gray;font-size:22pt;">&nbsp;&nbsp;Immediately<\/span><\/td><\/tr>';n+='<tr style="display:none;"><td><\/td><td class="bwTdRadiobuttonLightCurrencyTableCell"><input type="radio" id="rbMyEmailNotificationAggregated" name="rbgMyEmailNotificationFrequency" onclick="cmdRbgMyEmailNotificationFrequency_click(\'aggregatetwicedaily\');" />&nbsp;';n+='<span id="spanRbAggregateEmailTwiceDaily" style="color:gray;font-size:22pt;">&nbsp;&nbsp;Aggregate into an email sent twice daily at<br />';n+='<span style="float:right;">';n+='<select id="selectAggregateEmailTwiceDailyFirstTime" onchange="cmdRbgMyEmailNotificationFrequency_click(\'aggregatetwicedaily\');" disabled class="spanH2">';n+='<option value="1">1AM<\/option>';n+='<option value="2">2AM<\/option>';n+='<option value="3">3AM<\/option>';n+='<option value="4">4AM<\/option>';n+='<option value="5">5AM<\/option>';n+='<option value="6">6AM<\/option>';n+='<option value="7">7AM<\/option>';n+='<option value="8">8AM<\/option>';n+='<option value="9" selected>9AM<\/option>';n+='<option value="10">10AM<\/option>';n+='<option value="11">11AM<\/option>';n+='<option value="12">12PM<\/option>';n+='<option value="13">1PM<\/option>';n+='<option value="14">2PM<\/option>';n+='<option value="15">3PM<\/option>';n+='<option value="16">4PM<\/option>';n+='<option value="17">5PM<\/option>';n+='<option value="18">6PM<\/option>';n+='<option value="19">7PM<\/option>';n+='<option value="20">8PM<\/option>';n+='<option value="21">9PM<\/option>';n+='<option value="22">10PM<\/option>';n+='<option value="23">11PM<\/option>';n+='<option value="24">12AM<\/option>';n+="<\/select>";n+=" and ";n+='<select id="selectAggregateEmailTwiceDailySecondTime" onchange="cmdRbgMyEmailNotificationFrequency_click(\'aggregatetwicedaily\');" disabled class="spanH2">';n+='<option value="1">1AM<\/option>';n+='<option value="2">2AM<\/option>';n+='<option value="3">3AM<\/option>';n+='<option value="4">4AM<\/option>';n+='<option value="5">5AM<\/option>';n+='<option value="6">6AM<\/option>';n+='<option value="7">7AM<\/option>';n+='<option value="8">8AM<\/option>';n+='<option value="9">9AM<\/option>';n+='<option value="10">10AM<\/option>';n+='<option value="11">11AM<\/option>';n+='<option value="12">12PM<\/option>';n+='<option value="13">1PM<\/option>';n+='<option value="14">2PM<\/option>';n+='<option value="15">3PM<\/option>';n+='<option value="16" selected>4PM<\/option>';n+='<option value="17">5PM<\/option>';n+='<option value="18">6PM<\/option>';n+='<option value="19">7PM<\/option>';n+='<option value="20">8PM<\/option>';n+='<option value="21">9PM<\/option>';n+='<option value="22">10PM<\/option>';n+='<option value="23">11PM<\/option>';n+='<option value="24">12AM<\/option>';n+="<\/select>";n+="  ";n+='<select id="selectAggregateEmailTwiceDailyTimezoneDisplayName" onchange="cmdRbgMyEmailNotificationFrequency_click(\'aggregatetwicedaily\');" disabled class="spanH2">';n+='<option value="AST">AST<\/option>';n+='<option value="EST">EST<\/option>';n+='<option value="CST">CST<\/option>';n+='<option value="MST">MST<\/option>';n+='<option value="PST">PST<\/option>';n+="<\/select>";n+="<\/span>";n+="<\/span>";n+="<\/td><\/tr>";n+='   <tr><td colspan="2">&nbsp;<\/td><\/tr>';n+="<tr>";n+='  <td style="text-align:left;" class="bwSliderTitleCell">Send me this kind of email:<\/td>';n+="  <td>";n+='    <table style="width:100%;"><tr>';n+='      <td class="bwTdRadiobuttonLightCurrencyTableCell"><input type="radio" id="rbMyEmailNotificationTypeAllNotifications" name="rbgMyEmailNotificationTypes" onclick="cmdRbgMyEmailNotificationTypes_click(\'allnotifications\');" /><\/td>';n+='      <td class="bwTdRadiobuttonTextLightCurrencyTableCell"><span id="spanEmailNotificationTypeAllNotifications" style="color:gray;font-size:22pt;">All notifications<\/span><\/td>';n+="    <\/tr><\/table>";n+="  <\/td>";n+="<\/tr>";n+="<tr>";n+="  <td><\/td>";n+="  <td>";n+='    <table style="width:100%;"><tr>';n+='      <td class="bwTdRadiobuttonLightCurrencyTableCell"><input type="radio" id="rbMyEmailNotificationTypeOnlyTasks" name="rbgMyEmailNotificationTypes" onclick="cmdRbgMyEmailNotificationTypes_click(\'onlymytasknotifications\');" /><\/td>';n+='      <td class="bwTdRadiobuttonTextLightCurrencyTableCell"><span id="spanEmailNotificationTypeOnlyTasks" style="color:gray;font-size:22pt;">Only my task notifications<\/span><\/td>';n+="    <\/tr><\/table>";n+="  <\/td>";n+="<\/tr>";n+="<tr>";n+="  <td><\/td>";n+="  <td>";n+='    <table style="width:100%;"><tr>';n+='      <td class="bwTdRadiobuttonLightCurrencyTableCell"><input type="radio" id="rbMyEmailNotificationTypeNoNotifications" name="rbgMyEmailNotificationTypes" onclick="cmdRbgMyEmailNotificationTypes_click(\'nonotifications\');" /><\/td>';n+='      <td class="bwTdRadiobuttonTextLightCurrencyTableCell"><span id="spanEmailNotificationTypeNoNotifications" style="color:gray;font-size:22pt;">No email notifications<\/span><\/td>';n+="    <\/tr><\/table>";n+="  <\/td>";n+="<\/tr>";n+='   <tr><td style="text-align:left;" class="bwSliderTitleCell">';n+='           Display "Create a new request" button on the home page:<\/td>';n+='       <td class="bwChartCalculatorLightCurrencyTableCell"><label for="configurationBehaviorDisplayNewRequestsOnHomePageSlider"><\/label><input type="checkbox" name="configurationBehaviorDisplayNewRequestsOnHomePageSlider" id="configurationBehaviorDisplayNewRequestsOnHomePageSlider" /><\/td><\/tr>';n+="   <tr><td>&nbsp;<\/td><\/tr>";n+='   <tr><td style="text-align:left;" class="bwSliderTitleCell">';n+='           Display "Generate a new invitation link" button on the home page:<\/td>';n+='       <td class="bwChartCalculatorLightCurrencyTableCell"><label for="configurationBehaviorDisplayInvitationsOnHomePageSlider"><\/label><input type="checkbox" name="configurationBehaviorDisplayInvitationsOnHomePageSlider" id="configurationBehaviorDisplayInvitationsOnHomePageSlider" /><\/td><\/tr>';n+="   <tr><td>&nbsp;<\/td><\/tr>";n+="       <\/table>";$("#divFunctionalAreasSubSubMenus").html(n);emailAggregatorTwiceDailyFirstTime&&(document.getElementById("selectAggregateEmailTwiceDailyFirstTime").value=emailAggregatorTwiceDailyFirstTime,document.getElementById("selectAggregateEmailTwiceDailySecondTime").value=emailAggregatorTwiceDailySecondTime,document.getElementById("selectAggregateEmailTwiceDailyTimezoneDisplayName").value=emailAggregatorTwiceDailyTimezoneDisplayName);emailNotificationFrequency=="immediately"?(document.getElementById("rbMyEmailNotificationImmediately").setAttribute("checked","checked"),document.getElementById("spanRbEmailImmediately").style.color="black",document.getElementById("selectAggregateEmailTwiceDailyFirstTime").disabled=!0,document.getElementById("selectAggregateEmailTwiceDailySecondTime").disabled=!0,document.getElementById("selectAggregateEmailTwiceDailyTimezoneDisplayName").disabled=!0):emailNotificationFrequency=="aggregatetwicedaily"&&(document.getElementById("rbMyEmailNotificationAggregated").setAttribute("checked","checked"),document.getElementById("spanRbAggregateEmailTwiceDaily").style.color="black",document.getElementById("selectAggregateEmailTwiceDailyFirstTime").disabled=!1,document.getElementById("selectAggregateEmailTwiceDailySecondTime").disabled=!1,document.getElementById("selectAggregateEmailTwiceDailyTimezoneDisplayName").disabled=!1);emailNotificationTypes=="allnotifications"?(document.getElementById("rbMyEmailNotificationTypeAllNotifications").setAttribute("checked","checked"),document.getElementById("spanEmailNotificationTypeAllNotifications").style.color="black"):emailNotificationTypes=="onlymytasknotifications"?(document.getElementById("rbMyEmailNotificationTypeOnlyTasks").setAttribute("checked","checked"),document.getElementById("spanEmailNotificationTypeOnlyTasks").style.color="black"):emailNotificationTypes=="nonotifications"&&(document.getElementById("rbMyEmailNotificationTypeNoNotifications").setAttribute("checked","checked"),document.getElementById("spanEmailNotificationTypeNoNotifications").style.color="black");t={checked:tipsDisplayOn,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>ON<\/span>",off_label:"<span style='font-size:30pt;'>OFF<\/span>",width:200,height:88,button_width:96,clear_after:null};$("input#configurationBehaviorTipsSlider").switchButton(t);i={checked:displayNewRequestsOnHomePageDisplayOn,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>ON<\/span>",off_label:"<span style='font-size:30pt;'>OFF<\/span>",width:200,height:88,button_width:96,clear_after:null};$("input#configurationBehaviorDisplayNewRequestsOnHomePageSlider").switchButton(i);r={checked:displayInvitationsOnHomePageDisplayOn,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>ON<\/span>",off_label:"<span style='font-size:30pt;'>OFF<\/span>",width:200,height:88,button_width:96,clear_after:null};$("input#configurationBehaviorDisplayInvitationsOnHomePageSlider").switchButton(r);$("#configurationBehaviorTipsSlider").change(function(){var n,t;tipsDisplayOn=tipsDisplayOn==!0?!1:!0;n=[];n={bwParticipantId:participantId,bwTipsDisplayOn:tipsDisplayOn.toString()};t=webserviceurl+"/bwparticipant/updateuserconfigurationbehaviorTipsDisplay";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"?displayAlertDialog(n):tipsDisplayOn==!0?($("#spanAlertLink").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkNewRequest").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkMyStuff").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkSummary").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkConfiguration").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkHelp").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;")):($("#spanAlertLink").html("&nbsp;"),$("#spanAlertLinkNewRequest").html("&nbsp;"),$("#spanAlertLinkMyStuff").html("&nbsp;"),$("#spanAlertLinkSummary").html("&nbsp;"),$("#spanAlertLinkConfiguration").html("&nbsp;"),$("#spanAlertLinkHelp").html("&nbsp;"))},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorTipsSlider.change(): "+t+" "+i)}})});$("#configurationBehaviorDisplayNewRequestsOnHomePageSlider").change(function(){var n,t;displayNewRequestsOnHomePageDisplayOn=displayNewRequestsOnHomePageDisplayOn==!0?!1:!0;n=[];n={bwParticipantId:participantId,bwNewRequestsOnHomePageDisplayOn:displayNewRequestsOnHomePageDisplayOn.toString()};t=webserviceurl+"/bwparticipant/updateuserconfigurationbehaviordisplaynewrequestsonhomepage";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"&&displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorDisplayNewRequestsOnHomePageSlider.change(): "+t+" "+i)}})});$("#configurationBehaviorDisplayInvitationsOnHomePageSlider").change(function(){var n,t;displayInvitationsOnHomePageDisplayOn=displayInvitationsOnHomePageDisplayOn==!0?!1:!0;n=[];n={bwParticipantId:participantId,bwInvitationsOnHomePageDisplayOn:displayInvitationsOnHomePageDisplayOn.toString()};t=webserviceurl+"/bwparticipant/updateuserconfigurationbehaviordisplayinvitationsonhomepage";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"?displayAlertDialog(n):displayInvitationsOnHomePageDisplayOn==!0?$("#divInvitationSectionOnHomePage").show():$("#divInvitationSectionOnHomePage").hide()},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorDisplayInvitationsOnHomePageSlider.change(): "+t+" "+i)}})})}function kupValidateLicenseFormat(){var n,i,t;if(document.getElementById("btnAddNewLicense").disabled=!0,n=document.getElementById("txtLicense").value,n.length==36&&n.split("-")[0].length==8&&n.split("-")[1].length==4&&n.split("-")[2].length==4&&n.split("-")[3].length==4&&n.split("-")[4].length==12&&n.split("-")[2].indexOf("4")==0)if(globalLicenses.length==0)document.getElementById("btnAddNewLicense").disabled=!1;else{for(i=!1,t=0;t<globalLicenses.length;t++)globalLicenses[t][2]==n&&(i=!0);i==!0?(displayAlertDialog("You have already assigned this license. It can't be assigned twice."),document.getElementById("txtLicense").value=""):document.getElementById("btnAddNewLicense").disabled=!1}}function getLicenseExpiryFriendlyDate(n){var t=Number(n.split("-")[0])+1,i=n.split("-")[1],r=n.split("-")[2],u=r.split("T")[0],f=monthNames[i-1];return f+" "+u+", "+t}function cmdViewLicenses(){displayAlertDialog("This functionality is incomplete. Coming soon, this is where you will be able to view your license details and purchase invoice.")}function cmdAddNewLicense(){var i=document.getElementById("txtLicense").value,n=[],t;n={LicenseClaimedById:participantId,LicenseClaimedByFriendlyName:participantFriendlyName,LicenseClaimedByEmail:participantEmail,bwWorkflowAppId:workflowAppId,bwWorkflowAppLicenseId:i};t=webserviceurl+"/bwworkflowapplicenses/add";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){var t,i,r;if(n.message=="SUCCESS"){for(gWorkflowLicenseStatus=n.LicensePackageCategory,t=new Array(5),t[0]=n.LicensePackageCategory,t[1]=n.LicensePackageCategory,t[2]=n.bwWorkflowAppLicenseId,t[3]=n.LicenseClaimedTimestamp,t[4]=getLicenseExpiryFriendlyDate(n.LicenseClaimedTimestamp),globalLicenses.push(t),i="",r=0;r<globalLicenses.length;r++)i+='<br /><span style="cursor:pointer;" title="Click here to view your licenses..." onclick="cmdViewLicenses();"><span style="font-size:x-small;color:gray;">'+globalLicenses[r][2]+"<\/span>&nbsp;&nbsp;",i+='<span style="font-size:small;font-style:italic;">This '+globalLicenses[r][1]+" license is good until "+globalLicenses[r][4]+".<\/span><\/span>";i+="";i+="";i+="";document.getElementById("spanLicenseStatus").innerHTML=i;document.getElementById("txtLicense").value="";populateStartPageItem("divWorkflowSettings","Reports","")}else displayAlertDialog(n.message)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdAddNewLicense.bwworkflowapplicenses/add(): "+t+" "+i)}})}function displayForm_DisplayCloseOut(n){var t,i,u,r;try{$("#ArDialog").dialog("close")}catch(f){}$("#bwQuickLaunchMenuTd").css({width:"0"});$("#liWelcome").show();$("#liOfflineWelcome").hide();$("#liNewRequest").hide();$("#liArchive").hide();$("#liSummaryReport").hide();$("#liConfiguration").hide();$("#liHelp").hide();$("#liOfflineRequestForm").hide();t=document.getElementById("divNewRequestMasterDiv");t.style.borderRadius="120px 0 0 120px";$("#divWelcomeMasterDivTitle").text("Closeout: "+n);$("#divWelcomePageLeftButtonsWelcomeButton").css({height:"28px",width:"92%","white-space":"nowrap","border-radius":"0 0 0 0",padding:"12px 0 0 20px",margin:"0 0 0 0","border-width":"0 0 0 0","background-color":"#6682b5",color:"white",outline:"none",cursor:"pointer"});$("#divWelcomePageLeftButtonsWelcomeButton").off("click").click(function(){renderWelcomeScreen()});i='<div id="myxml" align="left" style="FONT-SIZE: 10pt; FONT-FAMILY: Calibri;"><\/div>';$("#welcomePageMyTasksTab").html(i);u="";r=webserviceurl+"/bwbudgetrequests/"+n;$.ajax({url:r,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var h=n.d.results[0][0].CloseoutXml,f="",i,t,r,e,o,s;f="/"+viewsFolderName+"/CloseOutEditForm.xsl";i=appweburl2+f;t=null;try{t=new ActiveXObject("Microsoft.XMLDOM");t.async=!1;t.load(i)}catch(u){try{t=document.implementation.createDocument("","",null);t.async=!1;t.load(i)}catch(u){try{r=new window.XMLHttpRequest;r.open("GET",i,!1);r.send(null);t=r.responseXML.documentElement}catch(u){displayAlertDialog("Failure attempting to parse XSLT in the browser.");WriteToErrorLog("Error in ios8.js.displayForm_DisplayArBasedOnWorkflowStatus()","Resubmit: Failure attempting to parse XSLT in the browser: "+u.name+", "+u.message+", "+u.stack);redirectForm()}}}e=TransformToHtmlText(h,t);$("#welcomePageMyTasksTab").empty();$("#welcomePageMyTasksTab").append(e);$("#dtCloseoutDate").datepicker();$("#dtPlacedIntoServiceDate").datepicker();o=$('span[xd\\:binding = "my:coDate"]')[0].innerHTML;document.getElementById("dtCloseoutDate").value=o;s=$('span[xd\\:binding = "my:coPlacedIntoServiceDate"]')[0].innerHTML;document.getElementById("dtPlacedIntoServiceDate").value=s;formatCurrency2("my:coEstimatedAmountClosed")},error:function(n,t,i){displayAlertDialog("Error in ios8.js.displayForm_DisplayCloseOut: "+i)}})}function renderLicensesOnSettingsPage(){var t="",n;if(globalLicenses.length==0)t+='<br /><span style="font-size:small;font-style:italic;">This workflow has no licenses assigned. It is currently the basic (free) version.<\/span>';else for(n=0;n<globalLicenses.length;n++)t+='<br /><span style="cursor:pointer;" title="Click here to view your licenses..." onclick="cmdViewLicenses();"><span style="font-size:x-small;color:gray;">'+globalLicenses[n][2]+"<\/span>&nbsp;&nbsp;",t+='<span style="font-size:small;font-style:italic;">This '+globalLicenses[n][1]+" license is good until "+globalLicenses[n][4]+".<\/span><\/span>";document.getElementById("spanLicenseStatus").innerHTML=t}function generateWorkflowSettingsPage(){var n,r,u,f,e,o,s,h,c,l,a,v,y,i,t,p;if(newBudgetRequestManagerTitle==""&&(newBudgetRequestManagerTitle="Manager"),$("#divFunctionalAreasMasterDiv").empty(),$("#divFunctionalAreasMasterSubMenuDiv").hide(),n="",n+='<table style="width:100%;padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+='<tr style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+='<td style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+='<div class="">',n+='<span id="spanSecondTopBarExpandCollapse" class="spanTopBarExpandCollapseIos8" onclick="cmdSecondTopBarExpandCollapse(\'spanSecondTopBarExpandCollapse\');">+<\/span><span id="xxxx" class="divTopBarTextContentsIos8" onclick="cmdSecondTopBarExpandCollapse(\'spanSecondTopBarExpandCollapse\');">Settings<\/span>',n+="<\/div>",n+="<\/td>",n+='<td style="text-align:right;white-space:nowrap;font-size:small;padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;"><!--Year:&nbsp;<select id="ddlYear" onchange="cmdYearSelectedChanged();"><\/select>--><\/td>',n+="<\/tr>",n+="<\/table>",$("#divFunctionalAreasMasterDiv").html(n),disableWorkflowSettingsButton(),$("#divFunctionalAreasSubSubMenus").empty(),n="",n+='<table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+="  <tr>",n+="    <td>",n+='<table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+="  <tr>",n+="    <td>",n+='        <span style="font-size:22pt;font-style:italic;">The currency symbol is displayed throughout.<\/span>',n+="    <\/td><\/tr>",n+="<\/table>",n+="<table>",n+="  <tr>",n+='    <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Currency symbol:&nbsp;",n+="    <\/td>",n+='    <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <select class="spanH2" id="selectBudgetRequestCurrencySymbol">',n+='           <option value="Dollar" selected>$ - Dollar ($ 9.99)<\/option>',n+='           <option value="Pound">£ - Pound (£ 9.99)<\/option>',n+='           <option value="Euro">€ - Euro (€ 9.99)<\/option>',n+='           <option value="Rand">R - Rand (R 9.99)<\/option>',n+='           <option value="Franc">₣ - Franc (₣ 9.99)<\/option>',n+='           <option value="Yen">¥ - Yen (¥ 9.99)<\/option>',n+='           <option value="Rouble">₽ - Rouble (₽ 9.99)<\/option>',n+='           <option value="Peso">₱ - Peso (₱ 9.99)<\/option>',n+='           <option value="Rupee">₹ - Rupee (₹ 9.99)<\/option>',n+='           <option value="Guilder">ƒ - Guilder (ƒ 9.99)<\/option>',n+="       <\/select>",n+="    <\/td>",n+="  <\/tr>",n+="<\/table>",n+="<br /><br />",n+='<table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+="  <tr>",n+="    <td>",n+='        <span style="font-size:22pt;font-style:italic;">The title of the workflow is displayed throughout, and also appears in email communications.<\/span>',n+="    <\/td><\/tr>",n+="<\/table>",n+="<table>",n+="  <tr>",n+='    <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Workflow title:&nbsp;",n+="    <\/td>",n+='    <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <input id="txtWorkflowAppTitle" type="text" value="" style="width:700px;" class="spanH2" />',n+='       &nbsp;&nbsp;<input type="button" value="Save" onclick="cmdSaveWorkflowTitle();" class="BwButton200" />',n+="    <\/td>",n+="  <\/tr>",n+="<\/table>",n+="<br /><br />",n+='<table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+="  <tr>",n+="    <td>",n+='        <span style="font-size:22pt;font-style:italic;">Specifying a user here enables the PO# issuing process. When a Budget Request has been completely approved, this user will issue a Purchase Order Number from your accounting system, and the Budget Request will be marked as Active.<\/span>',n+="    <\/td><\/tr>",n+="<\/table>",n+="<table>",n+="  <tr>",n+='    <td style="text-align:left;" class="bwSliderTitleCell">',n+='       <span id="spanDepartmentTitle"><\/span>:&nbsp;',n+="    <\/td>",n+='    <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <input id="txtBwDepartmentUserName" title="" class="spanH2" />',n+='       <input id="txtBwDepartmentUserId" style="display:none;" />',n+='       <input id="txtBwDepartmentUserEmail" style="display:none;" />',n+="       &nbsp;<img src=\"images/addressbook-icon35x35.png\" onclick=\"cmdDisplayPeoplePickerDialog('txtBwDepartmentUserName', 'txtBwDepartmentUserId', 'txtBwDepartmentUserEmail', 'btnSaveRemoveAccountingDepartmentUser');\" style=\"width:80px;height:80px;cursor:pointer;vertical-align:text-bottom;\" />",n+='       &nbsp;&nbsp;<span id="spanSaveAccountingDepartmentUserButton"><\/span>',n+="    <\/td>",n+="  <\/tr>",n+="<\/table>",n+="<br /><br />",n+='<table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',n+="  <tr>",n+="    <td>",n+='        <span style="font-size:22pt;font-style:italic;">The title of the person responsible for completing the details of a New Request. This is displayed on the Budget Request forms. The default is "Manager".<\/span>',n+="    <\/td><\/tr>",n+="<\/table>",n+="<table>",n+="  <tr>",n+='    <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Manager title:&nbsp;",n+="    <\/td>",n+='    <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <input id="NewBudgetRequestManagerTitle" type="text" value="'+newBudgetRequestManagerTitle+'" style="width:700px;" class="spanH2" />',n+='       &nbsp;&nbsp;<input type="button" value="Save" onclick="cmdSaveNewRequestManagerTitle();" class="BwButton200" />',n+="    <\/td>",n+="  <\/tr>",n+="<\/table>",n+="<br /><br />",n+="<table>",n+="<tr>",n+='   <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Require start/end dates on new requests:",n+="   <\/td>",n+='   <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <label for="configurationBehaviorRequireStartEndDatesSlider"><\/label><input type="checkbox" name="configurationBehaviorRequireStartEndDatesSlider" id="configurationBehaviorRequireStartEndDatesSlider" />',n+="   <\/td>",n+="<\/tr>",n+="<tr><td>&nbsp;<\/td><td><\/td><\/tr>",n+="<tr>",n+='   <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Require that a new request has some details:",n+="   <\/td>",n+='   <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <label for="configurationBehaviorRequireDetailsSlider"><\/label><input type="checkbox" name="configurationBehaviorRequireDetailsSlider" id="configurationBehaviorRequireDetailsSlider" />',n+="   <\/td>",n+="<\/tr>",n+="<tr><td>&nbsp;<\/td><td><\/td><\/tr>",n+="<tr>",n+='    <td colspan="2">',n+='<span style="font-size:small;font-style:italic;"><\/span>',n+="    <\/td>",n+="<\/tr>",n+="<tr>",n+='   <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Require attachments on new requests:",n+="   <\/td>",n+='   <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <label for="configurationBehaviorEnableNewRequestAttachmentsSlider"><\/label><input type="checkbox" name="configurationBehaviorEnableNewRequestAttachmentsSlider" id="configurationBehaviorEnableNewRequestAttachmentsSlider" />',n+="   <\/td>",n+="<\/tr>",n+="<tr><td>&nbsp;<\/td><td><\/td><\/tr>",(gWorkflowLicenseStatus=="bronze"||gWorkflowLicenseStatus=="silver"||gWorkflowLicenseStatus=="gold")&&(n+="<tr>",n+='   <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Enable budget requests:",n+="   <\/td>",n+='   <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <label for="configurationBehaviorEnableCapitalAndExpenseTrackingSlider"><\/label><input type="checkbox" name="configurationBehaviorEnableCapitalAndExpenseTrackingSlider" id="configurationBehaviorEnableCapitalAndExpenseTrackingSlider" />',n+="   <\/td>",n+="<\/tr>",n+="<tr><td>&nbsp;<\/td><td><\/td><\/tr>"),n+="<tr>",n+='   <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Enable quote requests:",n+="   <\/td>",n+='   <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <label for="configurationBehaviorEnableQuotingSlider"><\/label><input type="checkbox" name="configurationBehaviorEnableQuotingSlider" id="configurationBehaviorEnableQuotingSlider" />',n+="   <\/td>",n+="<\/tr>",n+="<tr><td>&nbsp;<\/td><td><\/td><\/tr>",n+="<tr>",n+='   <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Enable reimbursement requests:",n+="   <\/td>",n+='   <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <label for="configurationBehaviorEnableReimbursementRequestsSlider"><\/label><input type="checkbox" name="configurationBehaviorEnableReimbursementRequestsSlider" id="configurationBehaviorEnableReimbursementRequestsSlider" />',n+="   <\/td>",n+="<\/tr>",n+="<tr><td>&nbsp;<\/td><td><\/td><\/tr>",(gWorkflowLicenseStatus=="silver"||gWorkflowLicenseStatus=="gold")&&(n+="<tr>",n+='   <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Enable recurring expenses:",n+="   <\/td>",n+='   <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <label for="configurationBehaviorEnableRecurringExpensesSlider"><\/label><input type="checkbox" name="configurationBehaviorEnableRecurringExpensesSlider" id="configurationBehaviorEnableRecurringExpensesSlider" />',n+="   <\/td>",n+="<\/tr>",n+="<tr><td>&nbsp;<\/td><td><\/td><\/tr>"),gWorkflowLicenseStatus=="gold"&&(n+="<tr>",n+='   <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Enable addendums to existing requests (supplementals):",n+="   <\/td>",n+='   <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <label for="configurationBehaviorEnableSupplementalsSlider"><\/label><input type="checkbox" name="configurationBehaviorEnableSupplementalsSlider" id="configurationBehaviorEnableSupplementalsSlider" />',n+="   <\/td>",n+="<\/tr>",n+="<tr><td>&nbsp;<\/td><td><\/td><\/tr>"),n+="<tr>",n+='   <td style="text-align:left;" class="bwSliderTitleCell">',n+="       Enable closeouts:",n+="   <\/td>",n+='   <td class="bwChartCalculatorLightCurrencyTableCell">',n+='       <label for="configurationBehaviorEnableCloseOutsSlider"><\/label><input type="checkbox" name="configurationBehaviorEnableCloseOutsSlider" id="configurationBehaviorEnableCloseOutsSlider" />',n+="   <\/td>",n+="<\/tr>",n+="<tr><td>&nbsp;<\/td><td><\/td><\/tr>",n+="<\/table>",n+="",n+="    <\/td>",n+="  <\/tr>",n+="<\/table>",n+="<br /><br />",$("#divFunctionalAreasSubSubMenus").html(n),$("#spanDepartmentTitle").text("Procurement"),r={checked:tipsDisplayOn,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>ON<\/span>",off_label:"<span style='font-size:30pt;'>OFF<\/span>",width:50,height:22,button_width:24,clear_after:null},$("input#configurationBehaviorTipsSlider").switchButton(r),u={checked:requireStartEndDates,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>YES<\/span>",off_label:"<span style='font-size:30pt;'>NO<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#configurationBehaviorRequireStartEndDatesSlider").switchButton(u),f={checked:requireRequestDetails,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>YES<\/span>",off_label:"<span style='font-size:30pt;'>NO<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#configurationBehaviorRequireDetailsSlider").switchButton(f),e={checked:enableNewRequestAttachments,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>YES<\/span>",off_label:"<span style='font-size:30pt;'>NO<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#configurationBehaviorEnableNewRequestAttachmentsSlider").switchButton(e),o={checked:enableNewRequestBarcodeAttachments,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>YES<\/span>",off_label:"<span style='font-size:30pt;'>NO<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#configurationBehaviorEnableNewRequestBarcodeAttachmentsSlider").switchButton(o),s={checked:quotingEnabled,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>YES<\/span>",off_label:"<span style='font-size:30pt;'>NO<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#configurationBehaviorEnableQuotingSlider").switchButton(s),h={checked:reimbursementRequestsEnabled,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>YES<\/span>",off_label:"<span style='font-size:30pt;'>NO<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#configurationBehaviorEnableReimbursementRequestsSlider").switchButton(h),c={checked:closeoutsEnabled,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>YES<\/span>",off_label:"<span style='font-size:30pt;'>NO<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#configurationBehaviorEnableCloseOutsSlider").switchButton(c),l={checked:capitalAndExpenseTrackingEnabled,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>YES<\/span>",off_label:"<span style='font-size:30pt;'>NO<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#configurationBehaviorEnableCapitalAndExpenseTrackingSlider").switchButton(l),a={checked:recurringExpensesEnabled,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>YES<\/span>",off_label:"<span style='font-size:30pt;'>NO<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#configurationBehaviorEnableRecurringExpensesSlider").switchButton(a),v={checked:supplementalsEnabled,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>YES<\/span>",off_label:"<span style='font-size:30pt;'>NO<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#configurationBehaviorEnableSupplementalsSlider").switchButton(v),y={checked:strictAuditingEnabled,show_labels:!0,labels_placement:"left",on_label:"<span style='font-size:30pt;'>YES<\/span>",off_label:"<span style='font-size:30pt;'>NO<\/span>",width:200,height:88,button_width:96,clear_after:null},$("input#configurationBehaviorEnableStrictAuditingSlider").switchButton(y),document.getElementById("selectBudgetRequestCurrencySymbol").value=selectedCurrencySymbol,$("#txtWorkflowAppTitle").val(workflowAppTitle),globalLicenses.length>0){for(i="",t=0;t<globalLicenses.length;t++)i+='<br /><span style="font-size:x-small;color:gray;">'+globalLicenses[t][2]+"<\/span>&nbsp;&nbsp;",i+='<span style="font-size:small;font-style:italic;">This '+globalLicenses[t][1]+" license is good until "+globalLicenses[t][4]+".<\/span>";document.getElementById("spanLicenseStatus").innerHTML=i}$("#selectBudgetRequestCurrencySymbol").change(function(){var n=document.getElementById("selectBudgetRequestCurrencySymbol").value,t=[],i;t={bwTenantId:tenantId,bwWorkflowAppId:workflowAppId,bwSelectedCurrencySymbol:n};i=webserviceurl+"/bwworkflowapp/updateworkflowconfigurationselectedcurrencysymbol";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){t!="SUCCESS"?displayAlertDialog(t):bwSelectedCurrencySymbol=n},error:function(n,t,i){displayAlertDialog("Error in ios8.js.selectBudgetRequestCurrencySymbol.change(): "+t+" "+i)}})});$("#selectBudgetRequestTitleFormat").change(function(){displayAlertDialog("This functionality is not complete. Currently there is only the default Title format.");document.getElementById("selectBudgetRequestTitleFormat").selectedIndex=0});$("#configurationBehaviorTipsSlider").change(function(){var n,t;tipsDisplayOn=tipsDisplayOn==!0?!1:!0;n=[];n={bwParticipantId:participantId,bwTipsDisplayOn:tipsDisplayOn.toString()};t=webserviceurl+"/bwparticipant/updateuserconfigurationbehaviorTipsDisplay";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"?displayAlertDialog(n):tipsDisplayOn==!0?($("#spanAlertLink").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkNewRequest").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkMyStuff").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkSummary").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkConfiguration").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;"),$("#spanAlertLinkHelp").html("Tips!&nbsp;&nbsp;&nbsp;&nbsp;")):($("#spanAlertLink").html("&nbsp;"),$("#spanAlertLinkNewRequest").html("&nbsp;"),$("#spanAlertLinkMyStuff").html("&nbsp;"),$("#spanAlertLinkSummary").html("&nbsp;"),$("#spanAlertLinkConfiguration").html("&nbsp;"),$("#spanAlertLinkHelp").html("&nbsp;"))},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorTipsSlider.change(): "+t+" "+i)}})});$("#configurationBehaviorRequireStartEndDatesSlider").change(function(){var n,t;requireStartEndDates=requireStartEndDates==!0?!1:!0;n=[];n={bwWorkflowAppId:workflowAppId,bwRequireStartEndDates:requireStartEndDates.toString()};t=webserviceurl+"/bwworkflow/updateworkflowconfigurationbehaviorrequirestartenddates";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"&&displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorRequireStartEndDatesSlider.change(): "+t+" "+i)}})});$("#configurationBehaviorRequireDetailsSlider").change(function(){var n,t;requireRequestDetails=requireRequestDetails==!0?!1:!0;n=[];n={bwWorkflowAppId:workflowAppId,bwRequireRequestDetails:requireRequestDetails.toString()};t=webserviceurl+"/bwworkflow/updateworkflowconfigurationbehaviorrequirerequestdetails";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"&&displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorRequireDetailsSlider.change(): "+t+" "+i)}})});$("#configurationBehaviorEnableNewRequestAttachmentsSlider").change(function(){var n,t,i,r;enableNewRequestAttachments=enableNewRequestAttachments==!0?!1:!0;n=!0;t=!1;reimbursementRequestsEnabled==!0&&enableNewRequestAttachments==!1&&(n=confirm("Reimbursement Requests will be turned off as well, because attachments are required for this functionality.\n\n\nClick the OK button to proceed..."),n==!0&&(t=!0));n==!0&&(t==!0&&$("input#configurationBehaviorEnableReimbursementRequestsSlider").switchButton({checked:!1}),i=[],i={bwWorkflowAppId:workflowAppId,bwEnableNewRequestAttachments:enableNewRequestAttachments.toString()},r=webserviceurl+"/bwworkflow/updateworkflowconfigurationbehaviorenablenewrequestattachments",$.ajax({url:r,type:"POST",timeout:ajaxTimeout,data:i,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"&&displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorEnableNewRequestAttachmentsSlider.change():2: "+t+" "+i)}}))});$("#configurationBehaviorEnableNewRequestBarcodeAttachmentsSlider").change(function(){var n,t;enableNewRequestBarcodeAttachments=enableNewRequestBarcodeAttachments==!0?!1:!0;n=[];n={bwWorkflowAppId:workflowAppId,bwEnableNewRequestBarcodeAttachments:enableNewRequestBarcodeAttachments.toString()};t=webserviceurl+"/bwworkflow/updateworkflowconfigurationbehaviorenablenewrequestbarcodeattachments";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"&&displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorEnableNewRequestBarcodeAttachmentsSlider.change(): "+t+" "+i)}})});$("#configurationBehaviorEnableQuotingSlider").change(function(){var n,t;quotingEnabled=quotingEnabled==!0?!1:!0;n=[];n={bwWorkflowAppId:workflowAppId,bwQuotingEnabled:quotingEnabled.toString()};t=webserviceurl+"/bwworkflow/updateworkflowconfigurationbehaviorquotingenabled";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"&&displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorEnableQuotingSlider.change(): "+t+" "+i)}})});$("#configurationBehaviorEnableReimbursementRequestsSlider").change(function(){var n,t,i,r;reimbursementRequestsEnabled=reimbursementRequestsEnabled==!0?!1:!0;n=!0;t=!1;enableNewRequestAttachments==!1&&reimbursementRequestsEnabled==!0&&(n=confirm("Attachments will be enabled because they are needed by the Reimbursement Request process.\n\n\nClick the OK button to proceed..."),n==!0&&(t=!0));n==!0&&(t==!0&&$("input#configurationBehaviorEnableNewRequestAttachmentsSlider").switchButton({checked:!0}),i=[],i={bwWorkflowAppId:workflowAppId,bwExpenseRequestsEnabled:reimbursementRequestsEnabled.toString()},r=webserviceurl+"/bwworkflow/updateworkflowconfigurationbehaviorexpenserequestsenabled",$.ajax({url:r,type:"POST",timeout:ajaxTimeout,data:i,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"&&displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorEnableReimbursementRequestsSlider.change():2: "+t+" "+i)}}))});$("#configurationBehaviorEnableCloseOutsSlider").change(function(){var n,t;closeoutsEnabled=closeoutsEnabled==!0?!1:!0;n=[];n={bwWorkflowAppId:workflowAppId,bwCloseoutsEnabled:closeoutsEnabled.toString()};t=webserviceurl+"/bwworkflow/updateworkflowconfigurationbehaviorcloseoutsenabled";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"&&displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorEnableCloseOutsSlider.change(): "+t+" "+i)}})});$("#configurationBehaviorEnableCapitalAndExpenseTrackingSlider").change(function(){var n,t;capitalAndExpenseTrackingEnabled=capitalAndExpenseTrackingEnabled==!0?!1:!0;n=[];n={bwWorkflowAppId:workflowAppId,bwCapitalAndExpenseTrackingEnabled:capitalAndExpenseTrackingEnabled.toString()};t=webserviceurl+"/bwworkflow/updateworkflowconfigurationbehaviorcapitalandexpensetrackingenabled";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"&&displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorEnableCapitalAndExpenseTrackingSlider.change(): "+t+" "+i)}})});$("#configurationBehaviorEnableRecurringExpensesSlider").change(function(){var n,t;recurringExpensesEnabled=recurringExpensesEnabled==!0?!1:!0;n=[];n={bwWorkflowAppId:workflowAppId,bwRecurringExpensesEnabled:recurringExpensesEnabled.toString()};t=webserviceurl+"/bwworkflow/updateworkflowconfigurationbehaviorrecurringexpensesenabled";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){var t;n!="SUCCESS"?displayAlertDialog(n):recurringExpensesEnabled?(t='<input type="radio" name="rbRecurringExpensesChoice" /><span>recurring on fixed dates<\/span>',document.getElementById("spanRecurringExpensesChoiceOnFixedDates").innerHTML=t,t='<input type="radio" name="rbRecurringExpensesChoice" /><span>recurring on a time period<\/span>',document.getElementById("spanRecurringExpensesChoiceOnATimePeriod").innerHTML=t):(t='<input type="radio" name="rbRecurringExpensesChoice" disabled /><span style="color: #adadad;">recurring on fixed dates<\/span>',document.getElementById("spanRecurringExpensesChoiceOnFixedDates").innerHTML=t,t='<input type="radio" name="rbRecurringExpensesChoice" disabled /><span style="color: #adadad;">recurring on a time period<\/span>',document.getElementById("spanRecurringExpensesChoiceOnATimePeriod").innerHTML=t)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorEnableRecurringExpensesSlider.change(): "+t+" "+i)}})});$("#configurationBehaviorEnableSupplementalsSlider").change(function(){var n,t;supplementalsEnabled=supplementalsEnabled==!0?!1:!0;n=[];n={bwWorkflowAppId:workflowAppId,bwSupplementalsEnabled:supplementalsEnabled.toString()};t=webserviceurl+"/bwworkflow/updateworkflowconfigurationbehaviorsupplementalsenabled";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"&&displayAlertDialog(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorEnableSupplementalsSlider.change(): "+t+" "+i)}})});$("#configurationBehaviorEnableStrictAuditingSlider").change(function(){var n,t;strictAuditingEnabled=strictAuditingEnabled==!0?!1:!0;n=[];n={bwWorkflowAppId:workflowAppId,bwStrictAuditingEnabled:strictAuditingEnabled.toString()};t=webserviceurl+"/bwworkflow/updateworkflowconfigurationbehaviorstrictauditingenabled";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"?displayAlertDialog(n):displayAlertDialog("This functionality is incomplete. Coming soon! ios8.js.configurationBehaviorEnableStrictAuditingSlider.change().")},error:function(n,t,i){displayAlertDialog("Error in ios8.js.configurationBehaviorEnableStrictAuditingSlider.change(): "+t+" "+i)}})});$("#txtBwDepartmentUserName").autocomplete({source:function(n,t){$.ajax({url:webserviceurl+"/tenant/"+tenantId+"/participants/"+n.term,dataType:"json",success:function(n){for(var r=[],i=0;i<n.participants.length;i++)r[i]=n.participants[i].participant;t(r)}})},minLength:1,select:function(){},open:function(){},close:function(){var n=this.value.split("|")[0],t=this.value.split("|")[1];n.indexOf("undefined")>-1?(document.getElementById("txtBwDepartmentUserName").value="",document.getElementById("txtBwDepartmentUserId").value=""):(document.getElementById("txtBwDepartmentUserName").value=n,document.getElementById("txtBwDepartmentUserId").value=t,document.getElementById("btnSaveRemoveAccountingDepartmentUser").disabled=!1)}});p={bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwdepartments",type:"DELETE",contentType:"application/json",data:JSON.stringify(p),success:function(n){var t,i;if(n.length>0)for(t=0;t<n.length;t++)n[t].bwDepartmentTitle=="Procurement"&&($("#txtBwDepartmentUserName").val(n[t].bwDepartmentUserName),$("#txtBwDepartmentUserId").val(n[t].bwDepartmentUserId),i="",i+='<input id="btnSaveRemoveAccountingDepartmentUser" type="button" value="Remove" onclick="cmdRemoveAccountingDepartmentUser();" class="BwButton200" />',document.getElementById("spanSaveAccountingDepartmentUserButton").innerHTML=i);else i="",i+='<input id="btnSaveRemoveAccountingDepartmentUser" type="button" value="Save" onclick="cmdSaveAccountingDepartmentUser();" disabled class="BwButton200" />',document.getElementById("spanSaveAccountingDepartmentUserButton").innerHTML=i},error:function(n,t,i){displayAlertDialog("Error in ios8.js.generateWorkflowSettingsPage DELETE /bwdepartments:"+t+", "+i)}})}function cmdSaveWorkflowTitle(){var n=document.getElementById("txtWorkflowAppTitle").value,t=[],i;t={bwWorkflowAppId:workflowAppId,bwWorkflowAppTitle:n};i=webserviceurl+"/bwworkflowapp/updateworkflowconfigurationworkflowapptitle";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){t!="SUCCESS"?displayAlertDialog(t):workflowAppTitle=n},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdSaveWorkflowTitle(): "+t+" "+i)}})}function cmdSaveBudgetRequestTitlePrefix(){displayAlertDialog("This functionality is incomplete. Coming soon! In ios8.js.cmdSaveBudgetRequestTitlePrefix().")}function cmdSaveNewRequestManagerTitle(){var n=document.getElementById("NewBudgetRequestManagerTitle").value,t=[],i;t={bwTenantId:tenantId,bwWorkflowAppId:workflowAppId,bwNewBudgetRequestManagerTitle:n};i=webserviceurl+"/bwworkflowapp/updateworkflowconfigurationnewbudgetrequestmanagertitle";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){t!="SUCCESS"?displayAlertDialog(t):newBudgetRequestManagerTitle=n},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdSaveNewRequestManagerTitle(): "+t+" "+i)}})}function cmdRbgMyEmailNotificationTypes_click(n){var t,i;emailNotificationTypes=n;t=[];t={bwParticipantId:participantId,bwEmailNotificationTypes:n};i=webserviceurl+"/bwparticipant/updateuserconfigurationbehaviorEmailNotificationTypes";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){t!="SUCCESS"?displayAlertDialog(t):n=="allnotifications"?(document.getElementById("spanEmailNotificationTypeAllNotifications").style.color="black",document.getElementById("spanEmailNotificationTypeOnlyTasks").style.color="gray",document.getElementById("spanEmailNotificationTypeNoNotifications").style.color="gray"):n=="onlymytasknotifications"?(document.getElementById("spanEmailNotificationTypeAllNotifications").style.color="gray",document.getElementById("spanEmailNotificationTypeOnlyTasks").style.color="black",document.getElementById("spanEmailNotificationTypeNoNotifications").style.color="gray"):n=="nonotifications"&&(document.getElementById("spanEmailNotificationTypeAllNotifications").style.color="gray",document.getElementById("spanEmailNotificationTypeOnlyTasks").style.color="gray",document.getElementById("spanEmailNotificationTypeNoNotifications").style.color="black")},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdRbgMyEmailNotificationTypes_click(): "+t+" "+i)}})}function cmdRbgMyEmailNotificationFrequency_click(n){var t,i;$("#divWorkingOnItDialog").dialog({modal:!0,resizable:!1,closeOnEscape:!1,title:"Working on it...",width:"800",dialogClass:"no-close",hide:!1});$("#divWorkingOnItDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove();emailNotificationFrequency=n;emailAggregatorTwiceDailyFirstTime=document.getElementById("selectAggregateEmailTwiceDailyFirstTime").value;emailAggregatorTwiceDailySecondTime=document.getElementById("selectAggregateEmailTwiceDailySecondTime").value;emailAggregatorTwiceDailyTimezoneDisplayName=document.getElementById("selectAggregateEmailTwiceDailyTimezoneDisplayName").value;t=[];t={bwParticipantId:participantId,bwEmailNotificationFrequency:n,bwEmailAggregatorTwiceDailyFirstTime:emailAggregatorTwiceDailyFirstTime,bwEmailAggregatorTwiceDailySecondTime:emailAggregatorTwiceDailySecondTime,bwEmailAggregatorTwiceDailyTimezoneDisplayName:emailAggregatorTwiceDailyTimezoneDisplayName};i=webserviceurl+"/bwparticipant/updateuserconfigurationbehavioremailnotificationfrequency";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(t){$("#divWorkingOnItDialog").dialog("close");t.message!="SUCCESS"?(displayAlertDialog(t.message),n=="immediately"?(document.getElementById("spanRbEmailImmediately").style.color="black",document.getElementById("spanRbAggregateEmailTwiceDaily").style.color="gray",document.getElementById("selectAggregateEmailTwiceDailyFirstTime").disabled=!0,document.getElementById("selectAggregateEmailTwiceDailySecondTime").disabled=!0,document.getElementById("selectAggregateEmailTwiceDailyTimezoneDisplayName").disabled=!0):n=="aggregatetwicedaily"&&(document.getElementById("spanRbEmailImmediately").style.color="gray",document.getElementById("spanRbAggregateEmailTwiceDaily").style.color="black",document.getElementById("selectAggregateEmailTwiceDailyFirstTime").disabled=!1,document.getElementById("selectAggregateEmailTwiceDailySecondTime").disabled=!1,document.getElementById("selectAggregateEmailTwiceDailyTimezoneDisplayName").disabled=!1)):n=="immediately"?(document.getElementById("spanRbEmailImmediately").style.color="black",document.getElementById("spanRbAggregateEmailTwiceDaily").style.color="gray",document.getElementById("selectAggregateEmailTwiceDailyFirstTime").disabled=!0,document.getElementById("selectAggregateEmailTwiceDailySecondTime").disabled=!0,document.getElementById("selectAggregateEmailTwiceDailyTimezoneDisplayName").disabled=!0):n=="aggregatetwicedaily"&&(document.getElementById("spanRbEmailImmediately").style.color="gray",document.getElementById("spanRbAggregateEmailTwiceDaily").style.color="black",document.getElementById("selectAggregateEmailTwiceDailyFirstTime").disabled=!1,document.getElementById("selectAggregateEmailTwiceDailySecondTime").disabled=!1,document.getElementById("selectAggregateEmailTwiceDailyTimezoneDisplayName").disabled=!1)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdRbgMyEmailNotificationFrequency_click(): "+t+" "+i)}})}function createANewWorkflowApp(){var n={bwParticipantId:participantId,participantFriendlyName:participantFriendlyName,participantEmail:participantEmail,bwParticipantLogonType:participantLogonType,bwTenantId:tenantId};$.ajax({url:webserviceurl+"/bwworkflowapps/addaworkflow",type:"PUT",contentType:"application/json",data:JSON.stringify(n),success:function(n){var n,t;workflowAppId=n.workflowAppId;workflowAppTitle=n.workflowAppTitle;$("#AddAWorkflowAppDialog").dialog("close");$("#bwLoggedInUserDropDown").dialog("close");populateStartPageItem("divWelcome","Reports","");n=[];n={bwParticipantId:participantId,selectedWorkflowAppId:selectedWorkflowAppId};t=webserviceurl+"/bwparticipant/updateuserconfigurationselectedworkflowapp";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){n.message!="SUCCESS"?displayAlertDialog(n.message):(workflowAppId=selectedWorkflowAppId,workflowAppTitle=selectedWorkflowAppTitle,newBudgetRequestManagerTitle=n.d.results[0].bwNewBudgetRequestManagerTitle,requireStartEndDates=n.d.results[0].bwRequireStartEndDates=="true"?!0:!1,requireRequestDetails=n.d.results[0].bwRequireRequestDetails=="true"?!0:!1,requireRequestDetails=n.d.results[0].bwRequireRequestDetails=="true"?!0:!1,enableNewRequestAttachments=n.d.results[0].bwEnableNewRequestAttachments=="true"?!0:!1,enableNewRequestBarcodeAttachments=n.d.results[0].bwEnableNewRequestBarcodeAttachments=="true"?!0:!1,quotingEnabled=n.d.results[0].bwQuotingEnabled=="true"?!0:!1,reimbursementRequestsEnabled=n.d.results[0].bwExpenseRequestsEnabled=="true"?!0:!1,closeoutsEnabled=n.d.results[0].bwCloseoutsEnabled=="true"?!0:!1,recurringExpensesEnabled=n.d.results[0].bwRecurringExpensesEnabled=="true"?!0:!1,supplementalsEnabled=n.d.results[0].bwSupplementalsEnabled=="true"?!0:!1,strictAuditingEnabled=n.d.results[0].bwStrictAuditingEnabled=="true"?!0:!1,populateStartPageItem("divBehavior","Reports",""),$('#selectHomePageWorkflowAppDropDown option[value="'+selectedWorkflowAppId+'"]').attr("selected","selected"),renderHomePagePersonalizedSection())},error:function(n,t,i){displayAlertDialog("Error in ios8.js.createANewWorkflowApp(): "+t+" "+i)}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdAddAWorkflowApp():"+t+", "+i+"::"+JSON.stringify(n))}})}function cmdAddAWorkflowApp(){$("#AddAWorkflowAppDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"",width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#AddAWorkflowAppDialog").dialog("close")})}});$("#AddAWorkflowAppDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}function cmdPurchaseBronzePackage(){window.location="http://budgetworkflow.com/shop/bronze"}function cmdPurchaseSilverPackage(){window.location="http://budgetworkflow.com/shop/silver"}function cmdPurchaseGoldPackage(){window.location="http://budgetworkflow.com/shop/gold"}function cmdUpgradeAndPricingOptions(){var t,n;try{$("#bwLoggedInUserDropDown").dialog("close")}catch(i){}$("#bwQuickLaunchMenuTd").css({width:"0"});$("#liWelcome").show();$("#liOfflineWelcome").hide();$("#liNewRequest").hide();$("#liArchive").hide();$("#liSummaryReport").hide();$("#liConfiguration").hide();$("#liHelp").hide();$("#liOfflineRequestForm").hide();$("#welcomePageMyTasksTab").empty();t=document.getElementById("divNewRequestMasterDiv");t.style.borderRadius="120px 0 0 120px";$("#divWelcomeMasterDivTitle").text("Upgrade and pricing options...");document.getElementById("divWelcomePageLeftButtonsWelcomeButton").className="divLeftButtonIos8";$("#divWelcomePageLeftButtonsWelcomeButton").off("click").click(function(){renderWelcomeScreen()});n="";n+="<span style=\"color: rgb(63, 63, 63); font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif; font-size: 22pt;\"><strong>You can upgrade from the free Budget Workflow<\/strong><\/span><br />";n+="<br />";n+="<div style=\"color: rgb(63, 63, 63); font-family: 'Segoe UI Light','Segoe UI','Segoe',Tahoma,Helvetica,Arial,sans-serif; font-size: 12pt;\">";n+="    <table>";n+="        <tr>";n+='            <td style="background-color:#6682b5;color:white;padding:4px 20px 7px 15px;">';n+="                Basic - This is the free version.";n+="            <\/td>";n+="        <\/tr>";n+="        <tr>";n+="            <td>";n+="                <ul>";n+="                    <li>100 budget requests a month.<\/li>";n+="                    <li>Purchase order numbers tie into your existing accounting system.<\/li>";n+="                    <li>Add 25 budget requests a month for $9.99.<\/li>";n+="                <\/ul>";n+="            <\/td>";n+="        <\/tr>";n+="        <tr><td>&nbsp;<\/td><\/tr>";n+="        <tr>";n+='            <td class="tdPurchaseBronzePackage" style="color:white;padding:4px 20px 7px 15px;">';n+="                Bronze - CAPEX. $9.99/year.&nbsp;";n+='                <span style="text-align:right;"><input type="button" value="Upgrade Now" onclick="cmdPurchaseBronzePackage();" style="cursor:pointer;"/><\/span>';n+="            <\/td>";n+="        <\/tr>";n+="        <tr>";n+="            <td>";n+="                <ul>";n+="                    <li>Everything the free package has, plus capital and expense tracking.<\/li>";n+="                    <li>100 budget requests a month.<\/li>";n+="                    <li>Add 25 budget requests a month for $9.99.<\/li>";n+="                <\/ul>";n+="            <\/td>";n+="        <\/tr>";n+="        <tr><td>&nbsp;<\/td><\/tr>";n+="        <tr>";n+='            <td class="tdPurchaseSilverPackage" style="padding:4px 20px 7px 15px;">';n+="                Silver - CAPEX + OPEX. $99.99/year.&nbsp;";n+='                <span style="text-align:right;"><input type="button" value="Upgrade Now" onclick="cmdPurchaseSilverPackage();" style="cursor:pointer;"/><\/span>';n+="            <\/td>";n+="        <\/tr>";n+="        <tr>";n+="            <td>";n+="                <ul>";n+="                    <li>Everything the Bronze package has, plus recurring expenses.<\/li>";n+="                    <li>100 budget requests a month.<\/li>";n+="                    <li>Add 25 budget requests a month for $9.99.<\/li>";n+="                <\/ul>";n+="            <\/td>";n+="        <\/tr>";n+="        <tr><td>&nbsp;<\/td><\/tr>";n+="        <tr>";n+='            <td class="tdPurchaseGoldPackage" style="padding:4px 20px 7px 15px;">';n+="                Gold - CAPEX + OPEX + Supplementals. $199.99/year.&nbsp;";n+='                <span style="text-align:right;"><input type="button" value="Upgrade Now" onclick="cmdPurchaseGoldPackage();" style="cursor:pointer;"/><\/span>';n+="            <\/td>";n+="        <\/tr>";n+="        <tr>";n+="            <td>";n+="                <ul>";n+="                    <li>Everything the other packages have, plus the ability to add supplemental requests.<\/li>";n+="                    <li>100 budget requests a month.<\/li>";n+="                    <li>Add 25 budget or supplemental requests a month for $9.99.<\/li>";n+="                <\/ul>";n+="            <\/td>";n+="        <\/tr>";n+="    <\/table>";n+="    <br />";n+="<\/div>";$("#welcomePageMyTasksTab").html(n)}function cmdUserOptions(){try{$("#UserOptionsDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"User Options",width:"800px",dialogClass:"no-close",hide:!1,buttons:{Save:{text:"Save",id:"btnSaveUserOptions",style:"font-size:30pt;",click:function(){cmdSaveUserOptions();$(this).dialog("close")}},Cancel:{text:"Cancel",id:"btnCancelUserOptions",style:"font-size:30pt;",click:function(){$(this).dialog("close")}}},open:function(){var t,n;$("#bwLoggedInUserDropDown").dialog("close");$(".ui-widget-overlay").bind("click",function(){$("#UserOptionsDialog").dialog("close")});participantLogonType=="microsoft"?t="Microsoft":participantLogonType=="facebook"?t="Facebook":participantLogonType=="google"?t="Google":participantLogonType=="linkedin"?t="LinkedIn":participantLogonType=="custom"&&(t="BudgetRequests.com");n="";n+="You are logged in using your "+t+" logon.<br />";n+="<table>";n+="    <tr><td>&nbsp;<\/td><td><\/td><\/tr>";n+='    <tr><td>Name:<\/td><td><input id="txtUserOptionsFriendlyName" class="spanH2" style="width:92%;" /><\/td><\/tr>';n+='    <tr><td>Email:<\/td><td><input id="txtUserOptionsEmail" class="spanH2" style="width:92%;" /><\/td><\/tr>';n+="    <tr><td>&nbsp;<\/td><td><\/td><\/tr>";n+="<\/table>";n+="";$("#spanUserOptionsDialogContent").html(n);$("#txtUserOptionsFriendlyName").val(participantFriendlyName);$("#txtUserOptionsEmail").val(participantEmail)}});$("#UserOptionsDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}catch(n){displayAlertDialog("Error in cmdUserOptions(): "+n.message)}}function cmdSaveUserOptions(){var i=$("#txtUserOptionsFriendlyName").val(),r=$("#txtUserOptionsEmail").val(),u=$("#txtUserOptionsRole").val(),f=getCreatedTimestamp(),n=[],t;n={bwParticipantId:participantId,bwParticipantFriendlyName:i,bwParticipantEmail:r,bwParticipantRole:u,Modified:f};t=webserviceurl+"/bwparticipant/updateuserdetails";$.ajax({url:t,type:"POST",timeout:ajaxTimeout,data:n,headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog(n);renderWelcomeScreen()},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdSaveUserOptions(): "+t+" "+i)}})}function cmdSignOut(){try{tenantId="";workflowAppId="";workflowAppTitle="";participantId="";participantLogonType="";participantLogonTypeUserId="";participantFriendlyName="";participantEmail="";$("#bwLoggedInUserDropDown").dialog("close");renderWelcomePageOffline();swapStyleSheet("css/bw.core.colors.min.css")}catch(n){displayAlertDialog("Exception in ios8.js.cmdSignOut(): "+n.message+", "+n.stack)}}function cmdDeleteInvitation(n){var t=[],i;t={bwInvitationId:n};i=webserviceurl+"/bwinvitationsunclaimed/deletethisinvitation";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(n){n.n==1&&n.ok==1?populateStartPageItem("divParticipants","Reports",""):displayAlertDialog("There was a problem deleting this invitation. Error: "+JSON.stringify(n))},error:function(n,t,i){displayAlertDialog("Error in cmdDeleteInvitation(): "+i)}})}function cmdViewInvitation(n){$("#ViewInvitationDialog").dialog({modal:!0,resizable:!1,closeText:"Cancel",closeOnEscape:!0,title:"Invitation",width:"800px",dialogClass:"no-close",hide:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#ViewInvitationDialog").dialog("close")});var t=globalUrlPrefix+globalUrl+"?invitation="+n;document.getElementById("textareaViewInvitationDialogInvitationDetails").innerHTML=t;document.getElementById("textareaViewInvitationDialogInvitationDetails").blur()}});$("#ViewInvitationDialog").dialog().parents(".ui-dialog").find(".ui-dialog-titlebar").remove()}function generateParticipantsListButtons(){var n,t;$("#divFunctionalAreasMasterDiv").empty();$("#divFunctionalAreasMasterSubMenuDiv").hide();n="";n+='<table style="width:100%;padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">';n+='<tr style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">';n+='<td style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">';n+='<div class="">';n+='<span id="spanSecondTopBarExpandCollapse" class="spanTopBarExpandCollapseIos8" onclick="cmdSecondTopBarExpandCollapse(\'spanSecondTopBarExpandCollapse\');">+<\/span><span id="xxxx" class="divTopBarTextContentsIos8" onclick="cmdSecondTopBarExpandCollapse(\'spanSecondTopBarExpandCollapse\');">Participants<\/span>';n+="<\/div>";n+="<\/td>";n+='<td style="text-align:right;white-space:nowrap;font-size:small;padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;"><!--Year:&nbsp;<select id="ddlYear" onchange="cmdYearSelectedChanged();"><\/select>--><\/td>';n+="<\/tr>";n+="<\/table>";$("#divFunctionalAreasMasterDiv").html(n);disableParticipantsButton();$("#divFunctionalAreasSubSubMenus").empty();n="";n+='<table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">';n+="  <tr>";n+="    <td>";n+="<br />";n+='<div class="codeSnippetContainer" id="code-snippet-4" xmlns="">';n+='    <div class="codeSnippetContainerTabs">';n+='        <div class="codeSnippetContainerTabSingle" dir="ltr"><span style="font-size:25pt;"><a>&nbsp;&nbsp;Participants&nbsp;&nbsp;<\/a><\/span><\/div>';n+="    <\/div>";n+='    <div class="codeSnippetContainerCodeContainer">';n+='        <div class="codeSnippetToolBar">';n+='            <div class="codeSnippetToolBarText">';n+='                <a name="CodeSnippetCopyLink" title="Copy to clipboard." style="display: none;" href="javascript:displayAlertDialog(\'Copy support is not yet implemented.\');">Copy<\/a>';n+="            <\/div>";n+="        <\/div>";n+='        <div class="codeSnippetContainerCode" id="CodeSnippetContainerCode_5207fb9c-60fd-402f-8729-5795651a5ad3" dir="ltr">';n+="            <div>";n+='                <span id="spanBwParticipantsConfiguration" style="font-size:x-small;">';t={bwWorkflowId:workflowAppId};$.ajax({url:webserviceurl+"/workflow/participants",type:"DELETE",contentType:"application/json",data:JSON.stringify(t),success:function(t){var i,t;for(n+='<table class="myStuffTable">',n+="  <tr>",n+="    <td>Name<\/td>",n+="    <td>Email<\/td>",n+="    <td>Role<\/td>",n+="    <td><\/td>",n+="    <td><\/td>",n+="  <\/tr>",i=0;i<t.length;i++)n+="  <tr>",n+="    <td>"+t[i].bwParticipantFriendlyName+"<\/td>",n+="    <td>"+t[i].bwParticipantEmail+"<\/td>",n+="    <td>"+t[i].bwParticipantRole+"<\/td>",t[i].bwParticipantId==participantId||t[i].bwParticipantRole=="owner"?(n+="    <td><\/td>",n+="    <td><\/td>"):(n+='    <td><button class="BwButton300" onclick="cmdDisplayChangeUserRoleDialog(\''+t[i].bwParticipantId+"', '"+t[i].bwParticipantFriendlyName+"', '"+t[i].bwParticipantEmail+"', '"+t[i].bwParticipantRole+"', '"+t[i].bwParticipantLogonType+"');\">change<br />role<\/button><\/td>",n+='    <td><button class="BwButton360" onclick="cmdDisplayReassignUserTasksDialog(\''+t[i].bwParticipantId+"', '"+t[i].bwParticipantFriendlyName+"', '"+t[i].bwParticipantEmail+"', '"+t[i].bwParticipantRole+"', '"+t[i].bwParticipantLogonType+"');\">reassign<br />responsibilities (#)<\/button><\/td>",n+='    <td><img src="images/trash-can.png" class="trashcan" onclick="cmdDisplayDeleteUserDialog(\''+t[i].bwParticipantId+"', '"+t[i].bwParticipantFriendlyName+"', '"+t[i].bwParticipantEmail+"', '"+t[i].bwParticipantRole+"', '"+t[i].bwParticipantLogonType+'\');" title="Delete" style="cursor:pointer;" /><\/td>'),n+="  <\/tr>";n+="<\/table>";n+="                <\/span>";n+="            <\/div>";n+="        <\/div>";n+="    <\/div>";n+="<\/div>";n+="<br />";n+='<div class="codeSnippetContainer" id="code-snippet-4" xmlns="">';n+='    <div class="codeSnippetContainerTabs">';n+='        <div class="codeSnippetContainerTabSingle" dir="ltr"><span style="font-size:25pt;"><a>&nbsp;&nbsp;Unclaimed Invitations&nbsp;&nbsp;<\/a><\/span><\/div>';n+="    <\/div>";n+='    <div class="codeSnippetContainerCodeContainer">';n+='        <div class="codeSnippetToolBar">';n+='            <div class="codeSnippetToolBarText">';n+='                <a name="CodeSnippetCopyLink" title="Copy to clipboard." style="display: none;" href="javascript:displayAlertDialog(\'Copy support is not yet implemented.\');">Copy<\/a>';n+="            <\/div>";n+="        <\/div>";n+='        <div class="codeSnippetContainerCode" id="CodeSnippetContainerCode_5207fb9c-60fd-402f-8729-5795651a5ad3" dir="ltr">';n+="            <div>";n+='                <span id="spanBwInvitations" style="font-size:22pt;">';t={bwWorkflowAppId:workflowAppId};$.ajax({url:webserviceurl+"/bwinvitationsunclaimed",type:"DELETE",contentType:"application/json",data:JSON.stringify(t),success:function(t){if(t.length==0)n+="There are no unclaimed invitations.";else{n+='<table class="myStuffTable">';n+="  <tr>";n+="    <td>Created By<\/td>";n+="    <td>Created Date<\/td>";n+="    <td>Workflow<\/td>";n+="    <td><\/td>";n+="    <td><\/td>";n+="  <\/tr>";for(var i=0;i<t.length;i++)n+="  <tr>",n+='    <td title="'+t[i].bwInvitationCreatedByEmail+'" style="cursor:default;">'+t[i].bwInvitationCreatedByFriendlyName+"<\/td>",n+="    <td>"+t[i].bwInvitationCreatedTimestamp+"<\/td>",n+="    <td>"+t[i].bwWorkflowAppTitle+"<\/td>",n+="    <td><button onclick=\"cmdViewInvitation('"+t[i].bwInvitationId+'\');" class="BwButton200">view<\/button><\/td>',n+="    <td><button onclick=\"cmdDeleteInvitation('"+t[i].bwInvitationId+'\');" class="BwButton200">delete<\/button><\/td>',n+="  <\/tr>";n+="<\/table>"}n+="                <\/span>";n+="            <\/div>";n+="        <\/div>";n+="    <\/div>";n+="<\/div>";n+="<br />";n+='<div class="codeSnippetContainer" id="code-snippet-4" xmlns="">';n+='<div class="codeSnippetContainerTabs">';n+='<div class="codeSnippetContainerTabSingle" dir="ltr"><span style="font-size:25pt;"><a>&nbsp;&nbsp;Invite a participant to your budget workflow by emailing them this link&nbsp;&nbsp;<\/a><\/span><\/div>';n+="<\/div>";n+='<div class="codeSnippetContainerCodeContainer">';n+='    <div class="codeSnippetToolBar">';n+='        <div class="codeSnippetToolBarText">';n+='            <a name="CodeSnippetCopyLink" title="Copy to clipboard." style="display: none;" href="javascript:displayAlertDialog(\'Copy support is not yet implemented.\');">Copy<\/a>';n+="        <\/div>";n+="    <\/div>";n+='    <div class="codeSnippetContainerCode" id="CodeSnippetContainerCode_5207fb9c-60fd-402f-8729-5795651a5ad3" dir="ltr">';n+='        <div style="color:Black;"><pre>';n+='<span id="invitationLink" style="font-size:25pt;"><\/span>';n+="           <\/pre>";n+='<table style="width:100%;text-align:right;"><tr><td><button id="btnInviteNewParticipant" onclick="cmdInviteNewParticipant();" class="BwButton350">Generate a new invitation link<\/button><\/td><\/tr><\/table>';n+="               <\/div>";n+="                   <\/div>";n+="               <\/div>";n+="           <\/div>";n+='<span style="font-size:22pt;font-style:italic;">When a person accepts an invitation and logs in for the first time, they receive the lowest permissions role of "Participant". You will receive an email when they have joined, then you can come back here and use the "change role" button to increase their permissions.<\/span>';n+="    <\/td>";n+="  <\/tr>";n+="<\/table>";$("#divFunctionalAreasSubSubMenus").html(n)},error:function(n,t,i){displayAlertDialog("Error in ios8.js.generateParticipantsListButtons():1:"+t+", "+i)}})},error:function(n,t,i){displayAlertDialog("Error in ios8.js.generateParticipantsListButtons():2:"+t+", "+i)}})}function cmdDeleteApproverFromFinancialArea(n){var o,i,u,e,t,r,n;try{for(o=n-1,i=[],i=[],u=3;u<11;u++)if(e=$("#txtApprover"+u+"FriendlyName"),e.val()){var s=$("#txtApprover"+u+"Id").val(),h=$("#txtApprover"+u+"Email").val(),c=$("#txtApprover"+u+"FriendlyName").val(),l=$('span[xd\\:binding="my:Approval'+u+'BudgetThreshold"]')[0].innerHTML,a=parseFloat(l.replace(/[^0-9-.]/g,"")),f=[];f=new Array(4);f[0]=s;f[1]=h;f[2]=c;f[3]=a;i.push(f)}for(i.splice(n-3,1),t="",t+="<table>",i.length>0&&(t+="<tr>",t+="  <td><\/td>",t+="  <td><\/td>",t+='  <td style="text-align:center;">',t+='    <span style="color:cornflowerblue;font-size:18pt;">Budget Threshold<\/span>',t+="  <\/td>",t+="  <td><\/td>",t+="<\/tr>"),r=0;r<i.length;r++)i[r][0]&&(t+="<tr>",t+='  <td class="bwComTitleCell">Approver #'+(r+2).toString()+"<\/td>",t+='  <td class="bwChartCalculatorLightCurrencyTableCell" style="white-space:nowrap;">',n=r+3,t+='    <input id="txtApprover'+n+'FriendlyName" title="'+i[r][1]+'" value="'+i[r][2]+'" class="spanH2" />',t+='    <img src="images/addressbook-icon35x35.png" style="width:80px;height:80px;cursor:pointer;vertical-align:text-bottom;" onclick="cmdDisplayPeoplePickerDialog(\'txtApprover'+n+"FriendlyName', 'txtApprover"+n+"Id', 'txtApprover"+n+"Email');\" />",t+='    <input id="txtApprover'+n+'Id" style="display:none;" value="'+i[r][0]+'" />',t+='    <input id="txtApprover'+n+'Email" style="display:none;" value="'+i[r][1]+'" />',t+="  <\/td>",t+='  <td class="bwChartCalculatorLightCurrencyTableCell">',t+='    <span xd:binding="my:Approval'+n+'BudgetThreshold" class="bwCurrencyTextBox" contenteditable="true" tabindex="0">'+formatCurrency(i[r][3])+"<\/span>",t+="  <\/td>",t+='<td><img src="images/trash-can.png" class="trashcan" onclick="cmdDeleteApproverFromFinancialArea(\''+n+'\');" title="Delete" style="cursor:pointer;" /><\/td>',t+="<\/tr>");t+="<\/table>";document.getElementById("divFunctionalAreasApproverDataEntryFields").innerHTML=t}catch(v){displayAlertDialog("Error in cmdDeleteApproverFromFinancialArea(): "+v.message)}}function cmdUnHideFunctionalArea(n){var t=[],i;t={bwFunctionalAreaId:n,IsHidden:"false",ModifiedByFriendlyName:participantFriendlyName,ModifiedById:participantId,ModifiedByEmail:participantEmail};i=webserviceurl+"/bwfunctionalareas/hideorshowfunctionalarea";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog(n);populateStartPageItem("divFunctionalAreas","Reports","")},error:function(n,t,i){displayAlertDialog("Error in ios8.js.cmdImmediatelyHideFunctionalArea(): "+i)}})}function renderFunctionalAreaDetails(n){var c,r,s,o,i,u,f,e,l,h,t,a;try{$("#divIos8ConfigurationLeftMenu").dialog("close")}catch(v){}try{for(c=(new Date).getFullYear().toString(),u=0;u<BWMData[0].length;u++)(BWMData[0][u][0]=workflowAppId)&&(r=u);if(s=!1,o="",n=="AddAFinancialArea")o="Add a financial area:";else for(i=0;i<BWMData[0][r][4].length;i++)BWMData[0][r][4][i][0]==n&&(o=BWMData[0][r][4][i][1].toString(),BWMData[0][r][4][i][2]=="true"&&(s=!0));for($("#spanFunctionalAreasTopBarTextContentsIos8").text(o),$("#divFunctionalAreasMasterSubMenuDiv").show(),t="",t+='<table style="padding:0 0 0 0;margin:0 0 0 0;border-width:0 0 0 0;">',t+="    <tr>",t+='        <td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='            <div id="divMenuMasterDivAddAFunctionalArea" class="divLeftButtonIos8" onclick="renderFunctionalAreaDetails(\'AddAFinancialArea\');"><!--<img src="/images/plus.png" alt="" />-->+ Add a financial area&nbsp;&nbsp;&nbsp;&nbsp;<\/div>',t+="        <\/td>",t+="    <\/tr>",t+="    <tr><td><\/td><\/tr>",i=0;i<BWMData[0][r][4].length;i++)BWMData[0][r][4][i][3]==c&&(t+="    <tr>",t+='        <td style="padding:0 0 0 10px;margin:0 0 0 0;border-width:0 0 0 0;">',t+='            <div id="divFunctionalAreaMasterDiv'+BWMData[0][r][4][i][0].toString()+'" class="divLeftButtonIos8" onclick="renderFunctionalAreaDetails(\''+BWMData[0][r][4][i][0].toString()+"');\">"+BWMData[0][r][4][i][1].toString()+"&nbsp;&nbsp;&nbsp;&nbsp;<\/div>",t+="        <\/td>",t+="    <\/tr>",t+="    <tr><td><\/td><\/tr>");for(t+="<\/table>",$("#divFunctionalAreasListButtons").html(t),n=="AddAFinancialArea"?document.getElementById("divMenuMasterDivAddAFunctionalArea").className="divLeftButtonSelectedIos8":document.getElementById("divFunctionalAreaMasterDiv"+n).className="divLeftButtonSelectedIos8",$("#divFunctionalAreaSection").html($("#divFunctionalAreaTemplate").html()),t="",t+='<span xd:binding="my:FunctionalAreaId" style="display:none;">'+n+"<\/span>",t+="<table>",i=0;i<BWMData[0][r][4].length;i++)if(BWMData[0][r][4][i][0]==n){for(BWMData[0][r][4][i][7][0][1]&&(t+="<tr>",t+="  <td><\/td>",t+="  <td><\/td>",t+='  <td style="text-align:center;">',t+='    <span style="color:cornflowerblue;font-size:18pt;">Budget Threshold<\/span>',t+="  <\/td>",t+="  <td><\/td>",t+="<\/tr>"),u=0;u<BWMData[0][r][4][i][7].length;u++)BWMData[0][r][4][i][7][u][1]&&(t+="<tr>",t+='  <td class="bwComTitleCell">Approver #'+(u+2).toString()+"<\/td>",t+='  <td class="bwChartCalculatorLightCurrencyTableCell" style="white-space:nowrap;">',f=u+3,t+='    <input id="txtApprover'+f+'FriendlyName" title="'+BWMData[0][r][4][i][7][u][2]+'" value="'+BWMData[0][r][4][i][7][u][1]+'" class="spanH2" />',t+='    <img src="images/addressbook-icon35x35.png" style="width:80px;height:80px;cursor:pointer;vertical-align:text-bottom;" onclick="cmdDisplayPeoplePickerDialog(\'txtApprover'+f+"FriendlyName', 'txtApprover"+f+"Id', 'txtApprover"+f+"Email');\" />",t+='    <input id="txtApprover'+f+'Id" style="display:none;" value="'+BWMData[0][r][4][i][7][u][0]+'" />',t+='    <input id="txtApprover'+f+'Email" style="display:none;" value="'+BWMData[0][r][4][i][7][u][2]+'" />',t+="  <\/td>",t+='  <td class="bwChartCalculatorLightCurrencyTableCell">',t+='    <span xd:binding="my:Approval'+f+'BudgetThreshold" class="bwCurrencyTextBox" contenteditable="true" tabindex="0">'+formatCurrency(BWMData[0][r][4][i][7][u][3])+"<\/span>",t+="  <\/td>",t+='<td><img src="images/trash-can.png" class="trashcan" onclick="cmdDeleteApproverFromFinancialArea(\''+f+'\');" title="Delete" style="cursor:pointer;" /><\/td>',t+="<\/tr>");t+="<\/table>";$("#divFunctionalAreasApproverDataEntryFields").html(t);$("#txtFunctionalAreaId").val(BWMData[0][r][4][i][0]);$("#txtFunctionalAreaTitle").val(BWMData[0][r][4][i][1]);document.getElementById("cbFunctionalAreaQuote").checked=s==!0?!0:!1;e="";e+='<select id="txtFunctionalAreaYear" class="spanH2">';e+='<option value="'+BWMData[0][r][4][i][3]+'" selected>'+BWMData[0][r][4][i][3]+"<\/option>";e+="<\/select>";document.getElementById("spanFunctionalAreaYear").innerHTML=e;$("#txtFunctionalAreaYearlyBudget").val(BWMData[0][r][4][i][4]);document.getElementById("txtApprover1FriendlyName").value=BWMData[0][r][4][i][5][1];document.getElementById("txtApprover1FriendlyName").setAttribute("title",BWMData[0][r][4][i][5][2]);document.getElementById("txtApprover1Id").value=BWMData[0][r][4][i][5][0];document.getElementById("txtApprover1Email").value=BWMData[0][r][4][i][5][2];document.getElementById("txtApprover2FriendlyName").value=BWMData[0][r][4][i][6][1];document.getElementById("txtApprover2FriendlyName").setAttribute("title",BWMData[0][r][4][i][6][2]);document.getElementById("txtApprover2Id").value=BWMData[0][r][4][i][6][0];document.getElementById("txtApprover2Email").value=BWMData[0][r][4][i][6][2];l=$("#txtFunctionalAreaYearlyBudget").val();$("#txtFunctionalAreaYearlyBudget").val(formatCurrency(l));BWMData[0][r][4][i][13]=="true"?(t="",t+='<input type="button" value="Un-Hide" id="btnFunctionalAreaUnHide" onclick="cmdUnHideFunctionalArea(\''+n+'\');" class="BwButton200" />',t+="&nbsp;",t+='<input type="button" value="Save" onclick="cmdSaveFunctionalArea();" class="BwButton200" />',t+="&nbsp;",t+='<input type="button" value="Cancel" onclick="populateStartPageItem(\'divWelcome\', \'Reports\', \'\');" class="BwButton200" />',document.getElementById("spanFunctionalAreaDetailsBottomButtonSection").innerHTML=t):(t="",t+='<input type="button" value="Delete" id="btnFunctionalAreaDelete" onclick="cmdDeleteFunctionalArea(\''+n+'\');" class="BwButton200" />',t+="&nbsp;",t+='<input type="button" value="Save" onclick="cmdSaveFunctionalArea();" class="BwButton200" />',t+="&nbsp;",t+='<input type="button" value="Cancel" onclick="populateStartPageItem(\'divWelcome\', \'Reports\', \'\');" class="BwButton200" />',document.getElementById("spanFunctionalAreaDetailsBottomButtonSection").innerHTML=t);hookUpThePeoplePickers()}n=="AddAFinancialArea"&&(h="",h+=(new Date).getFullYear().toString(),document.getElementById("spanFunctionalAreaYear").innerHTML=h,t="",t+='<input type="button" value="Save" onclick="cmdSaveFunctionalArea();" class="BwButton200" />',t+="&nbsp;",t+='<input type="button" value="Cancel" onclick="populateStartPageItem(\'divWelcome\', \'Reports\', \'\');" class="BwButton200" />',document.getElementById("spanFunctionalAreaDetailsBottomButtonSection").innerHTML=t);a=document.getElementById("divFunctionalAreas");a.style.borderRadius="120px 0 0 120px"}catch(v){displayAlertDialog("Error in ios8.js.renderFunctionalAreaDetails("+n+"): ",v.message)}}function generateFunctionalAreasApproverDataEntryFields(){var n="",i,t;for(n+="<table>",n+="    <tr>",n+="        <td>",n+="<table>",i=BWMData,t=0;t<i.length;t++)n+="    <tr>",n+="        <td>Approver #"+t.toString()+"-1<\/td>",n+="    <\/tr>",n+="    <tr>",n+="        <td>",n+="            <table>",n+="                <tr>",n+='                    <td style="text-align:left;" class="bwFADrillDownLinkCell">Name<\/td>',n+='                    <td class="bwChartCalculatorLightCurrencyTableCell">',n+='                        <span xd:binding="my:xxxx" class="bwCurrencyTextBox" contenteditable="true" onblur="//formatCurrency($(this).attr(xd:binding));" onfocusin="//currencySpanOnFocusIn(this);" onkeyup="//currencySpanOnKeyUp(this);" tabindex="0" />',n+="                    <\/td>",n+="                <\/tr>",n+="                <tr>",n+='                    <td style="text-align:left;" class="bwFADrillDownLinkCell">Budget threshold<\/td>',n+='                    <td class="bwChartCalculatorLightCurrencyTableCell">',n+='                        <span xd:binding="my:xxxx" class="bwCurrencyTextBox" contenteditable="true" onblur="//formatCurrency($(this).attr(xd:binding));" onfocusin="//currencySpanOnFocusIn(this);" onkeyup="//currencySpanOnKeyUp(this);" tabindex="0" />',n+="                    <\/td>",n+="                <\/tr>",n+="            <\/table>",n+="        <\/td>",n+="    <\/tr>";n+="<\/table>";n+="        <\/td>";n+="    <\/tr>";n+="<\/table>";$("#divFunctionalAreasApproverDataEntryFields").html(n)}function cmdCreateSupplementalBudgetRequestAndStartWorkflow(n,t,i,r){var e,f;try{if(e=t+".xml",validateSupplementalRequest()){var o=createXmlDocument_InitSupplementalAr(i,r,t),s=document.getElementById("strProjectTitle").value,u=[],h=document.getElementById("dblRequestedCapital").value.replace(/[^0-9-.]/g,""),c=getCreatedTimestamp(),l=getDueDateTimestamp();u={bwBudgetRequestId:t,bwTenantId:tenantId,bwWorkflowAppId:workflowAppId,bwWorkflowId:null,IsSupplementalRequest:"true",RelatedBudgetRequestId:n,Created:c,CreatedBy:participantEmail,CreatedById:participantId,CreatedByEmail:participantEmail,bwDocumentXml:o.toString(),Title:null,ProjectTitle:s.toString(),BudgetAmount:null,RequestedCapital:h,RequestedExpense:0,FunctionalAreaId:i,ARStatus:"Submitted",BudgetWorkflowStatus:"Assign Budget",Quote:"false",ManagerId:r,bwWorkflowToken:"0",bwDueDate:l};f=webserviceurl+"/bwbudgetrequests/initbudgetrequest";$.ajax({url:f,type:"POST",timeout:ajaxTimeout,data:u,headers:{Accept:"application/json; odata=verbose"},success:function(){displayAlertDialog("The supplemental budget request has been submitted");populateStartPageItem("divWelcome","Reports","")},error:function(n){displayAlertDialog("Error creating the budget request in budgetrequests library. "+JSON.stringify(n))}})}else displayAlertDialog("Error: Validation failed for some reason.")}catch(a){displayAlertDialog("Error in ios8.js.cmdCreateSupplementalBudgetRequestAndStartWorkflow(): "+a.message)}}function cmdCreateRecurringExpenseBudgetRequestAndStartWorkflow(){var i;try{var n=document.getElementById("BudgetRequestId").innerHTML,r=document.getElementById("RecurringExpenseId").innerHTML,u=document.getElementById("dtRecurringExpenseNextReminderDate").value;if(validateNewBudgetRequestFormForRecurringExpense()){var f=createXmlDocument_InitRecurringExpenseBudgetRequest(n),e=$('span[xd\\:binding = "my:Project_Name"]')[0].innerHTML,t=[],o=document.getElementById("ddlFunctionalArea").value.split("|")[0],s=$('span[xd\\:binding = "my:Project_Manager_AccountId"]')[0].innerHTML,h=document.getElementById("dblRequestedCapital").value.replace(/[^0-9-.]/g,""),l=getCreatedTimestamp(),a=getDueDateTimestamp();t={bwBudgetRequestId:n,bwTenantId:tenantId,bwWorkflowAppId:workflowAppId,bwWorkflowId:null,IsSupplementalRequest:"false",RelatedBudgetRequestId:null,IsRecurringExpense:"true",RelatedRecurringExpenseId:r,RecurringExpenseNextReminderDate:u,CreatedBy:participantEmail,CreatedById:participantId,CreatedByEmail:participantEmail,bwDocumentXml:f,ProjectTitle:e,BudgetAmount:null,RequestedCapital:h,RequestedExpense:0,FunctionalAreaId:o,ARStatus:"Submitted",BudgetWorkflowStatus:"Assign Budget",Quote:"false",ManagerId:s,bwWorkflowToken:"0"};i=webserviceurl+"/bwbudgetrequests/initbudgetrequest";$.ajax({url:i,type:"POST",timeout:ajaxTimeout,data:t,headers:{Accept:"application/json; odata=verbose"},success:function(n){displayAlertDialog(n);clearNewBudgetRequestFormFields();populateStartPageItem("divWelcome","Reports","")},error:function(n){displayAlertDialog("Error creating the budget request in budgetrequests library. "+JSON.stringify(n))}})}}catch(c){displayAlertDialog("Error in cmdCreateRecurringExpenseBudgetRequestAndStartWorkflow(): "+c.message)}}function cmdUpdateRecurringExpenseReminderDate(){var h=document.getElementById("RecurringExpenseId").innerHTML,r=document.getElementById("dtRecurringExpenseNextReminderDate").value,n=new Date(r),u=n.getDate(),f=n.getMonth(),e=n.getFullYear(),t=new Date(e,f,u),i,o,s;t.getDate()==u&&t.getMonth()==f&&t.getFullYear()==e?(i=new Date,i.setHours(0,0,0,0),n.setHours(0,0,0,0),n<=i?(displayAlertDialog('Please specify an "Reminder Date" which occurs in the future before submitting your request.'),document.getElementById("dtRecurringExpenseNextReminderDate").value=""):(o={bwRecurringExpenseId:h,ReminderDate:r},s=webserviceurl+"/bwrecurringexpense/saveanewrecurringxpensereminderdate",$.ajax({url:s,type:"POST",timeout:ajaxTimeout,data:o,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"?displayAlertDialog(n):(displayAlertDialog("The reminder date has been updated."),document.getElementById("btnRecurringExpenseNextReminderDate").style.cursor="default",document.getElementById("btnRecurringExpenseNextReminderDate").setAttribute("disabled",""))},error:function(n,t,i){displayAlertDialog("Error in cmdUpdateRecurringExpenseReminderDate(): "+i)}}))):document.getElementById("dtRecurringExpenseNextReminderDate").value=""}function cmdUpdateRecurringExpenseReminderDate2(){var h=document.getElementById("RecurringExpenseId").innerHTML,t=document.getElementById("dtEstimatedStartDatexxRecurringExpense").value,n=new Date(t),u=n.getDate(),f=n.getMonth(),e=n.getFullYear(),i=new Date(e,f,u),r,o,s;i.getDate()==u&&i.getMonth()==f&&i.getFullYear()==e?(r=new Date,r.setHours(0,0,0,0),n.setHours(0,0,0,0),n<=r?(displayAlertDialog('Please specify an "Reminder Date" which occurs in the future before submitting your request.'),document.getElementById("dtEstimatedStartDatexxRecurringExpense").value=""):(o={bwRecurringExpenseId:h,ReminderDate:t},s=webserviceurl+"/bwrecurringexpense/saveanewrecurringxpensereminderdate",$.ajax({url:s,type:"POST",timeout:ajaxTimeout,data:o,headers:{Accept:"application/json; odata=verbose"},success:function(n){n!="SUCCESS"?displayAlertDialog(n):(displayAlertDialog("The reminder date has been updated."),document.getElementById("dtRecurringExpenseNextReminderDate").value=t,$("#RecurringExpenseDialog").dialog("close"))},error:function(n,t,i){displayAlertDialog("Error in cmdUpdateRecurringExpenseReminderDate(): "+i)}}))):document.getElementById("dtEstimatedStartDatexxRecurringExpense").value=""}function clearNewBudgetRequestFormFields(){try{document.getElementById("strProjectTitle").value="";document.getElementById("strBriefDescriptionOfProject").value="";document.getElementById("dblRequestedCapital").value="";document.getElementById("txtProjectManagerName").value="";document.getElementById("txtProjectManagerId").value="";document.getElementById("txtProjectManagerEmail").value="";document.getElementById("dtEstimatedStartDate").value="";document.getElementById("dtEstimatedEndDate").value="";document.getElementById("inputFile").value=""}catch(n){displayAlertDialog("Error in ios8.js.clearNewBudgetRequestFormFields().")}}function populateFunctionalAreas(){var n,t;try{n=(new Date).getFullYear().toString();$('<option value="'+n.toString()+'" selected>'+n.toString()+"<\/option>").appendTo($("#ddlYear"));t=webserviceurl+"/getfunctionalareasbyappid/"+workflowAppId+"/RETURNALL";$.ajax({url:t,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var u=(new Date).getFullYear().toString(),i,r,t;for($("#ddlFunctionalArea").empty(),i=[],i=[],t=0;t<n.d.results.length;t++)n.d.results[t].bwFunctionalAreaYear==u&&n.d.results[t].IsHidden!="true"&&(r=[],r=new Array(3),r[0]=n.d.results[t].bwFunctionalAreaId,r[1]=n.d.results[t].bwFunctionalAreaQuote,r[2]=n.d.results[t].bwFunctionalAreaTitle,i.push(r));if(i.length==0)displayAlertDialog("There are no Financial Areas to choose from for this Budget Request, therefore you cannot submit one at this time."),populateStartPageItem("divWelcome","Reports","");else for($("<option value=''>Select a financial area...<\/option>").appendTo($("#ddlFunctionalArea")),t=0;t<i.length;t++)$("<option value='"+i[t][0]+"|"+i[t][1]+"'>"+i[t][2]+"<\/option>").appendTo($("#ddlFunctionalArea"))},error:function(n,t,i){displayAlertDialog("Error populating functional areas: "+t+", "+i)}})}catch(i){displayAlertDialog("Error in populateFunctionalAreas(): "+i.message)}}function populateFunctionalAreasForAssignBudgetEditForm(){var n=webserviceurl+"/getfunctionalareasbyappid/"+workflowAppId+"/RETURNALL";$.ajax({url:n,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var e=(new Date).getFullYear().toString(),i,r,u,t,f;for($("#ddlFunctionalArea").empty(),i=[],i=[],t=0;t<n.d.results.length;t++)n.d.results[t].bwFunctionalAreaYear==e&&n.d.results[t].IsHidden!="true"&&(r=[],r=new Array(3),r[0]=n.d.results[t].bwFunctionalAreaId,r[1]=n.d.results[t].bwFunctionalAreaQuote,r[2]=n.d.results[t].bwFunctionalAreaTitle,i.push(r));for(u=$('span[xd\\:binding = "my:Functional_Area_Id"]')[0].innerHTML,t=0;t<i.length;t++)f=i[t][0],f==u?$('<option value="'+i[t][0]+'" selected>'+i[t][2]+"<\/option>").appendTo($("#ddlFunctionalArea")):$('<option value="'+i[t][0]+'">'+i[t][2]+"<\/option>").appendTo($("#ddlFunctionalArea"))},error:function(){displayAlertDialog("Error in populateFunctionalAreasForAssignBudgetEditForm().")}})}function populateFunctionalAreasForOfflineBudgetRequestSubmissionForm(){try{console.log("In populateFunctionalAreasForOfflineBudgetRequestSubmissionForm().");var t=webserviceurl+"/getfunctionalareasbyappid/"+workflowAppId+"/RETURNALL";$.ajax({url:t,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){for(var f=(new Date).getFullYear().toString(),i=[],r,u,e,i=[],t=0;t<n.d.results.length;t++)n.d.results[t].bwFunctionalAreaYear==f&&n.d.results[t].IsHidden!="true"&&(r=[],r=new Array(3),r[0]=n.d.results[t].bwFunctionalAreaId,r[1]=n.d.results[t].bwFunctionalAreaQuote,r[2]=n.d.results[t].bwFunctionalAreaTitle,i.push(r));for(u="",u+='<select id="ddlFunctionalAreaInXslForm" style="font-size:40pt;">',t=0;t<i.length;t++)e=i[t][0],u+='<option value="'+i[t][0]+'">'+i[t][2]+"<\/option>";u+="<\/select>";document.getElementById("spanFinancialAreasInXslForm").innerHTML=u},error:function(n,t,i){displayAlertDialog("Error in populateFunctionalAreasForOfflineBudgetRequestSubmissionForm(): "+t+", "+i)}})}catch(n){console.log("Exception in populateFunctionalAreasForOfflineBudgetRequestSubmissionForm(): "+n.message+", "+n.stack)}}function validateCapexForm2(){var n,t,i;try{if(console.log("In validateCapexForm2()."),n=!0,document.getElementById("strProjectTitleInXslForm").value==""&&(n=!1,displayAlertDialog('Please enter a "Description" before submitting your request.')),n&&document.getElementById("strBriefDescriptionOfProjectInXslForm").value==""&&requireRequestDetails==!0&&(n=!1,displayAlertDialog('Please enter some "Details" before submitting your request.')),n)try{console.log("dblRequestedCapitalInXslForm2: "+document.getElementById("dblRequestedCapitalInXslForm2").innerHTML);document.getElementById("dblRequestedCapitalInXslForm2").innerHTML==""?(n=!1,displayAlertDialog('Please enter a value for "Requested Amount" before submitting your request.')):(t=document.getElementById("dblRequestedCapitalInXslForm2").innerHTML,i=parseFloat(t.replace(/[^0-9-.]/g,"")),isNumberGreaterThanZero(i)||(n=!1,displayAlertDialog('xPlease enter a value greater than zero for "Requested Amount" before submitting your request.'),document.getElementById("dblRequestedCapitalInXslForm2").innerHTML=""))}catch(r){n=!1;displayAlertDialog('Please enter a value for "Requested Amount" before submitting your request.')}if(n&&document.getElementById("txtProjectManagerNameInXslForm").innerHTML==""&&(n=!1,displayAlertDialog('Please select a "'+newBudgetRequestManagerTitle+'" before submitting your request.')),n)try{document.getElementById("ddlYearInXslForm").innerHTML==""&&(n=!1,displayAlertDialog('Please select a "Year" before submitting your request.'))}catch(r){console.log('Exception trying to retrieve Year value from "ddlFunctionalAreaInXslForm".')}if(n)try{document.getElementById("ddlFunctionalAreaInXslForm").innerHTML==""&&(n=!1,displayAlertDialog('Please select a "Financial Area" before submitting your request.'))}catch(r){console.log('Exception trying to retrieve Functional Area value from "ddlFunctionalAreaInXslForm".')}return n}catch(r){console.log("Exception in validateCapexForm2(): "+r.message+", "+r.stack)}}function validateCapexForm3(){var n,t,u,f,i;try{if(console.log("In validateCapexForm3()."),n=!0,document.getElementById("strProjectTitle").value==""&&(n=!1,displayAlertDialog('Please enter a "Description" before submitting your request.')),n&&document.getElementById("strBriefDescriptionOfProject").value==""&&requireRequestDetails==!0&&(n=!1,displayAlertDialog('Please enter some "Details" before submitting your request.')),n)try{try{t=document.getElementById("dblRequestedCapital").value}catch(r){t=document.getElementById("dblRequestedCapital").innerHTML}console.log("dblRequestedCapital: "+t);t==""?(n=!1,displayAlertDialog('Please enter a value for "Requested Amount" before submitting your request.')):(u=t,f=parseFloat(u.replace(/[^0-9-.]/g,"")),isNumberGreaterThanZero(f)||(n=!1,displayAlertDialog('xPlease enter a value greater than zero for "Requested Amount" before submitting your request.'),document.getElementById("dblRequestedCapital").innerHTML=""))}catch(r){n=!1;displayAlertDialog('Please enter a value for "Requested Amount" before submitting your request.')}if(n){try{i=document.getElementById("txtProjectManagerName").value}catch(r){i=document.getElementById("txtProjectManagerName").innerHTML}console.log("projectManagerName: "+i);i==""&&(n=!1,displayAlertDialog('Please select a "'+newBudgetRequestManagerTitle+'" before submitting your request.'))}if(n)try{document.getElementById("ddlYear").innerHTML==""&&(n=!1,displayAlertDialog('Please select a "Year" before submitting your request.'))}catch(r){n=!1;console.log('Exception trying to retrieve Year value from "ddlYear".')}if(n)try{document.getElementById("ddlFunctionalArea").selectedIndex==0&&(n=!1,displayAlertDialog('Please select a "Financial Area" before submitting your request.'))}catch(r){n=!1;console.log('Exception trying to retrieve Functional Area value from "ddlFunctionalArea".')}return n}catch(r){return console.log("Exception in validateCapexForm2(): "+r.message+", "+r.stack),!1}}function validateNewBudgetRequestFormForRecurringExpense(){var n=!0,o,v,u,e,a,s,h,i,f,y;if($('span[xd\\:binding = "my:Project_Name"]')[0].innerHTML==""&&(n=!1,displayAlertDialog('Please enter a "Description" before submitting your request.')),n==!0){try{o=document.getElementById("dtRecurringExpenseNextReminderDate").value;s=!1}catch(p){h=document.getElementById("dtRecurringExpenseNextReminderDate").value;i=h.split("-");o=i[1]+"/"+i[2]+"/"+i[0];o.indexOf("undefined")>-1&&(o="");s=!0}try{if(o!=""){var t=new Date(o),c=t.getDate(),l=t.getMonth(),u=t.getFullYear(),r=new Date(u,l,c);r.getDate()==c&&r.getMonth()==l&&r.getFullYear()==u?(f=new Date,f.setHours(0,0,0,0),t.setHours(0,0,0,0),t<=f&&(n=!1,displayAlertDialog('Please specify an "Reminder Date" which occurs in the future before submitting your request.'))):(n=!1,displayAlertDialog('Please specify an "Reminder Date" before submitting your request.'))}else n=!1,displayAlertDialog('Please specify an "Reminder Date" before submitting your request.')}catch(p){n=!1;displayAlertDialog('Please specify an "Reminder Date" before submitting your request.')}}if(n&&document.getElementById("strBriefDescriptionOfProject").value==""&&requireRequestDetails==!0&&(n=!1,displayAlertDialog('Please enter some "Details" before submitting your request.')),n)try{$('span[xd\\:binding = "my:Requested_Capital"]')[0].innerHTML==""?(n=!1,displayAlertDialog('Please enter a value for "Requested Capital" before submitting your request.')):(v=$('span[xd\\:binding = "my:Requested_Capital"]')[0].innerHTML,u=parseFloat(v.replace(/[^0-9-.]/g,"")),isNumberGreaterThanZero(u)||(n=!1,displayAlertDialog('Please enter a value greater than zero for "Requested Capital" before submitting your request.')))}catch(p){n=!1;displayAlertDialog('Please enter a value for "Requested Capital" before submitting your request.')}if(n)try{$('span[xd\\:binding = "my:Project_Manager_AccountId"]')[0].innerHTML==""&&(n=!1,displayAlertDialog('Please select a "'+newBudgetRequestManagerTitle+'" before submitting your request.'))}catch(w){n=!1;displayAlertDialog('Please select a "'+newBudgetRequestManagerTitle+'" before submitting your request.')}if(n){try{e=document.getElementById("dtEstimatedStartDate").value;s=!1}catch(p){h=document.getElementById("dtEstimatedStartDate").value;i=h.split("-");e=i[1]+"/"+i[2]+"/"+i[0];e.indexOf("undefined")>-1&&(e="");s=!0}try{if(e!=""){var t=new Date(e),c=t.getDate(),l=t.getMonth(),u=t.getFullYear(),r=new Date(u,l,c);r.getDate()==c&&r.getMonth()==l&&r.getFullYear()==u?(f=new Date,f.setHours(0,0,0,0),t.setHours(0,0,0,0),t<f&&(n=!1,displayAlertDialog('Please specify an "Estimated Start Date" which occurs today or in the future before submitting your request.'))):(n=!1,displayAlertDialog('Please specify an "Estimated Start Date" before submitting your request.'))}else requireStartEndDates==!0&&(n=!1,displayAlertDialog('Please specify an "Estimated Start Date" before submitting your request.'))}catch(p){n=!1;displayAlertDialog('Please specify an "Estimated Start Date" before submitting your request.')}}if(n){try{a=document.getElementById("dtEstimatedEndDate").value;s=!1}catch(p){h=document.getElementById("dtEstimatedEndDate").value;i=h.split("-");a=i[1]+"/"+i[2]+"/"+i[0];a.indexOf("undefined")>-1&&(a="");s=!0}try{if(a!=""){var t=new Date(a),c=t.getDate(),l=t.getMonth(),u=t.getFullYear(),r=new Date(u,l,c);r.getDate()==c&&r.getMonth()==l&&r.getFullYear()==u?(f=new Date,t<f?(n=!1,displayAlertDialog('Please specify an "Estimated End Date" which occurs in the future before submitting your request.')):(y=new Date(e),t<y&&(n=!1,displayAlertDialog('Please specify an "Estimated End Date" which occurs the same day, or after the "Estimated Start Date" before submitting your request.')))):(n=!1,displayAlertDialog('Please specify an "Estimated End Date" before submitting your request.'))}else requireStartEndDates==!0&&(n=!1,displayAlertDialog('Please specify an "Estimated End Date" before submitting your request.'))}catch(p){n=!1;displayAlertDialog('Please specify an "Estimated End Date" before submitting your request.')}}return n}function validateSupplementalRequest(){var n=!0,t,i;if(document.getElementById("strProjectTitle").value==""&&(n=!1,displayAlertDialog('Please enter a "Description" before submitting your request.')),n&&document.getElementById("strBriefDescriptionOfProject").value==""&&requireRequestDetails==!0&&(n=!1,displayAlertDialog('Please enter some "Details" before submitting your request.')),n)try{document.getElementById("dblRequestedCapital").value==""?(n=!1,displayAlertDialog('Please enter a value for "Requested Amount" before submitting your request.')):(t=document.getElementById("dblRequestedCapital").value,i=parseFloat(t.replace(/[^0-9-.]/g,"")),isNumberGreaterThanZero(i)||(n=!1,displayAlertDialog('Please enter a value greater than zero for "Requested Amount" before submitting your request.'),document.getElementById("dblRequestedCapital").value=""))}catch(r){n=!1;displayAlertDialog('Please enter a value for "Requested Amount" before submitting your request.')}return n}function validateProjectManager(){var n=!1,t;try{return t=document.getElementById("txtProjectManagerName").value,t!=""&&(n=!0),n}catch(i){return!1}}function createXmlDocument_InitAr(n){var t='<?xml version="1.0" encoding="UTF-8"?>',o,s,e,f,h,c,l,r,u,i,v;try{t+='<my:myFields  xmlns:pc="http://schemas.microsoft.com/office/infopath/2007/PartnerControls" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2012-09-11T20:22:29"  xmlns:xd="http://schemas.microsoft.com/office/infopath/2003">';t+="<my:BudgetRequestId>"+n+"<\/my:BudgetRequestId>";o=document.getElementById("dblOfflineRequestRequestedCapital").value;s=parseFloat(o.replace(/[^0-9-.]/g,""));t+="<my:Requested_Capital>"+s+"<\/my:Requested_Capital>";e=document.getElementById("ddlFunctionalArea").value.split("|");t+="<my:Functional_Area_Id>"+e[0]+"<\/my:Functional_Area_Id>";f=$("#ddlFunctionalArea option:selected").text();f=f.replace(/&/g,"&amp;");t+="<my:Functional_Area>"+f+"<\/my:Functional_Area>";h=e[1]==!0?!0:!1;t+="<my:Quote>"+h+"<\/my:Quote>";c=encodeURIComponent(document.getElementById("strOfflineRequestBriefDescriptionOfProject").value);t+="<my:Brief_Description_of_Project>"+c+"<\/my:Brief_Description_of_Project>";l=encodeURIComponent(document.getElementById("strOfflineRequestProjectTitle").value);t+="<my:Project_Name>"+l+"<\/my:Project_Name>";t+='<my:Requested_Expense xsi:nil="true">0<\/my:Requested_Expense>';document.getElementById("dtOfflineRequestEstimatedStartDate")?r=document.getElementById("dtOfflineRequestEstimatedStartDate").value:(r=document.getElementById("dtEstimatedStartDate").value,i=r.split("-"),r=i[1]+"/"+i[2]+"/"+i[0],r.indexOf("undefined")>-1&&(r=""));t+="<my:Estimated_Start_Date>"+r+"<\/my:Estimated_Start_Date>";document.getElementById("dtOfflineRequestEstimatedEndDate")?u=document.getElementById("dtOfflineRequestEstimatedEndDate").value:(u=document.getElementById("dtEstimatedEndDate").value,i=u.split("-"),u=i[1]+"/"+i[2]+"/"+i[0],u.indexOf("undefined")>-1&&(u=""));t+="<my:Estimated_End_Date>"+u+"<\/my:Estimated_End_Date>";t+='<my:Budget_Amount2 xsi:nil="true"><\/my:Budget_Amount2>';t+="<my:Location><\/my:Location>";t+="<my:Cost_Center><\/my:Cost_Center>";t+="<my:FormStatus>FALSE<\/my:FormStatus>";t+="<my:Budget_Category><\/my:Budget_Category>";t+='<my:field3 xsi:nil="true"><\/my:field3>';t+="<my:AttachmentsFolderName>";t+=attachmentsFolderName;t+="<\/my:AttachmentsFolderName>";t+="<my:CapexAttachmentsGroup>";t+="    <my:CapexAttachments>";t+="    <\/my:CapexAttachments>";t+="<\/my:CapexAttachmentsGroup>";t+="<my:Year>"+document.getElementById("ddlYear").value+"<\/my:Year>";t+="<my:field4><\/my:field4>";var y=document.getElementById("txtProjectManagerName").value,p=document.getElementById("txtProjectManagerId").value,w=document.getElementById("txtProjectManagerEmail").value;t+="<my:Project_Manager_Hidden>";t+="\t<pc:Person>";t+="\t\t<pc:DisplayName>"+y+"<\/pc:DisplayName>";t+="\t\t<pc:AccountId>"+encodeURIComponent(p)+"<\/pc:AccountId>";t+="\t\t<pc:AccountType>"+w+"<\/pc:AccountType>";t+="\t<\/pc:Person>";t+="<\/my:Project_Manager_Hidden>";t+="<\/my:myFields>"}catch(a){v=t;t="FAILED";WriteToErrorLog("Error in ios8.js.createXmlDocument_InitAr()","Error creating the AR XML: "+a.name+", "+a.message);WriteToErrorLog("ios8.js.createXmlDocument_InitAr()",v)}return t}function createXmlDocument_InitArFromOfflineRequest(n){var t,l,a,s,e,v,h,c,r,u,i,o;console.log("In createXmlDocument_InitArFromOfflineRequest("+n+")");t='<?xml version="1.0" encoding="UTF-8"?>';try{t+='<my:myFields  xmlns:pc="http://schemas.microsoft.com/office/infopath/2007/PartnerControls" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2012-09-11T20:22:29"  xmlns:xd="http://schemas.microsoft.com/office/infopath/2003">';t+="<my:BudgetRequestId>"+n+"<\/my:BudgetRequestId>";l=document.getElementById("dblRequestedCapitalInXslForm2").innerHTML;a=parseFloat(l.replace(/[^0-9-.]/g,""));t+="<my:Requested_Capital>"+a+"<\/my:Requested_Capital>";s=document.getElementById("ddlFunctionalAreaInXslForm").value.split("|");t+="<my:Functional_Area_Id>"+s[0]+"<\/my:Functional_Area_Id>";e=$("#ddlFunctionalAreaInXslForm option:selected").text();e=e.replace(/&/g,"&amp;");t+="<my:Functional_Area>"+e+"<\/my:Functional_Area>";console.log("In createXmlDocument_InitArFromOfflineRequest(). curFunctionalArea: "+e);v=s[1]==!0?!0:!1;t+="<my:Quote>"+v+"<\/my:Quote>";h=encodeURIComponent(document.getElementById("strBriefDescriptionOfProjectInXslForm").innerHTML);t+="<my:Brief_Description_of_Project>"+h+"<\/my:Brief_Description_of_Project>";console.log("In createXmlDocument_InitArFromOfflineRequest(). curBriefDescription: "+h);c=encodeURIComponent(document.getElementById("strProjectTitleInXslForm").innerHTML);t+="<my:Project_Name>"+c+"<\/my:Project_Name>";console.log("In createXmlDocument_InitArFromOfflineRequest(). curProjectName: "+c);t+='<my:Requested_Expense xsi:nil="true">0<\/my:Requested_Expense>';r=document.getElementById("dtEstimatedStartDate").value;i=r.split("-");r=i[1]+"/"+i[2]+"/"+i[0];r.indexOf("undefined")>-1&&(r="");t+="<my:Estimated_Start_Date>"+r+"<\/my:Estimated_Start_Date>";u=document.getElementById("dtEstimatedEndDate").value;i=u.split("-");u=i[1]+"/"+i[2]+"/"+i[0];u.indexOf("undefined")>-1&&(u="");t+="<my:Estimated_End_Date>"+u+"<\/my:Estimated_End_Date>";t+='<my:Budget_Amount2 xsi:nil="true"><\/my:Budget_Amount2>';t+="<my:Location><\/my:Location>";t+="<my:Cost_Center><\/my:Cost_Center>";t+="<my:FormStatus>FALSE<\/my:FormStatus>";t+="<my:Budget_Category><\/my:Budget_Category>";t+='<my:field3 xsi:nil="true"><\/my:field3>';t+="<my:AttachmentsFolderName>";t+=attachmentsFolderName;t+="<\/my:AttachmentsFolderName>";t+="<my:CapexAttachmentsGroup>";t+="    <my:CapexAttachments>";t+="    <\/my:CapexAttachments>";t+="<\/my:CapexAttachmentsGroup>";t+="<my:Year>"+document.getElementById("ddlYear").value+"<\/my:Year>";t+="<my:field4><\/my:field4>";var y=document.getElementById("txtProjectManagerName").value,p=document.getElementById("txtProjectManagerId").value,w=document.getElementById("txtProjectManagerEmail").value;t+="<my:Project_Manager_Hidden>";t+="\t<pc:Person>";t+="\t\t<pc:DisplayName>"+y+"<\/pc:DisplayName>";t+="\t\t<pc:AccountId>"+encodeURIComponent(p)+"<\/pc:AccountId>";t+="\t\t<pc:AccountType>"+w+"<\/pc:AccountType>";t+="\t<\/pc:Person>";t+="<\/my:Project_Manager_Hidden>";t+="<\/my:myFields>"}catch(f){o=t;t="FAILED";WriteToErrorLog("Error in ios8.js.createXmlDocument_InitArFromOfflineRequest()","Error creating the AR XML: "+f.name+", "+f.message);WriteToErrorLog("ios8.js.createXmlDocument_InitArFromOfflineRequest()",o);console.log("Exception in ios8.js.createXmlDocument_InitArFromOfflineRequest(): "+f.name+", "+f.message+", "+o);displayAlertDialog("Exception in ios8.js.createXmlDocument_InitArFromOfflineRequest(): "+f.name+", "+f.message+", "+o)}return t}function createXmlDocument_InitRecurringExpense(n){var t='<?xml version="1.0" encoding="UTF-8"?>',c,l,a,s,v,y,p,i,e,u,o,r,tt;try{t+='<my:myFields  xmlns:pc="http://schemas.microsoft.com/office/infopath/2007/PartnerControls" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2012-09-11T20:22:29"  xmlns:xd="http://schemas.microsoft.com/office/infopath/2003">';t+="<my:RecurringExpenseId>"+n+"<\/my:RecurringExpenseId>";c=document.getElementById("dblRequestedCapital").value;l=parseFloat(c.replace(/[^0-9-.]/g,""));t+="<my:Requested_Capital>"+l+"<\/my:Requested_Capital>";a=document.getElementById("ddlFunctionalArea").value.split("|");t+="<my:Functional_Area_Id>"+a[0]+"<\/my:Functional_Area_Id>";s=$("#ddlFunctionalArea option:selected").text();s=s.replace(/&/g,"&amp;");t+="<my:Functional_Area>"+s+"<\/my:Functional_Area>";v=!1;t+="<my:Quote>"+v+"<\/my:Quote>";y=document.getElementById("strBriefDescriptionOfProject").value;t+="<my:Brief_Description_of_Project>"+y+"<\/my:Brief_Description_of_Project>";p=document.getElementById("strProjectTitle").value;t+="<my:Project_Name>"+p+"<\/my:Project_Name>";t+='<my:Requested_Expense xsi:nil="true">0<\/my:Requested_Expense>';try{if(e=document.getElementById("dtEstimatedStartDate").value,e=="")i="";else{var f=new Date,w=e.split("/")[2],b=e.split("/")[0],k=e.split("/")[1],d=f.getHours(),g=f.getMinutes(),nt=f.getSeconds();i=w+"-"+b+"-"+k+"T:"+d+":"+g+":"+nt}}catch(h){i=document.getElementById("dtEstimatedStartDate").value;r=i.split("-");i=r[1]+"/"+r[2]+"/"+r[0];i.indexOf("undefined")>-1&&(i="")}t+="<my:Estimated_Start_Date>"+i+"<\/my:Estimated_Start_Date>";try{if(o=document.getElementById("dtEstimatedEndDate").value,o=="")u="";else{var f=new Date,w=o.split("/")[2],b=o.split("/")[0],k=o.split("/")[1],d=f.getHours(),g=f.getMinutes(),nt=f.getSeconds();u=w+"-"+b+"-"+k+"T:"+d+":"+g+":"+nt}}catch(h){u=document.getElementById("dtEstimatedEndDate").value;r=u.split("-");u=r[1]+"/"+r[2]+"/"+r[0];u.indexOf("undefined")>-1&&(u="")}t+="<my:Estimated_End_Date>"+u+"<\/my:Estimated_End_Date>";t+='<my:Budget_Amount2 xsi:nil="true"><\/my:Budget_Amount2>';t+="<my:Location><\/my:Location>";t+="<my:Cost_Center><\/my:Cost_Center>";t+="<my:FormStatus>FALSE<\/my:FormStatus>";t+="<my:Budget_Category><\/my:Budget_Category>";t+='<my:field3 xsi:nil="true"><\/my:field3>';t+="<my:AttachmentsFolderName>";t+=attachmentsFolderName;t+="<\/my:AttachmentsFolderName>";t+="<my:CapexAttachmentsGroup>";t+="    <my:CapexAttachments>";t+="    <\/my:CapexAttachments>";t+="<\/my:CapexAttachmentsGroup>";t+="<my:Year>"+document.getElementById("ddlYear").value+"<\/my:Year>";t+="<my:field4><\/my:field4>";var it=document.getElementById("txtProjectManagerName").value,rt=document.getElementById("txtProjectManagerId").value,ut=document.getElementById("txtProjectManagerEmail").value;t+="<my:Project_Manager_Hidden>";t+="\t<pc:Person>";t+="\t\t<pc:DisplayName>"+it+"<\/pc:DisplayName>";t+="\t\t<pc:AccountId>"+encodeURIComponent(rt)+"<\/pc:AccountId>";t+="\t\t<pc:AccountType>"+ut+"<\/pc:AccountType>";t+="\t<\/pc:Person>";t+="<\/my:Project_Manager_Hidden>";t+="<\/my:myFields>"}catch(h){tt=t;displayAlertDialog("Error creating the AR XML. "+h.message);WriteToErrorLog("Error in ios8.js.createXmlDocument_InitRecurringExpense()","Error creating the AR XML: "+h.name+", "+h.message);WriteToErrorLog("ios8.js.createXmlDocument_InitRecurringExpense()",tt)}return t}function createXmlDocument_InitRecurringExpenseBudgetRequest(n){var t='<?xml version="1.0" encoding="UTF-8"?>',c,l,a,s,v,y,p,i,e,u,o,r,tt;try{t+='<my:myFields  xmlns:pc="http://schemas.microsoft.com/office/infopath/2007/PartnerControls" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2012-09-11T20:22:29"  xmlns:xd="http://schemas.microsoft.com/office/infopath/2003">';t+="<my:BudgetRequestId>"+n+"<\/my:BudgetRequestId>";c=$('span[xd\\:binding = "my:Requested_Capital"]')[0].innerHTML;l=parseFloat(c.replace(/[^0-9-.]/g,""));t+="<my:Requested_Capital>"+l+"<\/my:Requested_Capital>";a=document.getElementById("ddlFunctionalArea").value.split("|");t+="<my:Functional_Area_Id>"+a[0]+"<\/my:Functional_Area_Id>";s=$("#ddlFunctionalArea option:selected").text();s=s.replace(/&/g,"&amp;");t+="<my:Functional_Area>"+s+"<\/my:Functional_Area>";v=!1;t+="<my:Quote>"+v+"<\/my:Quote>";y=encodeURIComponent($('span[xd\\:binding = "my:Brief_Description_of_Project"]')[0].innerHTML);t+="<my:Brief_Description_of_Project>"+y+"<\/my:Brief_Description_of_Project>";p=encodeURIComponent($('span[xd\\:binding = "my:Project_Name"]')[0].innerHTML);t+="<my:Project_Name>"+p+"<\/my:Project_Name>";t+='<my:Requested_Expense xsi:nil="true">0<\/my:Requested_Expense>';try{if(e=document.getElementById("dtEstimatedStartDate").value,e=="")i="";else{var f=new Date,w=e.split("/")[2],b=e.split("/")[0],k=e.split("/")[1],d=f.getHours(),g=f.getMinutes(),nt=f.getSeconds();i=w+"-"+b+"-"+k+"T:"+d+":"+g+":"+nt}}catch(h){i=document.getElementById("dtEstimatedStartDate").value;r=i.split("-");i=r[1]+"/"+r[2]+"/"+r[0];i.indexOf("undefined")>-1&&(i="")}t+="<my:Estimated_Start_Date>"+i+"<\/my:Estimated_Start_Date>";try{if(o=document.getElementById("dtEstimatedEndDate").value,o=="")u="";else{var f=new Date,w=o.split("/")[2],b=o.split("/")[0],k=o.split("/")[1],d=f.getHours(),g=f.getMinutes(),nt=f.getSeconds();u=w+"-"+b+"-"+k+"T:"+d+":"+g+":"+nt}}catch(h){u=document.getElementById("dtEstimatedEndDate").value;r=u.split("-");u=r[1]+"/"+r[2]+"/"+r[0];u.indexOf("undefined")>-1&&(u="")}t+="<my:Estimated_End_Date>"+u+"<\/my:Estimated_End_Date>";t+='<my:Budget_Amount2 xsi:nil="true"><\/my:Budget_Amount2>';t+="<my:Location><\/my:Location>";t+="<my:Cost_Center><\/my:Cost_Center>";t+="<my:FormStatus>FALSE<\/my:FormStatus>";t+="<my:Budget_Category><\/my:Budget_Category>";t+='<my:field3 xsi:nil="true"><\/my:field3>';t+="<my:AttachmentsFolderName>";t+=attachmentsFolderName;t+="<\/my:AttachmentsFolderName>";t+="<my:CapexAttachmentsGroup>";t+="    <my:CapexAttachments>";t+="    <\/my:CapexAttachments>";t+="<\/my:CapexAttachmentsGroup>";t+="<my:Year>"+document.getElementById("ddlYear").value+"<\/my:Year>";t+="<my:field4><\/my:field4>";var it=document.getElementById("txtProjectManagerName").value,rt=document.getElementById("txtProjectManagerId").value,ut=document.getElementById("txtProjectManagerEmail").value;t+="<my:Project_Manager_Hidden>";t+="\t<pc:Person>";t+="\t\t<pc:DisplayName>"+it+"<\/pc:DisplayName>";t+="\t\t<pc:AccountId>"+encodeURIComponent(rt)+"<\/pc:AccountId>";t+="\t\t<pc:AccountType>"+ut+"<\/pc:AccountType>";t+="\t<\/pc:Person>";t+="<\/my:Project_Manager_Hidden>";t+="<\/my:myFields>"}catch(h){tt=t;displayAlertDialog("Error creating the AR XML. "+h.message);WriteToErrorLog("Error in ios8.js.createXmlDocument_InitRecurringExpenseBudgetRequest()","Error creating the AR XML: "+h.name+", "+h.message);WriteToErrorLog("ios8.js.createXmlDocument_InitRecurringExpenseBudgetRequest()",tt)}return t}function createXmlDocument_InitSupplementalAr(n,t,i){var r='<?xml version="1.0" encoding="UTF-8"?>',f,e,o,s,h;try{r+='<my:myFields  xmlns:pc="http://schemas.microsoft.com/office/infopath/2007/PartnerControls" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2012-09-11T20:22:29"  xmlns:xd="http://schemas.microsoft.com/office/infopath/2003">';r+="<my:BudgetRequestId>"+i+"<\/my:BudgetRequestId>";f=document.getElementById("dblRequestedCapital").value;e=parseFloat(f.replace(/[^0-9-.]/g,""));r+="<my:Requested_Capital>"+e+"<\/my:Requested_Capital>";r+="<my:Functional_Area_Id>"+n+"<\/my:Functional_Area_Id>";r+="<my:Functional_Area>needtopassthefatitle<\/my:Functional_Area>";r+="<my:Quote>needtopassquotevalue<\/my:Quote>";o=encodeURIComponent(document.getElementById("strBriefDescriptionOfProject").value);r+="<my:Brief_Description_of_Project>"+o+"<\/my:Brief_Description_of_Project>";s=encodeURIComponent(document.getElementById("strProjectTitle").value);r+="<my:Project_Name>"+s+"<\/my:Project_Name>";r+='<my:Requested_Expense xsi:nil="true">0<\/my:Requested_Expense>';r+="<my:Estimated_Start_Date><\/my:Estimated_Start_Date>";r+="<my:Estimated_End_Date><\/my:Estimated_End_Date>";r+='<my:Budget_Amount2 xsi:nil="true"><\/my:Budget_Amount2>';r+="<my:Location><\/my:Location>";r+="<my:Cost_Center><\/my:Cost_Center>";r+="<my:FormStatus>FALSE<\/my:FormStatus>";r+="<my:Budget_Category><\/my:Budget_Category>";r+='<my:field3 xsi:nil="true"><\/my:field3>';r+="<my:AttachmentsFolderName>";r+=attachmentsFolderName;r+="<\/my:AttachmentsFolderName>";r+="<my:CapexAttachmentsGroup>";r+="    <my:CapexAttachments>";r+="    <\/my:CapexAttachments>";r+="<\/my:CapexAttachmentsGroup>";r+="<my:Year>needtopassyearvalue<\/my:Year>";r+="<my:field4><\/my:field4>";r+="<\/my:myFields>"}catch(u){h=r;displayAlertDialog("Error creating the AR XML. "+u.message);WriteToErrorLog("Error in ios8.js.createXmlDocument_InitAr()","Error creating the AR XML: "+u.name+", "+u.message);WriteToErrorLog("ios8.js.createXmlDocument_InitAr()",h)}return r}var ajaxTimeout=3e3,Platform="IOS8",viewsFolderName="viewsIos8",iOSApp="",sharedFileFromIosFileContents,sharedFileFromIosFileName,sharedFileFromIosFileDescription,globalUrlPrefix="https://",globalUrl="budgetworkflow.com",globalUrlForWebServices="budgetworkflow.com",appHasBeenLaunchedFromEmailForThisRequestId="",errors="",connectionTimerObject,invitationAlreadyAccepted=!1,tempCloseOutXml,monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],googleOAuth2ClientId="327984438236-gka01b83peci6bd8oue6o15m8c9k5jpb.apps.googleusercontent.com",attachmentsFolderName="",tenantId,globalArchiveFilter,globalLicenses=[],gWorkflowLicenseStatus="gold",tipsDisplayOn=!1,displayInvitationsOnHomePageDisplayOn=!0,displayNewRequestsOnHomePageDisplayOn=!0,displayTaskDetailsBeforeRequests=!1,selectedCurrencySymbol,newBudgetRequestManagerTitle,bwLastSelectedArchiveScreenRequestType,bwLastSelectedNewRequestType,requireStartEndDates,requireRequestDetails,enableNewRequestAttachments,enableNewRequestBarcodeAttachments,bwEnabledRequestTypes={EnabledItems:[],Details:{BudgetRequests:{Enabled:!1,Ordinal:1,Text:"Budget Request",PluralText:"Budget Requests"},CapitalPlanProjects:{Enabled:!1,Ordinal:2,Text:"Capital Plan Project",PluralText:"Capital Plan Projects"},QuoteRequests:{Enabled:!1,Ordinal:3,Text:"Quote Request",PluralText:"Quote Requests"},ReimbursementRequests:{Enabled:!1,Ordinal:4,Text:"Reimbursement Request",PluralText:"Reimbursement Requests"},RecurringExpenses:{Enabled:!1,Ordinal:5,Text:"Recurring Expense",PluralText:"Recurring Expenses"},WorkOrders:{Enabled:!1,Ordinal:6,Text:"Work Order",PluralText:"Work Orders"}}},quotingEnabled,closeoutsEnabled,capitalAndExpenseTrackingEnabled,reimbursementRequestsEnabled,recurringExpensesEnabled,supplementalsEnabled,strictAuditingEnabled,emailNotificationFrequency,emailNotificationTypes,emailAggregatorTwiceDailyFirstTime,emailAggregatorTwiceDailySecondTime,emailAggregatorTwiceDailyTimezoneDisplayName,workflowAppId,workflowAppTitle,bwApprovalLevelWorkflowToken,filename,hideLoggedInUserDropDownFirstClickTracker,invitationUserId,participantId,participantLogonType,participantLogonTypeUserId,participantFriendlyName,participantEmail,webserviceurl,appweburl2,appweburl,hostweburl,sliceColors=["#005391","#B7CA10","#3A4A01","#87C8F0","#8E1828","#63A01F","#F8D033","#FD5E1D"],sliceHighlightedColors=["#4C86B2","#BFCA5B","#75804D","#B9DBF0","#8B3D47","#A0BC81","#F4D971","#EA8E69"],GetWorkflowAppConfigurationData9,GetWorkflowAppConfigurationData,GetUserDetails=[],RenderFinancialSummaryForSingleWorkflow,GetSingleWorkflowDataForFinancialSummary,RenderParticipantSummaryForSingleWorkflow,GetPendingBudgetRequestsByFunctionalAreaForSingleWorkflow,GetSingleParticipantDataAndRender,lastErrorSource="",newFunctionalAreaAdditionalApprovers=[],notifications=[],budgetRequests,supplementals,statusesForTheStatusDropdown,BWMData=[],tipToggle,tipsInitialized,arDialogDisplayRetryAttempt,arDialogDisplayRetryAttemptTimerObject;BWMData=new Array(2);$(document).ready(function(){var r,u,i,n;try{$.ajaxSetup({cache:!1});webserviceurl=globalUrlPrefix+globalUrlForWebServices+"/_bw";appweburl=globalUrlPrefix+globalUrlForWebServices;appweburl2=globalUrlPrefix+globalUrl;r=$("#divBwAuthentication").bwAuthentication({});u=window.setInterval(timedCheckForAlertsForIosBadgeUpdateUsingTitle,15e3);navigator.userAgent.toLowerCase().match(/android/i)&&document.getElementById("primaryStylesheet").setAttribute("href","css/appandroid2.min.css");window.onorientationchange=readDeviceOrientation;i="";try{i=getUrlParams().ActiveStateIdentifier.toString().split("#")[0]}catch(t){}i!=""?initializeTheLogon():(n=indexedDB.open(indexDBName,dbVersion),n.onblocked=function(n){console.log("In ios8.js.document.ready.openRequestsDatabase.onblocked(): errorCode: "+n.target.errorCode);displayAlertDialog("In ios8.js.document.ready.openRequestsDatabase.onblocked(): errorCode: "+n.target.errorCode)},n.onerror=function(n){console.log("In ios8.js.document.ready.openRequestsDatabase.onerror(): errorCode: "+n.target.errorCode);displayAlertDialog("In ios8.js.document.ready.openRequestsDatabase.onerror(): errorCode: "+n.target.errorCode);renderWelcomePageOffline()},n.onsuccess=function(){console.log("Success accessing IndexedDB database.");renderWelcomePageOffline()},n.onupgradeneeded=function(n){var i,r,t,u;console.log('The database "'+indexDBName+'" did not exist, so it is being created.');i=n.target.result;r=i.createObjectStore("objectStoreCachedRequests",{autoIncrement:!0});r.transaction.oncomplete=function(){console.log("In $(document).ready().objectStoreCachedRequests.transaction.oncomplete().");displayAlertDialog("1")};t=i.createObjectStore("OfflineAttachedFiles",{autoIncrement:!0,keyPath:"id"});t.transaction.oncomplete=function(){displayAlertDialog("2");console.log("In $(document).ready().objectStoreOfflineFiles.transaction.oncomplete(). Preparing to create indexes.");t.createIndex("encodingType","encodingType",{unique:!1});t.createIndex("fileContents","fileContents",{unique:!1});t.createIndex("fileName","fileName",{unique:!1});t.createIndex("fileDescription","fileDescription",{unique:!1});t.createIndex("bwBudgetRequestId","bwBudgetRequestId",{unique:!1});console.log("In $(document).ready().objectStoreOfflineFiles.transaction.oncomplete(). Successfully created indexes.")};u=i.createObjectStore("objectStoreCachedXsltFiles");u.transaction.oncomplete=function(){console.log("In $(document).ready().objectStoreXsltFiles.transaction.oncomplete().");loadXslFiles()}});$("#welcomePageTabs").tabs({active:1,activate:function(n,t){var i=t.newTab.index(),r;console.log("The user selected tab # "+i);i==2?populateStartPageItem("divArchive2","Reports",""):i==0?(console.log("DISPLAY THE NEW FORM HERE!!!!!!!!!!!!!!!!!!!!!!"),r="budgetrequest",$(".bwRequest").bwRequest("displayCreateRequestFormForMobile",r)):i==1}})}catch(t){console.log("Exception in ios8.js.document.ready(): "+t.message+", "+t.stack);displayAlertDialog("Exception in ios8.js.document.ready(): "+t.message+", "+t.stack)}});tipToggle=!1;tipsInitialized=!1;arDialogDisplayRetryAttempt=0;
//# sourceMappingURL=ios8.min.js.map
